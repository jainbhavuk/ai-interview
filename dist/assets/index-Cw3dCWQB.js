(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function Ff(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mp={exports:{}},sl={};var mw;function XN(){if(mw)return sl;mw=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,o){var u=null;if(o!==void 0&&(u=""+o),s.key!==void 0&&(u=""+s.key),"key"in s){o={};for(var f in s)f!=="key"&&(o[f]=s[f])}else o=s;return s=o.ref,{$$typeof:e,type:r,key:u,ref:s!==void 0?s:null,props:o}}return sl.Fragment=t,sl.jsx=n,sl.jsxs=n,sl}var gw;function YN(){return gw||(gw=1,Mp.exports=XN()),Mp.exports}var G=YN(),jp={exports:{}},$e={};var _w;function QN(){if(_w)return $e;_w=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),y=Symbol.iterator;function v(I){return I===null||typeof I!="object"?null:(I=y&&I[y]||I["@@iterator"],typeof I=="function"?I:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,R={};function E(I,D,V){this.props=I,this.context=D,this.refs=R,this.updater=V||w}E.prototype.isReactComponent={},E.prototype.setState=function(I,D){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,D,"setState")},E.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function A(){}A.prototype=E.prototype;function N(I,D,V){this.props=I,this.context=D,this.refs=R,this.updater=V||w}var M=N.prototype=new A;M.constructor=N,x(M,E.prototype),M.isPureReactComponent=!0;var B=Array.isArray;function Y(){}var W={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function Te(I,D,V){var ie=V.ref;return{$$typeof:e,type:I,key:D,ref:ie!==void 0?ie:null,props:V}}function xe(I,D){return Te(I.type,D,I.props)}function me(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function Je(I){var D={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(V){return D[V]})}var At=/\/+/g;function ue(I,D){return typeof I=="object"&&I!==null&&I.key!=null?Je(""+I.key):D.toString(36)}function se(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(Y,Y):(I.status="pending",I.then(function(D){I.status==="pending"&&(I.status="fulfilled",I.value=D)},function(D){I.status==="pending"&&(I.status="rejected",I.reason=D)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function $(I,D,V,ie,he){var O=typeof I;(O==="undefined"||O==="boolean")&&(I=null);var S=!1;if(I===null)S=!0;else switch(O){case"bigint":case"string":case"number":S=!0;break;case"object":switch(I.$$typeof){case e:case t:S=!0;break;case m:return S=I._init,$(S(I._payload),D,V,ie,he)}}if(S)return he=he(I),S=ie===""?"."+ue(I,0):ie,B(he)?(V="",S!=null&&(V=S.replace(At,"$&/")+"/"),$(he,D,V,"",function(Pe){return Pe})):he!=null&&(me(he)&&(he=xe(he,V+(he.key==null||I&&I.key===he.key?"":(""+he.key).replace(At,"$&/")+"/")+S)),D.push(he)),1;S=0;var Q=ie===""?".":ie+":";if(B(I))for(var L=0;L<I.length;L++)ie=I[L],O=Q+ue(ie,L),S+=$(ie,D,V,O,he);else if(L=v(I),typeof L=="function")for(I=L.call(I),L=0;!(ie=I.next()).done;)ie=ie.value,O=Q+ue(ie,L++),S+=$(ie,D,V,O,he);else if(O==="object"){if(typeof I.then=="function")return $(se(I),D,V,ie,he);throw D=String(I),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return S}function F(I,D,V){if(I==null)return I;var ie=[],he=0;return $(I,ie,"","",function(O){return D.call(V,O,he++)}),ie}function ne(I){if(I._status===-1){var D=I._result;D=D(),D.then(function(V){(I._status===0||I._status===-1)&&(I._status=1,I._result=V)},function(V){(I._status===0||I._status===-1)&&(I._status=2,I._result=V)}),I._status===-1&&(I._status=0,I._result=D)}if(I._status===1)return I._result.default;throw I._result}var oe=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},fe={map:F,forEach:function(I,D,V){F(I,function(){D.apply(this,arguments)},V)},count:function(I){var D=0;return F(I,function(){D++}),D},toArray:function(I){return F(I,function(D){return D})||[]},only:function(I){if(!me(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return $e.Activity=_,$e.Children=fe,$e.Component=E,$e.Fragment=n,$e.Profiler=s,$e.PureComponent=N,$e.StrictMode=r,$e.Suspense=d,$e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=W,$e.__COMPILER_RUNTIME={__proto__:null,c:function(I){return W.H.useMemoCache(I)}},$e.cache=function(I){return function(){return I.apply(null,arguments)}},$e.cacheSignal=function(){return null},$e.cloneElement=function(I,D,V){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var ie=x({},I.props),he=I.key;if(D!=null)for(O in D.key!==void 0&&(he=""+D.key),D)!C.call(D,O)||O==="key"||O==="__self"||O==="__source"||O==="ref"&&D.ref===void 0||(ie[O]=D[O]);var O=arguments.length-2;if(O===1)ie.children=V;else if(1<O){for(var S=Array(O),Q=0;Q<O;Q++)S[Q]=arguments[Q+2];ie.children=S}return Te(I.type,he,ie)},$e.createContext=function(I){return I={$$typeof:u,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:o,_context:I},I},$e.createElement=function(I,D,V){var ie,he={},O=null;if(D!=null)for(ie in D.key!==void 0&&(O=""+D.key),D)C.call(D,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(he[ie]=D[ie]);var S=arguments.length-2;if(S===1)he.children=V;else if(1<S){for(var Q=Array(S),L=0;L<S;L++)Q[L]=arguments[L+2];he.children=Q}if(I&&I.defaultProps)for(ie in S=I.defaultProps,S)he[ie]===void 0&&(he[ie]=S[ie]);return Te(I,O,he)},$e.createRef=function(){return{current:null}},$e.forwardRef=function(I){return{$$typeof:f,render:I}},$e.isValidElement=me,$e.lazy=function(I){return{$$typeof:m,_payload:{_status:-1,_result:I},_init:ne}},$e.memo=function(I,D){return{$$typeof:h,type:I,compare:D===void 0?null:D}},$e.startTransition=function(I){var D=W.T,V={};W.T=V;try{var ie=I(),he=W.S;he!==null&&he(V,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(Y,oe)}catch(O){oe(O)}finally{D!==null&&V.types!==null&&(D.types=V.types),W.T=D}},$e.unstable_useCacheRefresh=function(){return W.H.useCacheRefresh()},$e.use=function(I){return W.H.use(I)},$e.useActionState=function(I,D,V){return W.H.useActionState(I,D,V)},$e.useCallback=function(I,D){return W.H.useCallback(I,D)},$e.useContext=function(I){return W.H.useContext(I)},$e.useDebugValue=function(){},$e.useDeferredValue=function(I,D){return W.H.useDeferredValue(I,D)},$e.useEffect=function(I,D){return W.H.useEffect(I,D)},$e.useEffectEvent=function(I){return W.H.useEffectEvent(I)},$e.useId=function(){return W.H.useId()},$e.useImperativeHandle=function(I,D,V){return W.H.useImperativeHandle(I,D,V)},$e.useInsertionEffect=function(I,D){return W.H.useInsertionEffect(I,D)},$e.useLayoutEffect=function(I,D){return W.H.useLayoutEffect(I,D)},$e.useMemo=function(I,D){return W.H.useMemo(I,D)},$e.useOptimistic=function(I,D){return W.H.useOptimistic(I,D)},$e.useReducer=function(I,D,V){return W.H.useReducer(I,D,V)},$e.useRef=function(I){return W.H.useRef(I)},$e.useState=function(I){return W.H.useState(I)},$e.useSyncExternalStore=function(I,D,V){return W.H.useSyncExternalStore(I,D,V)},$e.useTransition=function(){return W.H.useTransition()},$e.version="19.2.0",$e}var yw;function l_(){return yw||(yw=1,jp.exports=QN()),jp.exports}var Re=l_(),Lp={exports:{}},il={},zp={exports:{}},Dp={};var vw;function KN(){return vw||(vw=1,(function(e){function t($,F){var ne=$.length;$.push(F);e:for(;0<ne;){var oe=ne-1>>>1,fe=$[oe];if(0<s(fe,F))$[oe]=F,$[ne]=fe,ne=oe;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var F=$[0],ne=$.pop();if(ne!==F){$[0]=ne;e:for(var oe=0,fe=$.length,I=fe>>>1;oe<I;){var D=2*(oe+1)-1,V=$[D],ie=D+1,he=$[ie];if(0>s(V,ne))ie<fe&&0>s(he,V)?($[oe]=he,$[ie]=ne,oe=ie):($[oe]=V,$[D]=ne,oe=D);else if(ie<fe&&0>s(he,ne))$[oe]=he,$[ie]=ne,oe=ie;else break e}}return F}function s($,F){var ne=$.sortIndex-F.sortIndex;return ne!==0?ne:$.id-F.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,f=u.now();e.unstable_now=function(){return u.now()-f}}var d=[],h=[],m=1,_=null,y=3,v=!1,w=!1,x=!1,R=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function M($){for(var F=n(h);F!==null;){if(F.callback===null)r(h);else if(F.startTime<=$)r(h),F.sortIndex=F.expirationTime,t(d,F);else break;F=n(h)}}function B($){if(x=!1,M($),!w)if(n(d)!==null)w=!0,Y||(Y=!0,Je());else{var F=n(h);F!==null&&se(B,F.startTime-$)}}var Y=!1,W=-1,C=5,Te=-1;function xe(){return R?!0:!(e.unstable_now()-Te<C)}function me(){if(R=!1,Y){var $=e.unstable_now();Te=$;var F=!0;try{e:{w=!1,x&&(x=!1,A(W),W=-1),v=!0;var ne=y;try{t:{for(M($),_=n(d);_!==null&&!(_.expirationTime>$&&xe());){var oe=_.callback;if(typeof oe=="function"){_.callback=null,y=_.priorityLevel;var fe=oe(_.expirationTime<=$);if($=e.unstable_now(),typeof fe=="function"){_.callback=fe,M($),F=!0;break t}_===n(d)&&r(d),M($)}else r(d);_=n(d)}if(_!==null)F=!0;else{var I=n(h);I!==null&&se(B,I.startTime-$),F=!1}}break e}finally{_=null,y=ne,v=!1}F=void 0}}finally{F?Je():Y=!1}}}var Je;if(typeof N=="function")Je=function(){N(me)};else if(typeof MessageChannel<"u"){var At=new MessageChannel,ue=At.port2;At.port1.onmessage=me,Je=function(){ue.postMessage(null)}}else Je=function(){E(me,0)};function se($,F){W=E(function(){$(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function($){switch(y){case 1:case 2:case 3:var F=3;break;default:F=y}var ne=y;y=F;try{return $()}finally{y=ne}},e.unstable_requestPaint=function(){R=!0},e.unstable_runWithPriority=function($,F){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ne=y;y=$;try{return F()}finally{y=ne}},e.unstable_scheduleCallback=function($,F,ne){var oe=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?oe+ne:oe):ne=oe,$){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=ne+fe,$={id:m++,callback:F,priorityLevel:$,startTime:ne,expirationTime:fe,sortIndex:-1},ne>oe?($.sortIndex=ne,t(h,$),n(d)===null&&$===n(h)&&(x?(A(W),W=-1):x=!0,se(B,ne-oe))):($.sortIndex=fe,t(d,$),w||v||(w=!0,Y||(Y=!0,Je()))),$},e.unstable_shouldYield=xe,e.unstable_wrapCallback=function($){var F=y;return function(){var ne=y;y=F;try{return $.apply(this,arguments)}finally{y=ne}}}})(Dp)),Dp}var bw;function WN(){return bw||(bw=1,zp.exports=KN()),zp.exports}var Up={exports:{}},rn={};var ww;function eI(){if(ww)return rn;ww=1;var e=l_();function t(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(d,h,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:_==null?null:""+_,children:d,containerInfo:h,implementation:m}}var u=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,rn.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return o(d,h,null,m)},rn.flushSync=function(d){var h=u.T,m=r.p;try{if(u.T=null,r.p=2,d)return d()}finally{u.T=h,r.p=m,r.d.f()}},rn.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(d,h))},rn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},rn.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,_=f(m,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?r.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:_,integrity:y,fetchPriority:v}):m==="script"&&r.d.X(d,{crossOrigin:_,integrity:y,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},rn.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=f(h.as,h.crossOrigin);r.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(d)},rn.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,_=f(m,h.crossOrigin);r.d.L(d,m,{crossOrigin:_,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},rn.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=f(h.as,h.crossOrigin);r.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(d)},rn.requestFormReset=function(d){r.d.r(d)},rn.unstable_batchedUpdates=function(d,h){return d(h)},rn.useFormState=function(d,h,m){return u.H.useFormState(d,h,m)},rn.useFormStatus=function(){return u.H.useHostTransitionStatus()},rn.version="19.2.0",rn}var Sw;function tI(){if(Sw)return Up.exports;Sw=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Up.exports=eI(),Up.exports}var Ew;function nI(){if(Ew)return il;Ew=1;var e=WN(),t=l_(),n=tI();function r(a){var i="https://react.dev/errors/"+a;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var i=a,l=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(l=i.return),a=i.return;while(a)}return i.tag===3?l:null}function u(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function f(a){if(a.tag===31){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function d(a){if(o(a)!==a)throw Error(r(188))}function h(a){var i=a.alternate;if(!i){if(i=o(a),i===null)throw Error(r(188));return i!==a?null:a}for(var l=a,c=i;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(c=p.return,c!==null){l=c;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return d(p),a;if(g===c)return d(p),i;g=g.sibling}throw Error(r(188))}if(l.return!==c.return)l=p,c=g;else{for(var b=!1,T=p.child;T;){if(T===l){b=!0,l=p,c=g;break}if(T===c){b=!0,c=p,l=g;break}T=T.sibling}if(!b){for(T=g.child;T;){if(T===l){b=!0,l=g,c=p;break}if(T===c){b=!0,c=g,l=p;break}T=T.sibling}if(!b)throw Error(r(189))}}if(l.alternate!==c)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?a:i}function m(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a;for(a=a.child;a!==null;){if(i=m(a),i!==null)return i;a=a.sibling}return null}var _=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),N=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),Te=Symbol.for("react.activity"),xe=Symbol.for("react.memo_cache_sentinel"),me=Symbol.iterator;function Je(a){return a===null||typeof a!="object"?null:(a=me&&a[me]||a["@@iterator"],typeof a=="function"?a:null)}var At=Symbol.for("react.client.reference");function ue(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===At?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case x:return"Fragment";case E:return"Profiler";case R:return"StrictMode";case B:return"Suspense";case Y:return"SuspenseList";case Te:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case w:return"Portal";case N:return a.displayName||"Context";case A:return(a._context.displayName||"Context")+".Consumer";case M:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case W:return i=a.displayName||null,i!==null?i:ue(a.type)||"Memo";case C:i=a._payload,a=a._init;try{return ue(a(i))}catch{}}return null}var se=Array.isArray,$=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},oe=[],fe=-1;function I(a){return{current:a}}function D(a){0>fe||(a.current=oe[fe],oe[fe]=null,fe--)}function V(a,i){fe++,oe[fe]=a.current,a.current=i}var ie=I(null),he=I(null),O=I(null),S=I(null);function Q(a,i){switch(V(O,i),V(he,a),V(ie,null),i.nodeType){case 9:case 11:a=(a=i.documentElement)&&(a=a.namespaceURI)?Db(a):0;break;default:if(a=i.tagName,i=i.namespaceURI)i=Db(i),a=Ub(i,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}D(ie),V(ie,a)}function L(){D(ie),D(he),D(O)}function Pe(a){a.memoizedState!==null&&V(S,a);var i=ie.current,l=Ub(i,a.type);i!==l&&(V(he,a),V(ie,l))}function nt(a){he.current===a&&(D(ie),D(he)),S.current===a&&(D(S),tl._currentValue=ne)}var Nt,Bt;function zt(a){if(Nt===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Nt=i&&i[1]||"",Bt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nt+a+Bt}var fr=!1;function It(a,i){if(!a||fr)return"";fr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var te=function(){throw Error()};if(Object.defineProperty(te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(te,[])}catch(H){var q=H}Reflect.construct(a,[],te)}else{try{te.call()}catch(H){q=H}a.call(te.prototype)}}else{try{throw Error()}catch(H){q=H}(te=a())&&typeof te.catch=="function"&&te.catch(function(){})}}catch(H){if(H&&q&&typeof H.stack=="string")return[H.stack,q.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),b=g[0],T=g[1];if(b&&T){var k=b.split(`
`),P=T.split(`
`);for(p=c=0;c<k.length&&!k[c].includes("DetermineComponentFrameRoot");)c++;for(;p<P.length&&!P[p].includes("DetermineComponentFrameRoot");)p++;if(c===k.length||p===P.length)for(c=k.length-1,p=P.length-1;1<=c&&0<=p&&k[c]!==P[p];)p--;for(;1<=c&&0<=p;c--,p--)if(k[c]!==P[p]){if(c!==1||p!==1)do if(c--,p--,0>p||k[c]!==P[p]){var J=`
`+k[c].replace(" at new "," at ");return a.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",a.displayName)),J}while(1<=c&&0<=p);break}}}finally{fr=!1,Error.prepareStackTrace=l}return(l=a?a.displayName||a.name:"")?zt(l):""}function Zr(a,i){switch(a.tag){case 26:case 27:case 5:return zt(a.type);case 16:return zt("Lazy");case 13:return a.child!==i&&i!==null?zt("Suspense Fallback"):zt("Suspense");case 19:return zt("SuspenseList");case 0:case 15:return It(a.type,!1);case 11:return It(a.type.render,!1);case 1:return It(a.type,!0);case 31:return zt("Activity");default:return""}}function Yl(a){try{var i="",l=null;do i+=Zr(a,l),l=a,a=a.return;while(a);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Xs=Object.prototype.hasOwnProperty,cs=e.unstable_scheduleCallback,Ys=e.unstable_cancelCallback,AC=e.unstable_shouldYield,CC=e.unstable_requestPaint,Cn=e.unstable_now,RC=e.unstable_getCurrentPriorityLevel,gy=e.unstable_ImmediatePriority,_y=e.unstable_UserBlockingPriority,Ql=e.unstable_NormalPriority,NC=e.unstable_LowPriority,yy=e.unstable_IdlePriority,IC=e.log,kC=e.unstable_setDisableYieldValue,ho=null,Rn=null;function va(a){if(typeof IC=="function"&&kC(a),Rn&&typeof Rn.setStrictMode=="function")try{Rn.setStrictMode(ho,a)}catch{}}var Nn=Math.clz32?Math.clz32:jC,$C=Math.log,MC=Math.LN2;function jC(a){return a>>>=0,a===0?32:31-($C(a)/MC|0)|0}var Kl=256,Wl=262144,eu=4194304;function fs(a){var i=a&42;if(i!==0)return i;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function tu(a,i,l){var c=a.pendingLanes;if(c===0)return 0;var p=0,g=a.suspendedLanes,b=a.pingedLanes;a=a.warmLanes;var T=c&134217727;return T!==0?(c=T&~g,c!==0?p=fs(c):(b&=T,b!==0?p=fs(b):l||(l=T&~a,l!==0&&(p=fs(l))))):(T=c&~g,T!==0?p=fs(T):b!==0?p=fs(b):l||(l=c&~a,l!==0&&(p=fs(l)))),p===0?0:i!==0&&i!==p&&(i&g)===0&&(g=p&-p,l=i&-i,g>=l||g===32&&(l&4194048)!==0)?i:p}function po(a,i){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&i)===0}function LC(a,i){switch(a){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vy(){var a=eu;return eu<<=1,(eu&62914560)===0&&(eu=4194304),a}function Sd(a){for(var i=[],l=0;31>l;l++)i.push(a);return i}function mo(a,i){a.pendingLanes|=i,i!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function zC(a,i,l,c,p,g){var b=a.pendingLanes;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=l,a.entangledLanes&=l,a.errorRecoveryDisabledLanes&=l,a.shellSuspendCounter=0;var T=a.entanglements,k=a.expirationTimes,P=a.hiddenUpdates;for(l=b&~l;0<l;){var J=31-Nn(l),te=1<<J;T[J]=0,k[J]=-1;var q=P[J];if(q!==null)for(P[J]=null,J=0;J<q.length;J++){var H=q[J];H!==null&&(H.lane&=-536870913)}l&=~te}c!==0&&by(a,c,0),g!==0&&p===0&&a.tag!==0&&(a.suspendedLanes|=g&~(b&~i))}function by(a,i,l){a.pendingLanes|=i,a.suspendedLanes&=~i;var c=31-Nn(i);a.entangledLanes|=i,a.entanglements[c]=a.entanglements[c]|1073741824|l&261930}function wy(a,i){var l=a.entangledLanes|=i;for(a=a.entanglements;l;){var c=31-Nn(l),p=1<<c;p&i|a[c]&i&&(a[c]|=i),l&=~p}}function Sy(a,i){var l=i&-i;return l=(l&42)!==0?1:Ed(l),(l&(a.suspendedLanes|i))!==0?0:l}function Ed(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Td(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Ey(){var a=F.p;return a!==0?a:(a=window.event,a===void 0?32:lw(a.type))}function Ty(a,i){var l=F.p;try{return F.p=a,i()}finally{F.p=l}}var ba=Math.random().toString(36).slice(2),Vt="__reactFiber$"+ba,gn="__reactProps$"+ba,Qs="__reactContainer$"+ba,xd="__reactEvents$"+ba,DC="__reactListeners$"+ba,UC="__reactHandles$"+ba,xy="__reactResources$"+ba,go="__reactMarker$"+ba;function Od(a){delete a[Vt],delete a[gn],delete a[xd],delete a[DC],delete a[UC]}function Ks(a){var i=a[Vt];if(i)return i;for(var l=a.parentNode;l;){if(i=l[Qs]||l[Vt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(a=Gb(a);a!==null;){if(l=a[Vt])return l;a=Gb(a)}return i}a=l,l=a.parentNode}return null}function Ws(a){if(a=a[Vt]||a[Qs]){var i=a.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return a}return null}function _o(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a.stateNode;throw Error(r(33))}function ei(a){var i=a[xy];return i||(i=a[xy]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Zt(a){a[go]=!0}var Oy=new Set,Ay={};function ds(a,i){ti(a,i),ti(a+"Capture",i)}function ti(a,i){for(Ay[a]=i,a=0;a<i.length;a++)Oy.add(i[a])}var PC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cy={},Ry={};function BC(a){return Xs.call(Ry,a)?!0:Xs.call(Cy,a)?!1:PC.test(a)?Ry[a]=!0:(Cy[a]=!0,!1)}function nu(a,i,l){if(BC(i))if(l===null)a.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":a.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){a.removeAttribute(i);return}}a.setAttribute(i,""+l)}}function ru(a,i,l){if(l===null)a.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(i);return}a.setAttribute(i,""+l)}}function qr(a,i,l,c){if(c===null)a.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttributeNS(i,l,""+c)}}function Qn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ny(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ZC(a,i,l){var c=Object.getOwnPropertyDescriptor(a.constructor.prototype,i);if(!a.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,g=c.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return p.call(this)},set:function(b){l=""+b,g.call(this,b)}}),Object.defineProperty(a,i,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(b){l=""+b},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function Ad(a){if(!a._valueTracker){var i=Ny(a)?"checked":"value";a._valueTracker=ZC(a,i,""+a[i])}}function Iy(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var l=i.getValue(),c="";return a&&(c=Ny(a)?a.checked?"true":"false":a.value),a=c,a!==l?(i.setValue(a),!0):!1}function au(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var qC=/[\n"\\]/g;function Kn(a){return a.replace(qC,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Cd(a,i,l,c,p,g,b,T){a.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?a.type=b:a.removeAttribute("type"),i!=null?b==="number"?(i===0&&a.value===""||a.value!=i)&&(a.value=""+Qn(i)):a.value!==""+Qn(i)&&(a.value=""+Qn(i)):b!=="submit"&&b!=="reset"||a.removeAttribute("value"),i!=null?Rd(a,b,Qn(i)):l!=null?Rd(a,b,Qn(l)):c!=null&&a.removeAttribute("value"),p==null&&g!=null&&(a.defaultChecked=!!g),p!=null&&(a.checked=p&&typeof p!="function"&&typeof p!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?a.name=""+Qn(T):a.removeAttribute("name")}function ky(a,i,l,c,p,g,b,T){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(a.type=g),i!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||i!=null)){Ad(a);return}l=l!=null?""+Qn(l):"",i=i!=null?""+Qn(i):l,T||i===a.value||(a.value=i),a.defaultValue=i}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,a.checked=T?a.checked:!!c,a.defaultChecked=!!c,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.name=b),Ad(a)}function Rd(a,i,l){i==="number"&&au(a.ownerDocument)===a||a.defaultValue===""+l||(a.defaultValue=""+l)}function ni(a,i,l,c){if(a=a.options,i){i={};for(var p=0;p<l.length;p++)i["$"+l[p]]=!0;for(l=0;l<a.length;l++)p=i.hasOwnProperty("$"+a[l].value),a[l].selected!==p&&(a[l].selected=p),p&&c&&(a[l].defaultSelected=!0)}else{for(l=""+Qn(l),i=null,p=0;p<a.length;p++){if(a[p].value===l){a[p].selected=!0,c&&(a[p].defaultSelected=!0);return}i!==null||a[p].disabled||(i=a[p])}i!==null&&(i.selected=!0)}}function $y(a,i,l){if(i!=null&&(i=""+Qn(i),i!==a.value&&(a.value=i),l==null)){a.defaultValue!==i&&(a.defaultValue=i);return}a.defaultValue=l!=null?""+Qn(l):""}function My(a,i,l,c){if(i==null){if(c!=null){if(l!=null)throw Error(r(92));if(se(c)){if(1<c.length)throw Error(r(93));c=c[0]}l=c}l==null&&(l=""),i=l}l=Qn(i),a.defaultValue=l,c=a.textContent,c===l&&c!==""&&c!==null&&(a.value=c),Ad(a)}function ri(a,i){if(i){var l=a.firstChild;if(l&&l===a.lastChild&&l.nodeType===3){l.nodeValue=i;return}}a.textContent=i}var FC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jy(a,i,l){var c=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?a.setProperty(i,""):i==="float"?a.cssFloat="":a[i]="":c?a.setProperty(i,l):typeof l!="number"||l===0||FC.has(i)?i==="float"?a.cssFloat=l:a[i]=(""+l).trim():a[i]=l+"px"}function Ly(a,i,l){if(i!=null&&typeof i!="object")throw Error(r(62));if(a=a.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="");for(var p in i)c=i[p],i.hasOwnProperty(p)&&l[p]!==c&&jy(a,p,c)}else for(var g in i)i.hasOwnProperty(g)&&jy(a,g,i[g])}function Nd(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var HC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),GC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function su(a){return GC.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Fr(){}var Id=null;function kd(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var ai=null,si=null;function zy(a){var i=Ws(a);if(i&&(a=i.stateNode)){var l=a[gn]||null;e:switch(a=i.stateNode,i.type){case"input":if(Cd(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=a;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Kn(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var c=l[i];if(c!==a&&c.form===a.form){var p=c[gn]||null;if(!p)throw Error(r(90));Cd(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(i=0;i<l.length;i++)c=l[i],c.form===a.form&&Iy(c)}break e;case"textarea":$y(a,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&ni(a,!!l.multiple,i,!1)}}}var $d=!1;function Dy(a,i,l){if($d)return a(i,l);$d=!0;try{var c=a(i);return c}finally{if($d=!1,(ai!==null||si!==null)&&(Gu(),ai&&(i=ai,a=si,si=ai=null,zy(i),a)))for(i=0;i<a.length;i++)zy(a[i])}}function yo(a,i){var l=a.stateNode;if(l===null)return null;var c=l[gn]||null;if(c===null)return null;l=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(a=a.type,c=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!c;break e;default:a=!1}if(a)return null;if(l&&typeof l!="function")throw Error(r(231,i,typeof l));return l}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Md=!1;if(Hr)try{var vo={};Object.defineProperty(vo,"passive",{get:function(){Md=!0}}),window.addEventListener("test",vo,vo),window.removeEventListener("test",vo,vo)}catch{Md=!1}var wa=null,jd=null,iu=null;function Uy(){if(iu)return iu;var a,i=jd,l=i.length,c,p="value"in wa?wa.value:wa.textContent,g=p.length;for(a=0;a<l&&i[a]===p[a];a++);var b=l-a;for(c=1;c<=b&&i[l-c]===p[g-c];c++);return iu=p.slice(a,1<c?1-c:void 0)}function ou(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function lu(){return!0}function Py(){return!1}function _n(a){function i(l,c,p,g,b){this._reactName=l,this._targetInst=p,this.type=c,this.nativeEvent=g,this.target=b,this.currentTarget=null;for(var T in a)a.hasOwnProperty(T)&&(l=a[T],this[T]=l?l(g):g[T]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?lu:Py,this.isPropagationStopped=Py,this}return _(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=lu)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=lu)},persist:function(){},isPersistent:lu}),i}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uu=_n(hs),bo=_({},hs,{view:0,detail:0}),VC=_n(bo),Ld,zd,wo,cu=_({},bo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ud,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==wo&&(wo&&a.type==="mousemove"?(Ld=a.screenX-wo.screenX,zd=a.screenY-wo.screenY):zd=Ld=0,wo=a),Ld)},movementY:function(a){return"movementY"in a?a.movementY:zd}}),By=_n(cu),JC=_({},cu,{dataTransfer:0}),XC=_n(JC),YC=_({},bo,{relatedTarget:0}),Dd=_n(YC),QC=_({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),KC=_n(QC),WC=_({},hs,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),eR=_n(WC),tR=_({},hs,{data:0}),Zy=_n(tR),nR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sR(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=aR[a])?!!i[a]:!1}function Ud(){return sR}var iR=_({},bo,{key:function(a){if(a.key){var i=nR[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=ou(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?rR[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ud,charCode:function(a){return a.type==="keypress"?ou(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ou(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),oR=_n(iR),lR=_({},cu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qy=_n(lR),uR=_({},bo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ud}),cR=_n(uR),fR=_({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),dR=_n(fR),hR=_({},cu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),pR=_n(hR),mR=_({},hs,{newState:0,oldState:0}),gR=_n(mR),_R=[9,13,27,32],Pd=Hr&&"CompositionEvent"in window,So=null;Hr&&"documentMode"in document&&(So=document.documentMode);var yR=Hr&&"TextEvent"in window&&!So,Fy=Hr&&(!Pd||So&&8<So&&11>=So),Hy=" ",Gy=!1;function Vy(a,i){switch(a){case"keyup":return _R.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jy(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ii=!1;function vR(a,i){switch(a){case"compositionend":return Jy(i);case"keypress":return i.which!==32?null:(Gy=!0,Hy);case"textInput":return a=i.data,a===Hy&&Gy?null:a;default:return null}}function bR(a,i){if(ii)return a==="compositionend"||!Pd&&Vy(a,i)?(a=Uy(),iu=jd=wa=null,ii=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Fy&&i.locale!=="ko"?null:i.data;default:return null}}var wR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xy(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!wR[a.type]:i==="textarea"}function Yy(a,i,l,c){ai?si?si.push(c):si=[c]:ai=c,i=Wu(i,"onChange"),0<i.length&&(l=new uu("onChange","change",null,l,c),a.push({event:l,listeners:i}))}var Eo=null,To=null;function SR(a){kb(a,0)}function fu(a){var i=_o(a);if(Iy(i))return a}function Qy(a,i){if(a==="change")return i}var Ky=!1;if(Hr){var Bd;if(Hr){var Zd="oninput"in document;if(!Zd){var Wy=document.createElement("div");Wy.setAttribute("oninput","return;"),Zd=typeof Wy.oninput=="function"}Bd=Zd}else Bd=!1;Ky=Bd&&(!document.documentMode||9<document.documentMode)}function ev(){Eo&&(Eo.detachEvent("onpropertychange",tv),To=Eo=null)}function tv(a){if(a.propertyName==="value"&&fu(To)){var i=[];Yy(i,To,a,kd(a)),Dy(SR,i)}}function ER(a,i,l){a==="focusin"?(ev(),Eo=i,To=l,Eo.attachEvent("onpropertychange",tv)):a==="focusout"&&ev()}function TR(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return fu(To)}function xR(a,i){if(a==="click")return fu(i)}function OR(a,i){if(a==="input"||a==="change")return fu(i)}function AR(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var In=typeof Object.is=="function"?Object.is:AR;function xo(a,i){if(In(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var l=Object.keys(a),c=Object.keys(i);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var p=l[c];if(!Xs.call(i,p)||!In(a[p],i[p]))return!1}return!0}function nv(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function rv(a,i){var l=nv(a);a=0;for(var c;l;){if(l.nodeType===3){if(c=a+l.textContent.length,a<=i&&c>=i)return{node:l,offset:i-a};a=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=nv(l)}}function av(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?av(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function sv(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var i=au(a.document);i instanceof a.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)a=i.contentWindow;else break;i=au(a.document)}return i}function qd(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}var CR=Hr&&"documentMode"in document&&11>=document.documentMode,oi=null,Fd=null,Oo=null,Hd=!1;function iv(a,i,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Hd||oi==null||oi!==au(c)||(c=oi,"selectionStart"in c&&qd(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Oo&&xo(Oo,c)||(Oo=c,c=Wu(Fd,"onSelect"),0<c.length&&(i=new uu("onSelect","select",null,i,l),a.push({event:i,listeners:c}),i.target=oi)))}function ps(a,i){var l={};return l[a.toLowerCase()]=i.toLowerCase(),l["Webkit"+a]="webkit"+i,l["Moz"+a]="moz"+i,l}var li={animationend:ps("Animation","AnimationEnd"),animationiteration:ps("Animation","AnimationIteration"),animationstart:ps("Animation","AnimationStart"),transitionrun:ps("Transition","TransitionRun"),transitionstart:ps("Transition","TransitionStart"),transitioncancel:ps("Transition","TransitionCancel"),transitionend:ps("Transition","TransitionEnd")},Gd={},ov={};Hr&&(ov=document.createElement("div").style,"AnimationEvent"in window||(delete li.animationend.animation,delete li.animationiteration.animation,delete li.animationstart.animation),"TransitionEvent"in window||delete li.transitionend.transition);function ms(a){if(Gd[a])return Gd[a];if(!li[a])return a;var i=li[a],l;for(l in i)if(i.hasOwnProperty(l)&&l in ov)return Gd[a]=i[l];return a}var lv=ms("animationend"),uv=ms("animationiteration"),cv=ms("animationstart"),RR=ms("transitionrun"),NR=ms("transitionstart"),IR=ms("transitioncancel"),fv=ms("transitionend"),dv=new Map,Vd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vd.push("scrollEnd");function dr(a,i){dv.set(a,i),ds(i,[a])}var du=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Wn=[],ui=0,Jd=0;function hu(){for(var a=ui,i=Jd=ui=0;i<a;){var l=Wn[i];Wn[i++]=null;var c=Wn[i];Wn[i++]=null;var p=Wn[i];Wn[i++]=null;var g=Wn[i];if(Wn[i++]=null,c!==null&&p!==null){var b=c.pending;b===null?p.next=p:(p.next=b.next,b.next=p),c.pending=p}g!==0&&hv(l,p,g)}}function pu(a,i,l,c){Wn[ui++]=a,Wn[ui++]=i,Wn[ui++]=l,Wn[ui++]=c,Jd|=c,a.lanes|=c,a=a.alternate,a!==null&&(a.lanes|=c)}function Xd(a,i,l,c){return pu(a,i,l,c),mu(a)}function gs(a,i){return pu(a,null,null,i),mu(a)}function hv(a,i,l){a.lanes|=l;var c=a.alternate;c!==null&&(c.lanes|=l);for(var p=!1,g=a.return;g!==null;)g.childLanes|=l,c=g.alternate,c!==null&&(c.childLanes|=l),g.tag===22&&(a=g.stateNode,a===null||a._visibility&1||(p=!0)),a=g,g=g.return;return a.tag===3?(g=a.stateNode,p&&i!==null&&(p=31-Nn(l),a=g.hiddenUpdates,c=a[p],c===null?a[p]=[i]:c.push(i),i.lane=l|536870912),g):null}function mu(a){if(50<Jo)throw Jo=0,ap=null,Error(r(185));for(var i=a.return;i!==null;)a=i,i=a.return;return a.tag===3?a.stateNode:null}var ci={};function kR(a,i,l,c){this.tag=a,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(a,i,l,c){return new kR(a,i,l,c)}function Yd(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Gr(a,i){var l=a.alternate;return l===null?(l=kn(a.tag,i,a.key,a.mode),l.elementType=a.elementType,l.type=a.type,l.stateNode=a.stateNode,l.alternate=a,a.alternate=l):(l.pendingProps=i,l.type=a.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=a.flags&65011712,l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,i=a.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=a.sibling,l.index=a.index,l.ref=a.ref,l.refCleanup=a.refCleanup,l}function pv(a,i){a.flags&=65011714;var l=a.alternate;return l===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,i=l.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),a}function gu(a,i,l,c,p,g){var b=0;if(c=a,typeof a=="function")Yd(a)&&(b=1);else if(typeof a=="string")b=zN(a,l,ie.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case Te:return a=kn(31,l,i,p),a.elementType=Te,a.lanes=g,a;case x:return _s(l.children,p,g,i);case R:b=8,p|=24;break;case E:return a=kn(12,l,i,p|2),a.elementType=E,a.lanes=g,a;case B:return a=kn(13,l,i,p),a.elementType=B,a.lanes=g,a;case Y:return a=kn(19,l,i,p),a.elementType=Y,a.lanes=g,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case N:b=10;break e;case A:b=9;break e;case M:b=11;break e;case W:b=14;break e;case C:b=16,c=null;break e}b=29,l=Error(r(130,a===null?"null":typeof a,"")),c=null}return i=kn(b,l,i,p),i.elementType=a,i.type=c,i.lanes=g,i}function _s(a,i,l,c){return a=kn(7,a,c,i),a.lanes=l,a}function Qd(a,i,l){return a=kn(6,a,null,i),a.lanes=l,a}function mv(a){var i=kn(18,null,null,0);return i.stateNode=a,i}function Kd(a,i,l){return i=kn(4,a.children!==null?a.children:[],a.key,i),i.lanes=l,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}var gv=new WeakMap;function er(a,i){if(typeof a=="object"&&a!==null){var l=gv.get(a);return l!==void 0?l:(i={value:a,source:i,stack:Yl(i)},gv.set(a,i),i)}return{value:a,source:i,stack:Yl(i)}}var fi=[],di=0,_u=null,Ao=0,tr=[],nr=0,Sa=null,Rr=1,Nr="";function Vr(a,i){fi[di++]=Ao,fi[di++]=_u,_u=a,Ao=i}function _v(a,i,l){tr[nr++]=Rr,tr[nr++]=Nr,tr[nr++]=Sa,Sa=a;var c=Rr;a=Nr;var p=32-Nn(c)-1;c&=~(1<<p),l+=1;var g=32-Nn(i)+p;if(30<g){var b=p-p%5;g=(c&(1<<b)-1).toString(32),c>>=b,p-=b,Rr=1<<32-Nn(i)+p|l<<p|c,Nr=g+a}else Rr=1<<g|l<<p|c,Nr=a}function Wd(a){a.return!==null&&(Vr(a,1),_v(a,1,0))}function eh(a){for(;a===_u;)_u=fi[--di],fi[di]=null,Ao=fi[--di],fi[di]=null;for(;a===Sa;)Sa=tr[--nr],tr[nr]=null,Nr=tr[--nr],tr[nr]=null,Rr=tr[--nr],tr[nr]=null}function yv(a,i){tr[nr++]=Rr,tr[nr++]=Nr,tr[nr++]=Sa,Rr=i.id,Nr=i.overflow,Sa=a}var Jt=null,mt=null,Ve=!1,Ea=null,rr=!1,th=Error(r(519));function Ta(a){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Co(er(i,a)),th}function vv(a){var i=a.stateNode,l=a.type,c=a.memoizedProps;switch(i[Vt]=a,i[gn]=c,l){case"dialog":Fe("cancel",i),Fe("close",i);break;case"iframe":case"object":case"embed":Fe("load",i);break;case"video":case"audio":for(l=0;l<Yo.length;l++)Fe(Yo[l],i);break;case"source":Fe("error",i);break;case"img":case"image":case"link":Fe("error",i),Fe("load",i);break;case"details":Fe("toggle",i);break;case"input":Fe("invalid",i),ky(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Fe("invalid",i);break;case"textarea":Fe("invalid",i),My(i,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||c.suppressHydrationWarning===!0||Lb(i.textContent,l)?(c.popover!=null&&(Fe("beforetoggle",i),Fe("toggle",i)),c.onScroll!=null&&Fe("scroll",i),c.onScrollEnd!=null&&Fe("scrollend",i),c.onClick!=null&&(i.onclick=Fr),i=!0):i=!1,i||Ta(a,!0)}function bv(a){for(Jt=a.return;Jt;)switch(Jt.tag){case 5:case 31:case 13:rr=!1;return;case 27:case 3:rr=!0;return;default:Jt=Jt.return}}function hi(a){if(a!==Jt)return!1;if(!Ve)return bv(a),Ve=!0,!1;var i=a.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=a.type,l=!(l!=="form"&&l!=="button")||vp(a.type,a.memoizedProps)),l=!l),l&&mt&&Ta(a),bv(a),i===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));mt=Hb(a)}else if(i===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));mt=Hb(a)}else i===27?(i=mt,Da(a.type)?(a=Tp,Tp=null,mt=a):mt=i):mt=Jt?sr(a.stateNode.nextSibling):null;return!0}function ys(){mt=Jt=null,Ve=!1}function nh(){var a=Ea;return a!==null&&(wn===null?wn=a:wn.push.apply(wn,a),Ea=null),a}function Co(a){Ea===null?Ea=[a]:Ea.push(a)}var rh=I(null),vs=null,Jr=null;function xa(a,i,l){V(rh,i._currentValue),i._currentValue=l}function Xr(a){a._currentValue=rh.current,D(rh)}function ah(a,i,l){for(;a!==null;){var c=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),a===l)break;a=a.return}}function sh(a,i,l,c){var p=a.child;for(p!==null&&(p.return=a);p!==null;){var g=p.dependencies;if(g!==null){var b=p.child;g=g.firstContext;e:for(;g!==null;){var T=g;g=p;for(var k=0;k<i.length;k++)if(T.context===i[k]){g.lanes|=l,T=g.alternate,T!==null&&(T.lanes|=l),ah(g.return,l,a),c||(b=null);break e}g=T.next}}else if(p.tag===18){if(b=p.return,b===null)throw Error(r(341));b.lanes|=l,g=b.alternate,g!==null&&(g.lanes|=l),ah(b,l,a),b=null}else b=p.child;if(b!==null)b.return=p;else for(b=p;b!==null;){if(b===a){b=null;break}if(p=b.sibling,p!==null){p.return=b.return,b=p;break}b=b.return}p=b}}function pi(a,i,l,c){a=null;for(var p=i,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var b=p.alternate;if(b===null)throw Error(r(387));if(b=b.memoizedProps,b!==null){var T=p.type;In(p.pendingProps.value,b.value)||(a!==null?a.push(T):a=[T])}}else if(p===S.current){if(b=p.alternate,b===null)throw Error(r(387));b.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(a!==null?a.push(tl):a=[tl])}p=p.return}a!==null&&sh(i,a,l,c),i.flags|=262144}function yu(a){for(a=a.firstContext;a!==null;){if(!In(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function bs(a){vs=a,Jr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Xt(a){return wv(vs,a)}function vu(a,i){return vs===null&&bs(a),wv(a,i)}function wv(a,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},Jr===null){if(a===null)throw Error(r(308));Jr=i,a.dependencies={lanes:0,firstContext:i},a.flags|=524288}else Jr=Jr.next=i;return l}var $R=typeof AbortController<"u"?AbortController:function(){var a=[],i=this.signal={aborted:!1,addEventListener:function(l,c){a.push(c)}};this.abort=function(){i.aborted=!0,a.forEach(function(l){return l()})}},MR=e.unstable_scheduleCallback,jR=e.unstable_NormalPriority,kt={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ih(){return{controller:new $R,data:new Map,refCount:0}}function Ro(a){a.refCount--,a.refCount===0&&MR(jR,function(){a.controller.abort()})}var No=null,oh=0,mi=0,gi=null;function LR(a,i){if(No===null){var l=No=[];oh=0,mi=cp(),gi={status:"pending",value:void 0,then:function(c){l.push(c)}}}return oh++,i.then(Sv,Sv),i}function Sv(){if(--oh===0&&No!==null){gi!==null&&(gi.status="fulfilled");var a=No;No=null,mi=0,gi=null;for(var i=0;i<a.length;i++)(0,a[i])()}}function zR(a,i){var l=[],c={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return a.then(function(){c.status="fulfilled",c.value=i;for(var p=0;p<l.length;p++)(0,l[p])(i)},function(p){for(c.status="rejected",c.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),c}var Ev=$.S;$.S=function(a,i){ib=Cn(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&LR(a,i),Ev!==null&&Ev(a,i)};var ws=I(null);function lh(){var a=ws.current;return a!==null?a:dt.pooledCache}function bu(a,i){i===null?V(ws,ws.current):V(ws,i.pool)}function Tv(){var a=lh();return a===null?null:{parent:kt._currentValue,pool:a}}var _i=Error(r(460)),uh=Error(r(474)),wu=Error(r(542)),Su={then:function(){}};function xv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Ov(a,i,l){switch(l=a[l],l===void 0?a.push(i):l!==i&&(i.then(Fr,Fr),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Cv(a),a;default:if(typeof i.status=="string")i.then(Fr,Fr);else{if(a=dt,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=i,a.status="pending",a.then(function(c){if(i.status==="pending"){var p=i;p.status="fulfilled",p.value=c}},function(c){if(i.status==="pending"){var p=i;p.status="rejected",p.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Cv(a),a}throw Es=i,_i}}function Ss(a){try{var i=a._init;return i(a._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Es=l,_i):l}}var Es=null;function Av(){if(Es===null)throw Error(r(459));var a=Es;return Es=null,a}function Cv(a){if(a===_i||a===wu)throw Error(r(483))}var yi=null,Io=0;function Eu(a){var i=Io;return Io+=1,yi===null&&(yi=[]),Ov(yi,a,i)}function ko(a,i){i=i.props.ref,a.ref=i!==void 0?i:null}function Tu(a,i){throw i.$$typeof===y?Error(r(525)):(a=Object.prototype.toString.call(i),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)))}function Rv(a){function i(z,j){if(a){var U=z.deletions;U===null?(z.deletions=[j],z.flags|=16):U.push(j)}}function l(z,j){if(!a)return null;for(;j!==null;)i(z,j),j=j.sibling;return null}function c(z){for(var j=new Map;z!==null;)z.key!==null?j.set(z.key,z):j.set(z.index,z),z=z.sibling;return j}function p(z,j){return z=Gr(z,j),z.index=0,z.sibling=null,z}function g(z,j,U){return z.index=U,a?(U=z.alternate,U!==null?(U=U.index,U<j?(z.flags|=67108866,j):U):(z.flags|=67108866,j)):(z.flags|=1048576,j)}function b(z){return a&&z.alternate===null&&(z.flags|=67108866),z}function T(z,j,U,K){return j===null||j.tag!==6?(j=Qd(U,z.mode,K),j.return=z,j):(j=p(j,U),j.return=z,j)}function k(z,j,U,K){var Oe=U.type;return Oe===x?J(z,j,U.props.children,K,U.key):j!==null&&(j.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===C&&Ss(Oe)===j.type)?(j=p(j,U.props),ko(j,U),j.return=z,j):(j=gu(U.type,U.key,U.props,null,z.mode,K),ko(j,U),j.return=z,j)}function P(z,j,U,K){return j===null||j.tag!==4||j.stateNode.containerInfo!==U.containerInfo||j.stateNode.implementation!==U.implementation?(j=Kd(U,z.mode,K),j.return=z,j):(j=p(j,U.children||[]),j.return=z,j)}function J(z,j,U,K,Oe){return j===null||j.tag!==7?(j=_s(U,z.mode,K,Oe),j.return=z,j):(j=p(j,U),j.return=z,j)}function te(z,j,U){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=Qd(""+j,z.mode,U),j.return=z,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case v:return U=gu(j.type,j.key,j.props,null,z.mode,U),ko(U,j),U.return=z,U;case w:return j=Kd(j,z.mode,U),j.return=z,j;case C:return j=Ss(j),te(z,j,U)}if(se(j)||Je(j))return j=_s(j,z.mode,U,null),j.return=z,j;if(typeof j.then=="function")return te(z,Eu(j),U);if(j.$$typeof===N)return te(z,vu(z,j),U);Tu(z,j)}return null}function q(z,j,U,K){var Oe=j!==null?j.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return Oe!==null?null:T(z,j,""+U,K);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case v:return U.key===Oe?k(z,j,U,K):null;case w:return U.key===Oe?P(z,j,U,K):null;case C:return U=Ss(U),q(z,j,U,K)}if(se(U)||Je(U))return Oe!==null?null:J(z,j,U,K,null);if(typeof U.then=="function")return q(z,j,Eu(U),K);if(U.$$typeof===N)return q(z,j,vu(z,U),K);Tu(z,U)}return null}function H(z,j,U,K,Oe){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return z=z.get(U)||null,T(j,z,""+K,Oe);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case v:return z=z.get(K.key===null?U:K.key)||null,k(j,z,K,Oe);case w:return z=z.get(K.key===null?U:K.key)||null,P(j,z,K,Oe);case C:return K=Ss(K),H(z,j,U,K,Oe)}if(se(K)||Je(K))return z=z.get(U)||null,J(j,z,K,Oe,null);if(typeof K.then=="function")return H(z,j,U,Eu(K),Oe);if(K.$$typeof===N)return H(z,j,U,vu(j,K),Oe);Tu(j,K)}return null}function ge(z,j,U,K){for(var Oe=null,Ye=null,be=j,ze=j=0,Ge=null;be!==null&&ze<U.length;ze++){be.index>ze?(Ge=be,be=null):Ge=be.sibling;var Qe=q(z,be,U[ze],K);if(Qe===null){be===null&&(be=Ge);break}a&&be&&Qe.alternate===null&&i(z,be),j=g(Qe,j,ze),Ye===null?Oe=Qe:Ye.sibling=Qe,Ye=Qe,be=Ge}if(ze===U.length)return l(z,be),Ve&&Vr(z,ze),Oe;if(be===null){for(;ze<U.length;ze++)be=te(z,U[ze],K),be!==null&&(j=g(be,j,ze),Ye===null?Oe=be:Ye.sibling=be,Ye=be);return Ve&&Vr(z,ze),Oe}for(be=c(be);ze<U.length;ze++)Ge=H(be,z,ze,U[ze],K),Ge!==null&&(a&&Ge.alternate!==null&&be.delete(Ge.key===null?ze:Ge.key),j=g(Ge,j,ze),Ye===null?Oe=Ge:Ye.sibling=Ge,Ye=Ge);return a&&be.forEach(function(qa){return i(z,qa)}),Ve&&Vr(z,ze),Oe}function Ie(z,j,U,K){if(U==null)throw Error(r(151));for(var Oe=null,Ye=null,be=j,ze=j=0,Ge=null,Qe=U.next();be!==null&&!Qe.done;ze++,Qe=U.next()){be.index>ze?(Ge=be,be=null):Ge=be.sibling;var qa=q(z,be,Qe.value,K);if(qa===null){be===null&&(be=Ge);break}a&&be&&qa.alternate===null&&i(z,be),j=g(qa,j,ze),Ye===null?Oe=qa:Ye.sibling=qa,Ye=qa,be=Ge}if(Qe.done)return l(z,be),Ve&&Vr(z,ze),Oe;if(be===null){for(;!Qe.done;ze++,Qe=U.next())Qe=te(z,Qe.value,K),Qe!==null&&(j=g(Qe,j,ze),Ye===null?Oe=Qe:Ye.sibling=Qe,Ye=Qe);return Ve&&Vr(z,ze),Oe}for(be=c(be);!Qe.done;ze++,Qe=U.next())Qe=H(be,z,ze,Qe.value,K),Qe!==null&&(a&&Qe.alternate!==null&&be.delete(Qe.key===null?ze:Qe.key),j=g(Qe,j,ze),Ye===null?Oe=Qe:Ye.sibling=Qe,Ye=Qe);return a&&be.forEach(function(JN){return i(z,JN)}),Ve&&Vr(z,ze),Oe}function ft(z,j,U,K){if(typeof U=="object"&&U!==null&&U.type===x&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case v:e:{for(var Oe=U.key;j!==null;){if(j.key===Oe){if(Oe=U.type,Oe===x){if(j.tag===7){l(z,j.sibling),K=p(j,U.props.children),K.return=z,z=K;break e}}else if(j.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===C&&Ss(Oe)===j.type){l(z,j.sibling),K=p(j,U.props),ko(K,U),K.return=z,z=K;break e}l(z,j);break}else i(z,j);j=j.sibling}U.type===x?(K=_s(U.props.children,z.mode,K,U.key),K.return=z,z=K):(K=gu(U.type,U.key,U.props,null,z.mode,K),ko(K,U),K.return=z,z=K)}return b(z);case w:e:{for(Oe=U.key;j!==null;){if(j.key===Oe)if(j.tag===4&&j.stateNode.containerInfo===U.containerInfo&&j.stateNode.implementation===U.implementation){l(z,j.sibling),K=p(j,U.children||[]),K.return=z,z=K;break e}else{l(z,j);break}else i(z,j);j=j.sibling}K=Kd(U,z.mode,K),K.return=z,z=K}return b(z);case C:return U=Ss(U),ft(z,j,U,K)}if(se(U))return ge(z,j,U,K);if(Je(U)){if(Oe=Je(U),typeof Oe!="function")throw Error(r(150));return U=Oe.call(U),Ie(z,j,U,K)}if(typeof U.then=="function")return ft(z,j,Eu(U),K);if(U.$$typeof===N)return ft(z,j,vu(z,U),K);Tu(z,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,j!==null&&j.tag===6?(l(z,j.sibling),K=p(j,U),K.return=z,z=K):(l(z,j),K=Qd(U,z.mode,K),K.return=z,z=K),b(z)):l(z,j)}return function(z,j,U,K){try{Io=0;var Oe=ft(z,j,U,K);return yi=null,Oe}catch(be){if(be===_i||be===wu)throw be;var Ye=kn(29,be,null,z.mode);return Ye.lanes=K,Ye.return=z,Ye}}}var Ts=Rv(!0),Nv=Rv(!1),Oa=!1;function ch(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fh(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Aa(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ca(a,i,l){var c=a.updateQueue;if(c===null)return null;if(c=c.shared,(et&2)!==0){var p=c.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),c.pending=i,i=mu(a),hv(a,null,l),i}return pu(a,c,i,l),mu(a)}function $o(a,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var c=i.lanes;c&=a.pendingLanes,l|=c,i.lanes=l,wy(a,l)}}function dh(a,i){var l=a.updateQueue,c=a.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?p=g=b:g=g.next=b,l=l.next}while(l!==null);g===null?p=g=i:g=g.next=i}else p=g=i;l={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},a.updateQueue=l;return}a=l.lastBaseUpdate,a===null?l.firstBaseUpdate=i:a.next=i,l.lastBaseUpdate=i}var hh=!1;function Mo(){if(hh){var a=gi;if(a!==null)throw a}}function jo(a,i,l,c){hh=!1;var p=a.updateQueue;Oa=!1;var g=p.firstBaseUpdate,b=p.lastBaseUpdate,T=p.shared.pending;if(T!==null){p.shared.pending=null;var k=T,P=k.next;k.next=null,b===null?g=P:b.next=P,b=k;var J=a.alternate;J!==null&&(J=J.updateQueue,T=J.lastBaseUpdate,T!==b&&(T===null?J.firstBaseUpdate=P:T.next=P,J.lastBaseUpdate=k))}if(g!==null){var te=p.baseState;b=0,J=P=k=null,T=g;do{var q=T.lane&-536870913,H=q!==T.lane;if(H?(He&q)===q:(c&q)===q){q!==0&&q===mi&&(hh=!0),J!==null&&(J=J.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var ge=a,Ie=T;q=i;var ft=l;switch(Ie.tag){case 1:if(ge=Ie.payload,typeof ge=="function"){te=ge.call(ft,te,q);break e}te=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=Ie.payload,q=typeof ge=="function"?ge.call(ft,te,q):ge,q==null)break e;te=_({},te,q);break e;case 2:Oa=!0}}q=T.callback,q!==null&&(a.flags|=64,H&&(a.flags|=8192),H=p.callbacks,H===null?p.callbacks=[q]:H.push(q))}else H={lane:q,tag:T.tag,payload:T.payload,callback:T.callback,next:null},J===null?(P=J=H,k=te):J=J.next=H,b|=q;if(T=T.next,T===null){if(T=p.shared.pending,T===null)break;H=T,T=H.next,H.next=null,p.lastBaseUpdate=H,p.shared.pending=null}}while(!0);J===null&&(k=te),p.baseState=k,p.firstBaseUpdate=P,p.lastBaseUpdate=J,g===null&&(p.shared.lanes=0),$a|=b,a.lanes=b,a.memoizedState=te}}function Iv(a,i){if(typeof a!="function")throw Error(r(191,a));a.call(i)}function kv(a,i){var l=a.callbacks;if(l!==null)for(a.callbacks=null,a=0;a<l.length;a++)Iv(l[a],i)}var vi=I(null),xu=I(0);function $v(a,i){a=aa,V(xu,a),V(vi,i),aa=a|i.baseLanes}function ph(){V(xu,aa),V(vi,vi.current)}function mh(){aa=xu.current,D(vi),D(xu)}var $n=I(null),ar=null;function Ra(a){var i=a.alternate;V(Ct,Ct.current&1),V($n,a),ar===null&&(i===null||vi.current!==null||i.memoizedState!==null)&&(ar=a)}function gh(a){V(Ct,Ct.current),V($n,a),ar===null&&(ar=a)}function Mv(a){a.tag===22?(V(Ct,Ct.current),V($n,a),ar===null&&(ar=a)):Na()}function Na(){V(Ct,Ct.current),V($n,$n.current)}function Mn(a){D($n),ar===a&&(ar=null),D(Ct)}var Ct=I(0);function Ou(a){for(var i=a;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Sp(l)||Ep(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Yr=0,Le=null,ut=null,$t=null,Au=!1,bi=!1,xs=!1,Cu=0,Lo=0,wi=null,DR=0;function wt(){throw Error(r(321))}function _h(a,i){if(i===null)return!1;for(var l=0;l<i.length&&l<a.length;l++)if(!In(a[l],i[l]))return!1;return!0}function yh(a,i,l,c,p,g){return Yr=g,Le=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,$.H=a===null||a.memoizedState===null?_0:$h,xs=!1,g=l(c,p),xs=!1,bi&&(g=Lv(i,l,c,p)),jv(a),g}function jv(a){$.H=Uo;var i=ut!==null&&ut.next!==null;if(Yr=0,$t=ut=Le=null,Au=!1,Lo=0,wi=null,i)throw Error(r(300));a===null||Mt||(a=a.dependencies,a!==null&&yu(a)&&(Mt=!0))}function Lv(a,i,l,c){Le=a;var p=0;do{if(bi&&(wi=null),Lo=0,bi=!1,25<=p)throw Error(r(301));if(p+=1,$t=ut=null,a.updateQueue!=null){var g=a.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}$.H=y0,g=i(l,c)}while(bi);return g}function UR(){var a=$.H,i=a.useState()[0];return i=typeof i.then=="function"?zo(i):i,a=a.useState()[0],(ut!==null?ut.memoizedState:null)!==a&&(Le.flags|=1024),i}function vh(){var a=Cu!==0;return Cu=0,a}function bh(a,i,l){i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~l}function wh(a){if(Au){for(a=a.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}Au=!1}Yr=0,$t=ut=Le=null,bi=!1,Lo=Cu=0,wi=null}function on(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?Le.memoizedState=$t=a:$t=$t.next=a,$t}function Rt(){if(ut===null){var a=Le.alternate;a=a!==null?a.memoizedState:null}else a=ut.next;var i=$t===null?Le.memoizedState:$t.next;if(i!==null)$t=i,ut=a;else{if(a===null)throw Le.alternate===null?Error(r(467)):Error(r(310));ut=a,a={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},$t===null?Le.memoizedState=$t=a:$t=$t.next=a}return $t}function Ru(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zo(a){var i=Lo;return Lo+=1,wi===null&&(wi=[]),a=Ov(wi,a,i),i=Le,($t===null?i.memoizedState:$t.next)===null&&(i=i.alternate,$.H=i===null||i.memoizedState===null?_0:$h),a}function Nu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return zo(a);if(a.$$typeof===N)return Xt(a)}throw Error(r(438,String(a)))}function Sh(a){var i=null,l=Le.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var c=Le.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(p){return p.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=Ru(),Le.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(a),c=0;c<a;c++)l[c]=xe;return i.index++,l}function Qr(a,i){return typeof i=="function"?i(a):i}function Iu(a){var i=Rt();return Eh(i,ut,a)}function Eh(a,i,l){var c=a.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=l;var p=a.baseQueue,g=c.pending;if(g!==null){if(p!==null){var b=p.next;p.next=g.next,g.next=b}i.baseQueue=p=g,c.pending=null}if(g=a.baseState,p===null)a.memoizedState=g;else{i=p.next;var T=b=null,k=null,P=i,J=!1;do{var te=P.lane&-536870913;if(te!==P.lane?(He&te)===te:(Yr&te)===te){var q=P.revertLane;if(q===0)k!==null&&(k=k.next={lane:0,revertLane:0,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),te===mi&&(J=!0);else if((Yr&q)===q){P=P.next,q===mi&&(J=!0);continue}else te={lane:0,revertLane:P.revertLane,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},k===null?(T=k=te,b=g):k=k.next=te,Le.lanes|=q,$a|=q;te=P.action,xs&&l(g,te),g=P.hasEagerState?P.eagerState:l(g,te)}else q={lane:te,revertLane:P.revertLane,gesture:P.gesture,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},k===null?(T=k=q,b=g):k=k.next=q,Le.lanes|=te,$a|=te;P=P.next}while(P!==null&&P!==i);if(k===null?b=g:k.next=T,!In(g,a.memoizedState)&&(Mt=!0,J&&(l=gi,l!==null)))throw l;a.memoizedState=g,a.baseState=b,a.baseQueue=k,c.lastRenderedState=g}return p===null&&(c.lanes=0),[a.memoizedState,c.dispatch]}function Th(a){var i=Rt(),l=i.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=a;var c=l.dispatch,p=l.pending,g=i.memoizedState;if(p!==null){l.pending=null;var b=p=p.next;do g=a(g,b.action),b=b.next;while(b!==p);In(g,i.memoizedState)||(Mt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,c]}function zv(a,i,l){var c=Le,p=Rt(),g=Ve;if(g){if(l===void 0)throw Error(r(407));l=l()}else l=i();var b=!In((ut||p).memoizedState,l);if(b&&(p.memoizedState=l,Mt=!0),p=p.queue,Ah(Pv.bind(null,c,p,a),[a]),p.getSnapshot!==i||b||$t!==null&&$t.memoizedState.tag&1){if(c.flags|=2048,Si(9,{destroy:void 0},Uv.bind(null,c,p,l,i),null),dt===null)throw Error(r(349));g||(Yr&127)!==0||Dv(c,i,l)}return l}function Dv(a,i,l){a.flags|=16384,a={getSnapshot:i,value:l},i=Le.updateQueue,i===null?(i=Ru(),Le.updateQueue=i,i.stores=[a]):(l=i.stores,l===null?i.stores=[a]:l.push(a))}function Uv(a,i,l,c){i.value=l,i.getSnapshot=c,Bv(i)&&Zv(a)}function Pv(a,i,l){return l(function(){Bv(i)&&Zv(a)})}function Bv(a){var i=a.getSnapshot;a=a.value;try{var l=i();return!In(a,l)}catch{return!0}}function Zv(a){var i=gs(a,2);i!==null&&Sn(i,a,2)}function xh(a){var i=on();if(typeof a=="function"){var l=a;if(a=l(),xs){va(!0);try{l()}finally{va(!1)}}}return i.memoizedState=i.baseState=a,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qr,lastRenderedState:a},i}function qv(a,i,l,c){return a.baseState=l,Eh(a,ut,typeof c=="function"?c:Qr)}function PR(a,i,l,c,p){if(Mu(a))throw Error(r(485));if(a=i.action,a!==null){var g={payload:p,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){g.listeners.push(b)}};$.T!==null?l(!0):g.isTransition=!1,c(g),l=i.pending,l===null?(g.next=i.pending=g,Fv(i,g)):(g.next=l.next,i.pending=l.next=g)}}function Fv(a,i){var l=i.action,c=i.payload,p=a.state;if(i.isTransition){var g=$.T,b={};$.T=b;try{var T=l(p,c),k=$.S;k!==null&&k(b,T),Hv(a,i,T)}catch(P){Oh(a,i,P)}finally{g!==null&&b.types!==null&&(g.types=b.types),$.T=g}}else try{g=l(p,c),Hv(a,i,g)}catch(P){Oh(a,i,P)}}function Hv(a,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){Gv(a,i,c)},function(c){return Oh(a,i,c)}):Gv(a,i,l)}function Gv(a,i,l){i.status="fulfilled",i.value=l,Vv(i),a.state=l,i=a.pending,i!==null&&(l=i.next,l===i?a.pending=null:(l=l.next,i.next=l,Fv(a,l)))}function Oh(a,i,l){var c=a.pending;if(a.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=l,Vv(i),i=i.next;while(i!==c)}a.action=null}function Vv(a){a=a.listeners;for(var i=0;i<a.length;i++)(0,a[i])()}function Jv(a,i){return i}function Xv(a,i){if(Ve){var l=dt.formState;if(l!==null){e:{var c=Le;if(Ve){if(mt){t:{for(var p=mt,g=rr;p.nodeType!==8;){if(!g){p=null;break t}if(p=sr(p.nextSibling),p===null){p=null;break t}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){mt=sr(p.nextSibling),c=p.data==="F!";break e}}Ta(c)}c=!1}c&&(i=l[0])}}return l=on(),l.memoizedState=l.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jv,lastRenderedState:i},l.queue=c,l=p0.bind(null,Le,c),c.dispatch=l,c=xh(!1),g=kh.bind(null,Le,!1,c.queue),c=on(),p={state:i,dispatch:null,action:a,pending:null},c.queue=p,l=PR.bind(null,Le,p,g,l),p.dispatch=l,c.memoizedState=a,[i,l,!1]}function Yv(a){var i=Rt();return Qv(i,ut,a)}function Qv(a,i,l){if(i=Eh(a,i,Jv)[0],a=Iu(Qr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=zo(i)}catch(b){throw b===_i?wu:b}else c=i;i=Rt();var p=i.queue,g=p.dispatch;return l!==i.memoizedState&&(Le.flags|=2048,Si(9,{destroy:void 0},BR.bind(null,p,l),null)),[c,g,a]}function BR(a,i){a.action=i}function Kv(a){var i=Rt(),l=ut;if(l!==null)return Qv(i,l,a);Rt(),i=i.memoizedState,l=Rt();var c=l.queue.dispatch;return l.memoizedState=a,[i,c,!1]}function Si(a,i,l,c){return a={tag:a,create:l,deps:c,inst:i,next:null},i=Le.updateQueue,i===null&&(i=Ru(),Le.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=a.next=a:(c=l.next,l.next=a,a.next=c,i.lastEffect=a),a}function Wv(){return Rt().memoizedState}function ku(a,i,l,c){var p=on();Le.flags|=a,p.memoizedState=Si(1|i,{destroy:void 0},l,c===void 0?null:c)}function $u(a,i,l,c){var p=Rt();c=c===void 0?null:c;var g=p.memoizedState.inst;ut!==null&&c!==null&&_h(c,ut.memoizedState.deps)?p.memoizedState=Si(i,g,l,c):(Le.flags|=a,p.memoizedState=Si(1|i,g,l,c))}function e0(a,i){ku(8390656,8,a,i)}function Ah(a,i){$u(2048,8,a,i)}function ZR(a){Le.flags|=4;var i=Le.updateQueue;if(i===null)i=Ru(),Le.updateQueue=i,i.events=[a];else{var l=i.events;l===null?i.events=[a]:l.push(a)}}function t0(a){var i=Rt().memoizedState;return ZR({ref:i,nextImpl:a}),function(){if((et&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function n0(a,i){return $u(4,2,a,i)}function r0(a,i){return $u(4,4,a,i)}function a0(a,i){if(typeof i=="function"){a=a();var l=i(a);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function s0(a,i,l){l=l!=null?l.concat([a]):null,$u(4,4,a0.bind(null,i,a),l)}function Ch(){}function i0(a,i){var l=Rt();i=i===void 0?null:i;var c=l.memoizedState;return i!==null&&_h(i,c[1])?c[0]:(l.memoizedState=[a,i],a)}function o0(a,i){var l=Rt();i=i===void 0?null:i;var c=l.memoizedState;if(i!==null&&_h(i,c[1]))return c[0];if(c=a(),xs){va(!0);try{a()}finally{va(!1)}}return l.memoizedState=[c,i],c}function Rh(a,i,l){return l===void 0||(Yr&1073741824)!==0&&(He&261930)===0?a.memoizedState=i:(a.memoizedState=l,a=lb(),Le.lanes|=a,$a|=a,l)}function l0(a,i,l,c){return In(l,i)?l:vi.current!==null?(a=Rh(a,l,c),In(a,i)||(Mt=!0),a):(Yr&42)===0||(Yr&1073741824)!==0&&(He&261930)===0?(Mt=!0,a.memoizedState=l):(a=lb(),Le.lanes|=a,$a|=a,i)}function u0(a,i,l,c,p){var g=F.p;F.p=g!==0&&8>g?g:8;var b=$.T,T={};$.T=T,kh(a,!1,i,l);try{var k=p(),P=$.S;if(P!==null&&P(T,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var J=zR(k,c);Do(a,i,J,zn(a))}else Do(a,i,c,zn(a))}catch(te){Do(a,i,{then:function(){},status:"rejected",reason:te},zn())}finally{F.p=g,b!==null&&T.types!==null&&(b.types=T.types),$.T=b}}function qR(){}function Nh(a,i,l,c){if(a.tag!==5)throw Error(r(476));var p=c0(a).queue;u0(a,p,i,ne,l===null?qR:function(){return f0(a),l(c)})}function c0(a){var i=a.memoizedState;if(i!==null)return i;i={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qr,lastRenderedState:ne},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qr,lastRenderedState:l},next:null},a.memoizedState=i,a=a.alternate,a!==null&&(a.memoizedState=i),i}function f0(a){var i=c0(a);i.next===null&&(i=a.alternate.memoizedState),Do(a,i.next.queue,{},zn())}function Ih(){return Xt(tl)}function d0(){return Rt().memoizedState}function h0(){return Rt().memoizedState}function FR(a){for(var i=a.return;i!==null;){switch(i.tag){case 24:case 3:var l=zn();a=Aa(l);var c=Ca(i,a,l);c!==null&&(Sn(c,i,l),$o(c,i,l)),i={cache:ih()},a.payload=i;return}i=i.return}}function HR(a,i,l){var c=zn();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Mu(a)?m0(i,l):(l=Xd(a,i,l,c),l!==null&&(Sn(l,a,c),g0(l,i,c)))}function p0(a,i,l){var c=zn();Do(a,i,l,c)}function Do(a,i,l,c){var p={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Mu(a))m0(i,p);else{var g=a.alternate;if(a.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var b=i.lastRenderedState,T=g(b,l);if(p.hasEagerState=!0,p.eagerState=T,In(T,b))return pu(a,i,p,0),dt===null&&hu(),!1}catch{}if(l=Xd(a,i,p,c),l!==null)return Sn(l,a,c),g0(l,i,c),!0}return!1}function kh(a,i,l,c){if(c={lane:2,revertLane:cp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Mu(a)){if(i)throw Error(r(479))}else i=Xd(a,l,c,2),i!==null&&Sn(i,a,2)}function Mu(a){var i=a.alternate;return a===Le||i!==null&&i===Le}function m0(a,i){bi=Au=!0;var l=a.pending;l===null?i.next=i:(i.next=l.next,l.next=i),a.pending=i}function g0(a,i,l){if((l&4194048)!==0){var c=i.lanes;c&=a.pendingLanes,l|=c,i.lanes=l,wy(a,l)}}var Uo={readContext:Xt,use:Nu,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt};Uo.useEffectEvent=wt;var _0={readContext:Xt,use:Nu,useCallback:function(a,i){return on().memoizedState=[a,i===void 0?null:i],a},useContext:Xt,useEffect:e0,useImperativeHandle:function(a,i,l){l=l!=null?l.concat([a]):null,ku(4194308,4,a0.bind(null,i,a),l)},useLayoutEffect:function(a,i){return ku(4194308,4,a,i)},useInsertionEffect:function(a,i){ku(4,2,a,i)},useMemo:function(a,i){var l=on();i=i===void 0?null:i;var c=a();if(xs){va(!0);try{a()}finally{va(!1)}}return l.memoizedState=[c,i],c},useReducer:function(a,i,l){var c=on();if(l!==void 0){var p=l(i);if(xs){va(!0);try{l(i)}finally{va(!1)}}}else p=i;return c.memoizedState=c.baseState=p,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:p},c.queue=a,a=a.dispatch=HR.bind(null,Le,a),[c.memoizedState,a]},useRef:function(a){var i=on();return a={current:a},i.memoizedState=a},useState:function(a){a=xh(a);var i=a.queue,l=p0.bind(null,Le,i);return i.dispatch=l,[a.memoizedState,l]},useDebugValue:Ch,useDeferredValue:function(a,i){var l=on();return Rh(l,a,i)},useTransition:function(){var a=xh(!1);return a=u0.bind(null,Le,a.queue,!0,!1),on().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,i,l){var c=Le,p=on();if(Ve){if(l===void 0)throw Error(r(407));l=l()}else{if(l=i(),dt===null)throw Error(r(349));(He&127)!==0||Dv(c,i,l)}p.memoizedState=l;var g={value:l,getSnapshot:i};return p.queue=g,e0(Pv.bind(null,c,g,a),[a]),c.flags|=2048,Si(9,{destroy:void 0},Uv.bind(null,c,g,l,i),null),l},useId:function(){var a=on(),i=dt.identifierPrefix;if(Ve){var l=Nr,c=Rr;l=(c&~(1<<32-Nn(c)-1)).toString(32)+l,i="_"+i+"R_"+l,l=Cu++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=DR++,i="_"+i+"r_"+l.toString(32)+"_";return a.memoizedState=i},useHostTransitionStatus:Ih,useFormState:Xv,useActionState:Xv,useOptimistic:function(a){var i=on();i.memoizedState=i.baseState=a;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=kh.bind(null,Le,!0,l),l.dispatch=i,[a,i]},useMemoCache:Sh,useCacheRefresh:function(){return on().memoizedState=FR.bind(null,Le)},useEffectEvent:function(a){var i=on(),l={impl:a};return i.memoizedState=l,function(){if((et&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}},$h={readContext:Xt,use:Nu,useCallback:i0,useContext:Xt,useEffect:Ah,useImperativeHandle:s0,useInsertionEffect:n0,useLayoutEffect:r0,useMemo:o0,useReducer:Iu,useRef:Wv,useState:function(){return Iu(Qr)},useDebugValue:Ch,useDeferredValue:function(a,i){var l=Rt();return l0(l,ut.memoizedState,a,i)},useTransition:function(){var a=Iu(Qr)[0],i=Rt().memoizedState;return[typeof a=="boolean"?a:zo(a),i]},useSyncExternalStore:zv,useId:d0,useHostTransitionStatus:Ih,useFormState:Yv,useActionState:Yv,useOptimistic:function(a,i){var l=Rt();return qv(l,ut,a,i)},useMemoCache:Sh,useCacheRefresh:h0};$h.useEffectEvent=t0;var y0={readContext:Xt,use:Nu,useCallback:i0,useContext:Xt,useEffect:Ah,useImperativeHandle:s0,useInsertionEffect:n0,useLayoutEffect:r0,useMemo:o0,useReducer:Th,useRef:Wv,useState:function(){return Th(Qr)},useDebugValue:Ch,useDeferredValue:function(a,i){var l=Rt();return ut===null?Rh(l,a,i):l0(l,ut.memoizedState,a,i)},useTransition:function(){var a=Th(Qr)[0],i=Rt().memoizedState;return[typeof a=="boolean"?a:zo(a),i]},useSyncExternalStore:zv,useId:d0,useHostTransitionStatus:Ih,useFormState:Kv,useActionState:Kv,useOptimistic:function(a,i){var l=Rt();return ut!==null?qv(l,ut,a,i):(l.baseState=a,[a,l.queue.dispatch])},useMemoCache:Sh,useCacheRefresh:h0};y0.useEffectEvent=t0;function Mh(a,i,l,c){i=a.memoizedState,l=l(c,i),l=l==null?i:_({},i,l),a.memoizedState=l,a.lanes===0&&(a.updateQueue.baseState=l)}var jh={enqueueSetState:function(a,i,l){a=a._reactInternals;var c=zn(),p=Aa(c);p.payload=i,l!=null&&(p.callback=l),i=Ca(a,p,c),i!==null&&(Sn(i,a,c),$o(i,a,c))},enqueueReplaceState:function(a,i,l){a=a._reactInternals;var c=zn(),p=Aa(c);p.tag=1,p.payload=i,l!=null&&(p.callback=l),i=Ca(a,p,c),i!==null&&(Sn(i,a,c),$o(i,a,c))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var l=zn(),c=Aa(l);c.tag=2,i!=null&&(c.callback=i),i=Ca(a,c,l),i!==null&&(Sn(i,a,l),$o(i,a,l))}};function v0(a,i,l,c,p,g,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(c,g,b):i.prototype&&i.prototype.isPureReactComponent?!xo(l,c)||!xo(p,g):!0}function b0(a,i,l,c){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,c),i.state!==a&&jh.enqueueReplaceState(i,i.state,null)}function Os(a,i){var l=i;if("ref"in i){l={};for(var c in i)c!=="ref"&&(l[c]=i[c])}if(a=a.defaultProps){l===i&&(l=_({},l));for(var p in a)l[p]===void 0&&(l[p]=a[p])}return l}function w0(a){du(a)}function S0(a){console.error(a)}function E0(a){du(a)}function ju(a,i){try{var l=a.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function T0(a,i,l){try{var c=a.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Lh(a,i,l){return l=Aa(l),l.tag=3,l.payload={element:null},l.callback=function(){ju(a,i)},l}function x0(a){return a=Aa(a),a.tag=3,a}function O0(a,i,l,c){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var g=c.value;a.payload=function(){return p(g)},a.callback=function(){T0(i,l,c)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){T0(i,l,c),typeof p!="function"&&(Ma===null?Ma=new Set([this]):Ma.add(this));var T=c.stack;this.componentDidCatch(c.value,{componentStack:T!==null?T:""})})}function GR(a,i,l,c,p){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=l.alternate,i!==null&&pi(i,l,p,!0),l=$n.current,l!==null){switch(l.tag){case 31:case 13:return ar===null?Vu():l.alternate===null&&St===0&&(St=3),l.flags&=-257,l.flags|=65536,l.lanes=p,c===Su?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([c]):i.add(c),op(a,c,p)),!1;case 22:return l.flags|=65536,c===Su?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([c]):l.add(c)),op(a,c,p)),!1}throw Error(r(435,l.tag))}return op(a,c,p),Vu(),!1}if(Ve)return i=$n.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=p,c!==th&&(a=Error(r(422),{cause:c}),Co(er(a,l)))):(c!==th&&(i=Error(r(423),{cause:c}),Co(er(i,l))),a=a.current.alternate,a.flags|=65536,p&=-p,a.lanes|=p,c=er(c,l),p=Lh(a.stateNode,c,p),dh(a,p),St!==4&&(St=2)),!1;var g=Error(r(520),{cause:c});if(g=er(g,l),Vo===null?Vo=[g]:Vo.push(g),St!==4&&(St=2),i===null)return!0;c=er(c,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,a=p&-p,l.lanes|=a,a=Lh(l.stateNode,c,a),dh(l,a),!1;case 1:if(i=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ma===null||!Ma.has(g))))return l.flags|=65536,p&=-p,l.lanes|=p,p=x0(p),O0(p,a,l,c),dh(l,p),!1}l=l.return}while(l!==null);return!1}var zh=Error(r(461)),Mt=!1;function Yt(a,i,l,c){i.child=a===null?Nv(i,null,l,c):Ts(i,a.child,l,c)}function A0(a,i,l,c,p){l=l.render;var g=i.ref;if("ref"in c){var b={};for(var T in c)T!=="ref"&&(b[T]=c[T])}else b=c;return bs(i),c=yh(a,i,l,b,g,p),T=vh(),a!==null&&!Mt?(bh(a,i,p),Kr(a,i,p)):(Ve&&T&&Wd(i),i.flags|=1,Yt(a,i,c,p),i.child)}function C0(a,i,l,c,p){if(a===null){var g=l.type;return typeof g=="function"&&!Yd(g)&&g.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=g,R0(a,i,g,c,p)):(a=gu(l.type,null,c,i,i.mode,p),a.ref=i.ref,a.return=i,i.child=a)}if(g=a.child,!Hh(a,p)){var b=g.memoizedProps;if(l=l.compare,l=l!==null?l:xo,l(b,c)&&a.ref===i.ref)return Kr(a,i,p)}return i.flags|=1,a=Gr(g,c),a.ref=i.ref,a.return=i,i.child=a}function R0(a,i,l,c,p){if(a!==null){var g=a.memoizedProps;if(xo(g,c)&&a.ref===i.ref)if(Mt=!1,i.pendingProps=c=g,Hh(a,p))(a.flags&131072)!==0&&(Mt=!0);else return i.lanes=a.lanes,Kr(a,i,p)}return Dh(a,i,l,c,p)}function N0(a,i,l,c){var p=c.children,g=a!==null?a.memoizedState:null;if(a===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,a!==null){for(c=i.child=a.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;c=p&~g}else c=0,i.child=null;return I0(a,i,g,l,c)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},a!==null&&bu(i,g!==null?g.cachePool:null),g!==null?$v(i,g):ph(),Mv(i);else return c=i.lanes=536870912,I0(a,i,g!==null?g.baseLanes|l:l,l,c)}else g!==null?(bu(i,g.cachePool),$v(i,g),Na(),i.memoizedState=null):(a!==null&&bu(i,null),ph(),Na());return Yt(a,i,p,l),i.child}function Po(a,i){return a!==null&&a.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function I0(a,i,l,c,p){var g=lh();return g=g===null?null:{parent:kt._currentValue,pool:g},i.memoizedState={baseLanes:l,cachePool:g},a!==null&&bu(i,null),ph(),Mv(i),a!==null&&pi(a,i,c,!0),i.childLanes=p,null}function Lu(a,i){return i=Du({mode:i.mode,children:i.children},a.mode),i.ref=a.ref,a.child=i,i.return=a,i}function k0(a,i,l){return Ts(i,a.child,null,l),a=Lu(i,i.pendingProps),a.flags|=2,Mn(i),i.memoizedState=null,a}function VR(a,i,l){var c=i.pendingProps,p=(i.flags&128)!==0;if(i.flags&=-129,a===null){if(Ve){if(c.mode==="hidden")return a=Lu(i,c),i.lanes=536870912,Po(null,a);if(gh(i),(a=mt)?(a=Fb(a,rr),a=a!==null&&a.data==="&"?a:null,a!==null&&(i.memoizedState={dehydrated:a,treeContext:Sa!==null?{id:Rr,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},l=mv(a),l.return=i,i.child=l,Jt=i,mt=null)):a=null,a===null)throw Ta(i);return i.lanes=536870912,null}return Lu(i,c)}var g=a.memoizedState;if(g!==null){var b=g.dehydrated;if(gh(i),p)if(i.flags&256)i.flags&=-257,i=k0(a,i,l);else if(i.memoizedState!==null)i.child=a.child,i.flags|=128,i=null;else throw Error(r(558));else if(Mt||pi(a,i,l,!1),p=(l&a.childLanes)!==0,Mt||p){if(c=dt,c!==null&&(b=Sy(c,l),b!==0&&b!==g.retryLane))throw g.retryLane=b,gs(a,b),Sn(c,a,b),zh;Vu(),i=k0(a,i,l)}else a=g.treeContext,mt=sr(b.nextSibling),Jt=i,Ve=!0,Ea=null,rr=!1,a!==null&&yv(i,a),i=Lu(i,c),i.flags|=4096;return i}return a=Gr(a.child,{mode:c.mode,children:c.children}),a.ref=i.ref,i.child=a,a.return=i,a}function zu(a,i){var l=i.ref;if(l===null)a!==null&&a.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(a===null||a.ref!==l)&&(i.flags|=4194816)}}function Dh(a,i,l,c,p){return bs(i),l=yh(a,i,l,c,void 0,p),c=vh(),a!==null&&!Mt?(bh(a,i,p),Kr(a,i,p)):(Ve&&c&&Wd(i),i.flags|=1,Yt(a,i,l,p),i.child)}function $0(a,i,l,c,p,g){return bs(i),i.updateQueue=null,l=Lv(i,c,l,p),jv(a),c=vh(),a!==null&&!Mt?(bh(a,i,g),Kr(a,i,g)):(Ve&&c&&Wd(i),i.flags|=1,Yt(a,i,l,g),i.child)}function M0(a,i,l,c,p){if(bs(i),i.stateNode===null){var g=ci,b=l.contextType;typeof b=="object"&&b!==null&&(g=Xt(b)),g=new l(c,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=jh,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=c,g.state=i.memoizedState,g.refs={},ch(i),b=l.contextType,g.context=typeof b=="object"&&b!==null?Xt(b):ci,g.state=i.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(Mh(i,l,b,c),g.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(b=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),b!==g.state&&jh.enqueueReplaceState(g,g.state,null),jo(i,c,g,p),Mo(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(a===null){g=i.stateNode;var T=i.memoizedProps,k=Os(l,T);g.props=k;var P=g.context,J=l.contextType;b=ci,typeof J=="object"&&J!==null&&(b=Xt(J));var te=l.getDerivedStateFromProps;J=typeof te=="function"||typeof g.getSnapshotBeforeUpdate=="function",T=i.pendingProps!==T,J||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T||P!==b)&&b0(i,g,c,b),Oa=!1;var q=i.memoizedState;g.state=q,jo(i,c,g,p),Mo(),P=i.memoizedState,T||q!==P||Oa?(typeof te=="function"&&(Mh(i,l,te,c),P=i.memoizedState),(k=Oa||v0(i,l,k,c,q,P,b))?(J||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=P),g.props=c,g.state=P,g.context=b,c=k):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{g=i.stateNode,fh(a,i),b=i.memoizedProps,J=Os(l,b),g.props=J,te=i.pendingProps,q=g.context,P=l.contextType,k=ci,typeof P=="object"&&P!==null&&(k=Xt(P)),T=l.getDerivedStateFromProps,(P=typeof T=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b!==te||q!==k)&&b0(i,g,c,k),Oa=!1,q=i.memoizedState,g.state=q,jo(i,c,g,p),Mo();var H=i.memoizedState;b!==te||q!==H||Oa||a!==null&&a.dependencies!==null&&yu(a.dependencies)?(typeof T=="function"&&(Mh(i,l,T,c),H=i.memoizedState),(J=Oa||v0(i,l,J,c,q,H,k)||a!==null&&a.dependencies!==null&&yu(a.dependencies))?(P||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,H,k),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,H,k)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||b===a.memoizedProps&&q===a.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&q===a.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=H),g.props=c,g.state=H,g.context=k,c=J):(typeof g.componentDidUpdate!="function"||b===a.memoizedProps&&q===a.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&q===a.memoizedState||(i.flags|=1024),c=!1)}return g=c,zu(a,i),c=(i.flags&128)!==0,g||c?(g=i.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,a!==null&&c?(i.child=Ts(i,a.child,null,p),i.child=Ts(i,null,l,p)):Yt(a,i,l,p),i.memoizedState=g.state,a=i.child):a=Kr(a,i,p),a}function j0(a,i,l,c){return ys(),i.flags|=256,Yt(a,i,l,c),i.child}var Uh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ph(a){return{baseLanes:a,cachePool:Tv()}}function Bh(a,i,l){return a=a!==null?a.childLanes&~l:0,i&&(a|=Ln),a}function L0(a,i,l){var c=i.pendingProps,p=!1,g=(i.flags&128)!==0,b;if((b=g)||(b=a!==null&&a.memoizedState===null?!1:(Ct.current&2)!==0),b&&(p=!0,i.flags&=-129),b=(i.flags&32)!==0,i.flags&=-33,a===null){if(Ve){if(p?Ra(i):Na(),(a=mt)?(a=Fb(a,rr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(i.memoizedState={dehydrated:a,treeContext:Sa!==null?{id:Rr,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},l=mv(a),l.return=i,i.child=l,Jt=i,mt=null)):a=null,a===null)throw Ta(i);return Ep(a)?i.lanes=32:i.lanes=536870912,null}var T=c.children;return c=c.fallback,p?(Na(),p=i.mode,T=Du({mode:"hidden",children:T},p),c=_s(c,p,l,null),T.return=i,c.return=i,T.sibling=c,i.child=T,c=i.child,c.memoizedState=Ph(l),c.childLanes=Bh(a,b,l),i.memoizedState=Uh,Po(null,c)):(Ra(i),Zh(i,T))}var k=a.memoizedState;if(k!==null&&(T=k.dehydrated,T!==null)){if(g)i.flags&256?(Ra(i),i.flags&=-257,i=qh(a,i,l)):i.memoizedState!==null?(Na(),i.child=a.child,i.flags|=128,i=null):(Na(),T=c.fallback,p=i.mode,c=Du({mode:"visible",children:c.children},p),T=_s(T,p,l,null),T.flags|=2,c.return=i,T.return=i,c.sibling=T,i.child=c,Ts(i,a.child,null,l),c=i.child,c.memoizedState=Ph(l),c.childLanes=Bh(a,b,l),i.memoizedState=Uh,i=Po(null,c));else if(Ra(i),Ep(T)){if(b=T.nextSibling&&T.nextSibling.dataset,b)var P=b.dgst;b=P,c=Error(r(419)),c.stack="",c.digest=b,Co({value:c,source:null,stack:null}),i=qh(a,i,l)}else if(Mt||pi(a,i,l,!1),b=(l&a.childLanes)!==0,Mt||b){if(b=dt,b!==null&&(c=Sy(b,l),c!==0&&c!==k.retryLane))throw k.retryLane=c,gs(a,c),Sn(b,a,c),zh;Sp(T)||Vu(),i=qh(a,i,l)}else Sp(T)?(i.flags|=192,i.child=a.child,i=null):(a=k.treeContext,mt=sr(T.nextSibling),Jt=i,Ve=!0,Ea=null,rr=!1,a!==null&&yv(i,a),i=Zh(i,c.children),i.flags|=4096);return i}return p?(Na(),T=c.fallback,p=i.mode,k=a.child,P=k.sibling,c=Gr(k,{mode:"hidden",children:c.children}),c.subtreeFlags=k.subtreeFlags&65011712,P!==null?T=Gr(P,T):(T=_s(T,p,l,null),T.flags|=2),T.return=i,c.return=i,c.sibling=T,i.child=c,Po(null,c),c=i.child,T=a.child.memoizedState,T===null?T=Ph(l):(p=T.cachePool,p!==null?(k=kt._currentValue,p=p.parent!==k?{parent:k,pool:k}:p):p=Tv(),T={baseLanes:T.baseLanes|l,cachePool:p}),c.memoizedState=T,c.childLanes=Bh(a,b,l),i.memoizedState=Uh,Po(a.child,c)):(Ra(i),l=a.child,a=l.sibling,l=Gr(l,{mode:"visible",children:c.children}),l.return=i,l.sibling=null,a!==null&&(b=i.deletions,b===null?(i.deletions=[a],i.flags|=16):b.push(a)),i.child=l,i.memoizedState=null,l)}function Zh(a,i){return i=Du({mode:"visible",children:i},a.mode),i.return=a,a.child=i}function Du(a,i){return a=kn(22,a,null,i),a.lanes=0,a}function qh(a,i,l){return Ts(i,a.child,null,l),a=Zh(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function z0(a,i,l){a.lanes|=i;var c=a.alternate;c!==null&&(c.lanes|=i),ah(a.return,i,l)}function Fh(a,i,l,c,p,g){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:p,treeForkCount:g}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=c,b.tail=l,b.tailMode=p,b.treeForkCount=g)}function D0(a,i,l){var c=i.pendingProps,p=c.revealOrder,g=c.tail;c=c.children;var b=Ct.current,T=(b&2)!==0;if(T?(b=b&1|2,i.flags|=128):b&=1,V(Ct,b),Yt(a,i,c,l),c=Ve?Ao:0,!T&&a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&z0(a,l,i);else if(a.tag===19)z0(a,l,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(p){case"forwards":for(l=i.child,p=null;l!==null;)a=l.alternate,a!==null&&Ou(a)===null&&(p=l),l=l.sibling;l=p,l===null?(p=i.child,i.child=null):(p=l.sibling,l.sibling=null),Fh(i,!1,p,l,g,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,p=i.child,i.child=null;p!==null;){if(a=p.alternate,a!==null&&Ou(a)===null){i.child=p;break}a=p.sibling,p.sibling=l,l=p,p=a}Fh(i,!0,l,null,g,c);break;case"together":Fh(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function Kr(a,i,l){if(a!==null&&(i.dependencies=a.dependencies),$a|=i.lanes,(l&i.childLanes)===0)if(a!==null){if(pi(a,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(a!==null&&i.child!==a.child)throw Error(r(153));if(i.child!==null){for(a=i.child,l=Gr(a,a.pendingProps),i.child=l,l.return=i;a.sibling!==null;)a=a.sibling,l=l.sibling=Gr(a,a.pendingProps),l.return=i;l.sibling=null}return i.child}function Hh(a,i){return(a.lanes&i)!==0?!0:(a=a.dependencies,!!(a!==null&&yu(a)))}function JR(a,i,l){switch(i.tag){case 3:Q(i,i.stateNode.containerInfo),xa(i,kt,a.memoizedState.cache),ys();break;case 27:case 5:Pe(i);break;case 4:Q(i,i.stateNode.containerInfo);break;case 10:xa(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,gh(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(Ra(i),i.flags|=128,null):(l&i.child.childLanes)!==0?L0(a,i,l):(Ra(i),a=Kr(a,i,l),a!==null?a.sibling:null);Ra(i);break;case 19:var p=(a.flags&128)!==0;if(c=(l&i.childLanes)!==0,c||(pi(a,i,l,!1),c=(l&i.childLanes)!==0),p){if(c)return D0(a,i,l);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),V(Ct,Ct.current),c)break;return null;case 22:return i.lanes=0,N0(a,i,l,i.pendingProps);case 24:xa(i,kt,a.memoizedState.cache)}return Kr(a,i,l)}function U0(a,i,l){if(a!==null)if(a.memoizedProps!==i.pendingProps)Mt=!0;else{if(!Hh(a,l)&&(i.flags&128)===0)return Mt=!1,JR(a,i,l);Mt=(a.flags&131072)!==0}else Mt=!1,Ve&&(i.flags&1048576)!==0&&_v(i,Ao,i.index);switch(i.lanes=0,i.tag){case 16:e:{var c=i.pendingProps;if(a=Ss(i.elementType),i.type=a,typeof a=="function")Yd(a)?(c=Os(a,c),i.tag=1,i=M0(null,i,a,c,l)):(i.tag=0,i=Dh(null,i,a,c,l));else{if(a!=null){var p=a.$$typeof;if(p===M){i.tag=11,i=A0(null,i,a,c,l);break e}else if(p===W){i.tag=14,i=C0(null,i,a,c,l);break e}}throw i=ue(a)||a,Error(r(306,i,""))}}return i;case 0:return Dh(a,i,i.type,i.pendingProps,l);case 1:return c=i.type,p=Os(c,i.pendingProps),M0(a,i,c,p,l);case 3:e:{if(Q(i,i.stateNode.containerInfo),a===null)throw Error(r(387));c=i.pendingProps;var g=i.memoizedState;p=g.element,fh(a,i),jo(i,c,null,l);var b=i.memoizedState;if(c=b.cache,xa(i,kt,c),c!==g.cache&&sh(i,[kt],l,!0),Mo(),c=b.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:b.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=j0(a,i,c,l);break e}else if(c!==p){p=er(Error(r(424)),i),Co(p),i=j0(a,i,c,l);break e}else for(a=i.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,mt=sr(a.firstChild),Jt=i,Ve=!0,Ea=null,rr=!0,l=Nv(i,null,c,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(ys(),c===p){i=Kr(a,i,l);break e}Yt(a,i,c,l)}i=i.child}return i;case 26:return zu(a,i),a===null?(l=Yb(i.type,null,i.pendingProps,null))?i.memoizedState=l:Ve||(l=i.type,a=i.pendingProps,c=ec(O.current).createElement(l),c[Vt]=i,c[gn]=a,Qt(c,l,a),Zt(c),i.stateNode=c):i.memoizedState=Yb(i.type,a.memoizedProps,i.pendingProps,a.memoizedState),null;case 27:return Pe(i),a===null&&Ve&&(c=i.stateNode=Vb(i.type,i.pendingProps,O.current),Jt=i,rr=!0,p=mt,Da(i.type)?(Tp=p,mt=sr(c.firstChild)):mt=p),Yt(a,i,i.pendingProps.children,l),zu(a,i),a===null&&(i.flags|=4194304),i.child;case 5:return a===null&&Ve&&((p=c=mt)&&(c=TN(c,i.type,i.pendingProps,rr),c!==null?(i.stateNode=c,Jt=i,mt=sr(c.firstChild),rr=!1,p=!0):p=!1),p||Ta(i)),Pe(i),p=i.type,g=i.pendingProps,b=a!==null?a.memoizedProps:null,c=g.children,vp(p,g)?c=null:b!==null&&vp(p,b)&&(i.flags|=32),i.memoizedState!==null&&(p=yh(a,i,UR,null,null,l),tl._currentValue=p),zu(a,i),Yt(a,i,c,l),i.child;case 6:return a===null&&Ve&&((a=l=mt)&&(l=xN(l,i.pendingProps,rr),l!==null?(i.stateNode=l,Jt=i,mt=null,a=!0):a=!1),a||Ta(i)),null;case 13:return L0(a,i,l);case 4:return Q(i,i.stateNode.containerInfo),c=i.pendingProps,a===null?i.child=Ts(i,null,c,l):Yt(a,i,c,l),i.child;case 11:return A0(a,i,i.type,i.pendingProps,l);case 7:return Yt(a,i,i.pendingProps,l),i.child;case 8:return Yt(a,i,i.pendingProps.children,l),i.child;case 12:return Yt(a,i,i.pendingProps.children,l),i.child;case 10:return c=i.pendingProps,xa(i,i.type,c.value),Yt(a,i,c.children,l),i.child;case 9:return p=i.type._context,c=i.pendingProps.children,bs(i),p=Xt(p),c=c(p),i.flags|=1,Yt(a,i,c,l),i.child;case 14:return C0(a,i,i.type,i.pendingProps,l);case 15:return R0(a,i,i.type,i.pendingProps,l);case 19:return D0(a,i,l);case 31:return VR(a,i,l);case 22:return N0(a,i,l,i.pendingProps);case 24:return bs(i),c=Xt(kt),a===null?(p=lh(),p===null&&(p=dt,g=ih(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=l),p=g),i.memoizedState={parent:c,cache:p},ch(i),xa(i,kt,p)):((a.lanes&l)!==0&&(fh(a,i),jo(i,null,null,l),Mo()),p=a.memoizedState,g=i.memoizedState,p.parent!==c?(p={parent:c,cache:c},i.memoizedState=p,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=p),xa(i,kt,c)):(c=g.cache,xa(i,kt,c),c!==p.cache&&sh(i,[kt],l,!0))),Yt(a,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function Wr(a){a.flags|=4}function Gh(a,i,l,c,p){if((i=(a.mode&32)!==0)&&(i=!1),i){if(a.flags|=16777216,(p&335544128)===p)if(a.stateNode.complete)a.flags|=8192;else if(db())a.flags|=8192;else throw Es=Su,uh}else a.flags&=-16777217}function P0(a,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!tw(i))if(db())a.flags|=8192;else throw Es=Su,uh}function Uu(a,i){i!==null&&(a.flags|=4),a.flags&16384&&(i=a.tag!==22?vy():536870912,a.lanes|=i,Oi|=i)}function Bo(a,i){if(!Ve)switch(a.tailMode){case"hidden":i=a.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?a.tail=null:l.sibling=null;break;case"collapsed":l=a.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:c.sibling=null}}function gt(a){var i=a.alternate!==null&&a.alternate.child===a.child,l=0,c=0;if(i)for(var p=a.child;p!==null;)l|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=a,p=p.sibling;else for(p=a.child;p!==null;)l|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=a,p=p.sibling;return a.subtreeFlags|=c,a.childLanes=l,i}function XR(a,i,l){var c=i.pendingProps;switch(eh(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(i),null;case 1:return gt(i),null;case 3:return l=i.stateNode,c=null,a!==null&&(c=a.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Xr(kt),L(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(a===null||a.child===null)&&(hi(i)?Wr(i):a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,nh())),gt(i),null;case 26:var p=i.type,g=i.memoizedState;return a===null?(Wr(i),g!==null?(gt(i),P0(i,g)):(gt(i),Gh(i,p,null,c,l))):g?g!==a.memoizedState?(Wr(i),gt(i),P0(i,g)):(gt(i),i.flags&=-16777217):(a=a.memoizedProps,a!==c&&Wr(i),gt(i),Gh(i,p,a,c,l)),null;case 27:if(nt(i),l=O.current,p=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==c&&Wr(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return gt(i),null}a=ie.current,hi(i)?vv(i):(a=Vb(p,c,l),i.stateNode=a,Wr(i))}return gt(i),null;case 5:if(nt(i),p=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==c&&Wr(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return gt(i),null}if(g=ie.current,hi(i))vv(i);else{var b=ec(O.current);switch(g){case 1:g=b.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:g=b.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":g=b.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":g=b.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":g=b.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?b.createElement("select",{is:c.is}):b.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?b.createElement(p,{is:c.is}):b.createElement(p)}}g[Vt]=i,g[gn]=c;e:for(b=i.child;b!==null;){if(b.tag===5||b.tag===6)g.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===i)break e;for(;b.sibling===null;){if(b.return===null||b.return===i)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}i.stateNode=g;e:switch(Qt(g,p,c),p){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Wr(i)}}return gt(i),Gh(i,i.type,a===null?null:a.memoizedProps,i.pendingProps,l),null;case 6:if(a&&i.stateNode!=null)a.memoizedProps!==c&&Wr(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(a=O.current,hi(i)){if(a=i.stateNode,l=i.memoizedProps,c=null,p=Jt,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}a[Vt]=i,a=!!(a.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||Lb(a.nodeValue,l)),a||Ta(i,!0)}else a=ec(a).createTextNode(c),a[Vt]=i,i.stateNode=a}return gt(i),null;case 31:if(l=i.memoizedState,a===null||a.memoizedState!==null){if(c=hi(i),l!==null){if(a===null){if(!c)throw Error(r(318));if(a=i.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[Vt]=i}else ys(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;gt(i),a=!1}else l=nh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=l),a=!0;if(!a)return i.flags&256?(Mn(i),i):(Mn(i),null);if((i.flags&128)!==0)throw Error(r(558))}return gt(i),null;case 13:if(c=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(p=hi(i),c!==null&&c.dehydrated!==null){if(a===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Vt]=i}else ys(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;gt(i),p=!1}else p=nh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=p),p=!0;if(!p)return i.flags&256?(Mn(i),i):(Mn(i),null)}return Mn(i),(i.flags&128)!==0?(i.lanes=l,i):(l=c!==null,a=a!==null&&a.memoizedState!==null,l&&(c=i.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==p&&(c.flags|=2048)),l!==a&&l&&(i.child.flags|=8192),Uu(i,i.updateQueue),gt(i),null);case 4:return L(),a===null&&pp(i.stateNode.containerInfo),gt(i),null;case 10:return Xr(i.type),gt(i),null;case 19:if(D(Ct),c=i.memoizedState,c===null)return gt(i),null;if(p=(i.flags&128)!==0,g=c.rendering,g===null)if(p)Bo(c,!1);else{if(St!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(g=Ou(a),g!==null){for(i.flags|=128,Bo(c,!1),a=g.updateQueue,i.updateQueue=a,Uu(i,a),i.subtreeFlags=0,a=l,l=i.child;l!==null;)pv(l,a),l=l.sibling;return V(Ct,Ct.current&1|2),Ve&&Vr(i,c.treeForkCount),i.child}a=a.sibling}c.tail!==null&&Cn()>Fu&&(i.flags|=128,p=!0,Bo(c,!1),i.lanes=4194304)}else{if(!p)if(a=Ou(g),a!==null){if(i.flags|=128,p=!0,a=a.updateQueue,i.updateQueue=a,Uu(i,a),Bo(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!Ve)return gt(i),null}else 2*Cn()-c.renderingStartTime>Fu&&l!==536870912&&(i.flags|=128,p=!0,Bo(c,!1),i.lanes=4194304);c.isBackwards?(g.sibling=i.child,i.child=g):(a=c.last,a!==null?a.sibling=g:i.child=g,c.last=g)}return c.tail!==null?(a=c.tail,c.rendering=a,c.tail=a.sibling,c.renderingStartTime=Cn(),a.sibling=null,l=Ct.current,V(Ct,p?l&1|2:l&1),Ve&&Vr(i,c.treeForkCount),a):(gt(i),null);case 22:case 23:return Mn(i),mh(),c=i.memoizedState!==null,a!==null?a.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(l&536870912)!==0&&(i.flags&128)===0&&(gt(i),i.subtreeFlags&6&&(i.flags|=8192)):gt(i),l=i.updateQueue,l!==null&&Uu(i,l.retryQueue),l=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==l&&(i.flags|=2048),a!==null&&D(ws),null;case 24:return l=null,a!==null&&(l=a.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),Xr(kt),gt(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function YR(a,i){switch(eh(i),i.tag){case 1:return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return Xr(kt),L(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 26:case 27:case 5:return nt(i),null;case 31:if(i.memoizedState!==null){if(Mn(i),i.alternate===null)throw Error(r(340));ys()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 13:if(Mn(i),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(r(340));ys()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return D(Ct),null;case 4:return L(),null;case 10:return Xr(i.type),null;case 22:case 23:return Mn(i),mh(),a!==null&&D(ws),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 24:return Xr(kt),null;case 25:return null;default:return null}}function B0(a,i){switch(eh(i),i.tag){case 3:Xr(kt),L();break;case 26:case 27:case 5:nt(i);break;case 4:L();break;case 31:i.memoizedState!==null&&Mn(i);break;case 13:Mn(i);break;case 19:D(Ct);break;case 10:Xr(i.type);break;case 22:case 23:Mn(i),mh(),a!==null&&D(ws);break;case 24:Xr(kt)}}function Zo(a,i){try{var l=i.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var p=c.next;l=p;do{if((l.tag&a)===a){c=void 0;var g=l.create,b=l.inst;c=g(),b.destroy=c}l=l.next}while(l!==p)}}catch(T){at(i,i.return,T)}}function Ia(a,i,l){try{var c=i.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var g=p.next;c=g;do{if((c.tag&a)===a){var b=c.inst,T=b.destroy;if(T!==void 0){b.destroy=void 0,p=i;var k=l,P=T;try{P()}catch(J){at(p,k,J)}}}c=c.next}while(c!==g)}}catch(J){at(i,i.return,J)}}function Z0(a){var i=a.updateQueue;if(i!==null){var l=a.stateNode;try{kv(i,l)}catch(c){at(a,a.return,c)}}}function q0(a,i,l){l.props=Os(a.type,a.memoizedProps),l.state=a.memoizedState;try{l.componentWillUnmount()}catch(c){at(a,i,c)}}function qo(a,i){try{var l=a.ref;if(l!==null){switch(a.tag){case 26:case 27:case 5:var c=a.stateNode;break;case 30:c=a.stateNode;break;default:c=a.stateNode}typeof l=="function"?a.refCleanup=l(c):l.current=c}}catch(p){at(a,i,p)}}function Ir(a,i){var l=a.ref,c=a.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(p){at(a,i,p)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){at(a,i,p)}else l.current=null}function F0(a){var i=a.type,l=a.memoizedProps,c=a.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(p){at(a,a.return,p)}}function Vh(a,i,l){try{var c=a.stateNode;yN(c,a.type,l,i),c[gn]=i}catch(p){at(a,a.return,p)}}function H0(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Da(a.type)||a.tag===4}function Jh(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||H0(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Da(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Xh(a,i,l){var c=a.tag;if(c===5||c===6)a=a.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(a,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(a),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Fr));else if(c!==4&&(c===27&&Da(a.type)&&(l=a.stateNode,i=null),a=a.child,a!==null))for(Xh(a,i,l),a=a.sibling;a!==null;)Xh(a,i,l),a=a.sibling}function Pu(a,i,l){var c=a.tag;if(c===5||c===6)a=a.stateNode,i?l.insertBefore(a,i):l.appendChild(a);else if(c!==4&&(c===27&&Da(a.type)&&(l=a.stateNode),a=a.child,a!==null))for(Pu(a,i,l),a=a.sibling;a!==null;)Pu(a,i,l),a=a.sibling}function G0(a){var i=a.stateNode,l=a.memoizedProps;try{for(var c=a.type,p=i.attributes;p.length;)i.removeAttributeNode(p[0]);Qt(i,c,l),i[Vt]=a,i[gn]=l}catch(g){at(a,a.return,g)}}var ea=!1,jt=!1,Yh=!1,V0=typeof WeakSet=="function"?WeakSet:Set,qt=null;function QR(a,i){if(a=a.containerInfo,_p=oc,a=sv(a),qd(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{l=(l=a.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var p=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var b=0,T=-1,k=-1,P=0,J=0,te=a,q=null;t:for(;;){for(var H;te!==l||p!==0&&te.nodeType!==3||(T=b+p),te!==g||c!==0&&te.nodeType!==3||(k=b+c),te.nodeType===3&&(b+=te.nodeValue.length),(H=te.firstChild)!==null;)q=te,te=H;for(;;){if(te===a)break t;if(q===l&&++P===p&&(T=b),q===g&&++J===c&&(k=b),(H=te.nextSibling)!==null)break;te=q,q=te.parentNode}te=H}l=T===-1||k===-1?null:{start:T,end:k}}else l=null}l=l||{start:0,end:0}}else l=null;for(yp={focusedElem:a,selectionRange:l},oc=!1,qt=i;qt!==null;)if(i=qt,a=i.child,(i.subtreeFlags&1028)!==0&&a!==null)a.return=i,qt=a;else for(;qt!==null;){switch(i=qt,g=i.alternate,a=i.flags,i.tag){case 0:if((a&4)!==0&&(a=i.updateQueue,a=a!==null?a.events:null,a!==null))for(l=0;l<a.length;l++)p=a[l],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&g!==null){a=void 0,l=i,p=g.memoizedProps,g=g.memoizedState,c=l.stateNode;try{var ge=Os(l.type,p);a=c.getSnapshotBeforeUpdate(ge,g),c.__reactInternalSnapshotBeforeUpdate=a}catch(Ie){at(l,l.return,Ie)}}break;case 3:if((a&1024)!==0){if(a=i.stateNode.containerInfo,l=a.nodeType,l===9)wp(a);else if(l===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":wp(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=i.sibling,a!==null){a.return=i.return,qt=a;break}qt=i.return}}function J0(a,i,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:na(a,l),c&4&&Zo(5,l);break;case 1:if(na(a,l),c&4)if(a=l.stateNode,i===null)try{a.componentDidMount()}catch(b){at(l,l.return,b)}else{var p=Os(l.type,i.memoizedProps);i=i.memoizedState;try{a.componentDidUpdate(p,i,a.__reactInternalSnapshotBeforeUpdate)}catch(b){at(l,l.return,b)}}c&64&&Z0(l),c&512&&qo(l,l.return);break;case 3:if(na(a,l),c&64&&(a=l.updateQueue,a!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{kv(a,i)}catch(b){at(l,l.return,b)}}break;case 27:i===null&&c&4&&G0(l);case 26:case 5:na(a,l),i===null&&c&4&&F0(l),c&512&&qo(l,l.return);break;case 12:na(a,l);break;case 31:na(a,l),c&4&&Q0(a,l);break;case 13:na(a,l),c&4&&K0(a,l),c&64&&(a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(l=iN.bind(null,l),ON(a,l))));break;case 22:if(c=l.memoizedState!==null||ea,!c){i=i!==null&&i.memoizedState!==null||jt,p=ea;var g=jt;ea=c,(jt=i)&&!g?ra(a,l,(l.subtreeFlags&8772)!==0):na(a,l),ea=p,jt=g}break;case 30:break;default:na(a,l)}}function X0(a){var i=a.alternate;i!==null&&(a.alternate=null,X0(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&Od(i)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var yt=null,yn=!1;function ta(a,i,l){for(l=l.child;l!==null;)Y0(a,i,l),l=l.sibling}function Y0(a,i,l){if(Rn&&typeof Rn.onCommitFiberUnmount=="function")try{Rn.onCommitFiberUnmount(ho,l)}catch{}switch(l.tag){case 26:jt||Ir(l,i),ta(a,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:jt||Ir(l,i);var c=yt,p=yn;Da(l.type)&&(yt=l.stateNode,yn=!1),ta(a,i,l),Ko(l.stateNode),yt=c,yn=p;break;case 5:jt||Ir(l,i);case 6:if(c=yt,p=yn,yt=null,ta(a,i,l),yt=c,yn=p,yt!==null)if(yn)try{(yt.nodeType===9?yt.body:yt.nodeName==="HTML"?yt.ownerDocument.body:yt).removeChild(l.stateNode)}catch(g){at(l,i,g)}else try{yt.removeChild(l.stateNode)}catch(g){at(l,i,g)}break;case 18:yt!==null&&(yn?(a=yt,Zb(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,l.stateNode),Mi(a)):Zb(yt,l.stateNode));break;case 4:c=yt,p=yn,yt=l.stateNode.containerInfo,yn=!0,ta(a,i,l),yt=c,yn=p;break;case 0:case 11:case 14:case 15:Ia(2,l,i),jt||Ia(4,l,i),ta(a,i,l);break;case 1:jt||(Ir(l,i),c=l.stateNode,typeof c.componentWillUnmount=="function"&&q0(l,i,c)),ta(a,i,l);break;case 21:ta(a,i,l);break;case 22:jt=(c=jt)||l.memoizedState!==null,ta(a,i,l),jt=c;break;default:ta(a,i,l)}}function Q0(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Mi(a)}catch(l){at(i,i.return,l)}}}function K0(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Mi(a)}catch(l){at(i,i.return,l)}}function KR(a){switch(a.tag){case 31:case 13:case 19:var i=a.stateNode;return i===null&&(i=a.stateNode=new V0),i;case 22:return a=a.stateNode,i=a._retryCache,i===null&&(i=a._retryCache=new V0),i;default:throw Error(r(435,a.tag))}}function Bu(a,i){var l=KR(a);i.forEach(function(c){if(!l.has(c)){l.add(c);var p=oN.bind(null,a,c);c.then(p,p)}})}function vn(a,i){var l=i.deletions;if(l!==null)for(var c=0;c<l.length;c++){var p=l[c],g=a,b=i,T=b;e:for(;T!==null;){switch(T.tag){case 27:if(Da(T.type)){yt=T.stateNode,yn=!1;break e}break;case 5:yt=T.stateNode,yn=!1;break e;case 3:case 4:yt=T.stateNode.containerInfo,yn=!0;break e}T=T.return}if(yt===null)throw Error(r(160));Y0(g,b,p),yt=null,yn=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)W0(i,a),i=i.sibling}var hr=null;function W0(a,i){var l=a.alternate,c=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:vn(i,a),bn(a),c&4&&(Ia(3,a,a.return),Zo(3,a),Ia(5,a,a.return));break;case 1:vn(i,a),bn(a),c&512&&(jt||l===null||Ir(l,l.return)),c&64&&ea&&(a=a.updateQueue,a!==null&&(c=a.callbacks,c!==null&&(l=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var p=hr;if(vn(i,a),bn(a),c&512&&(jt||l===null||Ir(l,l.return)),c&4){var g=l!==null?l.memoizedState:null;if(c=a.memoizedState,l===null)if(c===null)if(a.stateNode===null){e:{c=a.type,l=a.memoizedProps,p=p.ownerDocument||p;t:switch(c){case"title":g=p.getElementsByTagName("title")[0],(!g||g[go]||g[Vt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(c),p.head.insertBefore(g,p.querySelector("head > title"))),Qt(g,c,l),g[Vt]=a,Zt(g),c=g;break e;case"link":var b=Wb("link","href",p).get(c+(l.href||""));if(b){for(var T=0;T<b.length;T++)if(g=b[T],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(T,1);break t}}g=p.createElement(c),Qt(g,c,l),p.head.appendChild(g);break;case"meta":if(b=Wb("meta","content",p).get(c+(l.content||""))){for(T=0;T<b.length;T++)if(g=b[T],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(T,1);break t}}g=p.createElement(c),Qt(g,c,l),p.head.appendChild(g);break;default:throw Error(r(468,c))}g[Vt]=a,Zt(g),c=g}a.stateNode=c}else ew(p,a.type,a.stateNode);else a.stateNode=Kb(p,c,a.memoizedProps);else g!==c?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,c===null?ew(p,a.type,a.stateNode):Kb(p,c,a.memoizedProps)):c===null&&a.stateNode!==null&&Vh(a,a.memoizedProps,l.memoizedProps)}break;case 27:vn(i,a),bn(a),c&512&&(jt||l===null||Ir(l,l.return)),l!==null&&c&4&&Vh(a,a.memoizedProps,l.memoizedProps);break;case 5:if(vn(i,a),bn(a),c&512&&(jt||l===null||Ir(l,l.return)),a.flags&32){p=a.stateNode;try{ri(p,"")}catch(ge){at(a,a.return,ge)}}c&4&&a.stateNode!=null&&(p=a.memoizedProps,Vh(a,p,l!==null?l.memoizedProps:p)),c&1024&&(Yh=!0);break;case 6:if(vn(i,a),bn(a),c&4){if(a.stateNode===null)throw Error(r(162));c=a.memoizedProps,l=a.stateNode;try{l.nodeValue=c}catch(ge){at(a,a.return,ge)}}break;case 3:if(rc=null,p=hr,hr=tc(i.containerInfo),vn(i,a),hr=p,bn(a),c&4&&l!==null&&l.memoizedState.isDehydrated)try{Mi(i.containerInfo)}catch(ge){at(a,a.return,ge)}Yh&&(Yh=!1,eb(a));break;case 4:c=hr,hr=tc(a.stateNode.containerInfo),vn(i,a),bn(a),hr=c;break;case 12:vn(i,a),bn(a);break;case 31:vn(i,a),bn(a),c&4&&(c=a.updateQueue,c!==null&&(a.updateQueue=null,Bu(a,c)));break;case 13:vn(i,a),bn(a),a.child.flags&8192&&a.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(qu=Cn()),c&4&&(c=a.updateQueue,c!==null&&(a.updateQueue=null,Bu(a,c)));break;case 22:p=a.memoizedState!==null;var k=l!==null&&l.memoizedState!==null,P=ea,J=jt;if(ea=P||p,jt=J||k,vn(i,a),jt=J,ea=P,bn(a),c&8192)e:for(i=a.stateNode,i._visibility=p?i._visibility&-2:i._visibility|1,p&&(l===null||k||ea||jt||As(a)),l=null,i=a;;){if(i.tag===5||i.tag===26){if(l===null){k=l=i;try{if(g=k.stateNode,p)b=g.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{T=k.stateNode;var te=k.memoizedProps.style,q=te!=null&&te.hasOwnProperty("display")?te.display:null;T.style.display=q==null||typeof q=="boolean"?"":(""+q).trim()}}catch(ge){at(k,k.return,ge)}}}else if(i.tag===6){if(l===null){k=i;try{k.stateNode.nodeValue=p?"":k.memoizedProps}catch(ge){at(k,k.return,ge)}}}else if(i.tag===18){if(l===null){k=i;try{var H=k.stateNode;p?qb(H,!0):qb(k.stateNode,!1)}catch(ge){at(k,k.return,ge)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===a)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=a.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Bu(a,l))));break;case 19:vn(i,a),bn(a),c&4&&(c=a.updateQueue,c!==null&&(a.updateQueue=null,Bu(a,c)));break;case 30:break;case 21:break;default:vn(i,a),bn(a)}}function bn(a){var i=a.flags;if(i&2){try{for(var l,c=a.return;c!==null;){if(H0(c)){l=c;break}c=c.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var p=l.stateNode,g=Jh(a);Pu(a,g,p);break;case 5:var b=l.stateNode;l.flags&32&&(ri(b,""),l.flags&=-33);var T=Jh(a);Pu(a,T,b);break;case 3:case 4:var k=l.stateNode.containerInfo,P=Jh(a);Xh(a,P,k);break;default:throw Error(r(161))}}catch(J){at(a,a.return,J)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function eb(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var i=a;eb(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),a=a.sibling}}function na(a,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)J0(a,i.alternate,i),i=i.sibling}function As(a){for(a=a.child;a!==null;){var i=a;switch(i.tag){case 0:case 11:case 14:case 15:Ia(4,i,i.return),As(i);break;case 1:Ir(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&q0(i,i.return,l),As(i);break;case 27:Ko(i.stateNode);case 26:case 5:Ir(i,i.return),As(i);break;case 22:i.memoizedState===null&&As(i);break;case 30:As(i);break;default:As(i)}a=a.sibling}}function ra(a,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,p=a,g=i,b=g.flags;switch(g.tag){case 0:case 11:case 15:ra(p,g,l),Zo(4,g);break;case 1:if(ra(p,g,l),c=g,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(P){at(c,c.return,P)}if(c=g,p=c.updateQueue,p!==null){var T=c.stateNode;try{var k=p.shared.hiddenCallbacks;if(k!==null)for(p.shared.hiddenCallbacks=null,p=0;p<k.length;p++)Iv(k[p],T)}catch(P){at(c,c.return,P)}}l&&b&64&&Z0(g),qo(g,g.return);break;case 27:G0(g);case 26:case 5:ra(p,g,l),l&&c===null&&b&4&&F0(g),qo(g,g.return);break;case 12:ra(p,g,l);break;case 31:ra(p,g,l),l&&b&4&&Q0(p,g);break;case 13:ra(p,g,l),l&&b&4&&K0(p,g);break;case 22:g.memoizedState===null&&ra(p,g,l),qo(g,g.return);break;case 30:break;default:ra(p,g,l)}i=i.sibling}}function Qh(a,i){var l=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),a=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),a!==l&&(a!=null&&a.refCount++,l!=null&&Ro(l))}function Kh(a,i){a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&Ro(a))}function pr(a,i,l,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)tb(a,i,l,c),i=i.sibling}function tb(a,i,l,c){var p=i.flags;switch(i.tag){case 0:case 11:case 15:pr(a,i,l,c),p&2048&&Zo(9,i);break;case 1:pr(a,i,l,c);break;case 3:pr(a,i,l,c),p&2048&&(a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&Ro(a)));break;case 12:if(p&2048){pr(a,i,l,c),a=i.stateNode;try{var g=i.memoizedProps,b=g.id,T=g.onPostCommit;typeof T=="function"&&T(b,i.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(k){at(i,i.return,k)}}else pr(a,i,l,c);break;case 31:pr(a,i,l,c);break;case 13:pr(a,i,l,c);break;case 23:break;case 22:g=i.stateNode,b=i.alternate,i.memoizedState!==null?g._visibility&2?pr(a,i,l,c):Fo(a,i):g._visibility&2?pr(a,i,l,c):(g._visibility|=2,Ei(a,i,l,c,(i.subtreeFlags&10256)!==0||!1)),p&2048&&Qh(b,i);break;case 24:pr(a,i,l,c),p&2048&&Kh(i.alternate,i);break;default:pr(a,i,l,c)}}function Ei(a,i,l,c,p){for(p=p&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var g=a,b=i,T=l,k=c,P=b.flags;switch(b.tag){case 0:case 11:case 15:Ei(g,b,T,k,p),Zo(8,b);break;case 23:break;case 22:var J=b.stateNode;b.memoizedState!==null?J._visibility&2?Ei(g,b,T,k,p):Fo(g,b):(J._visibility|=2,Ei(g,b,T,k,p)),p&&P&2048&&Qh(b.alternate,b);break;case 24:Ei(g,b,T,k,p),p&&P&2048&&Kh(b.alternate,b);break;default:Ei(g,b,T,k,p)}i=i.sibling}}function Fo(a,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=a,c=i,p=c.flags;switch(c.tag){case 22:Fo(l,c),p&2048&&Qh(c.alternate,c);break;case 24:Fo(l,c),p&2048&&Kh(c.alternate,c);break;default:Fo(l,c)}i=i.sibling}}var Ho=8192;function Ti(a,i,l){if(a.subtreeFlags&Ho)for(a=a.child;a!==null;)nb(a,i,l),a=a.sibling}function nb(a,i,l){switch(a.tag){case 26:Ti(a,i,l),a.flags&Ho&&a.memoizedState!==null&&DN(l,hr,a.memoizedState,a.memoizedProps);break;case 5:Ti(a,i,l);break;case 3:case 4:var c=hr;hr=tc(a.stateNode.containerInfo),Ti(a,i,l),hr=c;break;case 22:a.memoizedState===null&&(c=a.alternate,c!==null&&c.memoizedState!==null?(c=Ho,Ho=16777216,Ti(a,i,l),Ho=c):Ti(a,i,l));break;default:Ti(a,i,l)}}function rb(a){var i=a.alternate;if(i!==null&&(a=i.child,a!==null)){i.child=null;do i=a.sibling,a.sibling=null,a=i;while(a!==null)}}function Go(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var c=i[l];qt=c,sb(c,a)}rb(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ab(a),a=a.sibling}function ab(a){switch(a.tag){case 0:case 11:case 15:Go(a),a.flags&2048&&Ia(9,a,a.return);break;case 3:Go(a);break;case 12:Go(a);break;case 22:var i=a.stateNode;a.memoizedState!==null&&i._visibility&2&&(a.return===null||a.return.tag!==13)?(i._visibility&=-3,Zu(a)):Go(a);break;default:Go(a)}}function Zu(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var c=i[l];qt=c,sb(c,a)}rb(a)}for(a=a.child;a!==null;){switch(i=a,i.tag){case 0:case 11:case 15:Ia(8,i,i.return),Zu(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,Zu(i));break;default:Zu(i)}a=a.sibling}}function sb(a,i){for(;qt!==null;){var l=qt;switch(l.tag){case 0:case 11:case 15:Ia(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ro(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,qt=c;else e:for(l=a;qt!==null;){c=qt;var p=c.sibling,g=c.return;if(X0(c),c===l){qt=null;break e}if(p!==null){p.return=g,qt=p;break e}qt=g}}}var WR={getCacheForType:function(a){var i=Xt(kt),l=i.data.get(a);return l===void 0&&(l=a(),i.data.set(a,l)),l},cacheSignal:function(){return Xt(kt).controller.signal}},eN=typeof WeakMap=="function"?WeakMap:Map,et=0,dt=null,qe=null,He=0,rt=0,jn=null,ka=!1,xi=!1,Wh=!1,aa=0,St=0,$a=0,Cs=0,ep=0,Ln=0,Oi=0,Vo=null,wn=null,tp=!1,qu=0,ib=0,Fu=1/0,Hu=null,Ma=null,Dt=0,ja=null,Ai=null,sa=0,np=0,rp=null,ob=null,Jo=0,ap=null;function zn(){return(et&2)!==0&&He!==0?He&-He:$.T!==null?cp():Ey()}function lb(){if(Ln===0)if((He&536870912)===0||Ve){var a=Wl;Wl<<=1,(Wl&3932160)===0&&(Wl=262144),Ln=a}else Ln=536870912;return a=$n.current,a!==null&&(a.flags|=32),Ln}function Sn(a,i,l){(a===dt&&(rt===2||rt===9)||a.cancelPendingCommit!==null)&&(Ci(a,0),La(a,He,Ln,!1)),mo(a,l),((et&2)===0||a!==dt)&&(a===dt&&((et&2)===0&&(Cs|=l),St===4&&La(a,He,Ln,!1)),kr(a))}function ub(a,i,l){if((et&6)!==0)throw Error(r(327));var c=!l&&(i&127)===0&&(i&a.expiredLanes)===0||po(a,i),p=c?rN(a,i):ip(a,i,!0),g=c;do{if(p===0){xi&&!c&&La(a,i,0,!1);break}else{if(l=a.current.alternate,g&&!tN(l)){p=ip(a,i,!1),g=!1;continue}if(p===2){if(g=i,a.errorRecoveryDisabledLanes&g)var b=0;else b=a.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){i=b;e:{var T=a;p=Vo;var k=T.current.memoizedState.isDehydrated;if(k&&(Ci(T,b).flags|=256),b=ip(T,b,!1),b!==2){if(Wh&&!k){T.errorRecoveryDisabledLanes|=g,Cs|=g,p=4;break e}g=wn,wn=p,g!==null&&(wn===null?wn=g:wn.push.apply(wn,g))}p=b}if(g=!1,p!==2)continue}}if(p===1){Ci(a,0),La(a,i,0,!0);break}e:{switch(c=a,g=p,g){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:La(c,i,Ln,!ka);break e;case 2:wn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(p=qu+300-Cn(),10<p)){if(La(c,i,Ln,!ka),tu(c,0,!0)!==0)break e;sa=i,c.timeoutHandle=Pb(cb.bind(null,c,l,wn,Hu,tp,i,Ln,Cs,Oi,ka,g,"Throttled",-0,0),p);break e}cb(c,l,wn,Hu,tp,i,Ln,Cs,Oi,ka,g,null,-0,0)}}break}while(!0);kr(a)}function cb(a,i,l,c,p,g,b,T,k,P,J,te,q,H){if(a.timeoutHandle=-1,te=i.subtreeFlags,te&8192||(te&16785408)===16785408){te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Fr},nb(i,g,te);var ge=(g&62914560)===g?qu-Cn():(g&4194048)===g?ib-Cn():0;if(ge=UN(te,ge),ge!==null){sa=g,a.cancelPendingCommit=ge(yb.bind(null,a,i,g,l,c,p,b,T,k,J,te,null,q,H)),La(a,g,b,!P);return}}yb(a,i,g,l,c,p,b,T,k)}function tN(a){for(var i=a;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var p=l[c],g=p.getSnapshot;p=p.value;try{if(!In(g(),p))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function La(a,i,l,c){i&=~ep,i&=~Cs,a.suspendedLanes|=i,a.pingedLanes&=~i,c&&(a.warmLanes|=i),c=a.expirationTimes;for(var p=i;0<p;){var g=31-Nn(p),b=1<<g;c[g]=-1,p&=~b}l!==0&&by(a,l,i)}function Gu(){return(et&6)===0?(Xo(0),!1):!0}function sp(){if(qe!==null){if(rt===0)var a=qe.return;else a=qe,Jr=vs=null,wh(a),yi=null,Io=0,a=qe;for(;a!==null;)B0(a.alternate,a),a=a.return;qe=null}}function Ci(a,i){var l=a.timeoutHandle;l!==-1&&(a.timeoutHandle=-1,wN(l)),l=a.cancelPendingCommit,l!==null&&(a.cancelPendingCommit=null,l()),sa=0,sp(),dt=a,qe=l=Gr(a.current,null),He=i,rt=0,jn=null,ka=!1,xi=po(a,i),Wh=!1,Oi=Ln=ep=Cs=$a=St=0,wn=Vo=null,tp=!1,(i&8)!==0&&(i|=i&32);var c=a.entangledLanes;if(c!==0)for(a=a.entanglements,c&=i;0<c;){var p=31-Nn(c),g=1<<p;i|=a[p],c&=~g}return aa=i,hu(),l}function fb(a,i){Le=null,$.H=Uo,i===_i||i===wu?(i=Av(),rt=3):i===uh?(i=Av(),rt=4):rt=i===zh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,jn=i,qe===null&&(St=1,ju(a,er(i,a.current)))}function db(){var a=$n.current;return a===null?!0:(He&4194048)===He?ar===null:(He&62914560)===He||(He&536870912)!==0?a===ar:!1}function hb(){var a=$.H;return $.H=Uo,a===null?Uo:a}function pb(){var a=$.A;return $.A=WR,a}function Vu(){St=4,ka||(He&4194048)!==He&&$n.current!==null||(xi=!0),($a&134217727)===0&&(Cs&134217727)===0||dt===null||La(dt,He,Ln,!1)}function ip(a,i,l){var c=et;et|=2;var p=hb(),g=pb();(dt!==a||He!==i)&&(Hu=null,Ci(a,i)),i=!1;var b=St;e:do try{if(rt!==0&&qe!==null){var T=qe,k=jn;switch(rt){case 8:sp(),b=6;break e;case 3:case 2:case 9:case 6:$n.current===null&&(i=!0);var P=rt;if(rt=0,jn=null,Ri(a,T,k,P),l&&xi){b=0;break e}break;default:P=rt,rt=0,jn=null,Ri(a,T,k,P)}}nN(),b=St;break}catch(J){fb(a,J)}while(!0);return i&&a.shellSuspendCounter++,Jr=vs=null,et=c,$.H=p,$.A=g,qe===null&&(dt=null,He=0,hu()),b}function nN(){for(;qe!==null;)mb(qe)}function rN(a,i){var l=et;et|=2;var c=hb(),p=pb();dt!==a||He!==i?(Hu=null,Fu=Cn()+500,Ci(a,i)):xi=po(a,i);e:do try{if(rt!==0&&qe!==null){i=qe;var g=jn;t:switch(rt){case 1:rt=0,jn=null,Ri(a,i,g,1);break;case 2:case 9:if(xv(g)){rt=0,jn=null,gb(i);break}i=function(){rt!==2&&rt!==9||dt!==a||(rt=7),kr(a)},g.then(i,i);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:xv(g)?(rt=0,jn=null,gb(i)):(rt=0,jn=null,Ri(a,i,g,7));break;case 5:var b=null;switch(qe.tag){case 26:b=qe.memoizedState;case 5:case 27:var T=qe;if(b?tw(b):T.stateNode.complete){rt=0,jn=null;var k=T.sibling;if(k!==null)qe=k;else{var P=T.return;P!==null?(qe=P,Ju(P)):qe=null}break t}}rt=0,jn=null,Ri(a,i,g,5);break;case 6:rt=0,jn=null,Ri(a,i,g,6);break;case 8:sp(),St=6;break e;default:throw Error(r(462))}}aN();break}catch(J){fb(a,J)}while(!0);return Jr=vs=null,$.H=c,$.A=p,et=l,qe!==null?0:(dt=null,He=0,hu(),St)}function aN(){for(;qe!==null&&!AC();)mb(qe)}function mb(a){var i=U0(a.alternate,a,aa);a.memoizedProps=a.pendingProps,i===null?Ju(a):qe=i}function gb(a){var i=a,l=i.alternate;switch(i.tag){case 15:case 0:i=$0(l,i,i.pendingProps,i.type,void 0,He);break;case 11:i=$0(l,i,i.pendingProps,i.type.render,i.ref,He);break;case 5:wh(i);default:B0(l,i),i=qe=pv(i,aa),i=U0(l,i,aa)}a.memoizedProps=a.pendingProps,i===null?Ju(a):qe=i}function Ri(a,i,l,c){Jr=vs=null,wh(i),yi=null,Io=0;var p=i.return;try{if(GR(a,p,i,l,He)){St=1,ju(a,er(l,a.current)),qe=null;return}}catch(g){if(p!==null)throw qe=p,g;St=1,ju(a,er(l,a.current)),qe=null;return}i.flags&32768?(Ve||c===1?a=!0:xi||(He&536870912)!==0?a=!1:(ka=a=!0,(c===2||c===9||c===3||c===6)&&(c=$n.current,c!==null&&c.tag===13&&(c.flags|=16384))),_b(i,a)):Ju(i)}function Ju(a){var i=a;do{if((i.flags&32768)!==0){_b(i,ka);return}a=i.return;var l=XR(i.alternate,i,aa);if(l!==null){qe=l;return}if(i=i.sibling,i!==null){qe=i;return}qe=i=a}while(i!==null);St===0&&(St=5)}function _b(a,i){do{var l=YR(a.alternate,a);if(l!==null){l.flags&=32767,qe=l;return}if(l=a.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(a=a.sibling,a!==null)){qe=a;return}qe=a=l}while(a!==null);St=6,qe=null}function yb(a,i,l,c,p,g,b,T,k){a.cancelPendingCommit=null;do Xu();while(Dt!==0);if((et&6)!==0)throw Error(r(327));if(i!==null){if(i===a.current)throw Error(r(177));if(g=i.lanes|i.childLanes,g|=Jd,zC(a,l,g,b,T,k),a===dt&&(qe=dt=null,He=0),Ai=i,ja=a,sa=l,np=g,rp=p,ob=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,lN(Ql,function(){return Eb(),null})):(a.callbackNode=null,a.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=$.T,$.T=null,p=F.p,F.p=2,b=et,et|=4;try{QR(a,i,l)}finally{et=b,F.p=p,$.T=c}}Dt=1,vb(),bb(),wb()}}function vb(){if(Dt===1){Dt=0;var a=ja,i=Ai,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=$.T,$.T=null;var c=F.p;F.p=2;var p=et;et|=4;try{W0(i,a);var g=yp,b=sv(a.containerInfo),T=g.focusedElem,k=g.selectionRange;if(b!==T&&T&&T.ownerDocument&&av(T.ownerDocument.documentElement,T)){if(k!==null&&qd(T)){var P=k.start,J=k.end;if(J===void 0&&(J=P),"selectionStart"in T)T.selectionStart=P,T.selectionEnd=Math.min(J,T.value.length);else{var te=T.ownerDocument||document,q=te&&te.defaultView||window;if(q.getSelection){var H=q.getSelection(),ge=T.textContent.length,Ie=Math.min(k.start,ge),ft=k.end===void 0?Ie:Math.min(k.end,ge);!H.extend&&Ie>ft&&(b=ft,ft=Ie,Ie=b);var z=rv(T,Ie),j=rv(T,ft);if(z&&j&&(H.rangeCount!==1||H.anchorNode!==z.node||H.anchorOffset!==z.offset||H.focusNode!==j.node||H.focusOffset!==j.offset)){var U=te.createRange();U.setStart(z.node,z.offset),H.removeAllRanges(),Ie>ft?(H.addRange(U),H.extend(j.node,j.offset)):(U.setEnd(j.node,j.offset),H.addRange(U))}}}}for(te=[],H=T;H=H.parentNode;)H.nodeType===1&&te.push({element:H,left:H.scrollLeft,top:H.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<te.length;T++){var K=te[T];K.element.scrollLeft=K.left,K.element.scrollTop=K.top}}oc=!!_p,yp=_p=null}finally{et=p,F.p=c,$.T=l}}a.current=i,Dt=2}}function bb(){if(Dt===2){Dt=0;var a=ja,i=Ai,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=$.T,$.T=null;var c=F.p;F.p=2;var p=et;et|=4;try{J0(a,i.alternate,i)}finally{et=p,F.p=c,$.T=l}}Dt=3}}function wb(){if(Dt===4||Dt===3){Dt=0,CC();var a=ja,i=Ai,l=sa,c=ob;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Dt=5:(Dt=0,Ai=ja=null,Sb(a,a.pendingLanes));var p=a.pendingLanes;if(p===0&&(Ma=null),Td(l),i=i.stateNode,Rn&&typeof Rn.onCommitFiberRoot=="function")try{Rn.onCommitFiberRoot(ho,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=$.T,p=F.p,F.p=2,$.T=null;try{for(var g=a.onRecoverableError,b=0;b<c.length;b++){var T=c[b];g(T.value,{componentStack:T.stack})}}finally{$.T=i,F.p=p}}(sa&3)!==0&&Xu(),kr(a),p=a.pendingLanes,(l&261930)!==0&&(p&42)!==0?a===ap?Jo++:(Jo=0,ap=a):Jo=0,Xo(0)}}function Sb(a,i){(a.pooledCacheLanes&=i)===0&&(i=a.pooledCache,i!=null&&(a.pooledCache=null,Ro(i)))}function Xu(){return vb(),bb(),wb(),Eb()}function Eb(){if(Dt!==5)return!1;var a=ja,i=np;np=0;var l=Td(sa),c=$.T,p=F.p;try{F.p=32>l?32:l,$.T=null,l=rp,rp=null;var g=ja,b=sa;if(Dt=0,Ai=ja=null,sa=0,(et&6)!==0)throw Error(r(331));var T=et;if(et|=4,ab(g.current),tb(g,g.current,b,l),et=T,Xo(0,!1),Rn&&typeof Rn.onPostCommitFiberRoot=="function")try{Rn.onPostCommitFiberRoot(ho,g)}catch{}return!0}finally{F.p=p,$.T=c,Sb(a,i)}}function Tb(a,i,l){i=er(l,i),i=Lh(a.stateNode,i,2),a=Ca(a,i,2),a!==null&&(mo(a,2),kr(a))}function at(a,i,l){if(a.tag===3)Tb(a,a,l);else for(;i!==null;){if(i.tag===3){Tb(i,a,l);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ma===null||!Ma.has(c))){a=er(l,a),l=x0(2),c=Ca(i,l,2),c!==null&&(O0(l,c,i,a),mo(c,2),kr(c));break}}i=i.return}}function op(a,i,l){var c=a.pingCache;if(c===null){c=a.pingCache=new eN;var p=new Set;c.set(i,p)}else p=c.get(i),p===void 0&&(p=new Set,c.set(i,p));p.has(l)||(Wh=!0,p.add(l),a=sN.bind(null,a,i,l),i.then(a,a))}function sN(a,i,l){var c=a.pingCache;c!==null&&c.delete(i),a.pingedLanes|=a.suspendedLanes&l,a.warmLanes&=~l,dt===a&&(He&l)===l&&(St===4||St===3&&(He&62914560)===He&&300>Cn()-qu?(et&2)===0&&Ci(a,0):ep|=l,Oi===He&&(Oi=0)),kr(a)}function xb(a,i){i===0&&(i=vy()),a=gs(a,i),a!==null&&(mo(a,i),kr(a))}function iN(a){var i=a.memoizedState,l=0;i!==null&&(l=i.retryLane),xb(a,l)}function oN(a,i){var l=0;switch(a.tag){case 31:case 13:var c=a.stateNode,p=a.memoizedState;p!==null&&(l=p.retryLane);break;case 19:c=a.stateNode;break;case 22:c=a.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(i),xb(a,l)}function lN(a,i){return cs(a,i)}var Yu=null,Ni=null,lp=!1,Qu=!1,up=!1,za=0;function kr(a){a!==Ni&&a.next===null&&(Ni===null?Yu=Ni=a:Ni=Ni.next=a),Qu=!0,lp||(lp=!0,cN())}function Xo(a,i){if(!up&&Qu){up=!0;do for(var l=!1,c=Yu;c!==null;){if(a!==0){var p=c.pendingLanes;if(p===0)var g=0;else{var b=c.suspendedLanes,T=c.pingedLanes;g=(1<<31-Nn(42|a)+1)-1,g&=p&~(b&~T),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,Rb(c,g))}else g=He,g=tu(c,c===dt?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||po(c,g)||(l=!0,Rb(c,g));c=c.next}while(l);up=!1}}function uN(){Ob()}function Ob(){Qu=lp=!1;var a=0;za!==0&&bN()&&(a=za);for(var i=Cn(),l=null,c=Yu;c!==null;){var p=c.next,g=Ab(c,i);g===0?(c.next=null,l===null?Yu=p:l.next=p,p===null&&(Ni=l)):(l=c,(a!==0||(g&3)!==0)&&(Qu=!0)),c=p}Dt!==0&&Dt!==5||Xo(a),za!==0&&(za=0)}function Ab(a,i){for(var l=a.suspendedLanes,c=a.pingedLanes,p=a.expirationTimes,g=a.pendingLanes&-62914561;0<g;){var b=31-Nn(g),T=1<<b,k=p[b];k===-1?((T&l)===0||(T&c)!==0)&&(p[b]=LC(T,i)):k<=i&&(a.expiredLanes|=T),g&=~T}if(i=dt,l=He,l=tu(a,a===i?l:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),c=a.callbackNode,l===0||a===i&&(rt===2||rt===9)||a.cancelPendingCommit!==null)return c!==null&&c!==null&&Ys(c),a.callbackNode=null,a.callbackPriority=0;if((l&3)===0||po(a,l)){if(i=l&-l,i===a.callbackPriority)return i;switch(c!==null&&Ys(c),Td(l)){case 2:case 8:l=_y;break;case 32:l=Ql;break;case 268435456:l=yy;break;default:l=Ql}return c=Cb.bind(null,a),l=cs(l,c),a.callbackPriority=i,a.callbackNode=l,i}return c!==null&&c!==null&&Ys(c),a.callbackPriority=2,a.callbackNode=null,2}function Cb(a,i){if(Dt!==0&&Dt!==5)return a.callbackNode=null,a.callbackPriority=0,null;var l=a.callbackNode;if(Xu()&&a.callbackNode!==l)return null;var c=He;return c=tu(a,a===dt?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),c===0?null:(ub(a,c,i),Ab(a,Cn()),a.callbackNode!=null&&a.callbackNode===l?Cb.bind(null,a):null)}function Rb(a,i){if(Xu())return null;ub(a,i,!0)}function cN(){SN(function(){(et&6)!==0?cs(gy,uN):Ob()})}function cp(){if(za===0){var a=mi;a===0&&(a=Kl,Kl<<=1,(Kl&261888)===0&&(Kl=256)),za=a}return za}function Nb(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:su(""+a)}function Ib(a,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,a.id&&l.setAttribute("form",a.id),i.parentNode.insertBefore(l,i),a=new FormData(a),l.parentNode.removeChild(l),a}function fN(a,i,l,c,p){if(i==="submit"&&l&&l.stateNode===p){var g=Nb((p[gn]||null).action),b=c.submitter;b&&(i=(i=b[gn]||null)?Nb(i.formAction):b.getAttribute("formAction"),i!==null&&(g=i,b=null));var T=new uu("action","action",null,c,p);a.push({event:T,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(za!==0){var k=b?Ib(p,b):new FormData(p);Nh(l,{pending:!0,data:k,method:p.method,action:g},null,k)}}else typeof g=="function"&&(T.preventDefault(),k=b?Ib(p,b):new FormData(p),Nh(l,{pending:!0,data:k,method:p.method,action:g},g,k))},currentTarget:p}]})}}for(var fp=0;fp<Vd.length;fp++){var dp=Vd[fp],dN=dp.toLowerCase(),hN=dp[0].toUpperCase()+dp.slice(1);dr(dN,"on"+hN)}dr(lv,"onAnimationEnd"),dr(uv,"onAnimationIteration"),dr(cv,"onAnimationStart"),dr("dblclick","onDoubleClick"),dr("focusin","onFocus"),dr("focusout","onBlur"),dr(RR,"onTransitionRun"),dr(NR,"onTransitionStart"),dr(IR,"onTransitionCancel"),dr(fv,"onTransitionEnd"),ti("onMouseEnter",["mouseout","mouseover"]),ti("onMouseLeave",["mouseout","mouseover"]),ti("onPointerEnter",["pointerout","pointerover"]),ti("onPointerLeave",["pointerout","pointerover"]),ds("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ds("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ds("onBeforeInput",["compositionend","keypress","textInput","paste"]),ds("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yo));function kb(a,i){i=(i&4)!==0;for(var l=0;l<a.length;l++){var c=a[l],p=c.event;c=c.listeners;e:{var g=void 0;if(i)for(var b=c.length-1;0<=b;b--){var T=c[b],k=T.instance,P=T.currentTarget;if(T=T.listener,k!==g&&p.isPropagationStopped())break e;g=T,p.currentTarget=P;try{g(p)}catch(J){du(J)}p.currentTarget=null,g=k}else for(b=0;b<c.length;b++){if(T=c[b],k=T.instance,P=T.currentTarget,T=T.listener,k!==g&&p.isPropagationStopped())break e;g=T,p.currentTarget=P;try{g(p)}catch(J){du(J)}p.currentTarget=null,g=k}}}}function Fe(a,i){var l=i[xd];l===void 0&&(l=i[xd]=new Set);var c=a+"__bubble";l.has(c)||($b(i,a,2,!1),l.add(c))}function hp(a,i,l){var c=0;i&&(c|=4),$b(l,a,c,i)}var Ku="_reactListening"+Math.random().toString(36).slice(2);function pp(a){if(!a[Ku]){a[Ku]=!0,Oy.forEach(function(l){l!=="selectionchange"&&(pN.has(l)||hp(l,!1,a),hp(l,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[Ku]||(i[Ku]=!0,hp("selectionchange",!1,i))}}function $b(a,i,l,c){switch(lw(i)){case 2:var p=ZN;break;case 8:p=qN;break;default:p=Rp}l=p.bind(null,i,l,a),p=void 0,!Md||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),c?p!==void 0?a.addEventListener(i,l,{capture:!0,passive:p}):a.addEventListener(i,l,!0):p!==void 0?a.addEventListener(i,l,{passive:p}):a.addEventListener(i,l,!1)}function mp(a,i,l,c,p){var g=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var b=c.tag;if(b===3||b===4){var T=c.stateNode.containerInfo;if(T===p)break;if(b===4)for(b=c.return;b!==null;){var k=b.tag;if((k===3||k===4)&&b.stateNode.containerInfo===p)return;b=b.return}for(;T!==null;){if(b=Ks(T),b===null)return;if(k=b.tag,k===5||k===6||k===26||k===27){c=g=b;continue e}T=T.parentNode}}c=c.return}Dy(function(){var P=g,J=kd(l),te=[];e:{var q=dv.get(a);if(q!==void 0){var H=uu,ge=a;switch(a){case"keypress":if(ou(l)===0)break e;case"keydown":case"keyup":H=oR;break;case"focusin":ge="focus",H=Dd;break;case"focusout":ge="blur",H=Dd;break;case"beforeblur":case"afterblur":H=Dd;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=By;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=XC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=cR;break;case lv:case uv:case cv:H=KC;break;case fv:H=dR;break;case"scroll":case"scrollend":H=VC;break;case"wheel":H=pR;break;case"copy":case"cut":case"paste":H=eR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=qy;break;case"toggle":case"beforetoggle":H=gR}var Ie=(i&4)!==0,ft=!Ie&&(a==="scroll"||a==="scrollend"),z=Ie?q!==null?q+"Capture":null:q;Ie=[];for(var j=P,U;j!==null;){var K=j;if(U=K.stateNode,K=K.tag,K!==5&&K!==26&&K!==27||U===null||z===null||(K=yo(j,z),K!=null&&Ie.push(Qo(j,K,U))),ft)break;j=j.return}0<Ie.length&&(q=new H(q,ge,null,l,J),te.push({event:q,listeners:Ie}))}}if((i&7)===0){e:{if(q=a==="mouseover"||a==="pointerover",H=a==="mouseout"||a==="pointerout",q&&l!==Id&&(ge=l.relatedTarget||l.fromElement)&&(Ks(ge)||ge[Qs]))break e;if((H||q)&&(q=J.window===J?J:(q=J.ownerDocument)?q.defaultView||q.parentWindow:window,H?(ge=l.relatedTarget||l.toElement,H=P,ge=ge?Ks(ge):null,ge!==null&&(ft=o(ge),Ie=ge.tag,ge!==ft||Ie!==5&&Ie!==27&&Ie!==6)&&(ge=null)):(H=null,ge=P),H!==ge)){if(Ie=By,K="onMouseLeave",z="onMouseEnter",j="mouse",(a==="pointerout"||a==="pointerover")&&(Ie=qy,K="onPointerLeave",z="onPointerEnter",j="pointer"),ft=H==null?q:_o(H),U=ge==null?q:_o(ge),q=new Ie(K,j+"leave",H,l,J),q.target=ft,q.relatedTarget=U,K=null,Ks(J)===P&&(Ie=new Ie(z,j+"enter",ge,l,J),Ie.target=U,Ie.relatedTarget=ft,K=Ie),ft=K,H&&ge)t:{for(Ie=mN,z=H,j=ge,U=0,K=z;K;K=Ie(K))U++;K=0;for(var Oe=j;Oe;Oe=Ie(Oe))K++;for(;0<U-K;)z=Ie(z),U--;for(;0<K-U;)j=Ie(j),K--;for(;U--;){if(z===j||j!==null&&z===j.alternate){Ie=z;break t}z=Ie(z),j=Ie(j)}Ie=null}else Ie=null;H!==null&&Mb(te,q,H,Ie,!1),ge!==null&&ft!==null&&Mb(te,ft,ge,Ie,!0)}}e:{if(q=P?_o(P):window,H=q.nodeName&&q.nodeName.toLowerCase(),H==="select"||H==="input"&&q.type==="file")var Ye=Qy;else if(Xy(q))if(Ky)Ye=OR;else{Ye=TR;var be=ER}else H=q.nodeName,!H||H.toLowerCase()!=="input"||q.type!=="checkbox"&&q.type!=="radio"?P&&Nd(P.elementType)&&(Ye=Qy):Ye=xR;if(Ye&&(Ye=Ye(a,P))){Yy(te,Ye,l,J);break e}be&&be(a,q,P),a==="focusout"&&P&&q.type==="number"&&P.memoizedProps.value!=null&&Rd(q,"number",q.value)}switch(be=P?_o(P):window,a){case"focusin":(Xy(be)||be.contentEditable==="true")&&(oi=be,Fd=P,Oo=null);break;case"focusout":Oo=Fd=oi=null;break;case"mousedown":Hd=!0;break;case"contextmenu":case"mouseup":case"dragend":Hd=!1,iv(te,l,J);break;case"selectionchange":if(CR)break;case"keydown":case"keyup":iv(te,l,J)}var ze;if(Pd)e:{switch(a){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else ii?Vy(a,l)&&(Ge="onCompositionEnd"):a==="keydown"&&l.keyCode===229&&(Ge="onCompositionStart");Ge&&(Fy&&l.locale!=="ko"&&(ii||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&ii&&(ze=Uy()):(wa=J,jd="value"in wa?wa.value:wa.textContent,ii=!0)),be=Wu(P,Ge),0<be.length&&(Ge=new Zy(Ge,a,null,l,J),te.push({event:Ge,listeners:be}),ze?Ge.data=ze:(ze=Jy(l),ze!==null&&(Ge.data=ze)))),(ze=yR?vR(a,l):bR(a,l))&&(Ge=Wu(P,"onBeforeInput"),0<Ge.length&&(be=new Zy("onBeforeInput","beforeinput",null,l,J),te.push({event:be,listeners:Ge}),be.data=ze)),fN(te,a,P,l,J)}kb(te,i)})}function Qo(a,i,l){return{instance:a,listener:i,currentTarget:l}}function Wu(a,i){for(var l=i+"Capture",c=[];a!==null;){var p=a,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=yo(a,l),p!=null&&c.unshift(Qo(a,p,g)),p=yo(a,i),p!=null&&c.push(Qo(a,p,g))),a.tag===3)return c;a=a.return}return[]}function mN(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Mb(a,i,l,c,p){for(var g=i._reactName,b=[];l!==null&&l!==c;){var T=l,k=T.alternate,P=T.stateNode;if(T=T.tag,k!==null&&k===c)break;T!==5&&T!==26&&T!==27||P===null||(k=P,p?(P=yo(l,g),P!=null&&b.unshift(Qo(l,P,k))):p||(P=yo(l,g),P!=null&&b.push(Qo(l,P,k)))),l=l.return}b.length!==0&&a.push({event:i,listeners:b})}var gN=/\r\n?/g,_N=/\u0000|\uFFFD/g;function jb(a){return(typeof a=="string"?a:""+a).replace(gN,`
`).replace(_N,"")}function Lb(a,i){return i=jb(i),jb(a)===i}function ct(a,i,l,c,p,g){switch(l){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||ri(a,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&ri(a,""+c);break;case"className":ru(a,"class",c);break;case"tabIndex":ru(a,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ru(a,l,c);break;case"style":Ly(a,c,g);break;case"data":if(i!=="object"){ru(a,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||l!=="href")){a.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){a.removeAttribute(l);break}c=su(""+c),a.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){a.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(i!=="input"&&ct(a,i,"name",p.name,p,null),ct(a,i,"formEncType",p.formEncType,p,null),ct(a,i,"formMethod",p.formMethod,p,null),ct(a,i,"formTarget",p.formTarget,p,null)):(ct(a,i,"encType",p.encType,p,null),ct(a,i,"method",p.method,p,null),ct(a,i,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){a.removeAttribute(l);break}c=su(""+c),a.setAttribute(l,c);break;case"onClick":c!=null&&(a.onclick=Fr);break;case"onScroll":c!=null&&Fe("scroll",a);break;case"onScrollEnd":c!=null&&Fe("scrollend",a);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(p.children!=null)throw Error(r(60));a.innerHTML=l}}break;case"multiple":a.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":a.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){a.removeAttribute("xlink:href");break}l=su(""+c),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?a.setAttribute(l,""+c):a.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?a.setAttribute(l,""):a.removeAttribute(l);break;case"capture":case"download":c===!0?a.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?a.setAttribute(l,c):a.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?a.setAttribute(l,c):a.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?a.removeAttribute(l):a.setAttribute(l,c);break;case"popover":Fe("beforetoggle",a),Fe("toggle",a),nu(a,"popover",c);break;case"xlinkActuate":qr(a,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":qr(a,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":qr(a,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":qr(a,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":qr(a,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":qr(a,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":qr(a,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":qr(a,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":qr(a,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":nu(a,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=HC.get(l)||l,nu(a,l,c))}}function gp(a,i,l,c,p,g){switch(l){case"style":Ly(a,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(p.children!=null)throw Error(r(60));a.innerHTML=l}}break;case"children":typeof c=="string"?ri(a,c):(typeof c=="number"||typeof c=="bigint")&&ri(a,""+c);break;case"onScroll":c!=null&&Fe("scroll",a);break;case"onScrollEnd":c!=null&&Fe("scrollend",a);break;case"onClick":c!=null&&(a.onclick=Fr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ay.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),i=l.slice(2,p?l.length-7:void 0),g=a[gn]||null,g=g!=null?g[l]:null,typeof g=="function"&&a.removeEventListener(i,g,p),typeof c=="function")){typeof g!="function"&&g!==null&&(l in a?a[l]=null:a.hasAttribute(l)&&a.removeAttribute(l)),a.addEventListener(i,c,p);break e}l in a?a[l]=c:c===!0?a.setAttribute(l,""):nu(a,l,c)}}}function Qt(a,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",a),Fe("load",a);var c=!1,p=!1,g;for(g in l)if(l.hasOwnProperty(g)){var b=l[g];if(b!=null)switch(g){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:ct(a,i,g,b,l,null)}}p&&ct(a,i,"srcSet",l.srcSet,l,null),c&&ct(a,i,"src",l.src,l,null);return;case"input":Fe("invalid",a);var T=g=b=p=null,k=null,P=null;for(c in l)if(l.hasOwnProperty(c)){var J=l[c];if(J!=null)switch(c){case"name":p=J;break;case"type":b=J;break;case"checked":k=J;break;case"defaultChecked":P=J;break;case"value":g=J;break;case"defaultValue":T=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(r(137,i));break;default:ct(a,i,c,J,l,null)}}ky(a,g,T,k,P,b,p,!1);return;case"select":Fe("invalid",a),c=b=g=null;for(p in l)if(l.hasOwnProperty(p)&&(T=l[p],T!=null))switch(p){case"value":g=T;break;case"defaultValue":b=T;break;case"multiple":c=T;default:ct(a,i,p,T,l,null)}i=g,l=b,a.multiple=!!c,i!=null?ni(a,!!c,i,!1):l!=null&&ni(a,!!c,l,!0);return;case"textarea":Fe("invalid",a),g=p=c=null;for(b in l)if(l.hasOwnProperty(b)&&(T=l[b],T!=null))switch(b){case"value":c=T;break;case"defaultValue":p=T;break;case"children":g=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:ct(a,i,b,T,l,null)}My(a,c,p,g);return;case"option":for(k in l)l.hasOwnProperty(k)&&(c=l[k],c!=null)&&(k==="selected"?a.selected=c&&typeof c!="function"&&typeof c!="symbol":ct(a,i,k,c,l,null));return;case"dialog":Fe("beforetoggle",a),Fe("toggle",a),Fe("cancel",a),Fe("close",a);break;case"iframe":case"object":Fe("load",a);break;case"video":case"audio":for(c=0;c<Yo.length;c++)Fe(Yo[c],a);break;case"image":Fe("error",a),Fe("load",a);break;case"details":Fe("toggle",a);break;case"embed":case"source":case"link":Fe("error",a),Fe("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(P in l)if(l.hasOwnProperty(P)&&(c=l[P],c!=null))switch(P){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:ct(a,i,P,c,l,null)}return;default:if(Nd(i)){for(J in l)l.hasOwnProperty(J)&&(c=l[J],c!==void 0&&gp(a,i,J,c,l,void 0));return}}for(T in l)l.hasOwnProperty(T)&&(c=l[T],c!=null&&ct(a,i,T,c,l,null))}function yN(a,i,l,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,b=null,T=null,k=null,P=null,J=null;for(H in l){var te=l[H];if(l.hasOwnProperty(H)&&te!=null)switch(H){case"checked":break;case"value":break;case"defaultValue":k=te;default:c.hasOwnProperty(H)||ct(a,i,H,null,c,te)}}for(var q in c){var H=c[q];if(te=l[q],c.hasOwnProperty(q)&&(H!=null||te!=null))switch(q){case"type":g=H;break;case"name":p=H;break;case"checked":P=H;break;case"defaultChecked":J=H;break;case"value":b=H;break;case"defaultValue":T=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(r(137,i));break;default:H!==te&&ct(a,i,q,H,c,te)}}Cd(a,b,T,k,P,J,g,p);return;case"select":H=b=T=q=null;for(g in l)if(k=l[g],l.hasOwnProperty(g)&&k!=null)switch(g){case"value":break;case"multiple":H=k;default:c.hasOwnProperty(g)||ct(a,i,g,null,c,k)}for(p in c)if(g=c[p],k=l[p],c.hasOwnProperty(p)&&(g!=null||k!=null))switch(p){case"value":q=g;break;case"defaultValue":T=g;break;case"multiple":b=g;default:g!==k&&ct(a,i,p,g,c,k)}i=T,l=b,c=H,q!=null?ni(a,!!l,q,!1):!!c!=!!l&&(i!=null?ni(a,!!l,i,!0):ni(a,!!l,l?[]:"",!1));return;case"textarea":H=q=null;for(T in l)if(p=l[T],l.hasOwnProperty(T)&&p!=null&&!c.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:ct(a,i,T,null,c,p)}for(b in c)if(p=c[b],g=l[b],c.hasOwnProperty(b)&&(p!=null||g!=null))switch(b){case"value":q=p;break;case"defaultValue":H=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==g&&ct(a,i,b,p,c,g)}$y(a,q,H);return;case"option":for(var ge in l)q=l[ge],l.hasOwnProperty(ge)&&q!=null&&!c.hasOwnProperty(ge)&&(ge==="selected"?a.selected=!1:ct(a,i,ge,null,c,q));for(k in c)q=c[k],H=l[k],c.hasOwnProperty(k)&&q!==H&&(q!=null||H!=null)&&(k==="selected"?a.selected=q&&typeof q!="function"&&typeof q!="symbol":ct(a,i,k,q,c,H));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ie in l)q=l[Ie],l.hasOwnProperty(Ie)&&q!=null&&!c.hasOwnProperty(Ie)&&ct(a,i,Ie,null,c,q);for(P in c)if(q=c[P],H=l[P],c.hasOwnProperty(P)&&q!==H&&(q!=null||H!=null))switch(P){case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(r(137,i));break;default:ct(a,i,P,q,c,H)}return;default:if(Nd(i)){for(var ft in l)q=l[ft],l.hasOwnProperty(ft)&&q!==void 0&&!c.hasOwnProperty(ft)&&gp(a,i,ft,void 0,c,q);for(J in c)q=c[J],H=l[J],!c.hasOwnProperty(J)||q===H||q===void 0&&H===void 0||gp(a,i,J,q,c,H);return}}for(var z in l)q=l[z],l.hasOwnProperty(z)&&q!=null&&!c.hasOwnProperty(z)&&ct(a,i,z,null,c,q);for(te in c)q=c[te],H=l[te],!c.hasOwnProperty(te)||q===H||q==null&&H==null||ct(a,i,te,q,c,H)}function zb(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function vN(){if(typeof performance.getEntriesByType=="function"){for(var a=0,i=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var p=l[c],g=p.transferSize,b=p.initiatorType,T=p.duration;if(g&&T&&zb(b)){for(b=0,T=p.responseEnd,c+=1;c<l.length;c++){var k=l[c],P=k.startTime;if(P>T)break;var J=k.transferSize,te=k.initiatorType;J&&zb(te)&&(k=k.responseEnd,b+=J*(k<T?1:(T-P)/(k-P)))}if(--c,i+=8*(g+b)/(p.duration/1e3),a++,10<a)break}}if(0<a)return i/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var _p=null,yp=null;function ec(a){return a.nodeType===9?a:a.ownerDocument}function Db(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ub(a,i){if(a===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&i==="foreignObject"?0:a}function vp(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var bp=null;function bN(){var a=window.event;return a&&a.type==="popstate"?a===bp?!1:(bp=a,!0):(bp=null,!1)}var Pb=typeof setTimeout=="function"?setTimeout:void 0,wN=typeof clearTimeout=="function"?clearTimeout:void 0,Bb=typeof Promise=="function"?Promise:void 0,SN=typeof queueMicrotask=="function"?queueMicrotask:typeof Bb<"u"?function(a){return Bb.resolve(null).then(a).catch(EN)}:Pb;function EN(a){setTimeout(function(){throw a})}function Da(a){return a==="head"}function Zb(a,i){var l=i,c=0;do{var p=l.nextSibling;if(a.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"||l==="/&"){if(c===0){a.removeChild(p),Mi(i);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")Ko(a.ownerDocument.documentElement);else if(l==="head"){l=a.ownerDocument.head,Ko(l);for(var g=l.firstChild;g;){var b=g.nextSibling,T=g.nodeName;g[go]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=b}}else l==="body"&&Ko(a.ownerDocument.body);l=p}while(l);Mi(i)}function qb(a,i){var l=a;a=0;do{var c=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(a===0)break;a--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||a++;l=c}while(l)}function wp(a){var i=a.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":wp(l),Od(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}a.removeChild(l)}}function TN(a,i,l,c){for(;a.nodeType===1;){var p=l;if(a.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(c){if(!a[go])switch(i){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(g=a.getAttribute("rel"),g==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(g!==p.rel||a.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||a.getAttribute("title")!==(p.title==null?null:p.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(g=a.getAttribute("src"),(g!==(p.src==null?null:p.src)||a.getAttribute("type")!==(p.type==null?null:p.type)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(i==="input"&&a.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&a.getAttribute("name")===g)return a}else return a;if(a=sr(a.nextSibling),a===null)break}return null}function xN(a,i,l){if(i==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=sr(a.nextSibling),a===null))return null;return a}function Fb(a,i){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!i||(a=sr(a.nextSibling),a===null))return null;return a}function Sp(a){return a.data==="$?"||a.data==="$~"}function Ep(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function ON(a,i){var l=a.ownerDocument;if(a.data==="$~")a._reactRetry=i;else if(a.data!=="$?"||l.readyState!=="loading")i();else{var c=function(){i(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),a._reactRetry=c}}function sr(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return a}var Tp=null;function Hb(a){a=a.nextSibling;for(var i=0;a;){if(a.nodeType===8){var l=a.data;if(l==="/$"||l==="/&"){if(i===0)return sr(a.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}a=a.nextSibling}return null}function Gb(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var l=a.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return a;i--}else l!=="/$"&&l!=="/&"||i++}a=a.previousSibling}return null}function Vb(a,i,l){switch(i=ec(l),a){case"html":if(a=i.documentElement,!a)throw Error(r(452));return a;case"head":if(a=i.head,!a)throw Error(r(453));return a;case"body":if(a=i.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Ko(a){for(var i=a.attributes;i.length;)a.removeAttributeNode(i[0]);Od(a)}var ir=new Map,Jb=new Set;function tc(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ia=F.d;F.d={f:AN,r:CN,D:RN,C:NN,L:IN,m:kN,X:MN,S:$N,M:jN};function AN(){var a=ia.f(),i=Gu();return a||i}function CN(a){var i=Ws(a);i!==null&&i.tag===5&&i.type==="form"?f0(i):ia.r(a)}var Ii=typeof document>"u"?null:document;function Xb(a,i,l){var c=Ii;if(c&&typeof i=="string"&&i){var p=Kn(i);p='link[rel="'+a+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),Jb.has(p)||(Jb.add(p),a={rel:a,crossOrigin:l,href:i},c.querySelector(p)===null&&(i=c.createElement("link"),Qt(i,"link",a),Zt(i),c.head.appendChild(i)))}}function RN(a){ia.D(a),Xb("dns-prefetch",a,null)}function NN(a,i){ia.C(a,i),Xb("preconnect",a,i)}function IN(a,i,l){ia.L(a,i,l);var c=Ii;if(c&&a&&i){var p='link[rel="preload"][as="'+Kn(i)+'"]';i==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+Kn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+Kn(l.imageSizes)+'"]')):p+='[href="'+Kn(a)+'"]';var g=p;switch(i){case"style":g=ki(a);break;case"script":g=$i(a)}ir.has(g)||(a=_({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:a,as:i},l),ir.set(g,a),c.querySelector(p)!==null||i==="style"&&c.querySelector(Wo(g))||i==="script"&&c.querySelector(el(g))||(i=c.createElement("link"),Qt(i,"link",a),Zt(i),c.head.appendChild(i)))}}function kN(a,i){ia.m(a,i);var l=Ii;if(l&&a){var c=i&&typeof i.as=="string"?i.as:"script",p='link[rel="modulepreload"][as="'+Kn(c)+'"][href="'+Kn(a)+'"]',g=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=$i(a)}if(!ir.has(g)&&(a=_({rel:"modulepreload",href:a},i),ir.set(g,a),l.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(el(g)))return}c=l.createElement("link"),Qt(c,"link",a),Zt(c),l.head.appendChild(c)}}}function $N(a,i,l){ia.S(a,i,l);var c=Ii;if(c&&a){var p=ei(c).hoistableStyles,g=ki(a);i=i||"default";var b=p.get(g);if(!b){var T={loading:0,preload:null};if(b=c.querySelector(Wo(g)))T.loading=5;else{a=_({rel:"stylesheet",href:a,"data-precedence":i},l),(l=ir.get(g))&&xp(a,l);var k=b=c.createElement("link");Zt(k),Qt(k,"link",a),k._p=new Promise(function(P,J){k.onload=P,k.onerror=J}),k.addEventListener("load",function(){T.loading|=1}),k.addEventListener("error",function(){T.loading|=2}),T.loading|=4,nc(b,i,c)}b={type:"stylesheet",instance:b,count:1,state:T},p.set(g,b)}}}function MN(a,i){ia.X(a,i);var l=Ii;if(l&&a){var c=ei(l).hoistableScripts,p=$i(a),g=c.get(p);g||(g=l.querySelector(el(p)),g||(a=_({src:a,async:!0},i),(i=ir.get(p))&&Op(a,i),g=l.createElement("script"),Zt(g),Qt(g,"link",a),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(p,g))}}function jN(a,i){ia.M(a,i);var l=Ii;if(l&&a){var c=ei(l).hoistableScripts,p=$i(a),g=c.get(p);g||(g=l.querySelector(el(p)),g||(a=_({src:a,async:!0,type:"module"},i),(i=ir.get(p))&&Op(a,i),g=l.createElement("script"),Zt(g),Qt(g,"link",a),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(p,g))}}function Yb(a,i,l,c){var p=(p=O.current)?tc(p):null;if(!p)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=ki(l.href),l=ei(p).hoistableStyles,c=l.get(i),c||(c={type:"style",instance:null,count:0,state:null},l.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){a=ki(l.href);var g=ei(p).hoistableStyles,b=g.get(a);if(b||(p=p.ownerDocument||p,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(a,b),(g=p.querySelector(Wo(a)))&&!g._p&&(b.instance=g,b.state.loading=5),ir.has(a)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ir.set(a,l),g||LN(p,a,l,b.state))),i&&c===null)throw Error(r(528,""));return b}if(i&&c!==null)throw Error(r(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=$i(l),l=ei(p).hoistableScripts,c=l.get(i),c||(c={type:"script",instance:null,count:0,state:null},l.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function ki(a){return'href="'+Kn(a)+'"'}function Wo(a){return'link[rel="stylesheet"]['+a+"]"}function Qb(a){return _({},a,{"data-precedence":a.precedence,precedence:null})}function LN(a,i,l,c){a.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=a.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),Qt(i,"link",l),Zt(i),a.head.appendChild(i))}function $i(a){return'[src="'+Kn(a)+'"]'}function el(a){return"script[async]"+a}function Kb(a,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var c=a.querySelector('style[data-href~="'+Kn(l.href)+'"]');if(c)return i.instance=c,Zt(c),c;var p=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(a.ownerDocument||a).createElement("style"),Zt(c),Qt(c,"style",p),nc(c,l.precedence,a),i.instance=c;case"stylesheet":p=ki(l.href);var g=a.querySelector(Wo(p));if(g)return i.state.loading|=4,i.instance=g,Zt(g),g;c=Qb(l),(p=ir.get(p))&&xp(c,p),g=(a.ownerDocument||a).createElement("link"),Zt(g);var b=g;return b._p=new Promise(function(T,k){b.onload=T,b.onerror=k}),Qt(g,"link",c),i.state.loading|=4,nc(g,l.precedence,a),i.instance=g;case"script":return g=$i(l.src),(p=a.querySelector(el(g)))?(i.instance=p,Zt(p),p):(c=l,(p=ir.get(g))&&(c=_({},l),Op(c,p)),a=a.ownerDocument||a,p=a.createElement("script"),Zt(p),Qt(p,"link",c),a.head.appendChild(p),i.instance=p);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,nc(c,l.precedence,a));return i.instance}function nc(a,i,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,g=p,b=0;b<c.length;b++){var T=c[b];if(T.dataset.precedence===i)g=T;else if(g!==p)break}g?g.parentNode.insertBefore(a,g.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(a,i.firstChild))}function xp(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.title==null&&(a.title=i.title)}function Op(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.integrity==null&&(a.integrity=i.integrity)}var rc=null;function Wb(a,i,l){if(rc===null){var c=new Map,p=rc=new Map;p.set(l,c)}else p=rc,c=p.get(l),c||(c=new Map,p.set(l,c));if(c.has(a))return c;for(c.set(a,null),l=l.getElementsByTagName(a),p=0;p<l.length;p++){var g=l[p];if(!(g[go]||g[Vt]||a==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var b=g.getAttribute(i)||"";b=a+b;var T=c.get(b);T?T.push(g):c.set(b,[g])}}return c}function ew(a,i,l){a=a.ownerDocument||a,a.head.insertBefore(l,i==="title"?a.querySelector("head > title"):null)}function zN(a,i,l){if(l===1||i.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(a=i.disabled,typeof i.precedence=="string"&&a==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function tw(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function DN(a,i,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var p=ki(c.href),g=i.querySelector(Wo(p));if(g){i=g._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(a.count++,a=ac.bind(a),i.then(a,a)),l.state.loading|=4,l.instance=g,Zt(g);return}g=i.ownerDocument||i,c=Qb(c),(p=ir.get(p))&&xp(c,p),g=g.createElement("link"),Zt(g);var b=g;b._p=new Promise(function(T,k){b.onload=T,b.onerror=k}),Qt(g,"link",c),l.instance=g}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(a.count++,l=ac.bind(a),i.addEventListener("load",l),i.addEventListener("error",l))}}var Ap=0;function UN(a,i){return a.stylesheets&&a.count===0&&ic(a,a.stylesheets),0<a.count||0<a.imgCount?function(l){var c=setTimeout(function(){if(a.stylesheets&&ic(a,a.stylesheets),a.unsuspend){var g=a.unsuspend;a.unsuspend=null,g()}},6e4+i);0<a.imgBytes&&Ap===0&&(Ap=62500*vN());var p=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&ic(a,a.stylesheets),a.unsuspend)){var g=a.unsuspend;a.unsuspend=null,g()}},(a.imgBytes>Ap?50:800)+i);return a.unsuspend=l,function(){a.unsuspend=null,clearTimeout(c),clearTimeout(p)}}:null}function ac(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ic(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var sc=null;function ic(a,i){a.stylesheets=null,a.unsuspend!==null&&(a.count++,sc=new Map,i.forEach(PN,a),sc=null,ac.call(a))}function PN(a,i){if(!(i.state.loading&4)){var l=sc.get(a);if(l)var c=l.get(null);else{l=new Map,sc.set(a,l);for(var p=a.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var b=p[g];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),c=b)}c&&l.set(null,c)}p=i.instance,b=p.getAttribute("data-precedence"),g=l.get(b)||c,g===c&&l.set(null,p),l.set(b,p),this.count++,c=ac.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),g?g.parentNode.insertBefore(p,g.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(p,a.firstChild)),i.state.loading|=4}}var tl={$$typeof:N,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function BN(a,i,l,c,p,g,b,T,k){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Sd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sd(0),this.hiddenUpdates=Sd(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function nw(a,i,l,c,p,g,b,T,k,P,J,te){return a=new BN(a,i,l,b,k,P,J,te,T),i=1,g===!0&&(i|=24),g=kn(3,null,null,i),a.current=g,g.stateNode=a,i=ih(),i.refCount++,a.pooledCache=i,i.refCount++,g.memoizedState={element:c,isDehydrated:l,cache:i},ch(g),a}function rw(a){return a?(a=ci,a):ci}function aw(a,i,l,c,p,g){p=rw(p),c.context===null?c.context=p:c.pendingContext=p,c=Aa(i),c.payload={element:l},g=g===void 0?null:g,g!==null&&(c.callback=g),l=Ca(a,c,i),l!==null&&(Sn(l,a,i),$o(l,a,i))}function sw(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var l=a.retryLane;a.retryLane=l!==0&&l<i?l:i}}function Cp(a,i){sw(a,i),(a=a.alternate)&&sw(a,i)}function iw(a){if(a.tag===13||a.tag===31){var i=gs(a,67108864);i!==null&&Sn(i,a,67108864),Cp(a,67108864)}}function ow(a){if(a.tag===13||a.tag===31){var i=zn();i=Ed(i);var l=gs(a,i);l!==null&&Sn(l,a,i),Cp(a,i)}}var oc=!0;function ZN(a,i,l,c){var p=$.T;$.T=null;var g=F.p;try{F.p=2,Rp(a,i,l,c)}finally{F.p=g,$.T=p}}function qN(a,i,l,c){var p=$.T;$.T=null;var g=F.p;try{F.p=8,Rp(a,i,l,c)}finally{F.p=g,$.T=p}}function Rp(a,i,l,c){if(oc){var p=Np(c);if(p===null)mp(a,i,c,lc,l),uw(a,c);else if(HN(p,a,i,l,c))c.stopPropagation();else if(uw(a,c),i&4&&-1<FN.indexOf(a)){for(;p!==null;){var g=Ws(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var b=fs(g.pendingLanes);if(b!==0){var T=g;for(T.pendingLanes|=2,T.entangledLanes|=2;b;){var k=1<<31-Nn(b);T.entanglements[1]|=k,b&=~k}kr(g),(et&6)===0&&(Fu=Cn()+500,Xo(0))}}break;case 31:case 13:T=gs(g,2),T!==null&&Sn(T,g,2),Gu(),Cp(g,2)}if(g=Np(c),g===null&&mp(a,i,c,lc,l),g===p)break;p=g}p!==null&&c.stopPropagation()}else mp(a,i,c,null,l)}}function Np(a){return a=kd(a),Ip(a)}var lc=null;function Ip(a){if(lc=null,a=Ks(a),a!==null){var i=o(a);if(i===null)a=null;else{var l=i.tag;if(l===13){if(a=u(i),a!==null)return a;a=null}else if(l===31){if(a=f(i),a!==null)return a;a=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return lc=a,null}function lw(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(RC()){case gy:return 2;case _y:return 8;case Ql:case NC:return 32;case yy:return 268435456;default:return 32}default:return 32}}var kp=!1,Ua=null,Pa=null,Ba=null,nl=new Map,rl=new Map,Za=[],FN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function uw(a,i){switch(a){case"focusin":case"focusout":Ua=null;break;case"dragenter":case"dragleave":Pa=null;break;case"mouseover":case"mouseout":Ba=null;break;case"pointerover":case"pointerout":nl.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":rl.delete(i.pointerId)}}function al(a,i,l,c,p,g){return a===null||a.nativeEvent!==g?(a={blockedOn:i,domEventName:l,eventSystemFlags:c,nativeEvent:g,targetContainers:[p]},i!==null&&(i=Ws(i),i!==null&&iw(i)),a):(a.eventSystemFlags|=c,i=a.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),a)}function HN(a,i,l,c,p){switch(i){case"focusin":return Ua=al(Ua,a,i,l,c,p),!0;case"dragenter":return Pa=al(Pa,a,i,l,c,p),!0;case"mouseover":return Ba=al(Ba,a,i,l,c,p),!0;case"pointerover":var g=p.pointerId;return nl.set(g,al(nl.get(g)||null,a,i,l,c,p)),!0;case"gotpointercapture":return g=p.pointerId,rl.set(g,al(rl.get(g)||null,a,i,l,c,p)),!0}return!1}function cw(a){var i=Ks(a.target);if(i!==null){var l=o(i);if(l!==null){if(i=l.tag,i===13){if(i=u(l),i!==null){a.blockedOn=i,Ty(a.priority,function(){ow(l)});return}}else if(i===31){if(i=f(l),i!==null){a.blockedOn=i,Ty(a.priority,function(){ow(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){a.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}a.blockedOn=null}function uc(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var l=Np(a.nativeEvent);if(l===null){l=a.nativeEvent;var c=new l.constructor(l.type,l);Id=c,l.target.dispatchEvent(c),Id=null}else return i=Ws(l),i!==null&&iw(i),a.blockedOn=l,!1;i.shift()}return!0}function fw(a,i,l){uc(a)&&l.delete(i)}function GN(){kp=!1,Ua!==null&&uc(Ua)&&(Ua=null),Pa!==null&&uc(Pa)&&(Pa=null),Ba!==null&&uc(Ba)&&(Ba=null),nl.forEach(fw),rl.forEach(fw)}function cc(a,i){a.blockedOn===i&&(a.blockedOn=null,kp||(kp=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,GN)))}var fc=null;function dw(a){fc!==a&&(fc=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){fc===a&&(fc=null);for(var i=0;i<a.length;i+=3){var l=a[i],c=a[i+1],p=a[i+2];if(typeof c!="function"){if(Ip(c||l)===null)continue;break}var g=Ws(l);g!==null&&(a.splice(i,3),i-=3,Nh(g,{pending:!0,data:p,method:l.method,action:c},c,p))}}))}function Mi(a){function i(k){return cc(k,a)}Ua!==null&&cc(Ua,a),Pa!==null&&cc(Pa,a),Ba!==null&&cc(Ba,a),nl.forEach(i),rl.forEach(i);for(var l=0;l<Za.length;l++){var c=Za[l];c.blockedOn===a&&(c.blockedOn=null)}for(;0<Za.length&&(l=Za[0],l.blockedOn===null);)cw(l),l.blockedOn===null&&Za.shift();if(l=(a.ownerDocument||a).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var p=l[c],g=l[c+1],b=p[gn]||null;if(typeof g=="function")b||dw(l);else if(b){var T=null;if(g&&g.hasAttribute("formAction")){if(p=g,b=g[gn]||null)T=b.formAction;else if(Ip(p)!==null)continue}else T=b.action;typeof T=="function"?l[c+1]=T:(l.splice(c,3),c-=3),dw(l)}}}function hw(){function a(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(b){return p=b})},focusReset:"manual",scroll:"manual"})}function i(){p!==null&&(p(),p=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,p=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),p!==null&&(p(),p=null)}}}function $p(a){this._internalRoot=a}dc.prototype.render=$p.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(r(409));var l=i.current,c=zn();aw(l,c,a,i,null,null)},dc.prototype.unmount=$p.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;aw(a.current,2,null,a,null,null),Gu(),i[Qs]=null}};function dc(a){this._internalRoot=a}dc.prototype.unstable_scheduleHydration=function(a){if(a){var i=Ey();a={blockedOn:null,target:a,priority:i};for(var l=0;l<Za.length&&i!==0&&i<Za[l].priority;l++);Za.splice(l,0,a),l===0&&cw(a)}};var pw=t.version;if(pw!=="19.2.0")throw Error(r(527,pw,"19.2.0"));F.findDOMNode=function(a){var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=h(i),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var VN={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hc.isDisabled&&hc.supportsFiber)try{ho=hc.inject(VN),Rn=hc}catch{}}return il.createRoot=function(a,i){if(!s(a))throw Error(r(299));var l=!1,c="",p=w0,g=S0,b=E0;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(b=i.onRecoverableError)),i=nw(a,1,!1,null,null,l,c,null,p,g,b,hw),a[Qs]=i.current,pp(a),new $p(i)},il.hydrateRoot=function(a,i,l){if(!s(a))throw Error(r(299));var c=!1,p="",g=w0,b=S0,T=E0,k=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(T=l.onRecoverableError),l.formState!==void 0&&(k=l.formState)),i=nw(a,1,!0,i,l??null,c,p,k,g,b,T,hw),i.context=rw(null),l=i.current,c=zn(),c=Ed(c),p=Aa(c),p.callback=null,Ca(l,p,c),l=c,i.current.lanes=l,mo(i,l),kr(i),a[Qs]=i.current,pp(a),new dc(i)},il.version="19.2.0",il}var Tw;function rI(){if(Tw)return Lp.exports;Tw=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Lp.exports=nI(),Lp.exports}var aI=rI(),xw=Object.defineProperty,sI=(e,t)=>{let n={};for(var r in e)xw(n,r,{get:e[r],enumerable:!0});return xw(n,Symbol.toStringTag,{value:"Module"}),n};function es(e){return typeof e=="object"&&e!==null&&"type"in e&&typeof e.type=="string"&&"source_type"in e&&(e.source_type==="url"||e.source_type==="base64"||e.source_type==="text"||e.source_type==="id")}function i1(e){return es(e)&&e.source_type==="url"&&"url"in e&&typeof e.url=="string"}function o1(e){return es(e)&&e.source_type==="base64"&&"data"in e&&typeof e.data=="string"}function iI(e){return es(e)&&e.source_type==="id"&&"id"in e&&typeof e.id=="string"}function oI(e){if(es(e)){if(e.source_type==="url")return{type:"image_url",image_url:{url:e.url}};if(e.source_type==="base64"){if(!e.mime_type)throw new Error("mime_type key is required for base64 data.");return{type:"image_url",image_url:{url:`data:${e.mime_type};base64,${e.data}`}}}}throw new Error("Unsupported source type. Only 'url' and 'base64' are supported.")}function Ow(e){const t=e.split(";")[0].split("/");if(t.length!==2)throw new Error(`Invalid mime type: "${e}" - does not match type/subtype format.`);const n=t[0].trim(),r=t[1].trim();if(n===""||r==="")throw new Error(`Invalid mime type: "${e}" - type or subtype is empty.`);const s={};for(const o of e.split(";").slice(1)){const u=o.split("=");if(u.length!==2)throw new Error(`Invalid parameter syntax in mime type: "${e}".`);const f=u[0].trim(),d=u[1].trim();if(f==="")throw new Error(`Invalid parameter syntax in mime type: "${e}".`);s[f]=d}return{type:n,subtype:r,parameters:s}}function af({dataUrl:e,asTypedArray:t=!1}){const n=e.match(/^data:(\w+\/\w+);base64,([A-Za-z0-9+/]+=*)$/);let r;if(n){r=n[1].toLowerCase();const s=t?Uint8Array.from(atob(n[2]),o=>o.charCodeAt(0)):n[2];return{mime_type:r,data:s}}}function l1(e,t){if(e.type==="text"){if(!t.fromStandardTextBlock)throw new Error(`Converter for ${t.providerName} does not implement \`fromStandardTextBlock\` method.`);return t.fromStandardTextBlock(e)}if(e.type==="image"){if(!t.fromStandardImageBlock)throw new Error(`Converter for ${t.providerName} does not implement \`fromStandardImageBlock\` method.`);return t.fromStandardImageBlock(e)}if(e.type==="audio"){if(!t.fromStandardAudioBlock)throw new Error(`Converter for ${t.providerName} does not implement \`fromStandardAudioBlock\` method.`);return t.fromStandardAudioBlock(e)}if(e.type==="file"){if(!t.fromStandardFileBlock)throw new Error(`Converter for ${t.providerName} does not implement \`fromStandardFileBlock\` method.`);return t.fromStandardFileBlock(e)}throw new Error(`Unable to convert content block type '${e.type}' to provider-specific format: not recognized.`)}function lI(e){return typeof e=="object"&&e!==null&&"type"in e&&"content"in e&&(typeof e.content=="string"||Array.isArray(e.content))}var Pp,Aw;function uI(){return Aw||(Aw=1,Pp=function(e,t){if(typeof e!="string")throw new TypeError("Expected a string");return t=typeof t>"u"?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}),Pp}var cI=uI();const fI=Ff(cI);var pc={exports:{}},Cw;function dI(){if(Cw)return pc.exports;Cw=1;const e=/[\p{Lu}]/u,t=/[\p{Ll}]/u,n=/^[\p{Lu}](?![\p{Lu}])/gu,r=/([\p{Alpha}\p{N}_]|$)/u,s=/[_.\- ]+/,o=new RegExp("^"+s.source),u=new RegExp(s.source+r.source,"gu"),f=new RegExp("\\d+"+r.source,"gu"),d=(y,v,w)=>{let x=!1,R=!1,E=!1;for(let A=0;A<y.length;A++){const N=y[A];x&&e.test(N)?(y=y.slice(0,A)+"-"+y.slice(A),x=!1,E=R,R=!0,A++):R&&E&&t.test(N)?(y=y.slice(0,A-1)+"-"+y.slice(A-1),E=R,R=!1,x=!0):(x=v(N)===N&&w(N)!==N,E=R,R=w(N)===N&&v(N)!==N)}return y},h=(y,v)=>(n.lastIndex=0,y.replace(n,w=>v(w))),m=(y,v)=>(u.lastIndex=0,f.lastIndex=0,y.replace(u,(w,x)=>v(x)).replace(f,w=>v(w))),_=(y,v)=>{if(!(typeof y=="string"||Array.isArray(y)))throw new TypeError("Expected the input to be `string | string[]`");if(v={pascalCase:!1,preserveConsecutiveUppercase:!1,...v},Array.isArray(y)?y=y.map(E=>E.trim()).filter(E=>E.length).join("-"):y=y.trim(),y.length===0)return"";const w=v.locale===!1?E=>E.toLowerCase():E=>E.toLocaleLowerCase(v.locale),x=v.locale===!1?E=>E.toUpperCase():E=>E.toLocaleUpperCase(v.locale);return y.length===1?v.pascalCase?x(y):w(y):(y!==w(y)&&(y=d(y,w,x)),y=y.replace(o,""),v.preserveConsecutiveUppercase?y=h(y,w):y=w(y),v.pascalCase&&(y=x(y.charAt(0))+y.slice(1)),m(y,x))};return pc.exports=_,pc.exports.default=_,pc.exports}dI();function hI(e,t){return t?.[e]||fI(e)}function pI(e,t,n){const r={};for(const s in e)Object.hasOwn(e,s)&&(r[t(s,n)]=e[s]);return r}const u1="__lc_escaped__";function mI(e){return"lc"in e||Object.keys(e).length===1&&u1 in e}function gI(e){return{[u1]:e}}function _I(e){return e!==null&&typeof e=="object"&&"lc_serializable"in e&&typeof e.toJSON=="function"}function yI(e){let t;return e!==null&&typeof e=="object"?"lc_id"in e&&Array.isArray(e.lc_id)?t=e.lc_id:t=[e.constructor?.name??"Object"]:t=[typeof e],{lc:1,type:"not_implemented",id:t}}function pg(e,t=new WeakSet){if(e!==null&&typeof e=="object"&&!Array.isArray(e)){if(t.has(e))return yI(e);if(_I(e))return e;t.add(e);const n=e;if(mI(n))return t.delete(e),gI(n);const r={};for(const[s,o]of Object.entries(n))r[s]=pg(o,t);return t.delete(e),r}return Array.isArray(e)?e.map(n=>pg(n,t)):e}function Rw(e){return Array.isArray(e)?[...e]:{...e}}function vI(e,t){const n=Rw(e);for(const[r,s]of Object.entries(t)){const[o,...u]=r.split(".").reverse();let f=n;for(const d of u.reverse()){if(f[d]===void 0)break;f[d]=Rw(f[d]),f=f[d]}f[o]!==void 0&&(f[o]={lc:1,type:"secret",id:[s]})}return n}function c1(e){const t=Object.getPrototypeOf(e);return typeof e.lc_name=="function"&&(typeof t.lc_name!="function"||e.lc_name()!==t.lc_name())?e.lc_name():e.name}var Nl=class f1{lc_serializable=!1;lc_kwargs;static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,c1(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(t,...n){this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(t||{}).filter(([r])=>this.lc_serializable_keys?.includes(r))):this.lc_kwargs=t??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof f1||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const t={},n={},r=Object.keys(this.lc_kwargs).reduce((f,d)=>(f[d]=d in this?this[d]:this.lc_kwargs[d],f),{});for(let f=Object.getPrototypeOf(this);f;f=Object.getPrototypeOf(f))Object.assign(t,Reflect.get(f,"lc_aliases",this)),Object.assign(n,Reflect.get(f,"lc_secrets",this)),Object.assign(r,Reflect.get(f,"lc_attributes",this));Object.keys(n).forEach(f=>{let d=this,h=r;const[m,..._]=f.split(".").reverse();for(const y of _.reverse()){if(!(y in d)||d[y]===void 0)return;(!(y in h)||h[y]===void 0)&&(typeof d[y]=="object"&&d[y]!=null?h[y]={}:Array.isArray(d[y])&&(h[y]=[])),d=d[y],h=h[y]}m in d&&d[m]!==void 0&&(h[m]=h[m]||d[m])});const s={},o=new WeakSet;o.add(this);for(const[f,d]of Object.entries(r))s[f]=pg(d,o);const u=pI(Object.keys(n).length?vI(s,n):s,hI,t);return{lc:1,type:"constructor",id:this.lc_id,kwargs:u}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}};function ye(e,t){return Ne(e)&&e.type===t}function Ne(e){return typeof e=="object"&&e!==null}function Fn(e){return Array.isArray(e)}function le(e){return typeof e=="string"}function Sr(e){return typeof e=="number"}function u_(e){return e instanceof Uint8Array}function Nw(e){try{return JSON.parse(e)}catch{return}}const Qa=e=>e();function bI(e){if(e.type==="char_location"&&le(e.document_title)&&Sr(e.start_char_index)&&Sr(e.end_char_index)&&le(e.cited_text)){const{document_title:t,start_char_index:n,end_char_index:r,cited_text:s,...o}=e;return{...o,type:"citation",source:"char",title:t??void 0,startIndex:n,endIndex:r,citedText:s}}if(e.type==="page_location"&&le(e.document_title)&&Sr(e.start_page_number)&&Sr(e.end_page_number)&&le(e.cited_text)){const{document_title:t,start_page_number:n,end_page_number:r,cited_text:s,...o}=e;return{...o,type:"citation",source:"page",title:t??void 0,startIndex:n,endIndex:r,citedText:s}}if(e.type==="content_block_location"&&le(e.document_title)&&Sr(e.start_block_index)&&Sr(e.end_block_index)&&le(e.cited_text)){const{document_title:t,start_block_index:n,end_block_index:r,cited_text:s,...o}=e;return{...o,type:"citation",source:"block",title:t??void 0,startIndex:n,endIndex:r,citedText:s}}if(e.type==="web_search_result_location"&&le(e.url)&&le(e.title)&&le(e.encrypted_index)&&le(e.cited_text)){const{url:t,title:n,encrypted_index:r,cited_text:s,...o}=e;return{...o,type:"citation",source:"url",url:t,title:n,startIndex:Number(r),endIndex:Number(r),citedText:s}}if(e.type==="search_result_location"&&le(e.source)&&le(e.title)&&Sr(e.start_block_index)&&Sr(e.end_block_index)&&le(e.cited_text)){const{source:t,title:n,start_block_index:r,end_block_index:s,cited_text:o,...u}=e;return{...u,type:"citation",source:"search",url:t,title:n??void 0,startIndex:r,endIndex:s,citedText:o}}}function d1(e){if(ye(e,"document")&&Ne(e.source)&&"type"in e.source){if(e.source.type==="base64"&&le(e.source.media_type)&&le(e.source.data))return{type:"file",mimeType:e.source.media_type,data:e.source.data};if(e.source.type==="url"&&le(e.source.url))return{type:"file",url:e.source.url};if(e.source.type==="file"&&le(e.source.file_id))return{type:"file",fileId:e.source.file_id};if(e.source.type==="text"&&le(e.source.data))return{type:"file",mimeType:String(e.source.media_type??"text/plain"),data:e.source.data}}else if(ye(e,"image")&&Ne(e.source)&&"type"in e.source){if(e.source.type==="base64"&&le(e.source.media_type)&&le(e.source.data))return{type:"image",mimeType:e.source.media_type,data:e.source.data};if(e.source.type==="url"&&le(e.source.url))return{type:"image",url:e.source.url};if(e.source.type==="file"&&le(e.source.file_id))return{type:"image",fileId:e.source.file_id}}}function wI(e){function*t(){for(const n of e){const r=d1(n);r?yield r:yield n}}return Array.from(t())}function Iw(e){function*t(){const n=typeof e.content=="string"?[{type:"text",text:e.content}]:e.content;for(const r of n){if(ye(r,"text")&&le(r.text)){const{text:s,citations:o,...u}=r;if(Fn(o)&&o.length){const f=o.reduce((d,h)=>{const m=bI(h);return m?[...d,m]:d},[]);yield{...u,type:"text",text:s,annotations:f};continue}else{yield{...u,type:"text",text:s};continue}}else if(ye(r,"thinking")&&le(r.thinking)){const{thinking:s,signature:o,...u}=r;yield{...u,type:"reasoning",reasoning:s,signature:o};continue}else if(ye(r,"redacted_thinking")){yield{type:"non_standard",value:r};continue}else if(ye(r,"tool_use")&&le(r.name)&&le(r.id)){yield{type:"tool_call",id:r.id,name:r.name,args:r.input};continue}else if(ye(r,"input_json_delta")){if(EI(e)&&e.tool_call_chunks?.length){const s=e.tool_call_chunks[0];yield{type:"tool_call_chunk",id:s.id,name:s.name,args:s.args,index:s.index};continue}}else if(ye(r,"server_tool_use")&&le(r.name)&&le(r.id)){const{name:s,id:o}=r;if(s==="web_search"){yield{id:o,type:"server_tool_call",name:"web_search",args:{query:Qa(()=>{if(typeof r.input=="string")return r.input;if(Ne(r.input)&&le(r.input.query))return r.input.query;if(le(r.partial_json)){const u=Nw(r.partial_json);if(u?.query)return u.query}return""})}};continue}else if(r.name==="code_execution"){yield{id:o,type:"server_tool_call",name:"code_execution",args:{code:Qa(()=>{if(typeof r.input=="string")return r.input;if(Ne(r.input)&&le(r.input.code))return r.input.code;if(le(r.partial_json)){const u=Nw(r.partial_json);if(u?.code)return u.code}return""})}};continue}}else if(ye(r,"web_search_tool_result")&&le(r.tool_use_id)&&Fn(r.content)){const{content:s,tool_use_id:o}=r;yield{type:"server_tool_call_result",name:"web_search",toolCallId:o,status:"success",output:{urls:s.reduce((u,f)=>ye(f,"web_search_result")?[...u,f.url]:u,[])}};continue}else if(ye(r,"code_execution_tool_result")&&le(r.tool_use_id)&&Ne(r.content)){yield{type:"server_tool_call_result",name:"code_execution",toolCallId:r.tool_use_id,status:"success",output:r.content};continue}else if(ye(r,"mcp_tool_use")){yield{id:r.id,type:"server_tool_call",name:"mcp_tool_use",args:r.input};continue}else if(ye(r,"mcp_tool_result")&&le(r.tool_use_id)&&Ne(r.content)){yield{type:"server_tool_call_result",name:"mcp_tool_use",toolCallId:r.tool_use_id,status:"success",output:r.content};continue}else if(ye(r,"container_upload")){yield{type:"server_tool_call",name:"container_upload",args:r.input};continue}else if(ye(r,"search_result")){yield{id:r.id,type:"non_standard",value:r};continue}else if(ye(r,"tool_result")){yield{id:r.id,type:"non_standard",value:r};continue}else{const s=d1(r);if(s){yield s;continue}}yield{type:"non_standard",value:r}}}return Array.from(t())}const SI={translateContent:Iw,translateContentChunk:Iw};function EI(e){return typeof e?._getType=="function"&&typeof e.concat=="function"&&e._getType()==="ai"}function TI(e){return i1(e)?{type:e.type,mimeType:e.mime_type,url:e.url,metadata:e.metadata}:o1(e)?{type:e.type,mimeType:e.mime_type??"application/octet-stream",data:e.data,metadata:e.metadata}:iI(e)?{type:e.type,mimeType:e.mime_type,fileId:e.id,metadata:e.metadata}:e}function xI(e){return e.map(TI)}function OI(e){return!!(ye(e,"image_url")&&Ne(e.image_url)||ye(e,"input_audio")&&Ne(e.input_audio)||ye(e,"file")&&Ne(e.file))}function AI(e){if(ye(e,"image_url")&&Ne(e.image_url)&&le(e.image_url.url)){const t=af({dataUrl:e.image_url.url});return t?{type:"image",mimeType:t.mime_type,data:t.data}:{type:"image",url:e.image_url.url}}else{if(ye(e,"input_audio")&&Ne(e.input_audio)&&le(e.input_audio.data)&&le(e.input_audio.format))return{type:"audio",data:e.input_audio.data,mimeType:`audio/${e.input_audio.format}`};if(ye(e,"file")&&Ne(e.file)&&le(e.file.data)){const t=af({dataUrl:e.file.data});if(t)return{type:"file",data:t.data,mimeType:t.mime_type};if(le(e.file.file_id))return{type:"file",fileId:e.file.file_id}}}return e}function CI(e){const t=[];typeof e.content=="string"?e.content.length>0&&t.push({type:"text",text:e.content}):t.push(...c_(e.content));for(const n of e.tool_calls??[])t.push({type:"tool_call",id:n.id,name:n.name,args:n.args});return t}function RI(e){const t=[];typeof e.content=="string"?e.content.length>0&&t.push({type:"text",text:e.content}):t.push(...c_(e.content));for(const n of e.tool_calls??[])t.push({type:"tool_call",id:n.id,name:n.name,args:n.args});return t}function c_(e){const t=[];for(const n of e)OI(n)?t.push(AI(n)):t.push(n);return t}function NI(e){if(e.type==="url_citation"){const{url:t,title:n,start_index:r,end_index:s}=e;return{type:"citation",url:t,title:n,startIndex:r,endIndex:s}}if(e.type==="file_citation"){const{file_id:t,filename:n,index:r}=e;return{type:"citation",title:n,startIndex:r,endIndex:r,fileId:t}}return e}function h1(e){function*t(){Ne(e.additional_kwargs?.reasoning)&&Fn(e.additional_kwargs.reasoning.summary)&&(yield{type:"reasoning",reasoning:e.additional_kwargs.reasoning.summary.reduce((r,s)=>Ne(s)&&le(s.text)?`${r}${s.text}`:r,"")});const n=typeof e.content=="string"?[{type:"text",text:e.content}]:e.content;for(const r of n)if(ye(r,"text")){const{text:s,annotations:o,...u}=r;Array.isArray(o)?yield{...u,type:"text",text:String(s),annotations:o.map(NI)}:yield{...u,type:"text",text:String(s)}}for(const r of e.tool_calls??[])yield{type:"tool_call",id:r.id,name:r.name,args:r.args};if(Ne(e.additional_kwargs)&&Fn(e.additional_kwargs.tool_outputs))for(const r of e.additional_kwargs.tool_outputs){if(ye(r,"web_search_call")){const s={};if(Ne(r.action)&&le(r.action.query)&&(s.query=r.action.query),yield{id:r.id,type:"server_tool_call",name:"web_search",args:s},r.status==="completed"||r.status==="failed"){const o={};Ne(r.action)&&(o.action=r.action),yield{type:"server_tool_call_result",toolCallId:le(r.id)?r.id:"",status:r.status==="completed"?"success":"error",output:o}}continue}else if(ye(r,"file_search_call")){yield{id:r.id,type:"server_tool_call",name:"file_search",args:{queries:Fn(r.queries)?r.queries:[]}},(r.status==="completed"||r.status==="failed")&&(yield{type:"server_tool_call_result",toolCallId:le(r.id)?r.id:"",status:r.status==="completed"?"success":"error",output:Fn(r.results)?{results:r.results}:{}});continue}else if(ye(r,"computer_call")){yield{type:"non_standard",value:r};continue}else if(ye(r,"code_interpreter_call")){if(le(r.code)&&(yield{id:r.id,type:"server_tool_call",name:"code_interpreter",args:{code:r.code}}),Fn(r.outputs)){const s=Qa(()=>{if(r.status!=="in_progress"){if(r.status==="completed")return 0;if(r.status==="incomplete")return 127;if(r.status!=="interpreting"&&r.status==="failed")return 1}});for(const o of r.outputs)if(ye(o,"logs")){yield{type:"server_tool_call_result",toolCallId:r.id??"",status:"success",output:{type:"code_interpreter_output",returnCode:s??0,stderr:[0,void 0].includes(s)?void 0:String(o.logs),stdout:[0,void 0].includes(s)?String(o.logs):void 0}};continue}}continue}else if(ye(r,"mcp_call")){yield{id:r.id,type:"server_tool_call",name:"mcp_call",args:r.input};continue}else if(ye(r,"mcp_list_tools")){yield{id:r.id,type:"server_tool_call",name:"mcp_list_tools",args:r.input};continue}else if(ye(r,"mcp_approval_request")){yield{type:"non_standard",value:r};continue}else if(ye(r,"image_generation_call")){le(r.result)&&(yield{type:"image",mimeType:"image/png",data:r.result,id:le(r.id)?r.id:void 0,metadata:{status:le(r.status)?r.status:void 0}}),yield{type:"non_standard",value:r};continue}Ne(r)&&(yield{type:"non_standard",value:r})}}return Array.from(t())}function II(e){function*t(){yield*h1(e);for(const n of e.tool_call_chunks??[])yield{type:"tool_call_chunk",id:n.id,name:n.name,args:n.args}}return Array.from(t())}const kI={translateContent:e=>typeof e.content=="string"?CI(e):h1(e),translateContentChunk:e=>typeof e.content=="string"?RI(e):II(e)};function $I(e,t="pretty"){return t==="pretty"?MI(e):JSON.stringify(e)}function MI(e){const t=[],n=` ${e.type.charAt(0).toUpperCase()+e.type.slice(1)} Message `,r=Math.floor((80-n.length)/2),s="=".repeat(r),o=n.length%2===0?s:`${s}=`;if(t.push(`${s}${n}${o}`),e.type==="ai"){const u=e;if(u.tool_calls&&u.tool_calls.length>0){t.push("Tool Calls:");for(const f of u.tool_calls){t.push(`  ${f.name} (${f.id})`),t.push(` Call ID: ${f.id}`),t.push("  Args:");for(const[d,h]of Object.entries(f.args))t.push(`    ${d}: ${typeof h=="object"?JSON.stringify(h):h}`)}}}if(e.type==="tool"){const u=e;u.name&&t.push(`Name: ${u.name}`)}return typeof e.content=="string"&&e.content.trim()&&(t.length>1&&t.push(""),t.push(e.content)),t.join(`
`)}const Bp=Symbol.for("langchain.message");function ts(e,t){return typeof e=="string"?e===""?t:typeof t=="string"?e+t:Array.isArray(t)&&t.length===0?e:Array.isArray(t)&&t.some(n=>es(n))?[{type:"text",source_type:"text",text:e},...t]:[{type:"text",text:e},...t]:Array.isArray(t)?Il(e,t)??[...e,...t]:t===""?e:Array.isArray(e)&&e.some(n=>es(n))?[...e,{type:"file",source_type:"text",text:t}]:[...e,{type:"text",text:t}]}function jI(e,t){return e==="error"||t==="error"?"error":"success"}function LI(e,t){function n(r,s){if(typeof r!="object"||r===null||r===void 0)return r;if(s>=t)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(u=>n(u,s+1));const o={};for(const u of Object.keys(r))o[u]=n(r[u],s+1);return o}return JSON.stringify(n(e,0),null,2)}var Fs=class extends Nl{lc_namespace=["langchain_core","messages"];lc_serializable=!0;get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}[Bp]=!0;id;name;content;additional_kwargs;response_metadata;_getType(){return this.type}getType(){return this._getType()}constructor(e){const t=typeof e=="string"||Array.isArray(e)?{content:e}:e;t.additional_kwargs||(t.additional_kwargs={}),t.response_metadata||(t.response_metadata={}),super(t),this.name=t.name,t.content===void 0&&t.contentBlocks!==void 0?(this.content=t.contentBlocks,this.response_metadata={output_version:"v1",...t.response_metadata}):t.content!==void 0?(this.content=t.content??[],this.response_metadata=t.response_metadata):(this.content=[],this.response_metadata=t.response_metadata),this.additional_kwargs=t.additional_kwargs,this.id=t.id}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}get contentBlocks(){const e=typeof this.content=="string"?[{type:"text",text:this.content}]:this.content;return[xI,c_,wI].reduce((t,n)=>n(t),e)}toDict(){return{type:this.getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}static isInstance(e){return typeof e=="object"&&e!==null&&Bp in e&&e[Bp]===!0&&lI(e)}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=LI(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}toFormattedString(e="pretty"){return $I(this,e)}};const zI=["index","created","timestamp"];function pn(e,t,n){const r=zI;if(e==null&&t==null)return;if(e==null||t==null)return e??t;const s={...e};for(const[o,u]of Object.entries(t))if(s[o]==null)s[o]=u;else{if(u==null)continue;if(typeof s[o]!=typeof u||Array.isArray(s[o])!==Array.isArray(u))throw new Error(`field[${o}] already exists in the message chunk, but with a different type.`);if(typeof s[o]=="string"){if(o==="type")continue;if(["id","name","output_version","model_provider"].includes(o))u&&(s[o]=u);else{if(r.includes(o))continue;s[o]+=u}}else if(typeof s[o]=="number"){if(r.includes(o))continue;s[o]=s[o]+u}else if(typeof s[o]=="object"&&!Array.isArray(s[o]))s[o]=pn(s[o],u);else if(Array.isArray(s[o]))s[o]=Il(s[o],u);else{if(s[o]===u)continue;console.warn(`field[${o}] already exists in this message chunk and value has unsupported type.`)}}return s}function DI(e){return typeof e=="number"||typeof e=="string"}function kw(e){return typeof e!="object"||e===null||!("index"in e)?!1:DI(e.index)}function Il(e,t,n){if(!(e==null&&t==null)){if(e==null||t==null)return e||t;{const r=[...e];for(const s of t)if(kw(s)){const o=r.findIndex(u=>{if(!kw(u))return!1;const f=u.index===s.index,d=u.id!=null&&s.id!=null&&u.id===s.id,h=u.id==null||s.id==null;return f&&(d||h)});o!==-1&&typeof r[o]=="object"&&r[o]!==null?r[o]=pn(r[o],s):r.push(s)}else{if(typeof s=="object"&&s!==null&&"text"in s&&s.text==="")continue;r.push(s)}return r}}}function UI(e,t,n){if(!(e==null&&t==null)){if(e==null||t==null)return e??t;if(typeof e!=typeof t)throw new Error(`Cannot merge objects of different types.
Left ${typeof e}
Right ${typeof t}`);if(typeof e=="string"&&typeof t=="string")return e+t;if(Array.isArray(e)&&Array.isArray(t))return Il(e,t);if(typeof e=="object"&&typeof t=="object")return pn(e,t);if(e===t)return e;throw new Error(`Can not merge objects of different types.
Left ${e}
Right ${t}`)}}var Hs=class p1 extends Fs{static isInstance(t){if(!super.isInstance(t))return!1;let n=Object.getPrototypeOf(t);for(;n!==null;){if(n===p1.prototype)return!0;n=Object.getPrototypeOf(n)}return!1}};function PI(e){return typeof e.role=="string"}function f_(e){return typeof e?._getType=="function"}function BI(e){return Hs.isInstance(e)}function ZI(e,t){return pn(e,t)??{}}function m1(e,t){const n={};return(e?.audio!==void 0||t?.audio!==void 0)&&(n.audio=(e?.audio??0)+(t?.audio??0)),(e?.image!==void 0||t?.image!==void 0)&&(n.image=(e?.image??0)+(t?.image??0)),(e?.video!==void 0||t?.video!==void 0)&&(n.video=(e?.video??0)+(t?.video??0)),(e?.document!==void 0||t?.document!==void 0)&&(n.document=(e?.document??0)+(t?.document??0)),(e?.text!==void 0||t?.text!==void 0)&&(n.text=(e?.text??0)+(t?.text??0)),n}function qI(e,t){const n={...m1(e,t)};return(e?.cache_read!==void 0||t?.cache_read!==void 0)&&(n.cache_read=(e?.cache_read??0)+(t?.cache_read??0)),(e?.cache_creation!==void 0||t?.cache_creation!==void 0)&&(n.cache_creation=(e?.cache_creation??0)+(t?.cache_creation??0)),n}function FI(e,t){const n={...m1(e,t)};return(e?.reasoning!==void 0||t?.reasoning!==void 0)&&(n.reasoning=(e?.reasoning??0)+(t?.reasoning??0)),n}function g1(e,t){return{input_tokens:(e?.input_tokens??0)+(t?.input_tokens??0),output_tokens:(e?.output_tokens??0)+(t?.output_tokens??0),total_tokens:(e?.total_tokens??0)+(t?.total_tokens??0),input_token_details:qI(e?.input_token_details,t?.input_token_details),output_token_details:FI(e?.output_token_details,t?.output_token_details)}}var d_=class extends Fs{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}lc_direct_tool_output=!0;type="tool";status;tool_call_id;metadata;artifact;constructor(e,t,n){const r=typeof e=="string"||Array.isArray(e)?{content:e,name:n,tool_call_id:t}:e;super(r),this.tool_call_id=r.tool_call_id,this.artifact=r.artifact,this.status=r.status,this.metadata=r.metadata}static isInstance(e){return super.isInstance(e)&&e.type==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}},HI=class extends Hs{type="tool";tool_call_id;status;artifact;constructor(e){super(e),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}concat(e){const t=this.constructor;return new t({content:ts(this.content,e.content),additional_kwargs:pn(this.additional_kwargs,e.additional_kwargs),response_metadata:pn(this.response_metadata,e.response_metadata),artifact:UI(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:jI(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}};function GI(e){const t=[],n=[];for(const r of e)if(r.function){const s=r.function.name;try{const o=JSON.parse(r.function.arguments);t.push({name:s||"",args:o||{},id:r.id})}catch{n.push({name:s,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[t,n]}function h_(e){switch(e){case"csv":return"text/csv";case"doc":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"html":return"text/html";case"md":return"text/markdown";case"pdf":return"application/pdf";case"txt":return"text/plain";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"gif":return"image/gif";case"jpeg":return"image/jpeg";case"jpg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";case"flv":return"video/flv";case"mkv":return"video/mkv";case"mov":return"video/mov";case"mp4":return"video/mp4";case"mpeg":return"video/mpeg";case"mpg":return"video/mpg";case"three_gp":return"video/three_gp";case"webm":return"video/webm";case"wmv":return"video/wmv";default:return"application/octet-stream"}}function VI(e){if(Ne(e.document)&&Ne(e.document.source)){const t=h_(Ne(e.document)&&le(e.document.format)?e.document.format:"");if(Ne(e.document.source)){if(Ne(e.document.source.s3Location)&&le(e.document.source.s3Location.uri))return{type:"file",mimeType:t,fileId:e.document.source.s3Location.uri};if(u_(e.document.source.bytes))return{type:"file",mimeType:t,data:e.document.source.bytes};if(le(e.document.source.text))return{type:"file",mimeType:t,data:Buffer.from(e.document.source.text).toString("base64")};if(Fn(e.document.source.content))return{type:"file",mimeType:t,data:e.document.source.content.reduce((n,r)=>Ne(r)&&le(r.text)?n+r.text:n,"")}}}return{type:"non_standard",value:e}}function JI(e){if(ye(e,"image")&&Ne(e.image)){const t=h_(Ne(e.image)&&le(e.image.format)?e.image.format:"");if(Ne(e.image.source)){if(Ne(e.image.source.s3Location)&&le(e.image.source.s3Location.uri))return{type:"image",mimeType:t,fileId:e.image.source.s3Location.uri};if(u_(e.image.source.bytes))return{type:"image",mimeType:t,data:e.image.source.bytes}}}return{type:"non_standard",value:e}}function XI(e){if(ye(e,"video")&&Ne(e.video)){const t=h_(Ne(e.video)&&le(e.video.format)?e.video.format:"");if(Ne(e.video.source)){if(Ne(e.video.source.s3Location)&&le(e.video.source.s3Location.uri))return{type:"video",mimeType:t,fileId:e.video.source.s3Location.uri};if(u_(e.video.source.bytes))return{type:"video",mimeType:t,data:e.video.source.bytes}}}return{type:"non_standard",value:e}}function $w(e){function*t(){const n=typeof e.content=="string"?[{type:"text",text:e.content}]:e.content;for(const r of n){if(ye(r,"cache_point")){yield{type:"non_standard",value:r};continue}else if(ye(r,"citations_content")&&Ne(r.citationsContent)){yield{type:"text",text:Fn(r.citationsContent.content)?r.citationsContent.content.reduce((s,o)=>Ne(o)&&le(o.text)?s+o.text:s,""):"",annotations:Fn(r.citationsContent.citations)?r.citationsContent.citations.reduce((s,o)=>{if(Ne(o)){const u=Fn(o.sourceContent)?o.sourceContent.reduce((d,h)=>Ne(h)&&le(h.text)?d+h.text:d,""):"",f=Qa(()=>{if(Ne(o.location)){const d=o.location.documentChar||o.location.documentPage||o.location.documentChunk;if(Ne(d))return{source:Sr(d.documentIndex)?d.documentIndex.toString():void 0,startIndex:Sr(d.start)?d.start:void 0,endIndex:Sr(d.end)?d.end:void 0}}return{}});s.push({type:"citation",citedText:u,...f})}return s},[]):[]};continue}else if(ye(r,"document")&&Ne(r.document)){yield VI(r);continue}else if(ye(r,"guard_content")){yield{type:"non_standard",value:r};continue}else if(ye(r,"image")&&Ne(r.image)){yield JI(r);continue}else if(ye(r,"reasoning_content")&&le(r.reasoningText)){yield{type:"reasoning",reasoning:r.reasoningText};continue}else if(ye(r,"text")&&le(r.text)){yield{type:"text",text:r.text};continue}else if(ye(r,"tool_result")){yield{type:"non_standard",value:r};continue}else{if(ye(r,"tool_call"))continue;if(ye(r,"video")&&Ne(r.video)){yield XI(r);continue}}yield{type:"non_standard",value:r}}}return Array.from(t())}const YI={translateContent:$w,translateContentChunk:$w};function Mw(e){const t=[],n=e.additional_kwargs?.reasoning_content;if(le(n)&&n.length>0&&t.push({type:"reasoning",reasoning:n}),typeof e.content=="string")e.content.length>0&&t.push({type:"text",text:e.content});else for(const r of e.content)typeof r=="object"&&"type"in r&&r.type==="text"&&"text"in r&&le(r.text)&&t.push({type:"text",text:r.text});for(const r of e.tool_calls??[])t.push({type:"tool_call",id:r.id,name:r.name,args:r.args});return t}const QI={translateContent:Mw,translateContentChunk:Mw};function jw(e){function*t(){const n=typeof e.content=="string"?[{type:"text",text:e.content}]:e.content;for(const r of n){if(ye(r,"text")&&le(r.text)){yield{type:"text",text:r.text};continue}else if(ye(r,"thinking")&&le(r.thinking)){yield{type:"reasoning",reasoning:r.thinking,...r.signature?{signature:r.signature}:{}};continue}else if(ye(r,"inlineData")&&Ne(r.inlineData)&&le(r.inlineData.mimeType)&&le(r.inlineData.data)){yield{type:"file",mimeType:r.inlineData.mimeType,data:r.inlineData.data};continue}else if(ye(r,"functionCall")&&Ne(r.functionCall)&&le(r.functionCall.name)&&Ne(r.functionCall.args)){yield{type:"tool_call",id:e.id,name:r.functionCall.name,args:r.functionCall.args};continue}else if(ye(r,"functionResponse")){yield{type:"non_standard",value:r};continue}else if(ye(r,"fileData")&&Ne(r.fileData)&&le(r.fileData.mimeType)&&le(r.fileData.fileUri)){yield{type:"file",mimeType:r.fileData.mimeType,fileId:r.fileData.fileUri};continue}else if(ye(r,"executableCode")){yield{type:"non_standard",value:r};continue}else if(ye(r,"codeExecutionResult")){yield{type:"non_standard",value:r};continue}yield{type:"non_standard",value:r}}}return Array.from(t())}const KI={translateContent:jw,translateContentChunk:jw};function Lw(e){function*t(){const n=typeof e.content=="string"?[{type:"text",text:e.content}]:e.content;for(const r of n){if(ye(r,"reasoning")&&le(r.reasoning)){const s=Qa(()=>{const o=n.indexOf(r);if(Fn(e.additional_kwargs?.signatures)&&o>=0)return e.additional_kwargs.signatures.at(o)});le(s)?yield{type:"reasoning",reasoning:r.reasoning,signature:s}:yield{type:"reasoning",reasoning:r.reasoning};continue}else if(ye(r,"thinking")&&le(r.thinking)){yield{type:"reasoning",reasoning:r.thinking,...r.signature?{signature:r.signature}:{}};continue}else if(ye(r,"text")&&le(r.text)){yield{type:"text",text:r.text};continue}else if(ye(r,"image_url")){if(le(r.image_url))if(r.image_url.startsWith("data:")){const s=r.image_url.match(/^data:([^;]+);base64,(.+)$/);s?yield{type:"image",data:s[2],mimeType:s[1]}:yield{type:"image",url:r.image_url}}else yield{type:"image",url:r.image_url};continue}else if(ye(r,"media")&&le(r.mimeType)&&le(r.data)){yield{type:"file",mimeType:r.mimeType,data:r.data};continue}yield{type:"non_standard",value:r}}}return Array.from(t())}const WI={translateContent:Lw,translateContentChunk:Lw};function zw(e){const t=[],n=e.additional_kwargs?.reasoning;if(le(n)&&n.length>0&&t.push({type:"reasoning",reasoning:n}),typeof e.content=="string"){let r=e.content;const s=r.match(/<think>([\s\S]*?)<\/think>/);if(s){const o=s[1].trim();o.length>0&&t.push({type:"reasoning",reasoning:o}),r=r.replace(/<think>[\s\S]*?<\/think>/,"").trim()}r.length>0&&t.push({type:"text",text:r})}else for(const r of e.content)if(typeof r=="object"&&"type"in r&&r.type==="text"&&"text"in r&&le(r.text)){let s=r.text;const o=s.match(/<think>([\s\S]*?)<\/think>/);if(o){const u=o[1].trim();u.length>0&&t.push({type:"reasoning",reasoning:u}),s=s.replace(/<think>[\s\S]*?<\/think>/,"").trim()}s.length>0&&t.push({type:"text",text:s})}for(const r of e.tool_calls??[])t.push({type:"tool_call",id:r.id,name:r.name,args:r.args});return t}const ek={translateContent:zw,translateContentChunk:zw};function Dw(e){const t=[],n=e.additional_kwargs?.reasoning_content;if(le(n)&&n.length>0&&t.push({type:"reasoning",reasoning:n}),typeof e.content=="string")e.content.length>0&&t.push({type:"text",text:e.content});else for(const r of e.content)typeof r=="object"&&"type"in r&&r.type==="text"&&"text"in r&&le(r.text)&&t.push({type:"text",text:r.text});for(const r of e.tool_calls??[])t.push({type:"tool_call",id:r.id,name:r.name,args:r.args});return t}const tk={translateContent:Dw,translateContentChunk:Dw};function Uw(e){const t=[];if(Ne(e.additional_kwargs?.reasoning)){const r=e.additional_kwargs.reasoning;if(Fn(r.summary)){const s=r.summary.reduce((o,u)=>Ne(u)&&le(u.text)?`${o}${u.text}`:o,"");s.length>0&&t.push({type:"reasoning",reasoning:s})}}const n=e.additional_kwargs?.reasoning_content;if(le(n)&&n.length>0&&t.push({type:"reasoning",reasoning:n}),typeof e.content=="string")e.content.length>0&&t.push({type:"text",text:e.content});else for(const r of e.content)typeof r=="object"&&"type"in r&&r.type==="text"&&"text"in r&&le(r.text)&&t.push({type:"text",text:r.text});for(const r of e.tool_calls??[])t.push({type:"tool_call",id:r.id,name:r.name,args:r.args});return t}const nk={translateContent:Uw,translateContentChunk:Uw};function Pw(e){function*t(){const n=Qa(()=>typeof e.content=="string"?e.additional_kwargs.originalTextContentBlock?[{...e.additional_kwargs.originalTextContentBlock,type:"text"}]:[{type:"text",text:e.content}]:e.content);for(const r of n){const s=Qa(()=>ye(r,"text")&&le(r.text)?{type:"text",text:r.text}:ye(r,"inlineData")&&Ne(r.inlineData)&&le(r.inlineData.mimeType)&&le(r.inlineData.data)?{type:"file",mimeType:r.inlineData.mimeType,data:r.inlineData.data}:ye(r,"functionCall")&&Ne(r.functionCall)&&le(r.functionCall.name)&&Ne(r.functionCall.args)?{type:"tool_call",id:e.id,name:r.functionCall.name,args:r.functionCall.args}:ye(r,"functionResponse")?{type:"non_standard",value:r}:ye(r,"fileData")&&Ne(r.fileData)&&le(r.fileData.mimeType)&&le(r.fileData.fileUri)?{type:"file",mimeType:r.fileData.mimeType,fileId:r.fileData.fileUri}:ye(r,"executableCode")?{type:"non_standard",value:r}:ye(r,"codeExecutionResult")?{type:"non_standard",value:r}:{type:"non_standard",value:r}),o=Qa(()=>"thought"in r&&r.thought?{type:"reasoning",reasoning:s.type==="text"?s.text:"",reasoningContentBlock:s}:s),u={thought:r.thought,thoughtSignature:r.thoughtSignature,partMetadata:r.partMetadata,...o};for(const f in u)u[f]===void 0&&delete u[f];yield u}}return Array.from(t())}const rk={translateContent:Pw,translateContentChunk:Pw};globalThis.lc_block_translators_registry??=new Map([["anthropic",SI],["bedrock-converse",YI],["deepseek",QI],["google",rk],["google-genai",KI],["google-vertexai",WI],["groq",ek],["ollama",tk],["openai",kI],["xai",nk]]);function _1(e){return globalThis.lc_block_translators_registry.get(e)}function y1(e){const t=Symbol.for(e);return{brand(n,r){const s=r?Symbol.for(`${e}.${r}`):t;class o extends n{[s]=!0;constructor(...f){super(...f)}static isInstance(f){return typeof f=="object"&&f!==null&&s in f&&f[s]===!0}}return Object.defineProperty(o,"name",{value:n.name}),o},sub(n){return y1(`${e}.${n}`)},isInstance(n){return typeof n=="object"&&n!==null&&t in n&&n[t]===!0}}}const ak=y1("langchain");function v1(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://docs.langchain.com/oss/javascript/langchain/errors/${t}/
`,e}const p_=ak.sub("error");var b1=class extends p_.brand(Error){name="LangChainError";constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},Bw=class extends p_.brand(b1,"model-abort"){name="ModelAbortError";partialOutput;constructor(e,t){super(e),this.partialOutput=t}},sk=class w1 extends p_.brand(b1,"context-overflow"){name="ContextOverflowError";cause;constructor(t){super(t??"Input exceeded the model's context window.")}static fromError(t){const n=new w1(t.message);return n.cause=t,n}};function S1(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="tool_call")}var ik=class extends Error{output;constructor(e,t){super(e),this.output=t}};function Zw(e,t=m_){e=e.trim();const n=e.indexOf("```");if(n===-1)return t(e);let r=e.substring(n+3);r.startsWith(`json
`)?r=r.substring(5):r.startsWith("json")?r=r.substring(4):r.startsWith(`
`)&&(r=r.substring(1));const s=r.indexOf("```");let o=r;return s!==-1&&(o=r.substring(0,s)),t(o.trim())}function ok(e){try{return JSON.parse(e)}catch{}const t=e.trim();if(t.length===0)throw new Error("Unexpected end of JSON input");let n=0;function r(){for(;n<t.length&&/\s/.test(t[n]);)n+=1}function s(){if(t[n]!=='"')throw new Error(`Expected '"' at position ${n}, got '${t[n]}'`);n+=1;let m="",_=!1;for(;n<t.length;){const y=t[n];if(_){if(y==="n")m+=`
`;else if(y==="t")m+="	";else if(y==="r")m+="\r";else if(y==="\\")m+="\\";else if(y==='"')m+='"';else if(y==="b")m+="\b";else if(y==="f")m+="\f";else if(y==="/")m+="/";else if(y==="u"){const v=t.substring(n+1,n+5);if(/^[0-9A-Fa-f]{0,4}$/.test(v))v.length===4?m+=String.fromCharCode(Number.parseInt(v,16)):m+=`u${v}`,n+=v.length;else throw new Error(`Invalid unicode escape sequence '\\u${v}' at position ${n}`)}else throw new Error(`Invalid escape sequence '\\${y}' at position ${n}`);_=!1}else if(y==="\\")_=!0;else{if(y==='"')return n+=1,m;m+=y}n+=1}return _&&(m+="\\"),m}function o(){const m=n;let _="";if(t[n]==="-"&&(_+="-",n+=1),n<t.length&&t[n]==="0"&&(_+="0",n+=1,t[n]>="0"&&t[n]<="9"))throw new Error(`Invalid number at position ${m}`);if(n<t.length&&t[n]>="1"&&t[n]<="9")for(;n<t.length&&t[n]>="0"&&t[n]<="9";)_+=t[n],n+=1;if(n<t.length&&t[n]===".")for(_+=".",n+=1;n<t.length&&t[n]>="0"&&t[n]<="9";)_+=t[n],n+=1;if(n<t.length&&(t[n]==="e"||t[n]==="E"))for(_+=t[n],n+=1,n<t.length&&(t[n]==="+"||t[n]==="-")&&(_+=t[n],n+=1);n<t.length&&t[n]>="0"&&t[n]<="9";)_+=t[n],n+=1;if(_==="-")return-0;const y=Number.parseFloat(_);if(Number.isNaN(y))throw n=m,new Error(`Invalid number '${_}' at position ${m}`);return y}function u(){if(r(),n>=t.length)throw new Error(`Unexpected end of input at position ${n}`);const m=t[n];if(m==="{")return d();if(m==="[")return f();if(m==='"')return s();if("null".startsWith(t.substring(n,n+4)))return n+=Math.min(4,t.length-n),null;if("true".startsWith(t.substring(n,n+4)))return n+=Math.min(4,t.length-n),!0;if("false".startsWith(t.substring(n,n+5)))return n+=Math.min(5,t.length-n),!1;if(m==="-"||m>="0"&&m<="9")return o();throw new Error(`Unexpected character '${m}' at position ${n}`)}function f(){if(t[n]!=="[")throw new Error(`Expected '[' at position ${n}, got '${t[n]}'`);const m=[];if(n+=1,r(),n>=t.length)return m;if(t[n]==="]")return n+=1,m;for(;n<t.length;){if(r(),n>=t.length||(m.push(u()),r(),n>=t.length))return m;if(t[n]==="]")return n+=1,m;if(t[n]===","){n+=1;continue}throw new Error(`Expected ',' or ']' at position ${n}, got '${t[n]}'`)}return m}function d(){if(t[n]!=="{")throw new Error(`Expected '{' at position ${n}, got '${t[n]}'`);const m={};if(n+=1,r(),n>=t.length)return m;if(t[n]==="}")return n+=1,m;for(;n<t.length;){if(r(),n>=t.length)return m;const _=s();if(r(),n>=t.length)return m;if(t[n]!==":")throw new Error(`Expected ':' at position ${n}, got '${t[n]}'`);if(n+=1,r(),n>=t.length||(m[_]=u(),r(),n>=t.length))return m;if(t[n]==="}")return n+=1,m;if(t[n]===","){n+=1;continue}throw new Error(`Expected ',' or '}' at position ${n}, got '${t[n]}'`)}return m}const h=u();if(r(),n<t.length)throw new Error(`Unexpected character '${t[n]}' at position ${n}`);return h}function m_(e){try{return typeof e>"u"?null:ok(e)}catch{return null}}var g_=class E1 extends Fs{static lc_name(){return"ChatMessage"}type="generic";role;static _chatMessageClass(){return E1}constructor(t,n){(typeof t=="string"||Array.isArray(t))&&(t={content:t,role:n}),super(t),this.role=t.role}static isInstance(t){return super.isInstance(t)&&t.type==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}},T1=class extends Hs{static lc_name(){return"ChatMessageChunk"}type="generic";role;constructor(e,t){(typeof e=="string"||Array.isArray(e))&&(e={content:e,role:t}),super(e),this.role=e.role}concat(e){const t=this.constructor;return new t({content:ts(this.content,e.content),additional_kwargs:pn(this.additional_kwargs,e.additional_kwargs),response_metadata:pn(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}static isInstance(e){return super.isInstance(e)&&e.type==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}},x1=class extends Hs{static lc_name(){return"FunctionMessageChunk"}type="function";concat(e){const t=this.constructor;return new t({content:ts(this.content,e.content),additional_kwargs:pn(this.additional_kwargs,e.additional_kwargs),response_metadata:pn(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}},Gs=class extends Fs{static lc_name(){return"HumanMessage"}type="human";constructor(e){super(e)}static isInstance(e){return super.isInstance(e)&&e.type==="human"}},O1=class extends Hs{static lc_name(){return"HumanMessageChunk"}type="human";constructor(e){super(e)}concat(e){const t=this.constructor;return new t({content:ts(this.content,e.content),additional_kwargs:pn(this.additional_kwargs,e.additional_kwargs),response_metadata:pn(this.response_metadata,e.response_metadata),id:this.id??e.id})}static isInstance(e){return super.isInstance(e)&&e.type==="human"}},lk=class extends Fs{type="remove";id;constructor(e){super({...e,content:[]}),this.id=e.id}get _printableFields(){return{...super._printableFields,id:this.id}}static isInstance(e){return super.isInstance(e)&&e.type==="remove"}},Qi=class Bc extends Fs{static lc_name(){return"SystemMessage"}type="system";constructor(t){super(t)}concat(t){if(typeof t=="string")return new Bc({...this,content:ts(this.content,t)});if(Bc.isInstance(t))return new Bc({...this,additional_kwargs:{...this.additional_kwargs,...t.additional_kwargs},response_metadata:{...this.response_metadata,...t.response_metadata},content:ts(this.content,t.content)});throw new Error("Unexpected chunk type for system message")}static isInstance(t){return super.isInstance(t)&&t.type==="system"}},mg=class extends Hs{static lc_name(){return"SystemMessageChunk"}type="system";constructor(e){super(e)}concat(e){const t=this.constructor;return new t({content:ts(this.content,e.content),additional_kwargs:pn(this.additional_kwargs,e.additional_kwargs),response_metadata:pn(this.response_metadata,e.response_metadata),id:this.id??e.id})}static isInstance(e){return super.isInstance(e)&&e.type==="system"}};const uk=e=>e();function ck(e){return S1(e)?e:typeof e.id=="string"&&e.type==="function"&&typeof e.function=="object"&&e.function!==null&&"arguments"in e.function&&typeof e.function.arguments=="string"&&"name"in e.function&&typeof e.function.name=="string"?{id:e.id,args:JSON.parse(e.function.arguments),name:e.function.name,type:"tool_call"}:e}function fk(e){return typeof e=="object"&&e!=null&&e.lc===1&&Array.isArray(e.id)&&e.kwargs!=null&&typeof e.kwargs=="object"}function Zp(e){let t,n;if(fk(e)){const r=e.id.at(-1);r==="HumanMessage"||r==="HumanMessageChunk"?t="user":r==="AIMessage"||r==="AIMessageChunk"?t="assistant":r==="SystemMessage"||r==="SystemMessageChunk"?t="system":r==="FunctionMessage"||r==="FunctionMessageChunk"?t="function":r==="ToolMessage"||r==="ToolMessageChunk"?t="tool":t="unknown",n=e.kwargs}else{const{type:r,...s}=e;t=r,n=s}if(t==="human"||t==="user")return new Gs(n);if(t==="ai"||t==="assistant"){const{tool_calls:r,...s}=n;if(!Array.isArray(r))return new ga(n);const o=r.map(ck);return new ga({...s,tool_calls:o})}else{if(t==="system")return new Qi(n);if(t==="developer")return new Qi({...n,additional_kwargs:{...n.additional_kwargs,__openai_role__:"developer"}});if(t==="tool"&&"tool_call_id"in n)return new d_({...n,content:n.content,tool_call_id:n.tool_call_id,name:n.name});if(t==="remove"&&"id"in n&&typeof n.id=="string")return new lk({...n,id:n.id});throw v1(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(e,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Zc(e){if(typeof e=="string")return new Gs(e);if(f_(e))return e;if(Array.isArray(e)){const[t,n]=e;return Zp({type:t,content:n})}else if(PI(e)){const{role:t,...n}=e;return Zp({...n,type:t})}else return Zp(e)}function A1(e,t="Human",n="AI"){const r=[];for(const s of e){let o;if(s.type==="human")o=t;else if(s.type==="ai")o=n;else if(s.type==="system")o="System";else if(s.type==="tool")o="Tool";else if(s.type==="generic")o=s.role;else throw new Error(`Got unsupported message type: ${s.type}`);const u=s.name?`${s.name}, `:"",f=s.text;let d=`${o}: ${u}${f}`;if(s.type==="ai"){const h=s;h.tool_calls&&h.tool_calls.length>0?d+=JSON.stringify(h.tool_calls):h.additional_kwargs&&"function_call"in h.additional_kwargs&&(d+=JSON.stringify(h.additional_kwargs.function_call))}r.push(d)}return r.join(`
`)}function dk(e){const t=e._getType();if(t==="human")return new O1({...e});if(t==="ai"){let n={...e};return"tool_calls"in n&&(n={...n,tool_call_chunks:n.tool_calls?.map(r=>({...r,type:"tool_call_chunk",index:void 0,args:JSON.stringify(r.args)}))}),new Vs({...n})}else{if(t==="system")return new mg({...e});if(t==="function")return new x1({...e});if(g_.isInstance(e))return new T1({...e});throw new Error("Unknown message type.")}}function hk(e){const t=e.reduce((s,o)=>{const u=s.findIndex(([f])=>"id"in o&&o.id&&"index"in o&&o.index!==void 0?o.id===f.id&&o.index===f.index:"id"in o&&o.id?o.id===f.id:"index"in o&&o.index!==void 0?o.index===f.index:!1);return u!==-1?s[u].push(o):s.push([o]),s},[]),n=[],r=[];for(const s of t){let o=null;const u=s[0]?.name??"",f=s.map(m=>m.args||"").join("").trim(),d=f.length?f:"{}",h=s[0]?.id;try{if(o=m_(d),!h||o===null||typeof o!="object"||Array.isArray(o))throw new Error("Malformed tool call chunk args.");n.push({name:u,args:o,id:h,type:"tool_call"})}catch{r.push({name:u,args:d,id:h,error:"Malformed args.",type:"invalid_tool_call"})}}return{tool_call_chunks:e,tool_calls:n,invalid_tool_calls:r}}var ga=class extends Fs{type="ai";tool_calls=[];invalid_tool_calls=[];usage_metadata;get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e){let t;if(typeof e=="string"||Array.isArray(e))t={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:{}};else{t=e;const n=t.additional_kwargs?.tool_calls,r=t.tool_calls;n!=null&&n.length>0&&(r===void 0||r.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `pnpm install @langchain/anthropic`,","pnpm install @langchain/openai`, etc."].join(" "));try{if(n!=null&&r===void 0){const[s,o]=GI(n);t.tool_calls=s??[],t.invalid_tool_calls=o??[]}else t.tool_calls=t.tool_calls??[],t.invalid_tool_calls=t.invalid_tool_calls??[]}catch{t.tool_calls=[],t.invalid_tool_calls=[]}if(t.response_metadata!==void 0&&"output_version"in t.response_metadata&&t.response_metadata.output_version==="v1"&&(t.contentBlocks=t.content,t.content=void 0),t.contentBlocks!==void 0){t.tool_calls&&t.contentBlocks.push(...t.tool_calls.map(o=>({type:"tool_call",id:o.id,name:o.name,args:o.args})));const s=t.contentBlocks.filter(o=>o.type==="tool_call").filter(o=>!t.tool_calls?.some(u=>u.id===o.id&&u.name===o.name));s.length>0&&(t.tool_calls=s.map(o=>({type:"tool_call",id:o.id,name:o.name,args:o.args})))}}super(t),typeof t!="string"&&(this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=t.usage_metadata}static lc_name(){return"AIMessage"}get contentBlocks(){if(this.response_metadata&&"output_version"in this.response_metadata&&this.response_metadata.output_version==="v1")return this.content;if(this.response_metadata&&"model_provider"in this.response_metadata&&typeof this.response_metadata.model_provider=="string"){const t=_1(this.response_metadata.model_provider);if(t)return t.translateContent(this)}const e=super.contentBlocks;if(this.tool_calls){const t=this.tool_calls.filter(n=>!e.some(r=>r.id===n.id&&r.name===n.name));e.push(...t.map(n=>({type:"tool_call",id:n.id,name:n.name,args:n.args})))}return e}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}static isInstance(e){return super.isInstance(e)&&e.type==="ai"}};function __(e){return e._getType()==="ai"}function qw(e){return e._getType()==="ai"}var Vs=class extends Hs{type="ai";tool_calls=[];invalid_tool_calls=[];tool_call_chunks=[];usage_metadata;constructor(e){let t;if(typeof e=="string"||Array.isArray(e))t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0||e.tool_call_chunks.length===0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const n=hk(e.tool_call_chunks??[]);t={...e,tool_call_chunks:n.tool_call_chunks,tool_calls:n.tool_calls,invalid_tool_calls:n.invalid_tool_calls,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}get contentBlocks(){if(this.response_metadata&&"output_version"in this.response_metadata&&this.response_metadata.output_version==="v1")return this.content;if(this.response_metadata&&"model_provider"in this.response_metadata&&typeof this.response_metadata.model_provider=="string"){const t=_1(this.response_metadata.model_provider);if(t)return t.translateContent(this)}const e=super.contentBlocks;if(this.tool_calls&&typeof this.content!="string"){const t=this.content.filter(n=>n.type==="tool_call").map(n=>n.id);for(const n of this.tool_calls)n.id&&!t.includes(n.id)&&e.push({...n,type:"tool_call",id:n.id,name:n.name,args:n.args})}return e}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const t={content:ts(this.content,e.content),additional_kwargs:pn(this.additional_kwargs,e.additional_kwargs),response_metadata:ZI(this.response_metadata,e.response_metadata),tool_call_chunks:[],tool_calls:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const r=Il(this.tool_call_chunks,e.tool_call_chunks);r!==void 0&&r.length>0&&(t.tool_call_chunks=r)}if(this.tool_calls!==void 0||e.tool_calls!==void 0){const r=Il(this.tool_calls,e.tool_calls);r!==void 0&&r.length>0&&(t.tool_calls=r)}(this.usage_metadata!==void 0||e.usage_metadata!==void 0)&&(t.usage_metadata=g1(this.usage_metadata,e.usage_metadata));const n=this.constructor;return new n(t)}static isInstance(e){return super.isInstance(e)&&e.type==="ai"}};const C1=Symbol.for("ls:tracing_async_local_storage"),qc=Symbol.for("lc:context_variables"),pk=e=>{globalThis[C1]=e},kl=()=>globalThis[C1];var mk={};const gk=()=>typeof window<"u"&&typeof window.document<"u",_k=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",yk=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),y_=()=>typeof Deno<"u",vk=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!y_(),R1=()=>{let e;return gk()?e="browser":vk()?e="node":_k()?e="webworker":yk()?e="jsdom":y_()?e="deno":e="other",e};let qp;function bk(){return qp===void 0&&(qp={library:"langchain-js",runtime:R1()}),qp}function ha(e){try{return typeof process<"u"?mk?.[e]:y_()?Deno?.env.get(e):void 0}catch{return}}const wk=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Tl(e){return typeof e=="string"&&wk.test(e)}function Sk(e){if(!Tl(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=t&255,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=t&255,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=t&255,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=t&255,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=t&255,n}var Kt=[];for(var Fp=0;Fp<256;++Fp)Kt.push((Fp+256).toString(16).slice(1));function v_(e,t=0){return(Kt[e[t+0]]+Kt[e[t+1]]+Kt[e[t+2]]+Kt[e[t+3]]+"-"+Kt[e[t+4]]+Kt[e[t+5]]+"-"+Kt[e[t+6]]+Kt[e[t+7]]+"-"+Kt[e[t+8]]+Kt[e[t+9]]+"-"+Kt[e[t+10]]+Kt[e[t+11]]+Kt[e[t+12]]+Kt[e[t+13]]+Kt[e[t+14]]+Kt[e[t+15]]).toLowerCase()}var mc,Ek=new Uint8Array(16);function N1(){if(!mc&&(mc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!mc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return mc(Ek)}function Tk(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}var xk="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Ok="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Ak(e,t,n){function r(s,o,u,f){var d;if(typeof s=="string"&&(s=Tk(s)),typeof o=="string"&&(o=Sk(o)),((d=o)===null||d===void 0?void 0:d.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var h=new Uint8Array(16+s.length);if(h.set(o),h.set(s,o.length),h=n(h),h[6]=h[6]&15|t,h[8]=h[8]&63|128,u){f=f||0;for(var m=0;m<16;++m)u[f+m]=h[m];return u}return v_(h)}try{r.name=e}catch{}return r.DNS=xk,r.URL=Ok,r}var Ck=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Fw={randomUUID:Ck};function Ms(e,t,n){if(Fw.randomUUID&&!e)return Fw.randomUUID();e=e||{};var r=e.random||(e.rng||N1)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,v_(r)}function Rk(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function Hp(e,t){return e<<t|e>>>32-t}function Nk(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){var r=unescape(encodeURIComponent(e));e=[];for(var s=0;s<r.length;++s)e.push(r.charCodeAt(s))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,u=Math.ceil(o/16),f=new Array(u),d=0;d<u;++d){for(var h=new Uint32Array(16),m=0;m<16;++m)h[m]=e[d*64+m*4]<<24|e[d*64+m*4+1]<<16|e[d*64+m*4+2]<<8|e[d*64+m*4+3];f[d]=h}f[u-1][14]=(e.length-1)*8/Math.pow(2,32),f[u-1][14]=Math.floor(f[u-1][14]),f[u-1][15]=(e.length-1)*8&4294967295;for(var _=0;_<u;++_){for(var y=new Uint32Array(80),v=0;v<16;++v)y[v]=f[_][v];for(var w=16;w<80;++w)y[w]=Hp(y[w-3]^y[w-8]^y[w-14]^y[w-16],1);for(var x=n[0],R=n[1],E=n[2],A=n[3],N=n[4],M=0;M<80;++M){var B=Math.floor(M/20),Y=Hp(x,5)+Rk(B,R,E,A)+N+t[B]+y[M]>>>0;N=A,A=E,E=Hp(R,30)>>>0,R=x,x=Y}n[0]=n[0]+x>>>0,n[1]=n[1]+R>>>0,n[2]=n[2]+E>>>0,n[3]=n[3]+A>>>0,n[4]=n[4]+N>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var Ik=Ak("v5",80,Nk),Hw=null,Gw=null,mr=0;function Ja(e,t,n){e=e||{};var r=0,s=new Uint8Array(16),o=e.random||(e.rng||N1)(),u=e.msecs!==void 0?e.msecs:Date.now(),f=e.seq!==void 0?e.seq:null,d=Gw,h=Hw;return u>mr&&e.msecs===void 0&&(mr=u,f!==null&&(d=null,h=null)),f!==null&&(f>2147483647&&(f=2147483647),d=f>>>19&4095,h=f&524287),(d===null||h===null)&&(d=o[6]&127,d=d<<8|o[7],h=o[8]&63,h=h<<8|o[9],h=h<<5|o[10]>>>3),u+1e4>mr&&f===null?++h>524287&&(h=0,++d>4095&&(d=0,mr++)):mr=u,Gw=d,Hw=h,s[r++]=mr/1099511627776&255,s[r++]=mr/4294967296&255,s[r++]=mr/16777216&255,s[r++]=mr/65536&255,s[r++]=mr/256&255,s[r++]=mr&255,s[r++]=d>>>4&15|112,s[r++]=d&255,s[r++]=h>>>13&63|128,s[r++]=h>>>5&255,s[r++]=h<<3&255|o[10]&7,s[r++]=o[11],s[r++]=o[12],s[r++]=o[13],s[r++]=o[14],s[r++]=o[15],v_(s)}var kk=class{};function $k(e){return"lc_prefer_streaming"in e&&e.lc_prefer_streaming}var Hf=class extends kk{lc_serializable=!1;get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,c1(this.constructor)]}lc_kwargs;ignoreLLM=!1;ignoreChain=!1;ignoreAgent=!1;ignoreRetriever=!1;ignoreCustomEvent=!1;raiseError=!1;awaitHandlers=ha("LANGCHAIN_CALLBACKS_BACKGROUND")==="false";constructor(e){super(),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Nl.prototype.toJSON.call(this)}toJSONNotImplemented(){return Nl.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends Hf{name=Ja();constructor(){super(),Object.assign(this,e)}}return new t}};const Mk=e=>{const t=e;return t!==void 0&&typeof t.copy=="function"&&typeof t.name=="string"&&typeof t.awaitHandlers=="boolean"},jk="gen_ai.operation.name",Lk="gen_ai.system",Vw="gen_ai.request.model",zk="gen_ai.response.model",Jw="gen_ai.usage.input_tokens",Xw="gen_ai.usage.output_tokens",Yw="gen_ai.usage.total_tokens",Dk="gen_ai.request.max_tokens",Uk="gen_ai.request.temperature",Pk="gen_ai.request.top_p",Bk="gen_ai.request.frequency_penalty",Zk="gen_ai.request.presence_penalty",qk="gen_ai.response.finish_reasons",Fk="gen_ai.prompt",Hk="gen_ai.completion",Gk="gen_ai.request.extra_query",Vk="gen_ai.request.extra_body",Jk="gen_ai.serialized.name",Xk="gen_ai.serialized.signature",Yk="gen_ai.serialized.doc",Qk="gen_ai.response.id",Kk="gen_ai.response.service_tier",Wk="gen_ai.response.system_fingerprint",e2="gen_ai.usage.input_token_details",t2="gen_ai.usage.output_token_details",n2="langsmith.trace.session_id",r2="langsmith.trace.session_name",a2="langsmith.span.kind",s2="langsmith.trace.name",i2="langsmith.metadata",Qw="langsmith.span.tags",o2="langsmith.request.streaming",l2="langsmith.request.headers",u2=(...e)=>fetch(...e),I1=Symbol.for("ls:fetch_implementation"),c2=()=>globalThis[I1]===void 0,f2=e=>async(...t)=>{if(e||dn("DEBUG")==="true"){const[r,s]=t;console.log(` ${s?.method||"GET"} ${r}`)}const n=await(globalThis[I1]??u2)(...t);return(e||dn("DEBUG")==="true")&&console.log(` ${n.status} ${n.statusText} ${n.url}`),n},k1=()=>dn("PROJECT")??Ur("LANGCHAIN_SESSION")??"default",Kw={};function Fc(e){Kw[e]||(console.warn(e),Kw[e]=!0)}const re=e=>BigInt(e),$1=re("0x9E3779B1"),M1=re("0x85EBCA77"),d2=re("0xC2B2AE3D"),ns=re("0x9E3779B185EBCA87"),Zs=re("0xC2B2AE3D27D4EB4F"),j1=re("0x165667B19E3779F9"),b_=re("0x85EBCA77C2B2AE63"),h2=re("0x27D4EB2F165667C5"),p2=re("0x165667919E3779F9"),m2=re("0x9FB21C651E98DF25");function g2(e){const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.substring(n,n+2),16);return t}const jr=g2("b8fe6c3923a44bbe7c01812cf721ad1cded46de9839097db7240a4a4b7b3671fcb79e64eccc0e578825ad07dccff7221b8084674f743248ee03590e6813a264c3c2852bb91c300cb88d0658b1b532ea371644897a20df94e3819ef46a9deacd8a8fa763fe39c343ff9dcbbc7c70b4f1d8a51e04bcdb45931c89f7ec9d9787364eac5ac8334d3ebc3c581a0fffa1363eb170ddd51b7f0da49d316552629d4689e2b16be587d47a1fc8ff8b8d17ad031ce45cb3a8f95160428afd7fbcabb4b407e"),Xi=(re(1)<<re(128))-re(1),De=(re(1)<<re(64))-re(1),sf=(re(1)<<re(32))-re(1),fa=64,L1=fa/8,_2=8,gc=4;function ht(e,t=0){return new Uint8Array(e.buffer,e.byteOffset+t,e.length-t)}function _t(e,t=0){return new DataView(e.buffer,e.byteOffset+t).getBigUint64(0,!0)}function qi(e,t=0){return new DataView(e.buffer,e.byteOffset+t).getUint32(0,!0)}function Gp(e,t=0){return e[t]}const y2=e=>(e&re(255))<<re(56)|(e&re(65280))<<re(40)|(e&re(16711680))<<re(24)|(e&re(4278190080))<<re(8)|(e&re(0xff00000000))>>re(8)|(e&re(0xff0000000000))>>re(24)|(e&re(0xff000000000000))>>re(40)|(e&re(0xff00000000000000))>>re(56),v2=e=>(e=(e&re(65535))<<re(16)|(e&re(4294901760))>>re(16),e=(e&re(16711935))<<re(8)|(e&re(4278255360))>>re(8),e),b2=(e,t)=>(e&sf)*(t&sf)&De,Ki=e=>{if(!e)throw new Error("Assert failed")};function w2(e,t){return(e<<t|e>>re(32)-t)&sf}function z1(e,t,n){for(let r=0;r<L1;r++){const s=_t(t,r*8),o=s^_t(n,r*8);e[r^1]+=s,e[r]+=b2(o,o>>re(32))}return e}function Ww(e,t,n,r){for(let s=0;s<r;s++)z1(e,ht(t,s*fa),ht(n,s*8));return e}function S2(e,t){for(let n=0;n<L1;n++){const r=_t(t,n*8);let s=e[n];s=gg(s,re(47)),s^=r,s*=$1,e[n]=s&De}return e}function _c(e,t){return D1(e[0]^_t(t,0),e[1]^_t(t,_2))}function eS(e,t,n){let r=n;return r+=_c(e.slice(0),ht(t,0*gc)),r+=_c(e.slice(2),ht(t,4*gc)),r+=_c(e.slice(4),ht(t,8*gc)),r+=_c(e.slice(6),ht(t,12*gc)),zr(r&De)}function E2(e,t,n,r,s){const o=Math.floor((n.byteLength-fa)/8),u=fa*o,f=Math.floor((t.byteLength-1)/u);for(let d=0;d<f;d++)e=Ww(e,ht(t,d*u),n,o),e=s(e,ht(n,n.byteLength-fa));{const d=Math.floor((t.byteLength-1-u*f)/fa);e=Ww(e,ht(t,f*u),n,d),e=r(e,ht(t,t.byteLength-fa),ht(n,n.byteLength-fa-7))}return e}function T2(e,t,n){let r=new BigUint64Array([d2,ns,Zs,j1,b_,M1,h2,$1]);Ki(e.length>128),r=E2(r,e,t,z1,S2),Ki(r.length*8==64);{const s=eS(r,ht(t,11),re(e.byteLength)*ns&De);return eS(r,ht(t,t.byteLength-fa-11),~(re(e.byteLength)*Zs)&De)<<re(64)|s}}function D1(e,t){const n=e*t&Xi;return n&De^n>>re(64)}function tS(e,t,n){return D1((_t(e,0)^_t(t,0)+n)&De,(_t(e,8)^_t(t,8)-n)&De)}function Hc(e,t,n,r,s){let o=e&De,u=e>>re(64)&De;return o+=tS(t,r,s),o^=_t(n,0)+_t(n,8),o&=De,u+=tS(n,ht(r,16),s),u^=_t(t,0)+_t(t,8),u&=De,u<<re(64)|o}function zr(e){return e^=e>>re(37),e*=p2,e&=De,e^=e>>re(32),e}function of(e){return e^=e>>re(33),e*=Zs,e&=De,e^=e>>re(29),e*=j1,e&=De,e^=e>>re(32),e}function x2(e,t,n){const r=e.byteLength;Ki(r>0&&r<=3);const s=re(Gp(e,r-1))|re(r<<8)|re(Gp(e,0)<<16)|re(Gp(e,r>>1)<<24),o=(re(qi(t,0))^re(qi(t,4)))+n,u=(s^o)&De,f=(re(qi(t,8))^re(qi(t,12)))-n,d=(w2(v2(s),re(13))^f)&De;return(of(d)&De)<<re(64)|of(u)}function gg(e,t){return e^e>>t}function O2(e,t,n){const r=e.byteLength;Ki(r>=4&&r<=8);{const s=qi(e,0),o=qi(e,r-4),u=re(s)|re(o)<<re(32),f=(_t(t,16)^_t(t,24))+n&De;let h=(u^f)*(ns+(re(r)<<re(2)))&Xi;return h+=(h&De)<<re(65),h&=Xi,h^=h>>re(67),gg(gg(h&De,re(35))*m2&De,re(28))|zr(h>>re(64))<<re(64)}}function A2(e,t,n){const r=e.byteLength;Ki(r>=9&&r<=16);{const s=(_t(t,32)^_t(t,40))+n&De,o=(_t(t,48)^_t(t,56))-n&De,u=_t(e);let f=_t(e,r-8),d=(u^f^s)*ns;const h=(d&De)+(re(r-1)<<re(54));d=d&(Xi^De)|h,f^=o,d+=f+(f&sf)*(M1-re(1))<<re(64),d&=Xi,d^=y2(d>>re(64));let m=(d&De)*Zs;return m+=(d>>re(64))*Zs<<re(64),m&=Xi,zr(m&De)|zr(m>>re(64))<<re(64)}}function C2(e,t){const n=e.byteLength;return Ki(n<=16),n>8?A2(e,jr,t):n>=4?O2(e,jr,t):n>0?x2(e,jr,t):of(t^_t(jr,64)^_t(jr,72))|of(t^_t(jr,80)^_t(jr,88))<<re(64)}function _g(e){return~e+re(1)&De}function R2(e,t,n){let r=re(e.byteLength)*ns&De,s=re(e.byteLength-1)/re(32);for(;s>=0;){const f=Number(s);r=Hc(r,ht(e,16*f),ht(e,e.byteLength-16*(f+1)),ht(t,32*f),n),s--}let o=r+(r>>re(64))&De;o=zr(o);let u=(r&De)*ns+(r>>re(64))*b_+(re(e.byteLength)-n&De)*Zs;return u&=De,u=_g(zr(u)),o|u<<re(64)}function N2(e,t,n){let r=re(e.byteLength)*ns&De;for(let u=32;u<160;u+=32)r=Hc(r,ht(e,u-32),ht(e,u-16),ht(t,u-32),n);r=zr(r&De)|zr(r>>re(64))<<re(64);for(let u=160;u<=e.byteLength;u+=32)r=Hc(r,ht(e,u-32),ht(e,u-16),ht(t,3+u-160),n);r=Hc(r,ht(e,e.byteLength-16),ht(e,e.byteLength-32),ht(t,103),_g(n));let s=r+(r>>re(64))&De;s=zr(s);let o=(r&De)*ns+(r>>re(64))*b_+(re(e.byteLength)-n&De)*Zs;return o&=De,o=_g(zr(o)),s|o<<re(64)}function I2(e,t=re(0)){const n=e.byteLength;return n<=16?C2(e,t):n<=128?R2(e,jr,t):n<=240?N2(e,jr,t):T2(e,jr)}function k2(e){const t=new Uint8Array(16),n=new DataView(t.buffer),r=e&De,s=e>>re(64);return n.setBigUint64(0,s,!1),n.setBigUint64(8,r,!1),t}const U1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Me(e,t){if(!U1.test(e)){const n=t!==void 0?`Invalid UUID for ${t}: ${e}`:`Invalid UUID: ${e}`;throw new Error(n)}return e}function $2(e){const t=typeof e=="string"?Date.parse(e):e;return Ja({msecs:t,seq:0})}function M2(e){if(!U1.test(e))return null;const t=e[14];return parseInt(t,16)}function j2(e){const t=e.replace(/-/g,""),n=new Uint8Array(16);for(let r=0;r<16;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}function L2(e){const t=Array.from(e).map(n=>n.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`}const z2=new TextEncoder;function D2(e){const t=z2.encode(e),n=I2(t);return k2(n)}function yc(e,t){const n=`${e}:${t}`,r=D2(n),s=new Uint8Array(16);if(M2(e)===7){const u=j2(e);s.set(u.slice(0,6),0)}else{const u=Date.now();s[0]=u/1099511627776&255,s[1]=u/4294967296&255,s[2]=u/16777216&255,s[3]=u/65536&255,s[4]=u/256&255,s[5]=u&255}return s[6]=112|r[0]&15,s[7]=r[1],s[8]=128|r[2]&63,s.set(r.slice(3,10),9),L2(s)}function U2(e,t){throw new Error("dump() is not supported in browser environments.")}function P2(e){throw new Error("load() is not supported in browser environments.")}function B2(e,t){return t===null?!1:Date.now()-e.createdAt>t*1e3}class Z2{constructor(t={}){Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ttlSeconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"refreshIntervalSeconds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"refreshTimer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_metrics",{enumerable:!0,configurable:!0,writable:!0,value:{hits:0,misses:0,refreshes:0,refreshErrors:0}}),this.configure(t)}get metrics(){return{...this._metrics}}get totalRequests(){return this._metrics.hits+this._metrics.misses}get hitRate(){const t=this.totalRequests;return t>0?this._metrics.hits/t:0}resetMetrics(){this._metrics={hits:0,misses:0,refreshes:0,refreshErrors:0}}get(t,n){if(this.maxSize===0)return;const r=this.cache.get(t);if(!r){this._metrics.misses+=1;return}return this.cache.delete(t),this.cache.set(t,{...r,refreshFunc:n}),this._metrics.hits+=1,r.value}set(t,n,r){if(this.maxSize===0)return;if(this.refreshTimer===void 0&&this.startRefreshLoop(),!this.cache.has(t)&&this.cache.size>=this.maxSize){const o=this.cache.keys().next().value;o!==void 0&&this.cache.delete(o)}const s={value:n,createdAt:Date.now(),refreshFunc:r};this.cache.delete(t),this.cache.set(t,s)}invalidate(t){this.cache.delete(t)}clear(){this.cache.clear()}get size(){return this.cache.size}stop(){this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=void 0)}dump(t){for(const[n,r]of this.cache.entries())r.value;U2()}load(t){const n=P2();if(!n)return 0;let r=0;const s=Date.now();for(const[o,u]of Object.entries(n)){if(this.cache.size>=this.maxSize)break;const f={value:u,createdAt:s};this.cache.set(o,f),r+=1}return r}startRefreshLoop(){this.stop(),this.ttlSeconds!==null&&(this.refreshTimer=setInterval(()=>{this.refreshStaleEntries().catch(t=>{console.warn("Unexpected error in cache refresh loop:",t)})},this.refreshIntervalSeconds*1e3),this.refreshTimer.unref&&this.refreshTimer.unref())}getStaleEntries(){const t=[];for(const[n,r]of this.cache.entries())B2(r,this.ttlSeconds)&&t.push([n,r]);return t}async refreshStaleEntries(){const t=this.getStaleEntries();if(t.length!==0){for(const[n,r]of t)if(r.refreshFunc!==void 0)try{const s=await r.refreshFunc();this.set(n,s,r.refreshFunc),this._metrics.refreshes+=1}catch(s){this._metrics.refreshErrors+=1,console.warn(`Failed to refresh cache entry ${n}:`,s)}}}configure(t){this.stop(),this.refreshIntervalSeconds=t.refreshIntervalSeconds??60,this.maxSize=t.maxSize??100,this.ttlSeconds=t.ttlSeconds??300}}const nS=new Z2,P1="0.5.6";var yg={};let $r;const q2=()=>typeof window<"u"&&typeof window.document<"u",F2=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",H2=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),B1=()=>typeof Deno<"u",G2=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!B1(),Z1=()=>$r||(typeof Bun<"u"?$r="bun":q2()?$r="browser":G2()?$r="node":F2()?$r="webworker":H2()?$r="jsdom":B1()?$r="deno":$r="other",$r);let Vp;function q1(){if(Vp===void 0){const e=Z1(),t=J2();Vp={library:"langsmith",runtime:e,sdk:"langsmith-js",sdk_version:P1,...t}}return Vp}function F1(){const e=V2(),t={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,s]of Object.entries(e))typeof s=="string"&&!n.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?t.revision_id=s:t[r]=s);return t}function V2(){const e={};try{if(typeof process<"u"&&yg)for(const[t,n]of Object.entries(yg))(t.startsWith("LANGCHAIN_")||t.startsWith("LANGSMITH_"))&&n!=null&&((t.toLowerCase().includes("key")||t.toLowerCase().includes("secret")||t.toLowerCase().includes("token"))&&typeof n=="string"?e[t]=n.slice(0,2)+"*".repeat(n.length-4)+n.slice(-2):e[t]=n)}catch{}return e}function Ur(e){try{return typeof process<"u"?yg?.[e]:void 0}catch{return}}function dn(e){return Ur(`LANGSMITH_${e}`)||Ur(`LANGCHAIN_${e}`)}let Jp;function J2(){if(Jp!==void 0)return Jp;const e=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],t={};for(const n of e){const r=Ur(n);r!==void 0&&(t[n]=r)}return Jp=t,t}function H1(){return Ur("OTEL_ENABLED")==="true"||dn("OTEL_ENABLED")==="true"}class X2{constructor(){Object.defineProperty(this,"hasWarned",{enumerable:!0,configurable:!0,writable:!0,value:!1})}startActiveSpan(t,...n){!this.hasWarned&&H1()&&(console.warn('You have enabled OTEL export via the `OTEL_ENABLED` or `LANGSMITH_OTEL_ENABLED` environment variable, but have not initialized the required OTEL instances. Please add:\n```\nimport { initializeOTEL } from "langsmith/experimental/otel/setup";\ninitializeOTEL();\n```\nat the beginning of your code.'),this.hasWarned=!0);let r;if(n.length===1&&typeof n[0]=="function"?r=n[0]:n.length===2&&typeof n[1]=="function"?r=n[1]:n.length===3&&typeof n[2]=="function"&&(r=n[2]),typeof r=="function")return r()}}class Y2{constructor(){Object.defineProperty(this,"mockTracer",{enumerable:!0,configurable:!0,writable:!0,value:new X2})}getTracer(t,n){return this.mockTracer}getActiveSpan(){}setSpan(t,n){return t}getSpan(t){}setSpanContext(t,n){return t}getTracerProvider(){}setGlobalTracerProvider(t){return!1}}class Q2{active(){return{}}with(t,n){return n()}}const Xp=Symbol.for("ls:otel_trace"),Yp=Symbol.for("ls:otel_context"),rS=Symbol.for("ls:otel_get_default_otlp_tracer_provider"),K2=new Y2,W2=new Q2;class e${getTraceInstance(){return globalThis[Xp]??K2}getContextInstance(){return globalThis[Yp]??W2}initializeGlobalInstances(t){globalThis[Xp]===void 0&&(globalThis[Xp]=t.trace),globalThis[Yp]===void 0&&(globalThis[Yp]=t.context)}setDefaultOTLPTracerComponents(t){globalThis[rS]=t}getDefaultOTLPTracerComponents(){return globalThis[rS]??void 0}}const w_=new e$;function G1(){return w_.getTraceInstance()}function t$(){return w_.getContextInstance()}function n$(){return w_.getDefaultOTLPTracerComponents()}const r$={llm:"chat",tool:"execute_tool",retriever:"embeddings",embedding:"embeddings",prompt:"chat"};function a$(e){return r$[e]||e}class s${constructor(){Object.defineProperty(this,"spans",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}exportBatch(t,n){for(const r of t)try{if(!r.run)continue;if(r.operation==="post"){const s=this.createSpanForRun(r,r.run,n.get(r.id));s&&!r.run.end_time&&this.spans.set(r.id,s)}else this.updateSpanForRun(r,r.run)}catch(s){console.error(`Error processing operation ${r.id}:`,s)}}createSpanForRun(t,n,r){const s=r&&G1().getSpan(r);if(s)try{return this.finishSpanSetup(s,n,t)}catch(o){console.error(`Failed to create span for run ${t.id}:`,o);return}}finishSpanSetup(t,n,r){return this.setSpanAttributes(t,n,r),n.error?(t.setStatus({code:2}),t.recordException(new Error(n.error))):t.setStatus({code:1}),n.end_time&&t.end(new Date(n.end_time)),t}updateSpanForRun(t,n){try{const r=this.spans.get(t.id);if(!r){console.debug(`No span found for run ${t.id} during update`);return}this.setSpanAttributes(r,n,t),n.error?(r.setStatus({code:2}),r.recordException(new Error(n.error))):r.setStatus({code:1});const s=n.end_time;s&&(r.end(new Date(s)),this.spans.delete(t.id))}catch(r){console.error(`Failed to update span for run ${t.id}:`,r)}}extractModelName(t){if(t.extra?.metadata){const n=t.extra.metadata;if(n.ls_model_name)return n.ls_model_name;if(n.invocation_params){const r=n.invocation_params;if(r.model)return r.model;if(r.model_name)return r.model_name}}}setSpanAttributes(t,n,r){if("run_type"in n&&n.run_type){t.setAttribute(a2,n.run_type);const f=a$(n.run_type||"chain");t.setAttribute(jk,f)}"name"in n&&n.name&&t.setAttribute(s2,n.name),"session_id"in n&&n.session_id&&t.setAttribute(n2,n.session_id),"session_name"in n&&n.session_name&&t.setAttribute(r2,n.session_name),this.setGenAiSystem(t,n);const s=this.extractModelName(n);s&&t.setAttribute(Vw,s),"prompt_tokens"in n&&typeof n.prompt_tokens=="number"&&t.setAttribute(Jw,n.prompt_tokens),"completion_tokens"in n&&typeof n.completion_tokens=="number"&&t.setAttribute(Xw,n.completion_tokens),"total_tokens"in n&&typeof n.total_tokens=="number"&&t.setAttribute(Yw,n.total_tokens),this.setInvocationParameters(t,n);const o=n.extra?.metadata||{};for(const[f,d]of Object.entries(o))d!=null&&t.setAttribute(`${i2}.${f}`,String(d));const u=n.tags;if(u&&Array.isArray(u)?t.setAttribute(Qw,u.join(", ")):u&&t.setAttribute(Qw,String(u)),"serialized"in n&&typeof n.serialized=="object"){const f=n.serialized;f.name&&t.setAttribute(Jk,String(f.name)),f.signature&&t.setAttribute(Xk,String(f.signature)),f.doc&&t.setAttribute(Yk,String(f.doc))}this.setIOAttributes(t,r)}setGenAiSystem(t,n){let r="langchain";const s=this.extractModelName(n);if(s){const o=s.toLowerCase();o.includes("anthropic")||o.startsWith("claude")?r="anthropic":o.includes("bedrock")?r="aws.bedrock":o.includes("azure")&&o.includes("openai")?r="az.ai.openai":o.includes("azure")&&o.includes("inference")?r="az.ai.inference":o.includes("cohere")?r="cohere":o.includes("deepseek")?r="deepseek":o.includes("gemini")?r="gemini":o.includes("groq")?r="groq":o.includes("watson")||o.includes("ibm")?r="ibm.watsonx.ai":o.includes("mistral")?r="mistral_ai":o.includes("gpt")||o.includes("openai")?r="openai":o.includes("perplexity")||o.includes("sonar")?r="perplexity":o.includes("vertex")?r="vertex_ai":(o.includes("xai")||o.includes("grok"))&&(r="xai")}t.setAttribute(Lk,r)}setInvocationParameters(t,n){if(!n.extra?.metadata?.invocation_params)return;const r=n.extra.metadata.invocation_params;r.max_tokens!==void 0&&t.setAttribute(Dk,r.max_tokens),r.temperature!==void 0&&t.setAttribute(Uk,r.temperature),r.top_p!==void 0&&t.setAttribute(Pk,r.top_p),r.frequency_penalty!==void 0&&t.setAttribute(Bk,r.frequency_penalty),r.presence_penalty!==void 0&&t.setAttribute(Zk,r.presence_penalty)}setIOAttributes(t,n){if(n.run.inputs)try{const r=n.run.inputs;typeof r=="object"&&r!==null&&(r.model&&Array.isArray(r.messages)&&t.setAttribute(Vw,r.model),r.stream!==void 0&&t.setAttribute(o2,r.stream),r.extra_headers&&t.setAttribute(l2,JSON.stringify(r.extra_headers)),r.extra_query&&t.setAttribute(Gk,JSON.stringify(r.extra_query)),r.extra_body&&t.setAttribute(Vk,JSON.stringify(r.extra_body))),t.setAttribute(Fk,JSON.stringify(r))}catch(r){console.debug(`Failed to process inputs for run ${n.id}`,r)}if(n.run.outputs)try{const r=n.run.outputs,s=this.getUnifiedRunTokens(r);if(s&&(t.setAttribute(Jw,s[0]),t.setAttribute(Xw,s[1]),t.setAttribute(Yw,s[0]+s[1])),r&&typeof r=="object"){if(r.model&&t.setAttribute(zk,String(r.model)),r.id&&t.setAttribute(Qk,r.id),r.choices&&Array.isArray(r.choices)){const o=r.choices.map(u=>u.finish_reason).filter(u=>u).map(String);o.length>0&&t.setAttribute(qk,o.join(", "))}if(r.service_tier&&t.setAttribute(Kk,r.service_tier),r.system_fingerprint&&t.setAttribute(Wk,r.system_fingerprint),r.usage_metadata&&typeof r.usage_metadata=="object"){const o=r.usage_metadata;o.input_token_details&&t.setAttribute(e2,JSON.stringify(o.input_token_details)),o.output_token_details&&t.setAttribute(t2,JSON.stringify(o.output_token_details))}}t.setAttribute(Hk,JSON.stringify(r))}catch(r){console.debug(`Failed to process outputs for run ${n.id}`,r)}}getUnifiedRunTokens(t){if(!t)return null;let n=this.extractUnifiedRunTokens(t.usage_metadata);if(n)return n;const r=Object.keys(t);for(const u of r){const f=t[u];if(!(!f||typeof f!="object")&&(n=this.extractUnifiedRunTokens(f.usage_metadata),n||f.lc===1&&f.kwargs&&typeof f.kwargs=="object"&&(n=this.extractUnifiedRunTokens(f.kwargs.usage_metadata),n)))return n}const s=t.generations||[];if(!Array.isArray(s))return null;const o=Array.isArray(s[0])?s.flat():s;for(const u of o)if(typeof u=="object"&&u.message&&typeof u.message=="object"&&u.message.kwargs&&typeof u.message.kwargs=="object"&&(n=this.extractUnifiedRunTokens(u.message.kwargs.usage_metadata),n))return n;return null}extractUnifiedRunTokens(t){return!t||typeof t!="object"||typeof t.input_tokens!="number"||typeof t.output_tokens!="number"?null:[t.input_tokens,t.output_tokens]}}const i$=Object.prototype.toString,o$=e=>i$.call(e)==="[object Error]",l$=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function u$(e){if(!(e&&o$(e)&&e.name==="TypeError"&&typeof e.message=="string"))return!1;const{message:n,stack:r}=e;return n==="Load failed"?r===void 0||"__sentry_captured__"in e:n.startsWith("error sending request for url")?!0:l$.has(n)}function c$(e){if(typeof e=="number"){if(e<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(e))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(e!==void 0)throw new TypeError("Expected `retries` to be a number or Infinity.")}function vc(e,t,{min:n=0,allowInfinity:r=!1}={}){if(t!==void 0){if(typeof t!="number"||Number.isNaN(t))throw new TypeError(`Expected \`${e}\` to be a number${r?" or Infinity":""}.`);if(!r&&!Number.isFinite(t))throw new TypeError(`Expected \`${e}\` to be a finite number.`);if(t<n)throw new TypeError(`Expected \`${e}\` to be  ${n}.`)}}let f$=class extends Error{constructor(t){super(),t instanceof Error?(this.originalError=t,{message:t}=t):(this.originalError=new Error(t),this.originalError.stack=this.stack),this.name="AbortError",this.message=t}};function d$(e,t){const n=Math.max(1,e+1),r=t.randomize?Math.random()+1:1;let s=Math.round(r*t.minTimeout*t.factor**(n-1));return s=Math.min(s,t.maxTimeout),s}function aS(e,t){return Number.isFinite(t)?t-(performance.now()-e):t}async function h$({error:e,attemptNumber:t,retriesConsumed:n,startTime:r,options:s}){const o=e instanceof Error?e:new TypeError(`Non-error was thrown: "${e}". You should only throw errors.`);if(o instanceof f$)throw o.originalError;const u=Number.isFinite(s.retries)?Math.max(0,s.retries-n):s.retries,f=s.maxRetryTime??Number.POSITIVE_INFINITY,d=Object.freeze({error:o,attemptNumber:t,retriesLeft:u,retriesConsumed:n});if(await s.onFailedAttempt(d),aS(r,f)<=0)throw o;const h=await s.shouldConsumeRetry(d),m=aS(r,f);if(m<=0||u<=0)throw o;if(o instanceof TypeError&&!u$(o)){if(h)throw o;return s.signal?.throwIfAborted(),!1}if(!await s.shouldRetry(d))throw o;if(!h)return s.signal?.throwIfAborted(),!1;const _=d$(n,s),y=Math.min(_,m);return y>0&&await new Promise((v,w)=>{const x=()=>{clearTimeout(R),s.signal?.removeEventListener("abort",x),w(s.signal.reason)},R=setTimeout(()=>{s.signal?.removeEventListener("abort",x),v()},y);s.unref&&R.unref?.(),s.signal?.addEventListener("abort",x,{once:!0})}),s.signal?.throwIfAborted(),!0}async function p$(e,t={}){if(t={...t},c$(t.retries),Object.hasOwn(t,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");t.retries??=10,t.factor??=2,t.minTimeout??=1e3,t.maxTimeout??=Number.POSITIVE_INFINITY,t.maxRetryTime??=Number.POSITIVE_INFINITY,t.randomize??=!1,t.onFailedAttempt??=()=>{},t.shouldRetry??=()=>!0,t.shouldConsumeRetry??=()=>!0,vc("factor",t.factor,{min:0,allowInfinity:!1}),vc("minTimeout",t.minTimeout,{min:0,allowInfinity:!1}),vc("maxTimeout",t.maxTimeout,{min:0,allowInfinity:!0}),vc("maxRetryTime",t.maxRetryTime,{min:0,allowInfinity:!0}),t.factor>0||(t.factor=1),t.signal?.throwIfAborted();let n=0,r=0;const s=performance.now();for(;!Number.isFinite(t.retries)||r<=t.retries;){n++;try{t.signal?.throwIfAborted();const o=await e(n);return t.signal?.throwIfAborted(),o}catch(o){await h$({error:o,attemptNumber:n,retriesConsumed:r,startTime:s,options:t})&&r++}}throw new Error("Retry attempts exhausted without throwing an error.")}var bc={},Qp={exports:{}},sS;function m$(){return sS||(sS=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(d,h,m){this.fn=d,this.context=h,this.once=m||!1}function o(d,h,m,_,y){if(typeof m!="function")throw new TypeError("The listener must be a function");var v=new s(m,_||d,y),w=n?n+h:h;return d._events[w]?d._events[w].fn?d._events[w]=[d._events[w],v]:d._events[w].push(v):(d._events[w]=v,d._eventsCount++),d}function u(d,h){--d._eventsCount===0?d._events=new r:delete d._events[h]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var h=[],m,_;if(this._eventsCount===0)return h;for(_ in m=this._events)t.call(m,_)&&h.push(n?_.slice(1):_);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(m)):h},f.prototype.listeners=function(h){var m=n?n+h:h,_=this._events[m];if(!_)return[];if(_.fn)return[_.fn];for(var y=0,v=_.length,w=new Array(v);y<v;y++)w[y]=_[y].fn;return w},f.prototype.listenerCount=function(h){var m=n?n+h:h,_=this._events[m];return _?_.fn?1:_.length:0},f.prototype.emit=function(h,m,_,y,v,w){var x=n?n+h:h;if(!this._events[x])return!1;var R=this._events[x],E=arguments.length,A,N;if(R.fn){switch(R.once&&this.removeListener(h,R.fn,void 0,!0),E){case 1:return R.fn.call(R.context),!0;case 2:return R.fn.call(R.context,m),!0;case 3:return R.fn.call(R.context,m,_),!0;case 4:return R.fn.call(R.context,m,_,y),!0;case 5:return R.fn.call(R.context,m,_,y,v),!0;case 6:return R.fn.call(R.context,m,_,y,v,w),!0}for(N=1,A=new Array(E-1);N<E;N++)A[N-1]=arguments[N];R.fn.apply(R.context,A)}else{var M=R.length,B;for(N=0;N<M;N++)switch(R[N].once&&this.removeListener(h,R[N].fn,void 0,!0),E){case 1:R[N].fn.call(R[N].context);break;case 2:R[N].fn.call(R[N].context,m);break;case 3:R[N].fn.call(R[N].context,m,_);break;case 4:R[N].fn.call(R[N].context,m,_,y);break;default:if(!A)for(B=1,A=new Array(E-1);B<E;B++)A[B-1]=arguments[B];R[N].fn.apply(R[N].context,A)}}return!0},f.prototype.on=function(h,m,_){return o(this,h,m,_,!1)},f.prototype.once=function(h,m,_){return o(this,h,m,_,!0)},f.prototype.removeListener=function(h,m,_,y){var v=n?n+h:h;if(!this._events[v])return this;if(!m)return u(this,v),this;var w=this._events[v];if(w.fn)w.fn===m&&(!y||w.once)&&(!_||w.context===_)&&u(this,v);else{for(var x=0,R=[],E=w.length;x<E;x++)(w[x].fn!==m||y&&!w[x].once||_&&w[x].context!==_)&&R.push(w[x]);R.length?this._events[v]=R.length===1?R[0]:R:u(this,v)}return this},f.prototype.removeAllListeners=function(h){var m;return h?(m=n?n+h:h,this._events[m]&&u(this,m)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=n,f.EventEmitter=f,e.exports=f})(Qp)),Qp.exports}var ol={exports:{}},Kp,iS;function g$(){return iS||(iS=1,Kp=(e,t)=>(t=t||(()=>{}),e.then(n=>new Promise(r=>{r(t())}).then(()=>n),n=>new Promise(r=>{r(t())}).then(()=>{throw n})))),Kp}var oS;function _$(){if(oS)return ol.exports;oS=1;const e=g$();class t extends Error{constructor(s){super(s),this.name="TimeoutError"}}const n=(r,s,o)=>new Promise((u,f)=>{if(typeof s!="number"||s<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(s===1/0){u(r);return}const d=setTimeout(()=>{if(typeof o=="function"){try{u(o())}catch(_){f(_)}return}const h=typeof o=="string"?o:`Promise timed out after ${s} milliseconds`,m=o instanceof Error?o:new t(h);typeof r.cancel=="function"&&r.cancel(),f(m)},s);e(r.then(u,f),()=>{clearTimeout(d)})});return ol.exports=n,ol.exports.default=n,ol.exports.TimeoutError=t,ol.exports}var wc={},Sc={},lS;function y$(){if(lS)return Sc;lS=1,Object.defineProperty(Sc,"__esModule",{value:!0});function e(t,n,r){let s=0,o=t.length;for(;o>0;){const u=o/2|0;let f=s+u;r(t[f],n)<=0?(s=++f,o-=u+1):o=u}return s}return Sc.default=e,Sc}var uS;function v$(){if(uS)return wc;uS=1,Object.defineProperty(wc,"__esModule",{value:!0});const e=y$();class t{constructor(){this._queue=[]}enqueue(r,s){s=Object.assign({priority:0},s);const o={priority:s.priority,run:r};if(this.size&&this._queue[this.size-1].priority>=s.priority){this._queue.push(o);return}const u=e.default(this._queue,o,(f,d)=>d.priority-f.priority);this._queue.splice(u,0,o)}dequeue(){const r=this._queue.shift();return r?.run}filter(r){return this._queue.filter(s=>s.priority===r.priority).map(s=>s.run)}get size(){return this._queue.length}}return wc.default=t,wc}var cS;function b$(){if(cS)return bc;cS=1,Object.defineProperty(bc,"__esModule",{value:!0});const e=m$(),t=_$(),n=v$(),r=()=>{},s=new t.TimeoutError;class o extends e{constructor(f){var d,h,m,_;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r,this._resolveIdle=r,f=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:n.default},f),!(typeof f.intervalCap=="number"&&f.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(h=(d=f.intervalCap)===null||d===void 0?void 0:d.toString())!==null&&h!==void 0?h:""}\` (${typeof f.intervalCap})`);if(f.interval===void 0||!(Number.isFinite(f.interval)&&f.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(_=(m=f.interval)===null||m===void 0?void 0:m.toString())!==null&&_!==void 0?_:""}\` (${typeof f.interval})`);this._carryoverConcurrencyCount=f.carryoverConcurrencyCount,this._isIntervalIgnored=f.intervalCap===1/0||f.interval===0,this._intervalCap=f.intervalCap,this._interval=f.interval,this._queue=new f.queueClass,this._queueClass=f.queueClass,this.concurrency=f.concurrency,this._timeout=f.timeout,this._throwOnTimeout=f.throwOnTimeout===!0,this._isPaused=f.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const f=Date.now();if(this._intervalId===void 0){const d=this._intervalEnd-f;if(d<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},d)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const f=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const d=this._queue.dequeue();return d?(this.emit("active"),d(),f&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(f){if(!(typeof f=="number"&&f>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${f}\` (${typeof f})`);this._concurrency=f,this._processQueue()}async add(f,d={}){return new Promise((h,m)=>{const _=async()=>{this._pendingCount++,this._intervalCount++;try{const y=this._timeout===void 0&&d.timeout===void 0?f():t.default(Promise.resolve(f()),d.timeout===void 0?this._timeout:d.timeout,()=>{(d.throwOnTimeout===void 0?this._throwOnTimeout:d.throwOnTimeout)&&m(s)});h(await y)}catch(y){m(y)}this._next()};this._queue.enqueue(_,d),this._tryToStartAnother(),this.emit("add")})}async addAll(f,d){return Promise.all(f.map(async h=>this.add(h,d)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(f=>{const d=this._resolveEmpty;this._resolveEmpty=()=>{d(),f()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(f=>{const d=this._resolveIdle;this._resolveIdle=()=>{d(),f()}})}get size(){return this._queue.size}sizeBy(f){return this._queue.filter(f).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(f){this._timeout=f}}return bc.default=o,bc}var w$=b$();const pa=Ff(w$),S$="default"in pa?pa.default:pa,E$=[408,425,429,500,502,503,504];let fS=class{constructor(t){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxQueueSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queueSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.maxConcurrency=t.maxConcurrency??1/0,this.maxRetries=t.maxRetries??6,this.maxQueueSizeBytes=t.maxQueueSizeBytes,this.queue=new S$({concurrency:this.maxConcurrency}),this.onFailedResponseHook=t?.onFailedResponseHook}call(t,...n){return this.callWithOptions({},t,...n)}callWithOptions(t,n,...r){const s=t.sizeBytes??0;if(this.maxQueueSizeBytes!==void 0&&s>0&&this.queueSizeBytes+s>this.maxQueueSizeBytes)return Promise.reject(new Error(`Queue size limit (${this.maxQueueSizeBytes} bytes) exceeded. Current queue size: ${this.queueSizeBytes} bytes, attempted addition: ${s} bytes.`));s>0&&(this.queueSizeBytes+=s);const o=this.onFailedResponseHook;let u=this.queue.add(()=>p$(()=>n(...r).catch(f=>{throw f instanceof Error?f:new Error(f)}),{async onFailedAttempt({error:f}){if(typeof f!="object"||f==null)throw f;const d="message"in f&&typeof f.message=="string"?f.message:void 0;if(d?.startsWith("Cancel")||d?.startsWith("TimeoutError")||d?.startsWith("AbortError")||"name"in f&&f.name==="TimeoutError"||"code"in f&&f.code==="ECONNABORTED")throw f;const h="response"in f?f.response:void 0;if(o&&await o(h))return;const m=h?.status??("status"in f?f.status:void 0);if(m!=null&&(typeof m=="number"||typeof m=="string")&&!E$.includes(+m))throw f},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0});return s>0&&(u=u.finally(()=>{this.queueSizeBytes-=s})),t.signal?Promise.race([u,new Promise((f,d)=>{t.signal?.addEventListener("abort",()=>{d(new Error("AbortError"))})})]):u}};function dS(e){return typeof e?._getType=="function"}function hS(e){const t={type:e._getType(),data:{content:e.content}};return e?.additional_kwargs&&Object.keys(e.additional_kwargs).length>0&&(t.data.additional_kwargs={...e.additional_kwargs}),t}var Ec={exports:{}},Wp,pS;function Gf(){if(pS)return Wp;pS=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,s=t-6;return Wp={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:s,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Wp}var em,mS;function Vf(){if(mS)return em;mS=1;var e={};return em=typeof process=="object"&&e&&e.NODE_DEBUG&&/\bsemver\b/i.test(e.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{},em}var gS;function Zl(){return gS||(gS=1,(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:s}=Gf(),o=Vf();t=e.exports={};const u=t.re=[],f=t.safeRe=[],d=t.src=[],h=t.safeSrc=[],m=t.t={};let _=0;const y="[a-zA-Z0-9-]",v=[["\\s",1],["\\d",s],[y,r]],w=R=>{for(const[E,A]of v)R=R.split(`${E}*`).join(`${E}{0,${A}}`).split(`${E}+`).join(`${E}{1,${A}}`);return R},x=(R,E,A)=>{const N=w(E),M=_++;o(R,M,E),m[R]=M,d[M]=E,h[M]=N,u[M]=new RegExp(E,A?"g":void 0),f[M]=new RegExp(N,A?"g":void 0)};x("NUMERICIDENTIFIER","0|[1-9]\\d*"),x("NUMERICIDENTIFIERLOOSE","\\d+"),x("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${y}*`),x("MAINVERSION",`(${d[m.NUMERICIDENTIFIER]})\\.(${d[m.NUMERICIDENTIFIER]})\\.(${d[m.NUMERICIDENTIFIER]})`),x("MAINVERSIONLOOSE",`(${d[m.NUMERICIDENTIFIERLOOSE]})\\.(${d[m.NUMERICIDENTIFIERLOOSE]})\\.(${d[m.NUMERICIDENTIFIERLOOSE]})`),x("PRERELEASEIDENTIFIER",`(?:${d[m.NONNUMERICIDENTIFIER]}|${d[m.NUMERICIDENTIFIER]})`),x("PRERELEASEIDENTIFIERLOOSE",`(?:${d[m.NONNUMERICIDENTIFIER]}|${d[m.NUMERICIDENTIFIERLOOSE]})`),x("PRERELEASE",`(?:-(${d[m.PRERELEASEIDENTIFIER]}(?:\\.${d[m.PRERELEASEIDENTIFIER]})*))`),x("PRERELEASELOOSE",`(?:-?(${d[m.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${d[m.PRERELEASEIDENTIFIERLOOSE]})*))`),x("BUILDIDENTIFIER",`${y}+`),x("BUILD",`(?:\\+(${d[m.BUILDIDENTIFIER]}(?:\\.${d[m.BUILDIDENTIFIER]})*))`),x("FULLPLAIN",`v?${d[m.MAINVERSION]}${d[m.PRERELEASE]}?${d[m.BUILD]}?`),x("FULL",`^${d[m.FULLPLAIN]}$`),x("LOOSEPLAIN",`[v=\\s]*${d[m.MAINVERSIONLOOSE]}${d[m.PRERELEASELOOSE]}?${d[m.BUILD]}?`),x("LOOSE",`^${d[m.LOOSEPLAIN]}$`),x("GTLT","((?:<|>)?=?)"),x("XRANGEIDENTIFIERLOOSE",`${d[m.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),x("XRANGEIDENTIFIER",`${d[m.NUMERICIDENTIFIER]}|x|X|\\*`),x("XRANGEPLAIN",`[v=\\s]*(${d[m.XRANGEIDENTIFIER]})(?:\\.(${d[m.XRANGEIDENTIFIER]})(?:\\.(${d[m.XRANGEIDENTIFIER]})(?:${d[m.PRERELEASE]})?${d[m.BUILD]}?)?)?`),x("XRANGEPLAINLOOSE",`[v=\\s]*(${d[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[m.XRANGEIDENTIFIERLOOSE]})(?:${d[m.PRERELEASELOOSE]})?${d[m.BUILD]}?)?)?`),x("XRANGE",`^${d[m.GTLT]}\\s*${d[m.XRANGEPLAIN]}$`),x("XRANGELOOSE",`^${d[m.GTLT]}\\s*${d[m.XRANGEPLAINLOOSE]}$`),x("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),x("COERCE",`${d[m.COERCEPLAIN]}(?:$|[^\\d])`),x("COERCEFULL",d[m.COERCEPLAIN]+`(?:${d[m.PRERELEASE]})?(?:${d[m.BUILD]})?(?:$|[^\\d])`),x("COERCERTL",d[m.COERCE],!0),x("COERCERTLFULL",d[m.COERCEFULL],!0),x("LONETILDE","(?:~>?)"),x("TILDETRIM",`(\\s*)${d[m.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",x("TILDE",`^${d[m.LONETILDE]}${d[m.XRANGEPLAIN]}$`),x("TILDELOOSE",`^${d[m.LONETILDE]}${d[m.XRANGEPLAINLOOSE]}$`),x("LONECARET","(?:\\^)"),x("CARETTRIM",`(\\s*)${d[m.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",x("CARET",`^${d[m.LONECARET]}${d[m.XRANGEPLAIN]}$`),x("CARETLOOSE",`^${d[m.LONECARET]}${d[m.XRANGEPLAINLOOSE]}$`),x("COMPARATORLOOSE",`^${d[m.GTLT]}\\s*(${d[m.LOOSEPLAIN]})$|^$`),x("COMPARATOR",`^${d[m.GTLT]}\\s*(${d[m.FULLPLAIN]})$|^$`),x("COMPARATORTRIM",`(\\s*)${d[m.GTLT]}\\s*(${d[m.LOOSEPLAIN]}|${d[m.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",x("HYPHENRANGE",`^\\s*(${d[m.XRANGEPLAIN]})\\s+-\\s+(${d[m.XRANGEPLAIN]})\\s*$`),x("HYPHENRANGELOOSE",`^\\s*(${d[m.XRANGEPLAINLOOSE]})\\s+-\\s+(${d[m.XRANGEPLAINLOOSE]})\\s*$`),x("STAR","(<|>)?=?\\s*\\*"),x("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),x("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Ec,Ec.exports)),Ec.exports}var tm,_S;function S_(){if(_S)return tm;_S=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return tm=r=>r?typeof r!="object"?e:r:t,tm}var nm,yS;function V1(){if(yS)return nm;yS=1;const e=/^[0-9]+$/,t=(r,s)=>{if(typeof r=="number"&&typeof s=="number")return r===s?0:r<s?-1:1;const o=e.test(r),u=e.test(s);return o&&u&&(r=+r,s=+s),r===s?0:o&&!u?-1:u&&!o?1:r<s?-1:1};return nm={compareIdentifiers:t,rcompareIdentifiers:(r,s)=>t(s,r)},nm}var rm,vS;function mn(){if(vS)return rm;vS=1;const e=Vf(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=Gf(),{safeRe:r,t:s}=Zl(),o=S_(),{compareIdentifiers:u}=V1();class f{constructor(h,m){if(m=o(m),h instanceof f){if(h.loose===!!m.loose&&h.includePrerelease===!!m.includePrerelease)return h;h=h.version}else if(typeof h!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof h}".`);if(h.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",h,m),this.options=m,this.loose=!!m.loose,this.includePrerelease=!!m.includePrerelease;const _=h.trim().match(m.loose?r[s.LOOSE]:r[s.FULL]);if(!_)throw new TypeError(`Invalid Version: ${h}`);if(this.raw=h,this.major=+_[1],this.minor=+_[2],this.patch=+_[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");_[4]?this.prerelease=_[4].split(".").map(y=>{if(/^[0-9]+$/.test(y)){const v=+y;if(v>=0&&v<n)return v}return y}):this.prerelease=[],this.build=_[5]?_[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(h){if(e("SemVer.compare",this.version,this.options,h),!(h instanceof f)){if(typeof h=="string"&&h===this.version)return 0;h=new f(h,this.options)}return h.version===this.version?0:this.compareMain(h)||this.comparePre(h)}compareMain(h){return h instanceof f||(h=new f(h,this.options)),this.major<h.major?-1:this.major>h.major?1:this.minor<h.minor?-1:this.minor>h.minor?1:this.patch<h.patch?-1:this.patch>h.patch?1:0}comparePre(h){if(h instanceof f||(h=new f(h,this.options)),this.prerelease.length&&!h.prerelease.length)return-1;if(!this.prerelease.length&&h.prerelease.length)return 1;if(!this.prerelease.length&&!h.prerelease.length)return 0;let m=0;do{const _=this.prerelease[m],y=h.prerelease[m];if(e("prerelease compare",m,_,y),_===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(_===void 0)return-1;if(_===y)continue;return u(_,y)}while(++m)}compareBuild(h){h instanceof f||(h=new f(h,this.options));let m=0;do{const _=this.build[m],y=h.build[m];if(e("build compare",m,_,y),_===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(_===void 0)return-1;if(_===y)continue;return u(_,y)}while(++m)}inc(h,m,_){if(h.startsWith("pre")){if(!m&&_===!1)throw new Error("invalid increment argument: identifier is empty");if(m){const y=`-${m}`.match(this.options.loose?r[s.PRERELEASELOOSE]:r[s.PRERELEASE]);if(!y||y[1]!==m)throw new Error(`invalid identifier: ${m}`)}}switch(h){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",m,_);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",m,_);break;case"prepatch":this.prerelease.length=0,this.inc("patch",m,_),this.inc("pre",m,_);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",m,_),this.inc("pre",m,_);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const y=Number(_)?1:0;if(this.prerelease.length===0)this.prerelease=[y];else{let v=this.prerelease.length;for(;--v>=0;)typeof this.prerelease[v]=="number"&&(this.prerelease[v]++,v=-2);if(v===-1){if(m===this.prerelease.join(".")&&_===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(y)}}if(m){let v=[m,y];_===!1&&(v=[m]),u(this.prerelease[0],m)===0?isNaN(this.prerelease[1])&&(this.prerelease=v):this.prerelease=v}break}default:throw new Error(`invalid increment argument: ${h}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return rm=f,rm}var am,bS;function oo(){if(bS)return am;bS=1;const e=mn();return am=(n,r,s=!1)=>{if(n instanceof e)return n;try{return new e(n,r)}catch(o){if(!s)return null;throw o}},am}var sm,wS;function T$(){if(wS)return sm;wS=1;const e=oo();return sm=(n,r)=>{const s=e(n,r);return s?s.version:null},sm}var im,SS;function x$(){if(SS)return im;SS=1;const e=oo();return im=(n,r)=>{const s=e(n.trim().replace(/^[=v]+/,""),r);return s?s.version:null},im}var om,ES;function O$(){if(ES)return om;ES=1;const e=mn();return om=(n,r,s,o,u)=>{typeof s=="string"&&(u=o,o=s,s=void 0);try{return new e(n instanceof e?n.version:n,s).inc(r,o,u).version}catch{return null}},om}var lm,TS;function A$(){if(TS)return lm;TS=1;const e=oo();return lm=(n,r)=>{const s=e(n,null,!0),o=e(r,null,!0),u=s.compare(o);if(u===0)return null;const f=u>0,d=f?s:o,h=f?o:s,m=!!d.prerelease.length;if(!!h.prerelease.length&&!m){if(!h.patch&&!h.minor)return"major";if(h.compareMain(d)===0)return h.minor&&!h.patch?"minor":"patch"}const y=m?"pre":"";return s.major!==o.major?y+"major":s.minor!==o.minor?y+"minor":s.patch!==o.patch?y+"patch":"prerelease"},lm}var um,xS;function C$(){if(xS)return um;xS=1;const e=mn();return um=(n,r)=>new e(n,r).major,um}var cm,OS;function R$(){if(OS)return cm;OS=1;const e=mn();return cm=(n,r)=>new e(n,r).minor,cm}var fm,AS;function N$(){if(AS)return fm;AS=1;const e=mn();return fm=(n,r)=>new e(n,r).patch,fm}var dm,CS;function I$(){if(CS)return dm;CS=1;const e=oo();return dm=(n,r)=>{const s=e(n,r);return s&&s.prerelease.length?s.prerelease:null},dm}var hm,RS;function Ar(){if(RS)return hm;RS=1;const e=mn();return hm=(n,r,s)=>new e(n,s).compare(new e(r,s)),hm}var pm,NS;function k$(){if(NS)return pm;NS=1;const e=Ar();return pm=(n,r,s)=>e(r,n,s),pm}var mm,IS;function $$(){if(IS)return mm;IS=1;const e=Ar();return mm=(n,r)=>e(n,r,!0),mm}var gm,kS;function E_(){if(kS)return gm;kS=1;const e=mn();return gm=(n,r,s)=>{const o=new e(n,s),u=new e(r,s);return o.compare(u)||o.compareBuild(u)},gm}var _m,$S;function M$(){if($S)return _m;$S=1;const e=E_();return _m=(n,r)=>n.sort((s,o)=>e(s,o,r)),_m}var ym,MS;function j$(){if(MS)return ym;MS=1;const e=E_();return ym=(n,r)=>n.sort((s,o)=>e(o,s,r)),ym}var vm,jS;function Jf(){if(jS)return vm;jS=1;const e=Ar();return vm=(n,r,s)=>e(n,r,s)>0,vm}var bm,LS;function T_(){if(LS)return bm;LS=1;const e=Ar();return bm=(n,r,s)=>e(n,r,s)<0,bm}var wm,zS;function J1(){if(zS)return wm;zS=1;const e=Ar();return wm=(n,r,s)=>e(n,r,s)===0,wm}var Sm,DS;function X1(){if(DS)return Sm;DS=1;const e=Ar();return Sm=(n,r,s)=>e(n,r,s)!==0,Sm}var Em,US;function x_(){if(US)return Em;US=1;const e=Ar();return Em=(n,r,s)=>e(n,r,s)>=0,Em}var Tm,PS;function O_(){if(PS)return Tm;PS=1;const e=Ar();return Tm=(n,r,s)=>e(n,r,s)<=0,Tm}var xm,BS;function Y1(){if(BS)return xm;BS=1;const e=J1(),t=X1(),n=Jf(),r=x_(),s=T_(),o=O_();return xm=(f,d,h,m)=>{switch(d){case"===":return typeof f=="object"&&(f=f.version),typeof h=="object"&&(h=h.version),f===h;case"!==":return typeof f=="object"&&(f=f.version),typeof h=="object"&&(h=h.version),f!==h;case"":case"=":case"==":return e(f,h,m);case"!=":return t(f,h,m);case">":return n(f,h,m);case">=":return r(f,h,m);case"<":return s(f,h,m);case"<=":return o(f,h,m);default:throw new TypeError(`Invalid operator: ${d}`)}},xm}var Om,ZS;function L$(){if(ZS)return Om;ZS=1;const e=mn(),t=oo(),{safeRe:n,t:r}=Zl();return Om=(o,u)=>{if(o instanceof e)return o;if(typeof o=="number"&&(o=String(o)),typeof o!="string")return null;u=u||{};let f=null;if(!u.rtl)f=o.match(u.includePrerelease?n[r.COERCEFULL]:n[r.COERCE]);else{const v=u.includePrerelease?n[r.COERCERTLFULL]:n[r.COERCERTL];let w;for(;(w=v.exec(o))&&(!f||f.index+f[0].length!==o.length);)(!f||w.index+w[0].length!==f.index+f[0].length)&&(f=w),v.lastIndex=w.index+w[1].length+w[2].length;v.lastIndex=-1}if(f===null)return null;const d=f[2],h=f[3]||"0",m=f[4]||"0",_=u.includePrerelease&&f[5]?`-${f[5]}`:"",y=u.includePrerelease&&f[6]?`+${f[6]}`:"";return t(`${d}.${h}.${m}${_}${y}`,u)},Om}var Am,qS;function z$(){if(qS)return Am;qS=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const r=this.map.get(n);if(r!==void 0)return this.map.delete(n),this.map.set(n,r),r}delete(n){return this.map.delete(n)}set(n,r){if(!this.delete(n)&&r!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(n,r)}return this}}return Am=e,Am}var Cm,FS;function Cr(){if(FS)return Cm;FS=1;const e=/\s+/g;class t{constructor(se,$){if($=s($),se instanceof t)return se.loose===!!$.loose&&se.includePrerelease===!!$.includePrerelease?se:new t(se.raw,$);if(se instanceof o)return this.raw=se.value,this.set=[[se]],this.formatted=void 0,this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=se.trim().replace(e," "),this.set=this.raw.split("||").map(F=>this.parseRange(F.trim())).filter(F=>F.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const F=this.set[0];if(this.set=this.set.filter(ne=>!x(ne[0])),this.set.length===0)this.set=[F];else if(this.set.length>1){for(const ne of this.set)if(ne.length===1&&R(ne[0])){this.set=[ne];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let se=0;se<this.set.length;se++){se>0&&(this.formatted+="||");const $=this.set[se];for(let F=0;F<$.length;F++)F>0&&(this.formatted+=" "),this.formatted+=$[F].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(se){const F=((this.options.includePrerelease&&v)|(this.options.loose&&w))+":"+se,ne=r.get(F);if(ne)return ne;const oe=this.options.loose,fe=oe?d[h.HYPHENRANGELOOSE]:d[h.HYPHENRANGE];se=se.replace(fe,Je(this.options.includePrerelease)),u("hyphen replace",se),se=se.replace(d[h.COMPARATORTRIM],m),u("comparator trim",se),se=se.replace(d[h.TILDETRIM],_),u("tilde trim",se),se=se.replace(d[h.CARETTRIM],y),u("caret trim",se);let I=se.split(" ").map(he=>A(he,this.options)).join(" ").split(/\s+/).map(he=>me(he,this.options));oe&&(I=I.filter(he=>(u("loose invalid filter",he,this.options),!!he.match(d[h.COMPARATORLOOSE])))),u("range list",I);const D=new Map,V=I.map(he=>new o(he,this.options));for(const he of V){if(x(he))return[he];D.set(he.value,he)}D.size>1&&D.has("")&&D.delete("");const ie=[...D.values()];return r.set(F,ie),ie}intersects(se,$){if(!(se instanceof t))throw new TypeError("a Range is required");return this.set.some(F=>E(F,$)&&se.set.some(ne=>E(ne,$)&&F.every(oe=>ne.every(fe=>oe.intersects(fe,$)))))}test(se){if(!se)return!1;if(typeof se=="string")try{se=new f(se,this.options)}catch{return!1}for(let $=0;$<this.set.length;$++)if(At(this.set[$],se,this.options))return!0;return!1}}Cm=t;const n=z$(),r=new n,s=S_(),o=Xf(),u=Vf(),f=mn(),{safeRe:d,t:h,comparatorTrimReplace:m,tildeTrimReplace:_,caretTrimReplace:y}=Zl(),{FLAG_INCLUDE_PRERELEASE:v,FLAG_LOOSE:w}=Gf(),x=ue=>ue.value==="<0.0.0-0",R=ue=>ue.value==="",E=(ue,se)=>{let $=!0;const F=ue.slice();let ne=F.pop();for(;$&&F.length;)$=F.every(oe=>ne.intersects(oe,se)),ne=F.pop();return $},A=(ue,se)=>(ue=ue.replace(d[h.BUILD],""),u("comp",ue,se),ue=Y(ue,se),u("caret",ue),ue=M(ue,se),u("tildes",ue),ue=C(ue,se),u("xrange",ue),ue=xe(ue,se),u("stars",ue),ue),N=ue=>!ue||ue.toLowerCase()==="x"||ue==="*",M=(ue,se)=>ue.trim().split(/\s+/).map($=>B($,se)).join(" "),B=(ue,se)=>{const $=se.loose?d[h.TILDELOOSE]:d[h.TILDE];return ue.replace($,(F,ne,oe,fe,I)=>{u("tilde",ue,F,ne,oe,fe,I);let D;return N(ne)?D="":N(oe)?D=`>=${ne}.0.0 <${+ne+1}.0.0-0`:N(fe)?D=`>=${ne}.${oe}.0 <${ne}.${+oe+1}.0-0`:I?(u("replaceTilde pr",I),D=`>=${ne}.${oe}.${fe}-${I} <${ne}.${+oe+1}.0-0`):D=`>=${ne}.${oe}.${fe} <${ne}.${+oe+1}.0-0`,u("tilde return",D),D})},Y=(ue,se)=>ue.trim().split(/\s+/).map($=>W($,se)).join(" "),W=(ue,se)=>{u("caret",ue,se);const $=se.loose?d[h.CARETLOOSE]:d[h.CARET],F=se.includePrerelease?"-0":"";return ue.replace($,(ne,oe,fe,I,D)=>{u("caret",ue,ne,oe,fe,I,D);let V;return N(oe)?V="":N(fe)?V=`>=${oe}.0.0${F} <${+oe+1}.0.0-0`:N(I)?oe==="0"?V=`>=${oe}.${fe}.0${F} <${oe}.${+fe+1}.0-0`:V=`>=${oe}.${fe}.0${F} <${+oe+1}.0.0-0`:D?(u("replaceCaret pr",D),oe==="0"?fe==="0"?V=`>=${oe}.${fe}.${I}-${D} <${oe}.${fe}.${+I+1}-0`:V=`>=${oe}.${fe}.${I}-${D} <${oe}.${+fe+1}.0-0`:V=`>=${oe}.${fe}.${I}-${D} <${+oe+1}.0.0-0`):(u("no pr"),oe==="0"?fe==="0"?V=`>=${oe}.${fe}.${I}${F} <${oe}.${fe}.${+I+1}-0`:V=`>=${oe}.${fe}.${I}${F} <${oe}.${+fe+1}.0-0`:V=`>=${oe}.${fe}.${I} <${+oe+1}.0.0-0`),u("caret return",V),V})},C=(ue,se)=>(u("replaceXRanges",ue,se),ue.split(/\s+/).map($=>Te($,se)).join(" ")),Te=(ue,se)=>{ue=ue.trim();const $=se.loose?d[h.XRANGELOOSE]:d[h.XRANGE];return ue.replace($,(F,ne,oe,fe,I,D)=>{u("xRange",ue,F,ne,oe,fe,I,D);const V=N(oe),ie=V||N(fe),he=ie||N(I),O=he;return ne==="="&&O&&(ne=""),D=se.includePrerelease?"-0":"",V?ne===">"||ne==="<"?F="<0.0.0-0":F="*":ne&&O?(ie&&(fe=0),I=0,ne===">"?(ne=">=",ie?(oe=+oe+1,fe=0,I=0):(fe=+fe+1,I=0)):ne==="<="&&(ne="<",ie?oe=+oe+1:fe=+fe+1),ne==="<"&&(D="-0"),F=`${ne+oe}.${fe}.${I}${D}`):ie?F=`>=${oe}.0.0${D} <${+oe+1}.0.0-0`:he&&(F=`>=${oe}.${fe}.0${D} <${oe}.${+fe+1}.0-0`),u("xRange return",F),F})},xe=(ue,se)=>(u("replaceStars",ue,se),ue.trim().replace(d[h.STAR],"")),me=(ue,se)=>(u("replaceGTE0",ue,se),ue.trim().replace(d[se.includePrerelease?h.GTE0PRE:h.GTE0],"")),Je=ue=>(se,$,F,ne,oe,fe,I,D,V,ie,he,O)=>(N(F)?$="":N(ne)?$=`>=${F}.0.0${ue?"-0":""}`:N(oe)?$=`>=${F}.${ne}.0${ue?"-0":""}`:fe?$=`>=${$}`:$=`>=${$}${ue?"-0":""}`,N(V)?D="":N(ie)?D=`<${+V+1}.0.0-0`:N(he)?D=`<${V}.${+ie+1}.0-0`:O?D=`<=${V}.${ie}.${he}-${O}`:ue?D=`<${V}.${ie}.${+he+1}-0`:D=`<=${D}`,`${$} ${D}`.trim()),At=(ue,se,$)=>{for(let F=0;F<ue.length;F++)if(!ue[F].test(se))return!1;if(se.prerelease.length&&!$.includePrerelease){for(let F=0;F<ue.length;F++)if(u(ue[F].semver),ue[F].semver!==o.ANY&&ue[F].semver.prerelease.length>0){const ne=ue[F].semver;if(ne.major===se.major&&ne.minor===se.minor&&ne.patch===se.patch)return!0}return!1}return!0};return Cm}var Rm,HS;function Xf(){if(HS)return Rm;HS=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(m,_){if(_=n(_),m instanceof t){if(m.loose===!!_.loose)return m;m=m.value}m=m.trim().split(/\s+/).join(" "),u("comparator",m,_),this.options=_,this.loose=!!_.loose,this.parse(m),this.semver===e?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(m){const _=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],y=m.match(_);if(!y)throw new TypeError(`Invalid comparator: ${m}`);this.operator=y[1]!==void 0?y[1]:"",this.operator==="="&&(this.operator=""),y[2]?this.semver=new f(y[2],this.options.loose):this.semver=e}toString(){return this.value}test(m){if(u("Comparator.test",m,this.options.loose),this.semver===e||m===e)return!0;if(typeof m=="string")try{m=new f(m,this.options)}catch{return!1}return o(m,this.operator,this.semver,this.options)}intersects(m,_){if(!(m instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new d(m.value,_).test(this.value):m.operator===""?m.value===""?!0:new d(this.value,_).test(m.semver):(_=n(_),_.includePrerelease&&(this.value==="<0.0.0-0"||m.value==="<0.0.0-0")||!_.includePrerelease&&(this.value.startsWith("<0.0.0")||m.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&m.operator.startsWith(">")||this.operator.startsWith("<")&&m.operator.startsWith("<")||this.semver.version===m.semver.version&&this.operator.includes("=")&&m.operator.includes("=")||o(this.semver,"<",m.semver,_)&&this.operator.startsWith(">")&&m.operator.startsWith("<")||o(this.semver,">",m.semver,_)&&this.operator.startsWith("<")&&m.operator.startsWith(">")))}}Rm=t;const n=S_(),{safeRe:r,t:s}=Zl(),o=Y1(),u=Vf(),f=mn(),d=Cr();return Rm}var Nm,GS;function Yf(){if(GS)return Nm;GS=1;const e=Cr();return Nm=(n,r,s)=>{try{r=new e(r,s)}catch{return!1}return r.test(n)},Nm}var Im,VS;function D$(){if(VS)return Im;VS=1;const e=Cr();return Im=(n,r)=>new e(n,r).set.map(s=>s.map(o=>o.value).join(" ").trim().split(" ")),Im}var km,JS;function U$(){if(JS)return km;JS=1;const e=mn(),t=Cr();return km=(r,s,o)=>{let u=null,f=null,d=null;try{d=new t(s,o)}catch{return null}return r.forEach(h=>{d.test(h)&&(!u||f.compare(h)===-1)&&(u=h,f=new e(u,o))}),u},km}var $m,XS;function P$(){if(XS)return $m;XS=1;const e=mn(),t=Cr();return $m=(r,s,o)=>{let u=null,f=null,d=null;try{d=new t(s,o)}catch{return null}return r.forEach(h=>{d.test(h)&&(!u||f.compare(h)===1)&&(u=h,f=new e(u,o))}),u},$m}var Mm,YS;function B$(){if(YS)return Mm;YS=1;const e=mn(),t=Cr(),n=Jf();return Mm=(s,o)=>{s=new t(s,o);let u=new e("0.0.0");if(s.test(u)||(u=new e("0.0.0-0"),s.test(u)))return u;u=null;for(let f=0;f<s.set.length;++f){const d=s.set[f];let h=null;d.forEach(m=>{const _=new e(m.semver.version);switch(m.operator){case">":_.prerelease.length===0?_.patch++:_.prerelease.push(0),_.raw=_.format();case"":case">=":(!h||n(_,h))&&(h=_);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${m.operator}`)}}),h&&(!u||n(u,h))&&(u=h)}return u&&s.test(u)?u:null},Mm}var jm,QS;function Z$(){if(QS)return jm;QS=1;const e=Cr();return jm=(n,r)=>{try{return new e(n,r).range||"*"}catch{return null}},jm}var Lm,KS;function A_(){if(KS)return Lm;KS=1;const e=mn(),t=Xf(),{ANY:n}=t,r=Cr(),s=Yf(),o=Jf(),u=T_(),f=O_(),d=x_();return Lm=(m,_,y,v)=>{m=new e(m,v),_=new r(_,v);let w,x,R,E,A;switch(y){case">":w=o,x=f,R=u,E=">",A=">=";break;case"<":w=u,x=d,R=o,E="<",A="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(m,_,v))return!1;for(let N=0;N<_.set.length;++N){const M=_.set[N];let B=null,Y=null;if(M.forEach(W=>{W.semver===n&&(W=new t(">=0.0.0")),B=B||W,Y=Y||W,w(W.semver,B.semver,v)?B=W:R(W.semver,Y.semver,v)&&(Y=W)}),B.operator===E||B.operator===A||(!Y.operator||Y.operator===E)&&x(m,Y.semver))return!1;if(Y.operator===A&&R(m,Y.semver))return!1}return!0},Lm}var zm,WS;function q$(){if(WS)return zm;WS=1;const e=A_();return zm=(n,r,s)=>e(n,r,">",s),zm}var Dm,eE;function F$(){if(eE)return Dm;eE=1;const e=A_();return Dm=(n,r,s)=>e(n,r,"<",s),Dm}var Um,tE;function H$(){if(tE)return Um;tE=1;const e=Cr();return Um=(n,r,s)=>(n=new e(n,s),r=new e(r,s),n.intersects(r,s)),Um}var Pm,nE;function G$(){if(nE)return Pm;nE=1;const e=Yf(),t=Ar();return Pm=(n,r,s)=>{const o=[];let u=null,f=null;const d=n.sort((y,v)=>t(y,v,s));for(const y of d)e(y,r,s)?(f=y,u||(u=y)):(f&&o.push([u,f]),f=null,u=null);u&&o.push([u,null]);const h=[];for(const[y,v]of o)y===v?h.push(y):!v&&y===d[0]?h.push("*"):v?y===d[0]?h.push(`<=${v}`):h.push(`${y} - ${v}`):h.push(`>=${y}`);const m=h.join(" || "),_=typeof r.raw=="string"?r.raw:String(r);return m.length<_.length?m:r},Pm}var Bm,rE;function V$(){if(rE)return Bm;rE=1;const e=Cr(),t=Xf(),{ANY:n}=t,r=Yf(),s=Ar(),o=(_,y,v={})=>{if(_===y)return!0;_=new e(_,v),y=new e(y,v);let w=!1;e:for(const x of _.set){for(const R of y.set){const E=d(x,R,v);if(w=w||E!==null,E)continue e}if(w)return!1}return!0},u=[new t(">=0.0.0-0")],f=[new t(">=0.0.0")],d=(_,y,v)=>{if(_===y)return!0;if(_.length===1&&_[0].semver===n){if(y.length===1&&y[0].semver===n)return!0;v.includePrerelease?_=u:_=f}if(y.length===1&&y[0].semver===n){if(v.includePrerelease)return!0;y=f}const w=new Set;let x,R;for(const C of _)C.operator===">"||C.operator===">="?x=h(x,C,v):C.operator==="<"||C.operator==="<="?R=m(R,C,v):w.add(C.semver);if(w.size>1)return null;let E;if(x&&R){if(E=s(x.semver,R.semver,v),E>0)return null;if(E===0&&(x.operator!==">="||R.operator!=="<="))return null}for(const C of w){if(x&&!r(C,String(x),v)||R&&!r(C,String(R),v))return null;for(const Te of y)if(!r(C,String(Te),v))return!1;return!0}let A,N,M,B,Y=R&&!v.includePrerelease&&R.semver.prerelease.length?R.semver:!1,W=x&&!v.includePrerelease&&x.semver.prerelease.length?x.semver:!1;Y&&Y.prerelease.length===1&&R.operator==="<"&&Y.prerelease[0]===0&&(Y=!1);for(const C of y){if(B=B||C.operator===">"||C.operator===">=",M=M||C.operator==="<"||C.operator==="<=",x){if(W&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===W.major&&C.semver.minor===W.minor&&C.semver.patch===W.patch&&(W=!1),C.operator===">"||C.operator===">="){if(A=h(x,C,v),A===C&&A!==x)return!1}else if(x.operator===">="&&!r(x.semver,String(C),v))return!1}if(R){if(Y&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===Y.major&&C.semver.minor===Y.minor&&C.semver.patch===Y.patch&&(Y=!1),C.operator==="<"||C.operator==="<="){if(N=m(R,C,v),N===C&&N!==R)return!1}else if(R.operator==="<="&&!r(R.semver,String(C),v))return!1}if(!C.operator&&(R||x)&&E!==0)return!1}return!(x&&M&&!R&&E!==0||R&&B&&!x&&E!==0||W||Y)},h=(_,y,v)=>{if(!_)return y;const w=s(_.semver,y.semver,v);return w>0?_:w<0||y.operator===">"&&_.operator===">="?y:_},m=(_,y,v)=>{if(!_)return y;const w=s(_.semver,y.semver,v);return w<0?_:w>0||y.operator==="<"&&_.operator==="<="?y:_};return Bm=o,Bm}var Zm,aE;function J$(){if(aE)return Zm;aE=1;const e=Zl(),t=Gf(),n=mn(),r=V1(),s=oo(),o=T$(),u=x$(),f=O$(),d=A$(),h=C$(),m=R$(),_=N$(),y=I$(),v=Ar(),w=k$(),x=$$(),R=E_(),E=M$(),A=j$(),N=Jf(),M=T_(),B=J1(),Y=X1(),W=x_(),C=O_(),Te=Y1(),xe=L$(),me=Xf(),Je=Cr(),At=Yf(),ue=D$(),se=U$(),$=P$(),F=B$(),ne=Z$(),oe=A_(),fe=q$(),I=F$(),D=H$(),V=G$(),ie=V$();return Zm={parse:s,valid:o,clean:u,inc:f,diff:d,major:h,minor:m,patch:_,prerelease:y,compare:v,rcompare:w,compareLoose:x,compareBuild:R,sort:E,rsort:A,gt:N,lt:M,eq:B,neq:Y,gte:W,lte:C,cmp:Te,coerce:xe,Comparator:me,Range:Je,satisfies:At,toComparators:ue,maxSatisfying:se,minSatisfying:$,minVersion:F,validRange:ne,outside:oe,gtr:fe,ltr:I,intersects:D,simplifyRange:V,subset:ie,SemVer:n,re:e.re,src:e.src,tokens:e.t,SEMVER_SPEC_VERSION:t.SEMVER_SPEC_VERSION,RELEASE_TYPES:t.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},Zm}J$();function Fa(e){if(!e||e.split("/").length>2||e.startsWith("/")||e.endsWith("/")||e.split(":").length>2)throw new Error(`Invalid identifier format: ${e}`);const[t,n]=e.split(":"),r=n||"latest";if(t.includes("/")){const[s,o]=t.split("/",2);if(!s||!o)throw new Error(`Invalid identifier format: ${e}`);return[s,o,r]}else{if(!t)throw new Error(`Invalid identifier format: ${e}`);return["-",t,r]}}class X$ extends Error{constructor(t){super(t),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}}class Y$ extends Error{constructor(t){super(t),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithNotFoundError",this.status=404}}function sE(e){return e!=null&&typeof e=="object"&&"name"in e&&e?.name==="LangSmithNotFoundError"}async function we(e,t,n){let r;if(e.ok){n&&(r=await e.text());return}if(e.status===403)try{(await e.json())?.error==="org_scoped_key_requires_workspace"&&(r="This API key is org-scoped and requires workspace specification. Please provide 'workspaceId' parameter, or set LANGSMITH_WORKSPACE_ID environment variable.")}catch{const f=new Error(`${e.status} ${e.statusText}`);throw f.status=e?.status,f}if(r===void 0)try{r=await e.text()}catch{r=""}const s=`Failed to ${t}. Received status [${e.status}]: ${e.statusText}. Message: ${r}`;if(e.status===404)throw new Y$(s);if(e.status===409)throw new X$(s);const o=new Error(s);throw o.status=e.status,o}const Q1="ERR_CONFLICTING_ENDPOINTS";class Q$ extends Error{constructor(){super("You cannot provide both LANGSMITH_ENDPOINT / LANGCHAIN_ENDPOINT and LANGSMITH_RUNS_ENDPOINTS."),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:Q1}),this.name="ConflictingEndpointsError"}}function K$(e){return typeof e=="object"&&e!==null&&e.code===Q1}var iE="[...]",W$={result:"[Circular]"},lf=[],Fi=[];const eM=new TextEncoder;function tM(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Tc(e){return eM.encode(e)}function K1(e){if(e&&typeof e=="object"&&e!==null){if(e instanceof Map)return Object.fromEntries(e);if(e instanceof Set)return Array.from(e);if(e instanceof Date)return e.toISOString();if(e instanceof RegExp)return e.toString();if(e instanceof Error)return{name:e.name,message:e.message}}else if(typeof e=="bigint")return e.toString();return e}function nM(e){return function(t,n){return K1(n)}}function Pn(e,t,n,r,s){try{const o=JSON.stringify(e,nM(n),r);return Tc(o)}catch(o){if(!o.message?.includes("Converting circular structure to JSON"))return console.warn(`[WARNING]: LangSmith received unserializable value.${t?`
Context: ${t}`:""}`),Tc("[Unserializable]");dn("SUPPRESS_CIRCULAR_JSON_WARNINGS")!=="true"&&console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${t?`
Context: ${t}`:""}`),typeof s>"u"&&(s=tM()),vg(e,"",0,[],void 0,0,s);let u;try{Fi.length===0?u=JSON.stringify(e,n,r):u=JSON.stringify(e,rM(n),r)}catch{return Tc("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;lf.length!==0;){const f=lf.pop();f.length===4?Object.defineProperty(f[0],f[1],f[3]):f[0][f[1]]=f[2]}}return Tc(u)}}function qm(e,t,n,r){var s=Object.getOwnPropertyDescriptor(r,n);s.get!==void 0?s.configurable?(Object.defineProperty(r,n,{value:e}),lf.push([r,n,t,s])):Fi.push([t,n,e]):(r[n]=e,lf.push([r,n,t]))}function vg(e,t,n,r,s,o,u){o+=1;var f;if(typeof e=="object"&&e!==null){for(f=0;f<r.length;f++)if(r[f]===e){qm(W$,e,t,s);return}if(typeof u.depthLimit<"u"&&o>u.depthLimit){qm(iE,e,t,s);return}if(typeof u.edgesLimit<"u"&&n+1>u.edgesLimit){qm(iE,e,t,s);return}if(r.push(e),Array.isArray(e))for(f=0;f<e.length;f++)vg(e[f],f,f,r,e,o,u);else{e=K1(e);var d=Object.keys(e);for(f=0;f<d.length;f++){var h=d[f];vg(e[h],h,f,r,e,o,u)}}r.pop()}}function rM(e){return e=typeof e<"u"?e:function(t,n){return n},function(t,n){if(Fi.length>0)for(var r=0;r<Fi.length;r++){var s=Fi[r];if(s[1]===t&&s[0]===n){n=s[2],Fi.splice(r,1);break}}return e.call(this,t,n)}}function oE(e,t,n){if(n)return e;const r=q1(),s=t??F1(),o=e.extra??{},u=o.metadata;return e.extra={...o,runtime:{...r,...o?.runtime},metadata:{...s,...s.revision_id||"revision_id"in e&&e.revision_id?{revision_id:("revision_id"in e?e.revision_id:void 0)??s.revision_id}:{},...u}},e}const aM=e=>{const t=e?.toString()??dn("TRACING_SAMPLING_RATE");if(t===void 0)return;const n=parseFloat(t);if(n<0||n>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${n}`);return n},sM=e=>{const n=e.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return n==="localhost"||n==="127.0.0.1"||n==="::1"};async function iM(e){const t=[];for await(const n of e)t.push(n);return t}function xc(e){if(e!==void 0)return e.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const oM=async e=>{if(e?.status===429){const t=parseInt(e.headers.get("retry-after")??"10",10)*1e3;if(t>0)return await new Promise(n=>setTimeout(n,t)),!0}return!1};function lE(e){return typeof e=="number"?Number(e.toFixed(4)):e}const lM=24*1024*1024,W1=1024*1024*1024,uM=1e4,cM=100,uE="https://api.smith.langchain.com";class fM{constructor(t){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"maxSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSizeBytes=t??W1}peek(){return this.items[0]}push(t){let n;const r=new Promise(o=>{n=o}),s=Pn(t.item,`Serializing run with id: ${t.item.id}`).length;return this.sizeBytes+s>this.maxSizeBytes&&this.items.length>0?(console.warn(`AutoBatchQueue size limit (${this.maxSizeBytes} bytes) exceeded. Dropping run with id: ${t.item.id}. Current queue size: ${this.sizeBytes} bytes, attempted addition: ${s} bytes.`),n(),r):(this.items.push({action:t.action,payload:t.item,otelContext:t.otelContext,apiKey:t.apiKey,apiUrl:t.apiUrl,itemPromiseResolve:n,itemPromise:r,size:s}),this.sizeBytes+=s,r)}pop({upToSizeBytes:t,upToSize:n}){if(t<1)throw new Error("Number of bytes to pop off may not be less than 1.");const r=[];let s=0;for(;s+(this.peek()?.size??0)<t&&this.items.length>0&&r.length<n;){const o=this.items.shift();o&&(r.push(o),s+=o.size,this.sizeBytes-=o.size)}if(r.length===0&&this.items.length>0){const o=this.items.shift();r.push(o),s+=o.size,this.sizeBytes-=o.size}return[r.map(o=>({action:o.action,item:o.payload,otelContext:o.otelContext,apiKey:o.apiKey,apiUrl:o.apiUrl,size:o.size})),()=>r.forEach(o=>o.itemPromiseResolve())]}}class $l{get _fetch(){return this.fetchImplementation||f2(this.debug)}constructor(t={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workspaceId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitTracedRuntimeInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSizeLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:Ur("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"langSmithToOTELTranslator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchImplementation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cachedLSEnvVarsForMetadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_promptCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multipartStreamingDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_multipartDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_runCompressionDisabled",{enumerable:!0,configurable:!0,writable:!0,value:dn("DISABLE_RUN_COMPRESSION")==="true"}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:Ur("LANGSMITH_DEBUG")==="true"});const n=$l.getDefaultClientConfig();if(this.tracingSampleRate=aM(t.tracingSamplingRate),this.apiUrl=xc(t.apiUrl??n.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=xc(t.apiKey??n.apiKey),this.webUrl=xc(t.webUrl??n.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.workspaceId=xc(t.workspaceId??dn("WORKSPACE_ID")),this.timeout_ms=t.timeout_ms??9e4,this.caller=new fS({...t.callerOptions??{},maxRetries:4,debug:t.debug??this.debug}),this.traceBatchConcurrency=t.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=t.debug??this.debug,this.fetchImplementation=t.fetchImplementation;const r=t.maxIngestMemoryBytes??W1;this.batchIngestCaller=new fS({maxRetries:4,maxConcurrency:this.traceBatchConcurrency,maxQueueSizeBytes:r,...t.callerOptions??{},onFailedResponseHook:oM,debug:t.debug??this.debug}),this.hideInputs=t.hideInputs??t.anonymizer??n.hideInputs,this.hideOutputs=t.hideOutputs??t.anonymizer??n.hideOutputs,this.omitTracedRuntimeInfo=t.omitTracedRuntimeInfo??!1,this.autoBatchTracing=t.autoBatchTracing??this.autoBatchTracing,this.autoBatchQueue=new fM(r),this.blockOnRootRunFinalization=t.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=t.batchSizeBytesLimit,this.batchSizeLimit=t.batchSizeLimit,this.fetchOptions=t.fetchOptions||{},this.manualFlushMode=t.manualFlushMode??this.manualFlushMode,H1()&&(this.langSmithToOTELTranslator=new s$),this.cachedLSEnvVarsForMetadata=F1(),t.cache!==void 0&&t.disablePromptCache&&Fc("Both 'cache' and 'disablePromptCache' were provided. The 'cache' parameter is deprecated and will be removed in a future version. Using 'cache' parameter value."),t.cache!==void 0?(Fc("The 'cache' parameter is deprecated and will be removed in a future version. Use 'configureGlobalPromptCache()' to configure the global cache, or 'disablePromptCache: true' to disable caching for this client."),t.cache===!1?this._promptCache=void 0:t.cache===!0?this._promptCache=nS:this._promptCache=t.cache):t.disablePromptCache||(this._promptCache=nS)}static getDefaultClientConfig(){const t=dn("API_KEY"),n=dn("ENDPOINT")??uE,r=dn("HIDE_INPUTS")==="true",s=dn("HIDE_OUTPUTS")==="true";return{apiUrl:n,apiKey:t,webUrl:void 0,hideInputs:r,hideOutputs:s}}getHostUrl(){return this.webUrl?this.webUrl:sM(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const t={"User-Agent":`langsmith-js/${P1}`};return this.apiKey&&(t["x-api-key"]=`${this.apiKey}`),this.workspaceId&&(t["x-tenant-id"]=this.workspaceId),t}_getPlatformEndpointPath(t){return this.apiUrl.slice(-3)!=="/v1"&&this.apiUrl.slice(-4)!=="/v1/"?`/v1/platform/${t}`:`/platform/${t}`}async processInputs(t){return this.hideInputs===!1?t:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(t):t}async processOutputs(t){return this.hideOutputs===!1?t:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(t):t}async prepareRunCreateOrUpdateInputs(t){const n={...t};return n.inputs!==void 0&&(n.inputs=await this.processInputs(n.inputs)),n.outputs!==void 0&&(n.outputs=await this.processOutputs(n.outputs)),n}async _getResponse(t,n){const r=n?.toString()??"",s=`${this.apiUrl}${t}?${r}`;return await this.caller.call(async()=>{const u=await this._fetch(s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(u,`fetch ${t}`),u})}async _get(t,n){return(await this._getResponse(t,n)).json()}async*_getPaginated(t,n=new URLSearchParams,r){let s=Number(n.get("offset"))||0;const o=Number(n.get("limit"))||100;for(;;){n.set("offset",String(s)),n.set("limit",String(o));const u=`${this.apiUrl}${t}?${n}`,f=await this.caller.call(async()=>{const h=await this._fetch(u,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(h,`fetch ${t}`),h}),d=r?r(await f.json()):await f.json();if(d.length===0||(yield d,d.length<o))break;s+=d.length}}async*_getCursorPaginatedList(t,n=null,r="POST",s="runs"){const o=n?{...n}:{};for(;;){const u=JSON.stringify(o),d=await(await this.caller.call(async()=>{const m=await this._fetch(`${this.apiUrl}${t}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await we(m,`fetch ${t}`),m})).json();if(!d||!d[s])break;yield d[s];const h=d.cursors;if(!h||!h.next)break;o.cursor=h.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(t,n=!1){if(this.tracingSampleRate===void 0)return t;if(n){const r=[];for(const s of t)this.filteredPostUuids.has(s.trace_id)?s.id===s.trace_id&&this.filteredPostUuids.delete(s.trace_id):r.push(s);return r}else{const r=[];for(const s of t){const o=s.trace_id??s.id;this.filteredPostUuids.has(o)||(s.id===o?this._shouldSample()?r.push(s):this.filteredPostUuids.add(o):r.push(s))}return r}}async _getBatchSizeLimitBytes(){const t=await this._ensureServerInfo();return this.batchSizeBytesLimit??t?.batch_ingest_config?.size_limit_bytes??lM}async _getBatchSizeLimit(){const t=await this._ensureServerInfo();return this.batchSizeLimit??t?.batch_ingest_config?.size_limit??cM}async _getDatasetExamplesMultiPartSupport(){return(await this._ensureServerInfo()).instance_flags?.dataset_examples_multipart_enabled??!1}drainAutoBatchQueue({batchSizeLimitBytes:t,batchSizeLimit:n}){const r=[];for(;this.autoBatchQueue.items.length>0;){const[s,o]=this.autoBatchQueue.pop({upToSizeBytes:t,upToSize:n});if(!s.length){o();break}const u=s.reduce((h,m)=>{const _=m.apiUrl??this.apiUrl,y=m.apiKey??this.apiKey,w=m.apiKey===this.apiKey&&m.apiUrl===this.apiUrl?"default":`${_}|${y}`;return h[w]||(h[w]=[]),h[w].push(m),h},{}),f=[];for(const[h,m]of Object.entries(u)){const _=this._processBatch(m,{apiUrl:h==="default"?void 0:h.split("|")[0],apiKey:h==="default"?void 0:h.split("|")[1]});f.push(_)}const d=Promise.all(f).finally(o);r.push(d)}return Promise.all(r)}async _processBatch(t,n){if(!t.length)return;const r=t.reduce((s,o)=>s+(o.size??0),0);try{if(this.langSmithToOTELTranslator!==void 0)this._sendBatchToOTELTranslator(t);else{const s={runCreates:t.filter(f=>f.action==="create").map(f=>f.item),runUpdates:t.filter(f=>f.action==="update").map(f=>f.item)},o=await this._ensureServerInfo();if(!this._multipartDisabled&&(o?.batch_ingest_config?.use_multipart_endpoint??!0)){const f=!this._runCompressionDisabled&&o?.instance_flags?.gzip_body_enabled;try{await this.multipartIngestRuns(s,{...n,useGzip:f,sizeBytes:r})}catch(d){if(sE(d))this._multipartDisabled=!0,await this.batchIngestRuns(s,{...n,sizeBytes:r});else throw d}}else await this.batchIngestRuns(s,{...n,sizeBytes:r})}}catch(s){console.error("Error exporting batch:",s)}}_sendBatchToOTELTranslator(t){if(this.langSmithToOTELTranslator!==void 0){const n=new Map,r=[];for(const s of t)s.item.id&&s.otelContext&&(n.set(s.item.id,s.otelContext),s.action==="create"?r.push({operation:"post",id:s.item.id,trace_id:s.item.trace_id??s.item.id,run:s.item}):r.push({operation:"patch",id:s.item.id,trace_id:s.item.trace_id??s.item.id,run:s.item}));this.langSmithToOTELTranslator.exportBatch(r,n)}}async processRunOperation(t){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,t.item=oE(t.item,this.cachedLSEnvVarsForMetadata,this.omitTracedRuntimeInfo);const n=this.autoBatchQueue.push(t);if(this.manualFlushMode)return n;const r=await this._getBatchSizeLimitBytes(),s=await this._getBatchSizeLimit();return(this.autoBatchQueue.sizeBytes>r||this.autoBatchQueue.items.length>s)&&this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:s}),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:s})},this.autoBatchAggregationDelayMs)),n}async _getServerInfo(){const n=await(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(uM),...this.fetchOptions});return await we(r,"get server info"),r})).json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(n,null,2)+`
`),n}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch(t){console.warn(`[LANGSMITH]: Failed to fetch info on supported operations. Falling back to batch operations and default limits. Info: ${t.status??"Unspecified status code"} ${t.message}`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(t=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),t))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const t=await this._getBatchSizeLimitBytes(),n=await this._getBatchSizeLimit();await this.drainAutoBatchQueue({batchSizeLimitBytes:t,batchSizeLimit:n})}_cloneCurrentOTELContext(){const t=G1(),n=t$();if(this.langSmithToOTELTranslator!==void 0){const r=t.getActiveSpan();if(r)return t.setSpan(n.active(),r)}}async createRun(t,n){if(!this._filterForSampling([t]).length)return;const r={...this.headers,"Content-Type":"application/json"},s=t.project_name;delete t.project_name;const o=await this.prepareRunCreateOrUpdateInputs({session_name:s,...t,start_time:t.start_time??Date.now()});if(this.autoBatchTracing&&o.trace_id!==void 0&&o.dotted_order!==void 0){const d=this._cloneCurrentOTELContext();this.processRunOperation({action:"create",item:o,otelContext:d,apiKey:n?.apiKey,apiUrl:n?.apiUrl}).catch(console.error);return}const u=oE(o,this.cachedLSEnvVarsForMetadata,this.omitTracedRuntimeInfo);n?.apiKey!==void 0&&(r["x-api-key"]=n.apiKey),n?.workspaceId!==void 0&&(r["x-tenant-id"]=n.workspaceId);const f=Pn(u,`Creating run with id: ${u.id}`);await this.caller.call(async()=>{const d=await this._fetch(`${n?.apiUrl??this.apiUrl}/runs`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await we(d,"create run",!0),d})}async batchIngestRuns({runCreates:t,runUpdates:n},r){if(t===void 0&&n===void 0)return;let s=await Promise.all(t?.map(d=>this.prepareRunCreateOrUpdateInputs(d))??[]),o=await Promise.all(n?.map(d=>this.prepareRunCreateOrUpdateInputs(d))??[]);if(s.length>0&&o.length>0){const d=s.reduce((m,_)=>(_.id&&(m[_.id]=_),m),{}),h=[];for(const m of o)m.id!==void 0&&d[m.id]?d[m.id]={...d[m.id],...m}:h.push(m);s=Object.values(d),o=h}const u={post:s,patch:o};if(!u.post.length&&!u.patch.length)return;const f={post:[],patch:[]};for(const d of["post","patch"]){const h=d,m=u[h].reverse();let _=m.pop();for(;_!==void 0;)f[h].push(_),_=m.pop()}if(f.post.length>0||f.patch.length>0){const d=f.post.map(h=>h.id).concat(f.patch.map(h=>h.id)).join(",");await this._postBatchIngestRuns(Pn(f,`Ingesting runs with ids: ${d}`),r)}}async _postBatchIngestRuns(t,n){const r={...this.headers,"Content-Type":"application/json",Accept:"application/json"};n?.apiKey!==void 0&&(r["x-api-key"]=n.apiKey),await this.batchIngestCaller.callWithOptions({sizeBytes:n?.sizeBytes},async()=>{const s=await this._fetch(`${n?.apiUrl??this.apiUrl}/runs/batch`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:t});return await we(s,"batch create run",!0),s})}async multipartIngestRuns({runCreates:t,runUpdates:n},r){if(t===void 0&&n===void 0)return;const s={};let o=[];for(const _ of t??[]){const y=await this.prepareRunCreateOrUpdateInputs(_);y.id!==void 0&&y.attachments!==void 0&&(s[y.id]=y.attachments),delete y.attachments,o.push(y)}let u=[];for(const _ of n??[])u.push(await this.prepareRunCreateOrUpdateInputs(_));if(o.find(_=>_.trace_id===void 0||_.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(u.find(_=>_.trace_id===void 0||_.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(o.length>0&&u.length>0){const _=o.reduce((v,w)=>(w.id&&(v[w.id]=w),v),{}),y=[];for(const v of u)v.id!==void 0&&_[v.id]?_[v.id]={..._[v.id],...v}:y.push(v);o=Object.values(_),u=y}if(o.length===0&&u.length===0)return;const h=[],m=[];for(const[_,y]of[["post",o],["patch",u]])for(const v of y){const{inputs:w,outputs:x,events:R,extra:E,error:A,serialized:N,attachments:M,...B}=v,Y={inputs:w,outputs:x,events:R,extra:E,error:A,serialized:N},W=Pn(B,`Serializing for multipart ingestion of run with id: ${B.id}`);m.push({name:`${_}.${B.id}`,payload:new Blob([W],{type:`application/json; length=${W.length}`})});for(const[C,Te]of Object.entries(Y)){if(Te===void 0)continue;const xe=Pn(Te,`Serializing ${C} for multipart ingestion of run with id: ${B.id}`);m.push({name:`${_}.${B.id}.${C}`,payload:new Blob([xe],{type:`application/json; length=${xe.length}`})})}if(B.id!==void 0){const C=s[B.id];if(C){delete s[B.id];for(const[Te,xe]of Object.entries(C)){let me,Je;if(Array.isArray(xe)?[me,Je]=xe:(me=xe.mimeType,Je=xe.data),Te.includes(".")){console.warn(`Skipping attachment '${Te}' for run ${B.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}m.push({name:`attachment.${B.id}.${Te}`,payload:new Blob([Je],{type:`${me}; length=${Je.byteLength}`})})}}}h.push(`trace=${B.trace_id},id=${B.id}`)}await this._sendMultipartRequest(m,h.join("; "),r)}async _createNodeFetchBody(t,n){const r=[];for(const u of t)r.push(new Blob([`--${n}\r
`])),r.push(new Blob([`Content-Disposition: form-data; name="${u.name}"\r
`,`Content-Type: ${u.payload.type}\r
\r
`])),r.push(u.payload),r.push(new Blob([`\r
`]));return r.push(new Blob([`--${n}--\r
`])),await new Blob(r).arrayBuffer()}async _createMultipartStream(t,n){const r=new TextEncoder;return new ReadableStream({async start(o){const u=async f=>{typeof f=="string"?o.enqueue(r.encode(f)):o.enqueue(f)};for(const f of t){await u(`--${n}\r
`),await u(`Content-Disposition: form-data; name="${f.name}"\r
`),await u(`Content-Type: ${f.payload.type}\r
\r
`);const h=f.payload.stream().getReader();try{let m;for(;!(m=await h.read()).done;)o.enqueue(m.value)}finally{h.releaseLock()}await u(`\r
`)}await u(`--${n}--\r
`),o.close()}})}async _sendMultipartRequest(t,n,r){const s="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),o=()=>this._createNodeFetchBody(t,s),u=()=>this._createMultipartStream(t,s),f=async d=>this.batchIngestCaller.callWithOptions({sizeBytes:r?.sizeBytes},async()=>{const h=await d(),m={...this.headers,"Content-Type":`multipart/form-data; boundary=${s}`};r?.apiKey!==void 0&&(m["x-api-key"]=r.apiKey);let _=h;r?.useGzip&&typeof h=="object"&&"pipeThrough"in h&&(_=h.pipeThrough(new CompressionStream("gzip")),m["Content-Encoding"]="gzip");const y=await this._fetch(`${r?.apiUrl??this.apiUrl}/runs/multipart`,{method:"POST",headers:m,body:_,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(y,"Failed to send multipart request",!0),y});try{let d,h=!1;c2()&&!this.multipartStreamingDisabled&&Z1()!=="bun"?(h=!0,d=await f(u)):d=await f(o),(!this.multipartStreamingDisabled||h)&&d.status===422&&(r?.apiUrl??this.apiUrl)!==uE&&(console.warn(`Streaming multipart upload to ${r?.apiUrl??this.apiUrl}/runs/multipart failed. This usually means the host does not support chunked uploads. Retrying with a buffered upload for operation "${n}".`),this.multipartStreamingDisabled=!0,d=await f(o))}catch(d){if(sE(d))throw d;console.warn(`${d.message.trim()}

Context: ${n}`)}}async updateRun(t,n,r){Me(t),n.inputs&&(n.inputs=await this.processInputs(n.inputs)),n.outputs&&(n.outputs=await this.processOutputs(n.outputs));const s={...n,id:t};if(!this._filterForSampling([s],!0).length)return;if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){const f=this._cloneCurrentOTELContext();if(n.end_time!==void 0&&s.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:s,otelContext:f,apiKey:r?.apiKey,apiUrl:r?.apiUrl}).catch(console.error);return}else this.processRunOperation({action:"update",item:s,otelContext:f,apiKey:r?.apiKey,apiUrl:r?.apiUrl}).catch(console.error);return}const o={...this.headers,"Content-Type":"application/json"};r?.apiKey!==void 0&&(o["x-api-key"]=r.apiKey),r?.workspaceId!==void 0&&(o["x-tenant-id"]=r.workspaceId);const u=Pn(n,`Serializing payload to update run with id: ${t}`);await this.caller.call(async()=>{const f=await this._fetch(`${r?.apiUrl??this.apiUrl}/runs/${t}`,{method:"PATCH",headers:o,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await we(f,"update run",!0),f})}async readRun(t,{loadChildRuns:n}={loadChildRuns:!1}){Me(t);let r=await this._get(`/runs/${t}`);return n&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:t,run:n,projectOpts:r}){if(n!==void 0){let s;n.session_id?s=n.session_id:r?.projectName?s=(await this.readProject({projectName:r?.projectName})).id:r?.projectId?s=r?.projectId:s=(await this.readProject({projectName:dn("PROJECT")||"default"})).id;const o=await this._getTenantId();return`${this.getHostUrl()}/o/${o}/projects/p/${s}/r/${n.id}?poll=true`}else if(t!==void 0){const s=await this.readRun(t);if(!s.app_path)throw new Error(`Run ${t} has no app_path`);return`${this.getHostUrl()}${s.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(t){const n=await iM(this.listRuns({isRoot:!1,projectId:t.session_id,traceId:t.trace_id})),r={},s={};n.sort((o,u)=>(o?.dotted_order??"").localeCompare(u?.dotted_order??""));for(const o of n){if(o.parent_run_id===null||o.parent_run_id===void 0)throw new Error(`Child run ${o.id} has no parent`);o.dotted_order?.startsWith(t.dotted_order??"")&&o.id!==t.id&&(o.parent_run_id in r||(r[o.parent_run_id]=[]),r[o.parent_run_id].push(o),s[o.id]=o)}t.child_runs=r[t.id]||[];for(const o in r)o!==t.id&&(s[o].child_runs=r[o]);return t}async*listRuns(t){const{projectId:n,projectName:r,parentRunId:s,traceId:o,referenceExampleId:u,startTime:f,executionOrder:d,isRoot:h,runType:m,error:_,id:y,query:v,filter:w,traceFilter:x,treeFilter:R,limit:E,select:A,order:N}=t;let M=[];if(n&&(M=Array.isArray(n)?n:[n]),r){const C=Array.isArray(r)?r:[r],Te=await Promise.all(C.map(xe=>this.readProject({projectName:xe}).then(me=>me.id)));M.push(...Te)}const B=["app_path","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],Y={session:M.length?M:null,run_type:m,reference_example:u,query:v,filter:w,trace_filter:x,tree_filter:R,execution_order:d,parent_run:s,start_time:f?f.toISOString():null,error:_,id:y,limit:E,trace:o,select:A||B,is_root:h,order:N};Y.select.includes("child_run_ids")&&Fc("Deprecated: 'child_run_ids' in the listRuns select parameter is deprecated and will be removed in a future version.");let W=0;for await(const C of this._getCursorPaginatedList("/runs/query",Y))if(E){if(W>=E)break;if(C.length+W>E){yield*C.slice(0,E-W);break}W+=C.length,yield*C}else yield*C}async*listGroupRuns(t){const{projectId:n,projectName:r,groupBy:s,filter:o,startTime:u,endTime:f,limit:d,offset:h}=t,_={session_id:n||(await this.readProject({projectName:r})).id,group_by:s,filter:o,start_time:u?u.toISOString():null,end_time:f?f.toISOString():null,limit:Number(d)||100};let y=Number(h)||0;const v="/runs/group",w=`${this.apiUrl}${v}`;for(;;){const x={..._,offset:y},R=Object.fromEntries(Object.entries(x).filter(([Y,W])=>W!==void 0)),E=JSON.stringify(R),N=await(await this.caller.call(async()=>{const Y=await this._fetch(w,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:E});return await we(Y,`Failed to fetch ${v}`),Y})).json(),{groups:M,total:B}=N;if(M.length===0)break;for(const Y of M)yield Y;if(y+=M.length,y>=B)break}}async getRunStats({id:t,trace:n,parentRun:r,runType:s,projectNames:o,projectIds:u,referenceExampleIds:f,startTime:d,endTime:h,error:m,query:_,filter:y,traceFilter:v,treeFilter:w,isRoot:x,dataSourceType:R}){let E=u||[];o&&(E=[...u||[],...await Promise.all(o.map(W=>this.readProject({projectName:W}).then(C=>C.id)))]);const N=Object.fromEntries(Object.entries({id:t,trace:n,parent_run:r,run_type:s,session:E,reference_example:f,start_time:d,end_time:h,error:m,query:_,filter:y,trace_filter:v,tree_filter:w,is_root:x,data_source_type:R}).filter(([W,C])=>C!==void 0)),M=JSON.stringify(N);return await(await this.caller.call(async()=>{const W=await this._fetch(`${this.apiUrl}/runs/stats`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:M});return await we(W,"get run stats"),W})).json()}async shareRun(t,{shareId:n}={}){const r={run_id:t,share_token:n||Ms()};Me(t);const s=JSON.stringify(r),u=await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/runs/${t}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await we(f,"share run"),f})).json();if(u===null||!("share_token"in u))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${u.share_token}/r`}async unshareRun(t){Me(t),await this.caller.call(async()=>{const n=await this._fetch(`${this.apiUrl}/runs/${t}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(n,"unshare run",!0),n})}async readRunSharedLink(t){Me(t);const r=await(await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/runs/${t}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(s,"read run shared link"),s})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(t,{runIds:n}={}){const r=new URLSearchParams({share_token:t});if(n!==void 0)for(const u of n)r.append("id",u);return Me(t),await(await this.caller.call(async()=>{const u=await this._fetch(`${this.apiUrl}/public/${t}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(u,"list shared runs"),u})).json()}async readDatasetSharedSchema(t,n){if(!t&&!n)throw new Error("Either datasetId or datasetName must be given");t||(t=(await this.readDataset({datasetName:n})).id),Me(t);const s=await(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}/datasets/${t}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(o,"read dataset shared schema"),o})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async shareDataset(t,n){if(!t&&!n)throw new Error("Either datasetId or datasetName must be given");t||(t=(await this.readDataset({datasetName:n})).id);const r={dataset_id:t};Me(t);const s=JSON.stringify(r),u=await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/datasets/${t}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await we(f,"share dataset"),f})).json();return u.url=`${this.getHostUrl()}/public/${u.share_token}/d`,u}async unshareDataset(t){Me(t),await this.caller.call(async()=>{const n=await this._fetch(`${this.apiUrl}/datasets/${t}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(n,"unshare dataset",!0),n})}async readSharedDataset(t){return Me(t),await(await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/public/${t}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(s,"read shared dataset"),s})).json()}async listSharedExamples(t,n){const r={};n?.exampleIds&&(r.id=n.exampleIds);const s=new URLSearchParams;Object.entries(r).forEach(([f,d])=>{Array.isArray(d)?d.forEach(h=>s.append(f,h)):s.append(f,d)});const o=await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/public/${t}/examples?${s.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(f,"list shared examples"),f}),u=await o.json();if(!o.ok)throw"detail"in u?new Error(`Failed to list shared examples.
Status: ${o.status}
Message: ${Array.isArray(u.detail)?u.detail.join(`
`):"Unspecified error"}`):new Error(`Failed to list shared examples: ${o.status} ${o.statusText}`);return u.map(f=>({...f,_hostUrl:this.getHostUrl()}))}async createProject({projectName:t,description:n=null,metadata:r=null,upsert:s=!1,projectExtra:o=null,referenceDatasetId:u=null}){const f=s?"?upsert=true":"",d=`${this.apiUrl}/sessions${f}`,h=o||{};r&&(h.metadata=r);const m={name:t,extra:h,description:n};u!==null&&(m.reference_dataset_id=u);const _=JSON.stringify(m);return await(await this.caller.call(async()=>{const w=await this._fetch(d,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:_});return await we(w,"create project"),w})).json()}async updateProject(t,{name:n=null,description:r=null,metadata:s=null,projectExtra:o=null,endTime:u=null}){const f=`${this.apiUrl}/sessions/${t}`;let d=o;s&&(d={...d||{},metadata:s});const h=JSON.stringify({name:n,extra:d,description:r,end_time:u?new Date(u).toISOString():null});return await(await this.caller.call(async()=>{const y=await this._fetch(f,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await we(y,"update project"),y})).json()}async hasProject({projectId:t,projectName:n}){let r="/sessions";const s=new URLSearchParams;if(t!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(t!==void 0)Me(t),r+=`/${t}`;else if(n!==void 0)s.append("name",n);else throw new Error("Must provide projectName or projectId");const o=await this.caller.call(async()=>{const u=await this._fetch(`${this.apiUrl}${r}?${s}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(u,"has project"),u});try{const u=await o.json();return o.ok?Array.isArray(u)?u.length>0:!0:!1}catch{return!1}}async readProject({projectId:t,projectName:n,includeStats:r}){let s="/sessions";const o=new URLSearchParams;if(t!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(t!==void 0)Me(t),s+=`/${t}`;else if(n!==void 0)o.append("name",n);else throw new Error("Must provide projectName or projectId");r!==void 0&&o.append("include_stats",r.toString());const u=await this._get(s,o);let f;if(Array.isArray(u)){if(u.length===0)throw new Error(`Project[id=${t}, name=${n}] not found`);f=u[0]}else f=u;return f}async getProjectUrl({projectId:t,projectName:n}){if(t===void 0&&n===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:t,projectName:n}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${r.id}`}async getDatasetUrl({datasetId:t,datasetName:n}){if(t===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:t,datasetName:n}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const t=new URLSearchParams({limit:"1"});for await(const n of this._getPaginated("/sessions",t))return this._tenantId=n[0].tenant_id,n[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:t,name:n,nameContains:r,referenceDatasetId:s,referenceDatasetName:o,includeStats:u,datasetVersion:f,referenceFree:d,metadata:h}={}){const m=new URLSearchParams;if(t!==void 0)for(const _ of t)m.append("id",_);if(n!==void 0&&m.append("name",n),r!==void 0&&m.append("name_contains",r),s!==void 0)m.append("reference_dataset",s);else if(o!==void 0){const _=await this.readDataset({datasetName:o});m.append("reference_dataset",_.id)}u!==void 0&&m.append("include_stats",u.toString()),f!==void 0&&m.append("dataset_version",f),d!==void 0&&m.append("reference_free",d.toString()),h!==void 0&&m.append("metadata",JSON.stringify(h));for await(const _ of this._getPaginated("/sessions",m))yield*_}async deleteProject({projectId:t,projectName:n}){let r;if(t===void 0&&n===void 0)throw new Error("Must provide projectName or projectId");if(t!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");t===void 0?r=(await this.readProject({projectName:n})).id:r=t,Me(r),await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(s,`delete session ${r} (${n})`,!0),s})}async uploadCsv({csvFile:t,fileName:n,inputKeys:r,outputKeys:s,description:o,dataType:u,name:f}){const d=`${this.apiUrl}/datasets/upload`,h=new FormData,m=new Blob([t],{type:"text/csv"});return h.append("file",m,n),r.forEach(v=>{h.append("input_keys",v)}),s.forEach(v=>{h.append("output_keys",v)}),o&&h.append("description",o),u&&h.append("data_type",u),f&&h.append("name",f),await(await this.caller.call(async()=>{const v=await this._fetch(d,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await we(v,"upload CSV"),v})).json()}async createDataset(t,{description:n,dataType:r,inputsSchema:s,outputsSchema:o,metadata:u}={}){const f={name:t,description:n,extra:u?{metadata:u}:void 0};r&&(f.data_type=r),s&&(f.inputs_schema_definition=s),o&&(f.outputs_schema_definition=o);const d=JSON.stringify(f);return await(await this.caller.call(async()=>{const _=await this._fetch(`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await we(_,"create dataset"),_})).json()}async readDataset({datasetId:t,datasetName:n}){let r="/datasets";const s=new URLSearchParams({limit:"1"});if(t&&n)throw new Error("Must provide either datasetName or datasetId, not both");if(t)Me(t),r+=`/${t}`;else if(n)s.append("name",n);else throw new Error("Must provide datasetName or datasetId");const o=await this._get(r,s);let u;if(Array.isArray(o)){if(o.length===0)throw new Error(`Dataset[id=${t}, name=${n}] not found`);u=o[0]}else u=o;return u}async hasDataset({datasetId:t,datasetName:n}){try{return await this.readDataset({datasetId:t,datasetName:n}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:t,datasetName:n,fromVersion:r,toVersion:s}){let o=t;if(o===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");if(o!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");o===void 0&&(o=(await this.readDataset({datasetName:n})).id);const u=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof s=="string"?s:s.toISOString()});return await this._get(`/datasets/${o}/versions/diff`,u)}async readDatasetOpenaiFinetuning({datasetId:t,datasetName:n}){const r="/datasets";if(t===void 0)if(n!==void 0)t=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${r}/${t}/openai_ft`)).text()).trim().split(`
`).map(f=>JSON.parse(f))}async*listDatasets({limit:t=100,offset:n=0,datasetIds:r,datasetName:s,datasetNameContains:o,metadata:u}={}){const f="/datasets",d=new URLSearchParams({limit:t.toString(),offset:n.toString()});if(r!==void 0)for(const h of r)d.append("id",h);s!==void 0&&d.append("name",s),o!==void 0&&d.append("name_contains",o),u!==void 0&&d.append("metadata",JSON.stringify(u));for await(const h of this._getPaginated(f,d))yield*h}async updateDataset(t){const{datasetId:n,datasetName:r,...s}=t;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const o=n??(await this.readDataset({datasetName:r})).id;Me(o);const u=JSON.stringify(s);return await(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/datasets/${o}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await we(d,"update dataset"),d})).json()}async updateDatasetTag(t){const{datasetId:n,datasetName:r,asOf:s,tag:o}=t;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const u=n??(await this.readDataset({datasetName:r})).id;Me(u);const f=JSON.stringify({as_of:typeof s=="string"?s:s.toISOString(),tag:o});await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/datasets/${u}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await we(d,"update dataset tags",!0),d})}async deleteDataset({datasetId:t,datasetName:n}){let r="/datasets",s=t;if(t!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(n!==void 0&&(s=(await this.readDataset({datasetName:n})).id),s!==void 0)Me(s),r+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");await this.caller.call(async()=>{const o=await this._fetch(this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(o,`delete ${r}`,!0),o})}async indexDataset({datasetId:t,datasetName:n,tag:r}){let s=t;if(!s&&!n)throw new Error("Must provide either datasetName or datasetId");if(s&&n)throw new Error("Must provide either datasetName or datasetId, not both");s||(s=(await this.readDataset({datasetName:n})).id),Me(s);const u=JSON.stringify({tag:r});await(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/datasets/${s}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await we(d,"index dataset"),d})).json()}async similarExamples(t,n,r,{filter:s}={}){const o={limit:r,inputs:t};s!==void 0&&(o.filter=s),Me(n);const u=JSON.stringify(o);return(await(await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/datasets/${n}/search`,{headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,method:"POST",body:u});return await we(h,"fetch similar examples"),h})).json()).examples}async createExample(t,n,r){if(cE(t)&&(n!==void 0||r!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let s=n?r?.datasetId:t.dataset_id;const o=n?r?.datasetName:t.dataset_name;if(s===void 0&&o===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&o!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:o})).id);const u=(n?r?.createdAt:t.created_at)||new Date;let f;cE(t)?f=t:f={inputs:t,outputs:n,created_at:u?.toISOString(),id:r?.exampleId,metadata:r?.metadata,split:r?.split,source_run_id:r?.sourceRunId,use_source_run_io:r?.useSourceRunIO,use_source_run_attachments:r?.useSourceRunAttachments,attachments:r?.attachments};const d=await this._uploadExamplesMultipart(s,[f]);return await this.readExample(d.example_ids?.[0]??Ms())}async createExamples(t){if(Array.isArray(t)){if(t.length===0)return[];const A=t;let N=A[0].dataset_id;const M=A[0].dataset_name;if(N===void 0&&M===void 0)throw new Error("Must provide either datasetName or datasetId");if(N!==void 0&&M!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");N===void 0&&(N=(await this.readDataset({datasetName:M})).id);const B=await this._uploadExamplesMultipart(N,A);return await Promise.all(B.example_ids.map(W=>this.readExample(W)))}const{inputs:n,outputs:r,metadata:s,splits:o,sourceRunIds:u,useSourceRunIOs:f,useSourceRunAttachments:d,attachments:h,exampleIds:m,datasetId:_,datasetName:y}=t;if(n===void 0)throw new Error("Must provide inputs when using legacy parameters");let v=_;const w=y;if(v===void 0&&w===void 0)throw new Error("Must provide either datasetName or datasetId");if(v!==void 0&&w!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");v===void 0&&(v=(await this.readDataset({datasetName:w})).id);const x=n.map((A,N)=>({dataset_id:v,inputs:A,outputs:r?.[N],metadata:s?.[N],split:o?.[N],id:m?.[N],attachments:h?.[N],source_run_id:u?.[N],use_source_run_io:f?.[N],use_source_run_attachments:d?.[N]})),R=await this._uploadExamplesMultipart(v,x);return await Promise.all(R.example_ids.map(A=>this.readExample(A)))}async createLLMExample(t,n,r){return this.createExample({input:t},{output:n},r)}async createChatExample(t,n,r){const s=t.map(u=>dS(u)?hS(u):u),o=dS(n)?hS(n):n;return this.createExample({input:s},{output:o},r)}async readExample(t){Me(t);const n=`/examples/${t}`,r=await this._get(n),{attachment_urls:s,...o}=r,u=o;return s&&(u.attachments=Object.entries(s).reduce((f,[d,h])=>(f[d.slice(11)]={presigned_url:h.presigned_url,mime_type:h.mime_type},f),{})),u}async*listExamples({datasetId:t,datasetName:n,exampleIds:r,asOf:s,splits:o,inlineS3Urls:u,metadata:f,limit:d,offset:h,filter:m,includeAttachments:_}={}){let y;if(t!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0)y=t;else if(n!==void 0)y=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide a datasetName or datasetId");const v=new URLSearchParams({dataset:y}),w=s?typeof s=="string"?s:s?.toISOString():void 0;w&&v.append("as_of",w);const x=u??!0;if(v.append("inline_s3_urls",x.toString()),r!==void 0)for(const E of r)v.append("id",E);if(o!==void 0)for(const E of o)v.append("splits",E);if(f!==void 0){const E=JSON.stringify(f);v.append("metadata",E)}d!==void 0&&v.append("limit",d.toString()),h!==void 0&&v.append("offset",h.toString()),m!==void 0&&v.append("filter",m),_===!0&&["attachment_urls","outputs","metadata"].forEach(E=>v.append("select",E));let R=0;for await(const E of this._getPaginated("/examples",v)){for(const A of E){const{attachment_urls:N,...M}=A,B=M;N&&(B.attachments=Object.entries(N).reduce((Y,[W,C])=>(Y[W.slice(11)]={presigned_url:C.presigned_url,mime_type:C.mime_type||void 0},Y),{})),yield B,R++}if(d!==void 0&&R>=d)break}}async deleteExample(t){Me(t);const n=`/examples/${t}`;await this.caller.call(async()=>{const r=await this._fetch(this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(r,`delete ${n}`,!0),r})}async deleteExamples(t,n){if(t.forEach(r=>Me(r)),n?.hardDelete){const r=this._getPlatformEndpointPath("datasets/examples/delete");await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}${r}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({example_ids:t,hard_delete:!0}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(s,"hard delete examples",!0),s})}else{const r=new URLSearchParams;t.forEach(s=>r.append("example_ids",s)),await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/examples?${r.toString()}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(s,"delete examples",!0),s})}}async updateExample(t,n){let r;n?r=t:r=t.id,Me(r);let s;n?s={id:r,...n}:s=t;let o;return s.dataset_id!==void 0?o=s.dataset_id:o=(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(o,[s])}async updateExamples(t){let n;return t[0].dataset_id===void 0?n=(await this.readExample(t[0].id)).dataset_id:n=t[0].dataset_id,this._updateExamplesMultipart(n,t)}async readDatasetVersion({datasetId:t,datasetName:n,asOf:r,tag:s}){let o;if(t?o=t:o=(await this.readDataset({datasetName:n})).id,Me(o),r&&s||!r&&!s)throw new Error("Exactly one of asOf and tag must be specified.");const u=new URLSearchParams;return r!==void 0&&u.append("as_of",typeof r=="string"?r:r.toISOString()),s!==void 0&&u.append("tag",s),await(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/datasets/${o}/version?${u.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(d,"read dataset version"),d})).json()}async listDatasetSplits({datasetId:t,datasetName:n,asOf:r}){let s;if(t===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(t!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");t===void 0?s=(await this.readDataset({datasetName:n})).id:s=t,Me(s);const o=new URLSearchParams,u=r?typeof r=="string"?r:r?.toISOString():void 0;return u&&o.append("as_of",u),await this._get(`/datasets/${s}/splits`,o)}async updateDatasetSplits({datasetId:t,datasetName:n,splitName:r,exampleIds:s,remove:o=!1}){let u;if(t===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(t!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");t===void 0?u=(await this.readDataset({datasetName:n})).id:u=t,Me(u);const f={split_name:r,examples:s.map(h=>(Me(h),h)),remove:o},d=JSON.stringify(f);await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/datasets/${u}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await we(h,"update dataset splits",!0),h})}async createFeedback(t,n,{score:r,value:s,correction:o,comment:u,sourceInfo:f,feedbackSourceType:d="api",sourceRunId:h,feedbackId:m,feedbackConfig:_,projectId:y,comparativeExperimentId:v,sessionId:w,startTime:x}){if(!t&&!y)throw new Error("One of runId or projectId must be provided");if(t&&y)throw new Error("Only one of runId or projectId can be provided");const R={type:d??"api",metadata:f??{}};h!==void 0&&R?.metadata!==void 0&&!R.metadata.__run&&(R.metadata.__run={run_id:h}),R?.metadata!==void 0&&R.metadata.__run?.run_id!==void 0&&Me(R.metadata.__run.run_id);const E={id:m??Ms(),run_id:t,key:n,score:lE(r),value:s,correction:o,comment:u,feedback_source:R,comparative_experiment_id:v,feedbackConfig:_,session_id:w??y,start_time:x},A=JSON.stringify(E),N=`${this.apiUrl}/feedback`;return await this.caller.call(async()=>{const M=await this._fetch(N,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:A});return await we(M,"create feedback",!0),M}),E}async updateFeedback(t,{score:n,value:r,correction:s,comment:o}){const u={};n!=null&&(u.score=lE(n)),r!=null&&(u.value=r),s!=null&&(u.correction=s),o!=null&&(u.comment=o),Me(t);const f=JSON.stringify(u);await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/feedback/${t}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await we(d,"update feedback",!0),d})}async readFeedback(t){Me(t);const n=`/feedback/${t}`;return await this._get(n)}async deleteFeedback(t){Me(t);const n=`/feedback/${t}`;await this.caller.call(async()=>{const r=await this._fetch(this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(r,`delete ${n}`,!0),r})}async*listFeedback({runIds:t,feedbackKeys:n,feedbackSourceTypes:r}={}){const s=new URLSearchParams;if(t)for(const o of t)Me(o),s.append("run",o);if(n)for(const o of n)s.append("key",o);if(r)for(const o of r)s.append("source",o);for await(const o of this._getPaginated("/feedback",s))yield*o}async createPresignedFeedbackToken(t,n,{expiration:r,feedbackConfig:s}={}){const o={run_id:t,feedback_key:n,feedback_config:s};r?typeof r=="string"?o.expires_at=r:(r?.hours||r?.minutes||r?.days)&&(o.expires_in=r):o.expires_in={hours:3};const u=JSON.stringify(o);return await(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await we(d,"create presigned feedback token"),d})).json()}async createComparativeExperiment({name:t,experimentIds:n,referenceDatasetId:r,createdAt:s,description:o,metadata:u,id:f}){if(n.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:n[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const d={id:f,name:t,experiment_ids:n,reference_dataset_id:r,description:o,created_at:(s??new Date)?.toISOString(),extra:{}};u&&(d.extra.metadata=u);const h=JSON.stringify(d);return(await this.caller.call(async()=>{const _=await this._fetch(`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await we(_,"create comparative experiment"),_})).json()}async*listPresignedFeedbackTokens(t){Me(t);const n=new URLSearchParams({run_id:t});for await(const r of this._getPaginated("/feedback/tokens",n))yield*r}_selectEvalResults(t){let n;return"results"in t?n=t.results:Array.isArray(t)?n=t:n=[t],n}async _logEvaluationFeedback(t,n,r){const s=this._selectEvalResults(t),o=[];for(const u of s){let f=r||{};u.evaluatorInfo&&(f={...u.evaluatorInfo,...f});let d=null;u.targetRunId?d=u.targetRunId:n&&(d=n.id),o.push(await this.createFeedback(d,u.key,{score:u.score,value:u.value,comment:u.comment,correction:u.correction,sourceInfo:f,sourceRunId:u.sourceRunId,feedbackConfig:u.feedbackConfig,feedbackSourceType:"model",sessionId:n?.session_id,startTime:n?.start_time}))}return[s,o]}async logEvaluationFeedback(t,n,r){const[s]=await this._logEvaluationFeedback(t,n,r);return s}async createFeedbackConfig(t){const{feedbackKey:n,feedbackConfig:r,isLowerScoreBetter:s=!1}=t,o={feedback_key:n,feedback_config:r,is_lower_score_better:s};return(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/feedback-configs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(o)});return await we(f,"create feedback config"),f})).json()}async*listFeedbackConfigs(t={}){const{feedbackKeys:n,nameContains:r,limit:s}=t,o=new URLSearchParams;n&&n.forEach(f=>{o.append("key",f)}),r&&o.append("name_contains",r),o.append("limit",(s!==void 0?Math.min(s,100):100).toString());let u=0;for await(const f of this._getPaginated("/feedback-configs",o))if(yield*f,u+=f.length,s!==void 0&&u>=s)break}async updateFeedbackConfig(t,n={}){const{feedbackConfig:r,isLowerScoreBetter:s}=n,o={feedback_key:t};return r!==void 0&&(o.feedback_config=r),s!==void 0&&(o.is_lower_score_better=s),(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/feedback-configs`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(o)});return await we(f,"update feedback config"),f})).json()}async deleteFeedbackConfig(t){const n=new URLSearchParams({feedback_key:t});await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/feedback-configs?${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(r,"delete feedback config",!0),r})}async*listAnnotationQueues(t={}){const{queueIds:n,name:r,nameContains:s,limit:o}=t,u=new URLSearchParams;n&&n.forEach((d,h)=>{Me(d,`queueIds[${h}]`),u.append("ids",d)}),r&&u.append("name",r),s&&u.append("name_contains",s),u.append("limit",(o!==void 0?Math.min(o,100):100).toString());let f=0;for await(const d of this._getPaginated("/annotation-queues",u))if(yield*d,f++,o!==void 0&&f>=o)break}async createAnnotationQueue(t){const{name:n,description:r,queueId:s,rubricInstructions:o,rubricItems:u}=t,f={name:n,description:r,id:s||Ms(),rubric_instructions:o,rubric_items:u},d=JSON.stringify(Object.fromEntries(Object.entries(f).filter(([m,_])=>_!==void 0)));return(await this.caller.call(async()=>{const m=await this._fetch(`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await we(m,"create annotation queue"),m})).json()}async readAnnotationQueue(t){return(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${Me(t,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(r,"read annotation queue"),r})).json()}async updateAnnotationQueue(t,n){const{name:r,description:s,rubricInstructions:o,rubricItems:u}=n,f={};r!==void 0&&(f.name=r),s!==void 0&&(f.description=s),o!==void 0&&(f.rubric_instructions=o),u!==void 0&&(f.rubric_items=u);const d=JSON.stringify(f);await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/annotation-queues/${Me(t,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await we(h,"update annotation queue",!0),h})}async deleteAnnotationQueue(t){await this.caller.call(async()=>{const n=await this._fetch(`${this.apiUrl}/annotation-queues/${Me(t,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(n,"delete annotation queue",!0),n})}async addRunsToAnnotationQueue(t,n){const r=JSON.stringify(n.map((s,o)=>Me(s,`runIds[${o}]`).toString()));await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/annotation-queues/${Me(t,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await we(s,"add runs to annotation queue",!0),s})}async getRunFromAnnotationQueue(t,n){const r=`/annotation-queues/${Me(t,"queueId")}/run`;return(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(o,"get run from annotation queue"),o})).json()}async deleteRunFromAnnotationQueue(t,n){await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${Me(t,"queueId")}/runs/${Me(n,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(r,"delete run from annotation queue",!0),r})}async getSizeFromAnnotationQueue(t){return(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${Me(t,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(r,"get size from annotation queue"),r})).json()}async _currentTenantIsOwner(t){const n=await this._getSettings();return t=="-"||n.tenant_handle===t}async _ownerConflictError(t,n){const r=await this._getSettings();return new Error(`Cannot ${t} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${n}`)}async _getLatestCommitHash(t){const r=await(await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/commits/${t}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(s,"get latest commit hash"),s})).json();if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(t,n){const[r,s,o]=Fa(t),u=JSON.stringify({like:n});return(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/likes/${r}/${s}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await we(d,`${n?"like":"unlike"} prompt`),d})).json()}async _getPromptUrl(t){const[n,r,s]=Fa(t);if(await this._currentTenantIsOwner(n)){const o=await this._getSettings();return s!=="latest"?`${this.getHostUrl()}/prompts/${r}/${s.substring(0,8)}?organizationId=${o.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${o.id}`}else return s!=="latest"?`${this.getHostUrl()}/hub/${n}/${r}/${s.substring(0,8)}`:`${this.getHostUrl()}/hub/${n}/${r}`}async promptExists(t){return!!await this.getPrompt(t)}async likePrompt(t){return this._likeOrUnlikePrompt(t,!0)}async unlikePrompt(t){return this._likeOrUnlikePrompt(t,!1)}async*listCommits(t){for await(const n of this._getPaginated(`/commits/${t}/`,new URLSearchParams,r=>r.commits))yield*n}async*listPrompts(t){const n=new URLSearchParams;n.append("sort_field",t?.sortField??"updated_at"),n.append("sort_direction","desc"),n.append("is_archived",(!!t?.isArchived).toString()),t?.isPublic!==void 0&&n.append("is_public",t.isPublic.toString()),t?.query&&n.append("query",t.query);for await(const r of this._getPaginated("/repos",n,s=>s.repos))yield*r}async getPrompt(t){const[n,r,s]=Fa(t),u=await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/repos/${n}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return f?.status===404?null:(await we(f,"get prompt"),f)}))?.json();return u?.repo?u.repo:null}async createPrompt(t,n){const r=await this._getSettings();if(n?.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle.
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[s,o,u]=Fa(t);if(!await this._currentTenantIsOwner(s))throw await this._ownerConflictError("create a prompt",s);const f={repo_handle:o,...n?.description&&{description:n.description},...n?.readme&&{readme:n.readme},...n?.tags&&{tags:n.tags},is_public:!!n?.isPublic},d=JSON.stringify(f),h=await this.caller.call(async()=>{const _=await this._fetch(`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:d});return await we(_,"create prompt"),_}),{repo:m}=await h.json();return m}async createCommit(t,n,r){if(!await this.promptExists(t))throw new Error("Prompt does not exist, you must create it first.");const[s,o,u]=Fa(t),f=r?.parentCommitHash==="latest"||!r?.parentCommitHash?await this._getLatestCommitHash(`${s}/${o}`):r?.parentCommitHash,d={manifest:JSON.parse(JSON.stringify(n)),parent_commit:f},h=JSON.stringify(d),_=await(await this.caller.call(async()=>{const y=await this._fetch(`${this.apiUrl}/commits/${s}/${o}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await we(y,"create commit"),y})).json();return this._getPromptUrl(`${s}/${o}${_.commit_hash?`:${_.commit_hash}`:""}`)}async updateExamplesMultipart(t,n=[]){return this._updateExamplesMultipart(t,n)}async _updateExamplesMultipart(t,n=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const u of n){const f=u.id,d={...u.metadata&&{metadata:u.metadata},...u.split&&{split:u.split}},h=Pn(d,`Serializing body for example with id: ${f}`),m=new Blob([h],{type:"application/json"});if(r.append(f,m),u.inputs){const _=Pn(u.inputs,`Serializing inputs for example with id: ${f}`),y=new Blob([_],{type:"application/json"});r.append(`${f}.inputs`,y)}if(u.outputs){const _=Pn(u.outputs,`Serializing outputs whle updating example with id: ${f}`),y=new Blob([_],{type:"application/json"});r.append(`${f}.outputs`,y)}if(u.attachments)for(const[_,y]of Object.entries(u.attachments)){let v,w;Array.isArray(y)?[v,w]=y:(v=y.mimeType,w=y.data);const x=new Blob([w],{type:`${v}; length=${w.byteLength}`});r.append(`${f}.attachment.${_}`,x)}if(u.attachments_operations){const _=Pn(u.attachments_operations,`Serializing attachments while updating example with id: ${f}`),y=new Blob([_],{type:"application/json"});r.append(`${f}.attachments_operations`,y)}}const s=t??n[0]?.dataset_id;return(await this.caller.call(async()=>{const u=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${s}/examples`)}`,{method:"PATCH",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await we(u,"update examples"),u})).json()}async uploadExamplesMultipart(t,n=[]){return this._uploadExamplesMultipart(t,n)}async _uploadExamplesMultipart(t,n=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const o of n){const u=(o.id??Ms()).toString(),f={created_at:o.created_at,...o.metadata&&{metadata:o.metadata},...o.split&&{split:o.split},...o.source_run_id&&{source_run_id:o.source_run_id},...o.use_source_run_io&&{use_source_run_io:o.use_source_run_io},...o.use_source_run_attachments&&{use_source_run_attachments:o.use_source_run_attachments}},d=Pn(f,`Serializing body for uploaded example with id: ${u}`),h=new Blob([d],{type:"application/json"});if(r.append(u,h),o.inputs){const m=Pn(o.inputs,`Serializing inputs for uploaded example with id: ${u}`),_=new Blob([m],{type:"application/json"});r.append(`${u}.inputs`,_)}if(o.outputs){const m=Pn(o.outputs,`Serializing outputs for uploaded example with id: ${u}`),_=new Blob([m],{type:"application/json"});r.append(`${u}.outputs`,_)}if(o.attachments)for(const[m,_]of Object.entries(o.attachments)){let y,v;Array.isArray(_)?[y,v]=_:(y=_.mimeType,v=_.data);const w=new Blob([v],{type:`${y}; length=${v.byteLength}`});r.append(`${u}.attachment.${m}`,w)}}return(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${t}/examples`)}`,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await we(o,"upload examples"),o})).json()}async updatePrompt(t,n){if(!await this.promptExists(t))throw new Error("Prompt does not exist, you must create it first.");const[r,s]=Fa(t);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const o={};if(n?.description!==void 0&&(o.description=n.description),n?.readme!==void 0&&(o.readme=n.readme),n?.tags!==void 0&&(o.tags=n.tags),n?.isPublic!==void 0&&(o.is_public=n.isPublic),n?.isArchived!==void 0&&(o.is_archived=n.isArchived),Object.keys(o).length===0)throw new Error("No valid update options provided");const u=JSON.stringify(o);return(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/repos/${r}/${s}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await we(d,"update prompt"),d})).json()}async deletePrompt(t){if(!await this.promptExists(t))throw new Error("Prompt does not exist, you must create it first.");const[n,r,s]=Fa(t);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("delete a prompt",n);return(await this.caller.call(async()=>{const u=await this._fetch(`${this.apiUrl}/repos/${n}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(u,"delete prompt"),u})).json()}_getPromptCacheKey(t,n){return`${t}${n?":with_model":""}`}async _fetchPromptFromApi(t,n){const[r,s,o]=Fa(t),f=await(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}/commits/${r}/${s}/${o}${n?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await we(d,"pull prompt commit"),d})).json();return{owner:r,repo:s,commit_hash:f.commit_hash,manifest:f.manifest,examples:f.examples}}async pullPromptCommit(t,n){const r=this._fetchPromptFromApi.bind(this,t,n);if(!n?.skipCache&&this._promptCache){const s=this._getPromptCacheKey(t,n?.includeModel),o=this._promptCache.get(s,r);if(o)return o;const u=await r();return this._promptCache.set(s,u,r),u}return this._fetchPromptFromApi(t,n)}async _pullPrompt(t,n){const r=await this.pullPromptCommit(t,{includeModel:n?.includeModel,skipCache:n?.skipCache});return JSON.stringify(r.manifest)}async pushPrompt(t,n){return await this.promptExists(t)?n&&Object.keys(n).some(s=>s!=="object")&&await this.updatePrompt(t,{description:n?.description,readme:n?.readme,tags:n?.tags,isPublic:n?.isPublic}):await this.createPrompt(t,{description:n?.description,readme:n?.readme,tags:n?.tags,isPublic:n?.isPublic}),n?.object?await this.createCommit(t,n?.object,{parentCommitHash:n?.parentCommitHash}):await this._getPromptUrl(t)}async clonePublicDataset(t,n={}){const{sourceApiUrl:r=this.apiUrl,datasetName:s}=n,[o,u]=this.parseTokenOrUrl(t,r),f=new $l({apiUrl:o,apiKey:"placeholder"}),d=await f.readSharedDataset(u),h=s||d.name;try{if(await this.hasDataset({datasetId:h})){console.log(`Dataset ${h} already exists in your tenant. Skipping.`);return}}catch{}const m=await f.listSharedExamples(u),_=await this.createDataset(h,{description:d.description,dataType:d.data_type||"kv",inputsSchema:d.inputs_schema_definition??void 0,outputsSchema:d.outputs_schema_definition??void 0});try{await this.createExamples({inputs:m.map(y=>y.inputs),outputs:m.flatMap(y=>y.outputs?[y.outputs]:[]),datasetId:_.id})}catch(y){throw console.error(`An error occurred while creating dataset ${h}. You should delete it manually.`),y}}parseTokenOrUrl(t,n,r=2,s="dataset"){try{return Me(t),[n,t]}catch{}try{const u=new URL(t).pathname.split("/").filter(f=>f!=="");if(u.length>=r){const f=u[u.length-r];return[n,f]}else throw new Error(`Invalid public ${s} URL: ${t}`)}catch{throw new Error(`Invalid public ${s} URL or token: ${t}`)}}cleanup(){this._promptCache&&this._promptCache.stop()}async awaitPendingTraceBatches(){if(this.manualFlushMode)return console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve();await new Promise(t=>setTimeout(t,1)),await Promise.all([...this.autoBatchQueue.items.map(({itemPromise:t})=>t),this.batchIngestCaller.queue.onIdle()]),this.langSmithToOTELTranslator!==void 0&&await n$()?.DEFAULT_LANGSMITH_SPAN_PROCESSOR?.forceFlush()}}function cE(e){return"dataset_id"in e||"dataset_name"in e}const dM=e=>!!["TRACING_V2","TRACING"].find(n=>dn(n)==="true"),Ka=Symbol.for("lc:context_variables"),Fm=Symbol.for("langsmith:replica_trace_roots");function fE(e,t){if(Ka in e)return e[Ka][t]}function hM(e,t,n){const r=Ka in e?e[Ka]:{};r[t]=n,e[Ka]=r}const pM="6ba7b810-9dad-11d1-80b4-00c04fd430c8";function dE(e){const n=Object.keys(e).sort().map(r=>`${r}:${e[r]??""}`).join("|");return Ik(n,pM)}function mM(e){return e.replace(/[-:.]/g,"")}function ex(e,t=1){const n=t.toFixed(0).slice(0,3).padStart(3,"0");return`${new Date(e).toISOString().slice(0,-1)}${n}Z`}function tx(e,t,n=1){const r=ex(e,n);return{dottedOrder:mM(r)+t,microsecondPrecisionDatestring:r}}const gM=new Set(["projectName","updates","reroot"]);function _M(e){const t={};for(const n of Object.keys(e))gM.has(n)&&(t[n]=e[n]);return t}class uf{constructor(t,n,r,s){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=t,this.tags=n,this.project_name=r,this.replicas=s}static fromHeader(t){const n=t.split(",");let r={},s=[],o,u;for(const f of n){const[d,h]=f.split("="),m=decodeURIComponent(h);d==="langsmith-metadata"?r=JSON.parse(m):d==="langsmith-tags"?s=m.split(","):d==="langsmith-project"?o=m:d==="langsmith-replicas"&&(u=JSON.parse(m).map(y=>Array.isArray(y)?y:_M(y)))}return new uf(r,s,o,u)}toHeader(){const t=[];return this.metadata&&Object.keys(this.metadata).length>0&&t.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&t.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&t.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),t.join(",")}}class Tn{constructor(t){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"distributedParentId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_serialized_start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_awaitInputsOnPost",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),yM(t)){Object.assign(this,{...t});return}const n=Tn.getDefaultConfig(),{metadata:r,...s}=t,o=s.client??Tn.getSharedClient(),u={...r,...s?.extra?.metadata};if(s.extra={...s.extra,metadata:u},"id"in s&&s.id==null&&delete s.id,Object.assign(this,{...n,...s,client:o}),this.execution_order??=1,this.child_execution_order??=1,this.dotted_order||(this._serialized_start_time=ex(this.start_time,this.execution_order)),this.id||(this.id=$2(this._serialized_start_time??this.start_time)),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.replicas=SM(this.replicas),!this.dotted_order){const{dottedOrder:f}=tx(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+f:this.dotted_order=f}}set metadata(t){this.extra={...this.extra,metadata:{...this.extra?.metadata,...t}}}get metadata(){return this.extra?.metadata}static getDefaultConfig(){const t=Date.now();return{run_type:"chain",project_name:k1(),child_runs:[],api_url:Ur("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:Ur("LANGCHAIN_API_KEY"),caller_options:{},start_time:t,serialized:{},inputs:{},extra:{}}}static getSharedClient(){return Tn.sharedClient||(Tn.sharedClient=new $l),Tn.sharedClient}createChild(t){const n=this.child_execution_order+1,r=this.replicas?.map(m=>{const{reroot:_,...y}=m;return y}),s=t.replicas??r,o=new Tn({...t,parent_run:this,project_name:this.project_name,replicas:s,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:n,child_execution_order:n});Ka in this&&(o[Ka]=this[Ka]);const u=Symbol.for("lc:child_config"),f=t.extra?.[u]??this.extra[u];if(bM(f)){const m={...f},_=vM(m.callbacks)?m.callbacks.copy?.():void 0;_&&(Object.assign(_,{_parentRunId:o.id}),_.handlers?.find(nx)?.updateFromRunTree?.(o),m.callbacks=_),o.extra[u]=m}const d=new Set;let h=this;for(;h!=null&&!d.has(h.id);)d.add(h.id),h.child_execution_order=Math.max(h.child_execution_order,n),h=h.parent_run;return this.child_runs.push(o),o}async end(t,n,r=Date.now(),s){this.outputs=this.outputs??t,this.error=this.error??n,this.end_time=this.end_time??r,s&&Object.keys(s).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...s}}:{metadata:s})}_convertToCreate(t,n,r=!0){const s=t.extra??{};if(s?.runtime?.library===void 0&&(s.runtime||(s.runtime={}),n))for(const[f,d]of Object.entries(n))s.runtime[f]||(s.runtime[f]=d);let o,u;return r?(u=t.parent_run?.id??t.parent_run_id,o=[]):(o=t.child_runs.map(f=>this._convertToCreate(f,n,r)),u=void 0),{id:t.id,name:t.name,start_time:t._serialized_start_time??t.start_time,end_time:t.end_time,run_type:t.run_type,reference_example_id:t.reference_example_id,extra:s,serialized:t.serialized,error:t.error,inputs:t.inputs,outputs:t.outputs,session_name:t.project_name,child_runs:o,parent_run_id:u,trace_id:t.trace_id,dotted_order:t.dotted_order,tags:t.tags,attachments:t.attachments,events:t.events}}_sliceParentId(t,n){if(n.dotted_order){const r=n.dotted_order.split(".");let s=null;for(let o=0;o<r.length;o++)if(r[o].slice(-36)===t){s=o;break}if(s!==null){const o=r.slice(s+1);n.dotted_order=o.join("."),o.length>0?n.trace_id=o[0].slice(-36):n.trace_id=n.id}}n.parent_run_id===t&&(n.parent_run_id=void 0)}_setReplicaTraceRoot(t,n){const r=fE(this,Fm)??{};r[t]=n,hM(this,Fm,r);for(const s of this.child_runs)s._setReplicaTraceRoot(t,n)}_remapForProject(t){const{projectName:n,runtimeEnv:r,excludeChildRuns:s=!0,reroot:o=!1,distributedParentId:u,apiUrl:f,apiKey:d,workspaceId:h}=t,m=this._convertToCreate(this,r,s);if(n===this.project_name)return{...m,session_name:n};if(o){if(u)this._sliceParentId(u,m);else if(m.parent_run_id=void 0,m.dotted_order){const A=m.dotted_order.split(".");A.length>0&&(m.dotted_order=A[A.length-1],m.trace_id=m.id)}const E=dE({projectName:n,apiUrl:f,apiKey:d,workspaceId:h});this._setReplicaTraceRoot(E,m.id)}let _;if(!o){const E=fE(this,Fm)??{},A=dE({projectName:n,apiUrl:f,apiKey:d,workspaceId:h});if(_=E[A],_&&(m.trace_id=_,m.dotted_order)){const N=m.dotted_order.split(".");let M=null;for(let B=0;B<N.length;B++)if(N[B].slice(-36)===_){M=B;break}if(M!==null){const B=N.slice(M);m.dotted_order=B.join(".")}}}const y=m.id,v=yc(y,n);let w;m.trace_id?w=yc(m.trace_id,n):w=v;let x;m.parent_run_id&&(x=yc(m.parent_run_id,n));let R;return m.dotted_order&&(R=m.dotted_order.split(".").map(N=>{const M=N.slice(-36),B=yc(M,n);return N.slice(0,-36)+B}).join(".")),{...m,id:v,trace_id:w,parent_run_id:x,dotted_order:R,session_name:n}}async postRun(t=!0){this._awaitInputsOnPost&&(this.inputs=await this.inputs);try{const n=q1();if(this.replicas&&this.replicas.length>0)for(const{projectName:r,apiKey:s,apiUrl:o,workspaceId:u,reroot:f}of this.replicas){const d=this._remapForProject({projectName:r??this.project_name,runtimeEnv:n,excludeChildRuns:!0,reroot:f,distributedParentId:this.distributedParentId,apiUrl:o,apiKey:s,workspaceId:u});await this.client.createRun(d,{apiKey:s,apiUrl:o,workspaceId:u})}else{const r=this._convertToCreate(this,n,t);await this.client.createRun(r)}if(!t){Fc("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const r of this.child_runs)await r.postRun(!1)}this.child_runs=[]}catch(n){console.error(`Error in postRun for run ${this.id}:`,n)}}async patchRun(t){if(this.replicas&&this.replicas.length>0)for(const{projectName:n,apiKey:r,apiUrl:s,workspaceId:o,updates:u,reroot:f}of this.replicas){const d=this._remapForProject({projectName:n??this.project_name,runtimeEnv:void 0,excludeChildRuns:!0,reroot:f,distributedParentId:this.distributedParentId,apiUrl:s,apiKey:r,workspaceId:o}),h={id:d.id,name:d.name,run_type:d.run_type,start_time:d.start_time,outputs:d.outputs,error:d.error,parent_run_id:d.parent_run_id,session_name:d.session_name,reference_example_id:d.reference_example_id,end_time:d.end_time,dotted_order:d.dotted_order,trace_id:d.trace_id,events:d.events,tags:d.tags,extra:d.extra,attachments:this.attachments,...u};t?.excludeInputs||(h.inputs=d.inputs),await this.client.updateRun(d.id,h,{apiKey:r,apiUrl:s,workspaceId:o})}else try{const n={name:this.name,run_type:this.run_type,start_time:this._serialized_start_time??this.start_time,end_time:this.end_time,error:this.error,outputs:this.outputs,parent_run_id:this.parent_run?.id??this.parent_run_id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};t?.excludeInputs||(n.inputs=this.inputs),await this.client.updateRun(this.id,n)}catch(n){console.error(`Error in patchRun for run ${this.id}`,n)}this.child_runs=[]}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(t){this.events||(this.events=[]),typeof t=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:t}):this.events.push({...t,time:t.time??new Date().toISOString()})}static fromRunnableConfig(t,n){const r=t?.callbacks;let s,o,u,f=dM();if(r){const h=r?.getParentRunId?.()??"",m=r?.handlers?.find(_=>_?.name=="langchain_tracer");s=m?.getRun?.(h),o=m?.projectName,u=m?.client,f=f||!!m}return s?new Tn({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:u,tracingEnabled:f,project_name:o,tags:[...new Set((s?.tags??[]).concat(t?.tags??[]))],extra:{metadata:{...s?.extra?.metadata,...t?.metadata}}}).createChild(n):new Tn({...n,client:u,tracingEnabled:f,project_name:o})}static fromDottedOrder(t){return this.fromHeaders({"langsmith-trace":t})}static fromHeaders(t,n){const r="get"in t&&typeof t.get=="function"?{"langsmith-trace":t.get("langsmith-trace"),baggage:t.get("baggage")}:t,s=r["langsmith-trace"];if(!s||typeof s!="string")return;const o=s.trim(),u=o.split(".").map(m=>{const[_,y]=m.split("Z");return{strTime:_,time:Date.parse(_+"Z"),uuid:y}}),f=u[0].uuid,d={...n,name:n?.name??"parent",run_type:n?.run_type??"chain",start_time:n?.start_time??Date.now(),id:u.at(-1)?.uuid,trace_id:f,dotted_order:o};if(r.baggage&&typeof r.baggage=="string"){const m=uf.fromHeader(r.baggage);d.metadata=m.metadata,d.tags=m.tags,d.project_name=m.project_name,d.replicas=m.replicas}const h=new Tn(d);return h.distributedParentId=h.id,h}toHeaders(t){const n={"langsmith-trace":this.dotted_order,baggage:new uf(this.extra?.metadata,this.tags,this.project_name,this.replicas).toHeader()};if(t)for(const[r,s]of Object.entries(n))t.set(r,s);return n}}Object.defineProperty(Tn,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function yM(e){return e!=null&&typeof e.createChild=="function"&&typeof e.postRun=="function"}function nx(e){return typeof e=="object"&&e!=null&&typeof e.name=="string"&&e.name==="langchain_tracer"}function hE(e){return Array.isArray(e)&&e.some(t=>nx(t))}function vM(e){return typeof e=="object"&&e!=null&&Array.isArray(e.handlers)}function bM(e){const t=e?.callbacks;return e!=null&&typeof t=="object"&&(hE(t?.handlers)||hE(t))}function wM(){const e=Ur("LANGSMITH_RUNS_ENDPOINTS");if(!e)return[];try{const t=JSON.parse(e);if(Array.isArray(t)){const n=[];for(const r of t){if(typeof r!="object"||r===null){console.warn(`Invalid item type in LANGSMITH_RUNS_ENDPOINTS: expected object, got ${typeof r}`);continue}if(typeof r.api_url!="string"){console.warn(`Invalid api_url type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof r.api_url}`);continue}if(typeof r.api_key!="string"){console.warn(`Invalid api_key type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof r.api_key}`);continue}n.push({apiUrl:r.api_url.replace(/\/$/,""),apiKey:r.api_key})}return n}else if(typeof t=="object"&&t!==null){EM(t);const n=[];for(const[r,s]of Object.entries(t)){const o=r.replace(/\/$/,"");if(typeof s=="string")n.push({apiUrl:o,apiKey:s});else{console.warn(`Invalid value type in LANGSMITH_RUNS_ENDPOINTS for URL ${r}: expected string, got ${typeof s}`);continue}}return n}else return console.warn(`Invalid LANGSMITH_RUNS_ENDPOINTS  must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey, got ${typeof t}`),[]}catch(t){if(K$(t))throw t;return console.warn("Invalid LANGSMITH_RUNS_ENDPOINTS  must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey"),[]}}function SM(e){return e?e.map(t=>Array.isArray(t)?{projectName:t[0],updates:t[1]}:t):wM()}function EM(e){if(Object.keys(e).length>0&&dn("ENDPOINT"))throw new Q$}const TM=e=>{if(e)return e.events=e.events??[],e.child_runs=e.child_runs??[],e};function bg(e,t){if(e)return new Tn({...e,start_time:e._serialized_start_time??e.start_time,parent_run:bg(t),child_runs:e.child_runs.map(n=>bg(n)).filter(n=>n!==void 0),extra:{...e.extra,runtime:bk()},tracingEnabled:!1})}function Hm(e,t){return e&&!Array.isArray(e)&&typeof e=="object"?e:{[t]:e}}function ll(e){return typeof e._addRunToRunMap=="function"}var ql=class extends Hf{runMap=new Map;runTreeMap=new Map;usesRunTreeMap=!1;constructor(e){super(...arguments)}copy(){return this}getRunById(e){if(e!==void 0)return this.usesRunTreeMap?TM(this.runTreeMap.get(e)):this.runMap.get(e)}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const{dottedOrder:t,microsecondPrecisionDatestring:n}=tx(new Date(e.start_time).getTime(),e.id,e.execution_order),r={...e},s=this.getRunById(r.parent_run_id);if(r.parent_run_id!==void 0?s?(this._addChildRun(s,r),s.child_execution_order=Math.max(s.child_execution_order,r.child_execution_order),r.trace_id=s.trace_id,s.dotted_order!==void 0&&(r.dotted_order=[s.dotted_order,t].join("."),r._serialized_start_time=n)):r.parent_run_id=void 0:(r.trace_id=r.id,r.dotted_order=t,r._serialized_start_time=n),this.usesRunTreeMap){const o=bg(r,s);o!==void 0&&this.runTreeMap.set(r.id,o)}else this.runMap.set(r.id,r);return r}async _endTrace(e){const t=e.parent_run_id!==void 0&&this.getRunById(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),await this.onRunUpdate?.(e),this.usesRunTreeMap?this.runTreeMap.delete(e.id):this.runMap.delete(e.id)}_getExecutionOrder(e){const t=e!==void 0&&this.getRunById(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,n,r,s,o,u,f){const d=this._getExecutionOrder(r),h=Date.now(),m=u?{...s,metadata:u}:s,_={id:n,name:f??e.id[e.id.length-1],parent_run_id:r,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{prompts:t},execution_order:d,child_runs:[],child_execution_order:d,run_type:"llm",extra:m??{},tags:o||[]};return this._addRunToRunMap(_)}async handleLLMStart(e,t,n,r,s,o,u,f){const d=this.getRunById(n)??this._createRunForLLMStart(e,t,n,r,s,o,u,f);return await this.onRunCreate?.(d),await this.onLLMStart?.(d),d}_createRunForChatModelStart(e,t,n,r,s,o,u,f){const d=this._getExecutionOrder(r),h=Date.now(),m=u?{...s,metadata:u}:s,_={id:n,name:f??e.id[e.id.length-1],parent_run_id:r,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{messages:t},execution_order:d,child_runs:[],child_execution_order:d,run_type:"llm",extra:m??{},tags:o||[]};return this._addRunToRunMap(_)}async handleChatModelStart(e,t,n,r,s,o,u,f){const d=this.getRunById(n)??this._createRunForChatModelStart(e,t,n,r,s,o,u,f);return await this.onRunCreate?.(d),await this.onLLMStart?.(d),d}async handleLLMEnd(e,t,n,r,s){const o=this.getRunById(t);if(!o||o?.run_type!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.outputs=e,o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...s},await this.onLLMEnd?.(o),await this._endTrace(o),o}async handleLLMError(e,t,n,r,s){const o=this.getRunById(t);if(!o||o?.run_type!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...s},await this.onLLMError?.(o),await this._endTrace(o),o}_createRunForChainStart(e,t,n,r,s,o,u,f,d){const h=this._getExecutionOrder(r),m=Date.now(),_={id:n,name:f??e.id[e.id.length-1],parent_run_id:r,start_time:m,serialized:e,events:[{name:"start",time:new Date(m).toISOString()}],inputs:t,execution_order:h,child_execution_order:h,run_type:u??"chain",child_runs:[],extra:o?{...d,metadata:o}:{...d},tags:s||[]};return this._addRunToRunMap(_)}async handleChainStart(e,t,n,r,s,o,u,f){const d=this.getRunById(n)??this._createRunForChainStart(e,t,n,r,s,o,u,f);return await this.onRunCreate?.(d),await this.onChainStart?.(d),d}async handleChainEnd(e,t,n,r,s){const o=this.getRunById(t);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.outputs=Hm(e,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),s?.inputs!==void 0&&(o.inputs=Hm(s.inputs,"input")),await this.onChainEnd?.(o),await this._endTrace(o),o}async handleChainError(e,t,n,r,s){const o=this.getRunById(t);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),s?.inputs!==void 0&&(o.inputs=Hm(s.inputs,"input")),await this.onChainError?.(o),await this._endTrace(o),o}_createRunForToolStart(e,t,n,r,s,o,u){const f=this._getExecutionOrder(r),d=Date.now(),h={id:n,name:u??e.id[e.id.length-1],parent_run_id:r,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{input:t},execution_order:f,child_execution_order:f,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:s||[]};return this._addRunToRunMap(h)}async handleToolStart(e,t,n,r,s,o,u){const f=this.getRunById(n)??this._createRunForToolStart(e,t,n,r,s,o,u);return await this.onRunCreate?.(f),await this.onToolStart?.(f),f}async handleToolEnd(e,t){const n=this.getRunById(t);if(!n||n?.run_type!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await this.onToolEnd?.(n),await this._endTrace(n),n}async handleToolError(e,t){const n=this.getRunById(t);if(!n||n?.run_type!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await this.onToolError?.(n),await this._endTrace(n),n}async handleAgentAction(e,t){const n=this.getRunById(t);if(!n||n?.run_type!=="chain")return;const r=n;r.actions=r.actions||[],r.actions.push(e),r.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(n)}async handleAgentEnd(e,t){const n=this.getRunById(t);!n||n?.run_type!=="chain"||(n.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(n))}_createRunForRetrieverStart(e,t,n,r,s,o,u){const f=this._getExecutionOrder(r),d=Date.now(),h={id:n,name:u??e.id[e.id.length-1],parent_run_id:r,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{query:t},execution_order:f,child_execution_order:f,run_type:"retriever",child_runs:[],extra:o?{metadata:o}:{},tags:s||[]};return this._addRunToRunMap(h)}async handleRetrieverStart(e,t,n,r,s,o,u){const f=this.getRunById(n)??this._createRunForRetrieverStart(e,t,n,r,s,o,u);return await this.onRunCreate?.(f),await this.onRetrieverStart?.(f),f}async handleRetrieverEnd(e,t){const n=this.getRunById(t);if(!n||n?.run_type!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await this.onRetrieverEnd?.(n),await this._endTrace(n),n}async handleRetrieverError(e,t){const n=this.getRunById(t);if(!n||n?.run_type!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await this.onRetrieverError?.(n),await this._endTrace(n),n}async handleText(e,t){const n=this.getRunById(t);!n||n?.run_type!=="chain"||(n.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(n))}async handleLLMNewToken(e,t,n,r,s,o){const u=this.getRunById(n);if(!u||u?.run_type!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return u.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:o?.chunk}}),await this.onLLMNewToken?.(u,e,{chunk:o?.chunk}),u}},Gc={exports:{}};Gc.exports;var pE;function xM(){return pE||(pE=1,(function(e){const n=(o=0)=>u=>`\x1B[${38+o};5;${u}m`,r=(o=0)=>(u,f,d)=>`\x1B[${38+o};2;${u};${f};${d}m`;function s(){const o=new Map,u={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};u.color.gray=u.color.blackBright,u.bgColor.bgGray=u.bgColor.bgBlackBright,u.color.grey=u.color.blackBright,u.bgColor.bgGrey=u.bgColor.bgBlackBright;for(const[f,d]of Object.entries(u)){for(const[h,m]of Object.entries(d))u[h]={open:`\x1B[${m[0]}m`,close:`\x1B[${m[1]}m`},d[h]=u[h],o.set(m[0],m[1]);Object.defineProperty(u,f,{value:d,enumerable:!1})}return Object.defineProperty(u,"codes",{value:o,enumerable:!1}),u.color.close="\x1B[39m",u.bgColor.close="\x1B[49m",u.color.ansi256=n(),u.color.ansi16m=r(),u.bgColor.ansi256=n(10),u.bgColor.ansi16m=r(10),Object.defineProperties(u,{rgbToAnsi256:{value:(f,d,h)=>f===d&&d===h?f<8?16:f>248?231:Math.round((f-8)/247*24)+232:16+36*Math.round(f/255*5)+6*Math.round(d/255*5)+Math.round(h/255*5),enumerable:!1},hexToRgb:{value:f=>{const d=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(f.toString(16));if(!d)return[0,0,0];let{colorString:h}=d.groups;h.length===3&&(h=h.split("").map(_=>_+_).join(""));const m=Number.parseInt(h,16);return[m>>16&255,m>>8&255,m&255]},enumerable:!1},hexToAnsi256:{value:f=>u.rgbToAnsi256(...u.hexToRgb(f)),enumerable:!1}}),u}Object.defineProperty(e,"exports",{enumerable:!0,get:s})})(Gc)),Gc.exports}var OM=xM();const rx=Ff(OM);function ln(e,t){return`${e.open}${t}${e.close}`}function or(e,t){try{return JSON.stringify(e,null,2)}catch{return t}}function mE(e){return typeof e=="string"?e.trim():e==null?e:or(e,e.toString())}function Ha(e){if(!e.end_time)return"";const t=e.end_time-e.start_time;return t<1e3?`${t}ms`:`${(t/1e3).toFixed(2)}s`}const{color:En}=rx;var gE=class extends ql{name="console_callback_handler";persistRun(e){return Promise.resolve()}getParents(e){const t=[];let n=e;for(;n.parent_run_id;){const r=this.runMap.get(n.parent_run_id);if(r)t.push(r),n=r;else break}return t}getBreadcrumbs(e){const t=[...this.getParents(e).reverse(),e].map((n,r,s)=>{const o=`${n.execution_order}:${n.run_type}:${n.name}`;return r===s.length-1?ln(rx.bold,o):o}).join(" > ");return ln(En.grey,t)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.green,"[chain/start]")} [${t}] Entering Chain run with input: ${or(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.cyan,"[chain/end]")} [${t}] [${Ha(e)}] Exiting Chain run with output: ${or(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.red,"[chain/error]")} [${t}] [${Ha(e)}] Chain run errored with error: ${or(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map(r=>r.trim())}:e.inputs;console.log(`${ln(En.green,"[llm/start]")} [${t}] Entering LLM run with input: ${or(n,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.cyan,"[llm/end]")} [${t}] [${Ha(e)}] Exiting LLM run with output: ${or(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.red,"[llm/error]")} [${t}] [${Ha(e)}] LLM run errored with error: ${or(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.green,"[tool/start]")} [${t}] Entering Tool run with input: "${mE(e.inputs.input)}"`)}onToolEnd(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.cyan,"[tool/end]")} [${t}] [${Ha(e)}] Exiting Tool run with output: "${mE(e.outputs?.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.red,"[tool/error]")} [${t}] [${Ha(e)}] Tool run errored with error: ${or(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${or(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.cyan,"[retriever/end]")} [${t}] [${Ha(e)}] Exiting Retriever run with output: ${or(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${ln(En.red,"[retriever/error]")} [${t}] [${Ha(e)}] Retriever run errored with error: ${or(e.error,"[error]")}`)}onAgentAction(e){const t=e,n=this.getBreadcrumbs(e);console.log(`${ln(En.blue,"[agent/action]")} [${n}] Agent selected action: ${or(t.actions[t.actions.length-1],"[action]")}`)}};let Gm;const AM=()=>(Gm===void 0&&(Gm=new $l(ha("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{})),Gm);let CM=class{getStore(){}run(t,n){return n()}};const Vm=Symbol.for("ls:tracing_async_local_storage"),RM=new CM;let NM=class{getInstance(){return globalThis[Vm]??RM}initializeGlobalInstance(t){globalThis[Vm]===void 0&&(globalThis[Vm]=t)}};const IM=new NM;function kM(e=!1){const t=IM.getInstance().getStore();if(!e&&t===void 0)throw new Error(`Could not get the current run tree.

Please make sure you are calling this method within a traceable function and that tracing is enabled.`);return t}function C_(e){return typeof e=="function"&&"langsmith:traceable"in e}function $M(e){let t;for(const n of e)for(const r of n)ga.isInstance(r.message)&&r.message.usage_metadata!==void 0&&(t=g1(t,r.message.usage_metadata));return t}var Jm=class ax extends ql{name="langchain_tracer";projectName;exampleId;client;replicas;usesRunTreeMap=!0;constructor(t={}){super(t);const{exampleId:n,projectName:r,client:s,replicas:o}=t;this.projectName=r??k1(),this.replicas=o,this.exampleId=n,this.client=s??AM();const u=ax.getTraceableRunTree();u&&this.updateFromRunTree(u)}async persistRun(t){}async onRunCreate(t){t.extra?.lc_defers_inputs||await this.getRunTreeWithTracingConfig(t.id)?.postRun()}async onRunUpdate(t){const n=this.getRunTreeWithTracingConfig(t.id);t.extra?.lc_defers_inputs?await n?.postRun():await n?.patchRun()}onLLMEnd(t){const n=t.outputs;if(n?.generations){const r=$M(n.generations);if(r!==void 0){t.extra=t.extra??{};const s=t.extra.metadata??{};s.usage_metadata=r,t.extra.metadata=s}}}getRun(t){return this.runTreeMap.get(t)}updateFromRunTree(t){this.runTreeMap.set(t.id,t);let n=t;const r=new Set;for(;n.parent_run&&!(r.has(n.id)||(r.add(n.id),!n.parent_run));)n=n.parent_run;r.clear();const s=[n];for(;s.length>0;){const o=s.shift();!o||r.has(o.id)||(r.add(o.id),this.runTreeMap.set(o.id,o),o.child_runs&&s.push(...o.child_runs))}this.client=t.client??this.client,this.replicas=t.replicas??this.replicas,this.projectName=t.project_name??this.projectName,this.exampleId=t.reference_example_id??this.exampleId}getRunTreeWithTracingConfig(t){const n=this.runTreeMap.get(t);if(n)return new Tn({...n,client:this.client,project_name:this.projectName,replicas:this.replicas,reference_example_id:this.exampleId,tracingEnabled:!0})}static getTraceableRunTree(){try{return kM(!0)}catch{return}}};let xl;function MM(){return new("default"in pa?pa.default:pa)({autoStart:!0,concurrency:1})}function jM(){return typeof xl>"u"&&(xl=MM()),xl}async function Lt(e,t){if(t===!0){const n=kl();n!==void 0?await n.run(void 0,async()=>e()):await e()}else xl=jM(),xl.add(async()=>{const n=kl();n!==void 0?await n.run(void 0,async()=>e()):await e()})}const LM=e=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>ha(t)==="true");function sx(e){const t=kl();if(t!==void 0)return t.getStore()?.[qc]?.[e]}const zM=Symbol("lc:configure_hooks"),DM=()=>sx(zM)||[];var UM=class{setHandler(e){return this.setHandlers([e])}},Qf=class{constructor(e,t,n,r,s,o,u,f){this.runId=e,this.handlers=t,this.inheritableHandlers=n,this.tags=r,this.inheritableTags=s,this.metadata=o,this.inheritableMetadata=u,this._parentRunId=f}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{try{await t.handleText?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleCustomEvent(e,t,n,r,s){await Promise.all(this.handlers.map(o=>Lt(async()=>{try{await o.handleCustomEvent?.(e,t,this.runId,this.tags,this.metadata)}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}},PM=class extends Qf{getChild(e){const t=new ma(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw n}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${n}`),t.raiseError)throw e}},t.awaitHandlers)))}},_E=class extends Qf{async handleLLMNewToken(e,t,n,r,s,o){await Promise.all(this.handlers.map(u=>Lt(async()=>{if(!u.ignoreLLM)try{await u.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,o)}catch(f){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleLLMNewToken: ${f}`),u.raiseError)throw f}},u.awaitHandlers)))}async handleLLMError(e,t,n,r,s){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreLLM)try{await o.handleLLMError?.(e,this.runId,this._parentRunId,this.tags,s)}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMError: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleLLMEnd(e,t,n,r,s){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreLLM)try{await o.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags,s)}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMEnd: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}},BM=class extends Qf{getChild(e){const t=new ma(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,n,r,s){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreChain)try{await o.handleChainError?.(e,this.runId,this._parentRunId,this.tags,s)}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainError: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleChainEnd(e,t,n,r,s){await Promise.all(this.handlers.map(o=>Lt(async()=>{if(!o.ignoreChain)try{await o.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,s)}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainEnd: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{if(!t.ignoreAgent)try{await t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{if(!t.ignoreAgent)try{await t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}},ZM=class extends Qf{getChild(e){const t=new ma(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{if(!t.ignoreAgent)try{await t.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}async handleToolEvent(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{if(!t.ignoreAgent)try{await t.handleToolEvent?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if(t.raiseError)throw n}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>Lt(async()=>{if(!t.ignoreAgent)try{await t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${n}`),t.raiseError)throw n}},t.awaitHandlers)))}},ma=class fl extends UM{handlers=[];inheritableHandlers=[];tags=[];inheritableTags=[];metadata={};inheritableMetadata={};name="callback_manager";_parentRunId;constructor(t,n){super(),this.handlers=n?.handlers??this.handlers,this.inheritableHandlers=n?.inheritableHandlers??this.inheritableHandlers,this.tags=n?.tags??this.tags,this.inheritableTags=n?.inheritableTags??this.inheritableTags,this.metadata=n?.metadata??this.metadata,this.inheritableMetadata=n?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=t}getParentRunId(){return this._parentRunId}async handleLLMStart(t,n,r=void 0,s=void 0,o=void 0,u=void 0,f=void 0,d=void 0){return Promise.all(n.map(async(h,m)=>{const _=m===0&&r?r:Ja();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return ll(y)&&y._createRunForLLMStart(t,[h],_,this._parentRunId,o,this.tags,this.metadata,d),Lt(async()=>{try{await y.handleLLMStart?.(t,[h],_,this._parentRunId,o,this.tags,this.metadata,d)}catch(v){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${v}`),y.raiseError)throw v}},y.awaitHandlers)})),new _E(_,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(t,n,r=void 0,s=void 0,o=void 0,u=void 0,f=void 0,d=void 0){return Promise.all(n.map(async(h,m)=>{const _=m===0&&r?r:Ja();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return ll(y)&&y._createRunForChatModelStart(t,[h],_,this._parentRunId,o,this.tags,this.metadata,d),Lt(async()=>{try{if(y.handleChatModelStart)await y.handleChatModelStart?.(t,[h],_,this._parentRunId,o,this.tags,this.metadata,d);else if(y.handleLLMStart){const v=A1(h);await y.handleLLMStart?.(t,[v],_,this._parentRunId,o,this.tags,this.metadata,d)}}catch(v){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${v}`),y.raiseError)throw v}},y.awaitHandlers)})),new _E(_,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(t,n,r=Ja(),s=void 0,o=void 0,u=void 0,f=void 0,d=void 0,h=void 0){return await Promise.all(this.handlers.map(m=>{if(!m.ignoreChain)return ll(m)&&m._createRunForChainStart(t,n,r,this._parentRunId,this.tags,this.metadata,s,f,h),Lt(async()=>{try{await m.handleChainStart?.(t,n,r,this._parentRunId,this.tags,this.metadata,s,f,h)}catch(_){if((m.raiseError?console.error:console.warn)(`Error in handler ${m.constructor.name}, handleChainStart: ${_}`),m.raiseError)throw _}},m.awaitHandlers)})),new BM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(t,n,r=Ja(),s=void 0,o=void 0,u=void 0,f=void 0,d=void 0){return await Promise.all(this.handlers.map(h=>{if(!h.ignoreAgent)return ll(h)&&h._createRunForToolStart(t,n,r,this._parentRunId,this.tags,this.metadata,f),Lt(async()=>{try{await h.handleToolStart?.(t,n,r,this._parentRunId,this.tags,this.metadata,f,d)}catch(m){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleToolStart: ${m}`),h.raiseError)throw m}},h.awaitHandlers)})),new ZM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(t,n,r=Ja(),s=void 0,o=void 0,u=void 0,f=void 0){return await Promise.all(this.handlers.map(d=>{if(!d.ignoreRetriever)return ll(d)&&d._createRunForRetrieverStart(t,n,r,this._parentRunId,this.tags,this.metadata,f),Lt(async()=>{try{await d.handleRetrieverStart?.(t,n,r,this._parentRunId,this.tags,this.metadata,f)}catch(h){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleRetrieverStart: ${h}`),d.raiseError)throw h}},d.awaitHandlers)})),new PM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(t,n,r,s,o){await Promise.all(this.handlers.map(u=>Lt(async()=>{if(!u.ignoreCustomEvent)try{await u.handleCustomEvent?.(t,n,r,this.tags,this.metadata)}catch(f){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleCustomEvent: ${f}`),u.raiseError)throw f}},u.awaitHandlers)))}addHandler(t,n=!0){this.handlers.push(t),n&&this.inheritableHandlers.push(t)}removeHandler(t){this.handlers=this.handlers.filter(n=>n!==t),this.inheritableHandlers=this.inheritableHandlers.filter(n=>n!==t)}setHandlers(t,n=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of t)this.addHandler(r,n)}addTags(t,n=!0){this.removeTags(t),this.tags.push(...t),n&&this.inheritableTags.push(...t)}removeTags(t){this.tags=this.tags.filter(n=>!t.includes(n)),this.inheritableTags=this.inheritableTags.filter(n=>!t.includes(n))}addMetadata(t,n=!0){this.metadata={...this.metadata,...t},n&&(this.inheritableMetadata={...this.inheritableMetadata,...t})}removeMetadata(t){for(const n of Object.keys(t))delete this.metadata[n],delete this.inheritableMetadata[n]}copy(t=[],n=!0){const r=new fl(this._parentRunId);for(const s of this.handlers){const o=this.inheritableHandlers.includes(s);r.addHandler(s,o)}for(const s of this.tags){const o=this.inheritableTags.includes(s);r.addTags([s],o)}for(const s of Object.keys(this.metadata)){const o=Object.keys(this.inheritableMetadata).includes(s);r.addMetadata({[s]:this.metadata[s]},o)}for(const s of t)r.handlers.filter(o=>o.name==="console_callback_handler").some(o=>o.name===s.name)||r.addHandler(s,n);return r}static fromHandlers(t){class n extends Hf{name=Ja();constructor(){super(),Object.assign(this,t)}}const r=new this;return r.addHandler(new n),r}static configure(t,n,r,s,o,u,f){return this._configureSync(t,n,r,s,o,u,f)}static _configureSync(t,n,r,s,o,u,f){let d;(t||n)&&(Array.isArray(t)||!t?(d=new fl,d.setHandlers(t?.map(cf)??[],!0)):d=t,d=d.copy(Array.isArray(n)?n.map(cf):n?.handlers,!1));const h=ha("LANGCHAIN_VERBOSE")==="true"||f?.verbose,m=Jm.getTraceableRunTree()?.tracingEnabled??LM(),_=m||(ha("LANGCHAIN_TRACING")??!1);if(h||_){if(d||(d=new fl),h&&!d.handlers.some(y=>y.name===gE.prototype.name)){const y=new gE;d.addHandler(y,!0)}if(_&&!d.handlers.some(y=>y.name==="langchain_tracer")&&m){const y=new Jm;d.addHandler(y,!0)}if(m){const y=Jm.getTraceableRunTree();y&&d._parentRunId===void 0&&(d._parentRunId=y.id,d.handlers.find(v=>v.name==="langchain_tracer")?.updateFromRunTree(y))}}for(const{contextVar:y,inheritable:v=!0,handlerClass:w,envVar:x}of DM()){const R=x&&ha(x)==="true"&&w;let E;const A=y!==void 0?sx(y):void 0;A&&Mk(A)?E=A:R&&(E=new w({})),E!==void 0&&(d||(d=new fl),d.handlers.some(N=>N.name===E.name)||d.addHandler(E,v))}return(r||s)&&d&&(d.addTags(r??[]),d.addTags(s??[],!1)),(o||u)&&d&&(d.addMetadata(o??{}),d.addMetadata(u??{},!1)),d}};function cf(e){return"name"in e?e:Hf.fromMethods(e)}var qM=class{getStore(){}run(e,t){return t()}enterWith(e){}};const FM=new qM,yE=Symbol.for("lc:child_config");var HM=class{getInstance(){return kl()??FM}getRunnableConfig(){return this.getInstance().getStore()?.extra?.[yE]}runWithConfig(e,t,n){const r=ma._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata),s=this.getInstance(),o=s.getStore(),u=r?.getParentRunId(),f=r?.handlers?.find(h=>h?.name==="langchain_tracer");let d;return f&&u?d=f.getRunTreeWithTracingConfig(u):n||(d=new Tn({name:"<runnable_lambda>",tracingEnabled:!1})),d&&(d.extra={...d.extra,[yE]:e}),o!==void 0&&o[qc]!==void 0&&(d===void 0&&(d={}),d[qc]=o[qc]),s.run(d,t)}initializeGlobalInstance(e){kl()===void 0&&pk(e)}};const rs=new HM,Xm=25;async function xr(e){return ma._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata)}function vE(...e){const t={};for(const n of e.filter(r=>!!r))for(const r of Object.keys(n))if(r==="metadata")t[r]={...t[r],...n[r]};else if(r==="tags"){const s=t[r]??[];t[r]=[...new Set(s.concat(n[r]??[]))]}else if(r==="configurable")t[r]={...t[r],...n[r]};else if(r==="timeout")t.timeout===void 0?t.timeout=n.timeout:n.timeout!==void 0&&(t.timeout=Math.min(t.timeout,n.timeout));else if(r==="signal")t.signal===void 0?t.signal=n.signal:n.signal!==void 0&&("any"in AbortSignal?t.signal=AbortSignal.any([t.signal,n.signal]):t.signal=n.signal);else if(r==="callbacks"){const s=t.callbacks,o=n.callbacks;if(Array.isArray(o))if(!s)t.callbacks=o;else if(Array.isArray(s))t.callbacks=s.concat(o);else{const u=s.copy();for(const f of o)u.addHandler(cf(f),!0);t.callbacks=u}else if(o)if(!s)t.callbacks=o;else if(Array.isArray(s)){const u=o.copy();for(const f of s)u.addHandler(cf(f),!0);t.callbacks=u}else t.callbacks=new ma(o._parentRunId,{handlers:s.handlers.concat(o.handlers),inheritableHandlers:s.inheritableHandlers.concat(o.inheritableHandlers),tags:Array.from(new Set(s.tags.concat(o.tags))),inheritableTags:Array.from(new Set(s.inheritableTags.concat(o.inheritableTags))),metadata:{...s.metadata,...o.metadata}})}else{const s=r;t[s]=n[s]??t[s]}return t}const GM=new Set(["string","number","boolean"]);function st(e){const t=rs.getRunnableConfig();let n={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(t){const{runId:r,runName:s,...o}=t;n=Object.entries(o).reduce((u,[f,d])=>(d!==void 0&&(u[f]=d),u),n)}if(e&&(n=Object.entries(e).reduce((r,[s,o])=>(o!==void 0&&(r[s]=o),r),n)),n?.configurable)for(const r of Object.keys(n.configurable))GM.has(typeof n.configurable[r])&&!n.metadata?.[r]&&(n.metadata||(n.metadata={}),n.metadata[r]=n.configurable[r]);if(n.timeout!==void 0){if(n.timeout<=0)throw new Error("Timeout must be a positive number");const r=n.timeout,s=AbortSignal.timeout(r);n.metadata||(n.metadata={}),n.metadata.timeoutMs===void 0&&(n.metadata.timeoutMs=r),n.signal!==void 0?"any"in AbortSignal&&(n.signal=AbortSignal.any([n.signal,s])):n.signal=s,delete n.timeout}return n}function hn(e={},{callbacks:t,maxConcurrency:n,recursionLimit:r,runName:s,configurable:o,runId:u}={}){const f=st(e);return t!==void 0&&(delete f.runName,f.callbacks=t),r!==void 0&&(f.recursionLimit=r),n!==void 0&&(f.maxConcurrency=n),s!==void 0&&(f.runName=s),o!==void 0&&(f.configurable={...f.configurable,...o}),u!==void 0&&delete f.runId,f}function Wi(e){if(e)return{configurable:e.configurable,recursionLimit:e.recursionLimit,callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,maxConcurrency:e.maxConcurrency,timeout:e.timeout,signal:e.signal,store:e.store}}async function as(e,t){if(t===void 0)return e;let n;return Promise.race([e.catch(r=>{if(!t?.aborted)throw r}),new Promise((r,s)=>{n=()=>{s(ff(t))},t.addEventListener("abort",n,{once:!0}),t.aborted&&s(ff(t))})]).finally(()=>t.removeEventListener("abort",n))}function ff(e){return e?.reason instanceof Error?e.reason:typeof e?.reason=="string"?new Error(e.reason):new Error("Aborted")}var Pr=class wg extends ReadableStream{reader;ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const t=await this.reader.read();return t.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:t.value}}catch(t){throw this.reader.releaseLock(),t}}async return(){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}return{done:!0,value:void 0}}async throw(t){if(this.ensureReader(),this.locked){const n=this.reader.cancel();this.reader.releaseLock(),await n}throw t}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(t){const n=t.getReader();return new wg({start(r){return s();function s(){return n.read().then(({done:o,value:u})=>{if(o){r.close();return}return r.enqueue(u),s()})}},cancel(){n.releaseLock()}})}static fromAsyncGenerator(t){return new wg({async pull(n){const{value:r,done:s}=await t.next();s&&n.close(),n.enqueue(r)},async cancel(n){await t.return(n)}})}};function ix(e,t=2){const n=Array.from({length:t},()=>[]);return n.map(async function*(s){for(;;)if(s.length===0){const o=await e.next();for(const u of n)u.push(o)}else{if(s[0].done)return;yield s.shift().value}})}function Kf(e,t){if(Array.isArray(e)&&Array.isArray(t))return e.concat(t);if(typeof e=="string"&&typeof t=="string")return e+t;if(typeof e=="number"&&typeof t=="number")return e+t;if("concat"in e&&typeof e.concat=="function")return e.concat(t);if(typeof e=="object"&&typeof t=="object"){const n={...e};for(const[r,s]of Object.entries(t))r in n&&!Array.isArray(n[r])?n[r]=Kf(n[r],s):n[r]=s;return n}else throw new Error(`Cannot concat ${typeof e} and ${typeof t}`)}var lo=class{generator;setup;config;signal;firstResult;firstResultUsed=!1;constructor(e){this.generator=e.generator,this.config=e.config,this.signal=e.signal??this.config?.signal,this.setup=new Promise((t,n)=>{rs.runWithConfig(Wi(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(t,n):this.firstResult.then(r=>t(void 0),n)},!0)})}async next(...e){return this.signal?.throwIfAborted(),this.firstResultUsed?rs.runWithConfig(Wi(this.config),this.signal?async()=>as(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}};async function VM(e,t,n,r,...s){const o=new lo({generator:t,startSetup:n,signal:r}),u=await o.setup;return{output:e(o,u,...s),setup:u}}const JM=Object.prototype.hasOwnProperty;function Sg(e,t){return JM.call(e,t)}function Eg(e){if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=""+r;return n}if(Object.keys)return Object.keys(e);let t=[];for(let n in e)Sg(e,n)&&t.push(n);return t}function Tr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Tg(e){let t=0;const n=e.length;let r;for(;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function ji(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function XM(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function xg(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(xg(e[n]))return!0}else if(typeof e=="object"){const n=Eg(e),r=n.length;for(var t=0;t<r;t++)if(xg(e[n[t]]))return!0}}return!1}function bE(e,t){const n=[e];for(const r in t){const s=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof s<"u"&&n.push(`${r}: ${s}`)}return n.join(`
`)}var YM=class extends Error{constructor(e,t,n,r,s){super(bE(e,{name:t,index:n,operation:r,tree:s})),this.name=t,this.index=n,this.operation=r,this.tree=s,Object.setPrototypeOf(this,new.target.prototype),this.message=bE(e,{name:t,index:n,operation:r,tree:s})}},QM=sI({JsonPatchError:()=>Et,_areEquals:()=>jl,applyOperation:()=>Ps,applyPatch:()=>Ml,applyReducer:()=>e4,deepClone:()=>KM,getValueByPointer:()=>df,validate:()=>ox,validator:()=>hf});const Et=YM,KM=Tr,Hi={add:function(e,t,n){if(t==="__proto__"||t==="constructor")throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor` prop is banned for security reasons");return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){if(t==="__proto__"||t==="constructor")throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor` prop is banned for security reasons");var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){if(t==="__proto__"||t==="constructor")throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor` prop is banned for security reasons");var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){let r=df(n,this.path);r&&(r=Tr(r));const s=Ps(n,{op:"remove",path:this.from}).removed;return Ps(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(e,t,n){const r=df(n,this.from);return Ps(n,{op:"add",path:this.path,value:Tr(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:jl(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}};var WM={add:function(e,t,n){return Tg(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Hi.move,copy:Hi.copy,test:Hi.test,_get:Hi._get};function df(e,t){if(t=="")return e;var n={op:"_get",path:t};return Ps(e,n),n.value}function Ps(e,t,n=!1,r=!0,s=!0,o=0){if(n&&(typeof n=="function"?n(t,0,e,t.path):hf(t,0)),t.path===""){let u={newDocument:e};if(t.op==="add")return u.newDocument=t.value,u;if(t.op==="replace")return u.newDocument=t.value,u.removed=e,u;if(t.op==="move"||t.op==="copy")return u.newDocument=df(e,t.from),t.op==="move"&&(u.removed=e),u;if(t.op==="test"){if(u.test=jl(e,t.value),u.test===!1)throw new Et("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return u.newDocument=e,u}else{if(t.op==="remove")return u.removed=e,u.newDocument=null,u;if(t.op==="_get")return t.value=e,u;if(n)throw new Et("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return u}}else{r||(e=Tr(e));const u=(t.path||"").split("/");let f=e,d=1,h=u.length,m,_,y;for(typeof n=="function"?y=n:y=hf;;){if(_=u[d],_&&_.indexOf("~")!=-1&&(_=XM(_)),s&&(_=="__proto__"||_=="prototype"&&d>0&&u[d-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&m===void 0&&(f[_]===void 0?m=u.slice(0,d).join("/"):d==h-1&&(m=t.path),m!==void 0&&y(t,0,e,m)),d++,Array.isArray(f)){if(_==="-")_=f.length;else{if(n&&!Tg(_))throw new Et("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);Tg(_)&&(_=~~_)}if(d>=h){if(n&&t.op==="add"&&_>f.length)throw new Et("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);const v=WM[t.op].call(t,f,_,e);if(v.test===!1)throw new Et("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return v}}else if(d>=h){const v=Hi[t.op].call(t,f,_,e);if(v.test===!1)throw new Et("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return v}if(f=f[_],n&&d<h&&(!f||typeof f!="object"))throw new Et("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function Ml(e,t,n,r=!0,s=!0){if(n&&!Array.isArray(t))throw new Et("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Tr(e));const o=new Array(t.length);for(let u=0,f=t.length;u<f;u++)o[u]=Ps(e,t[u],n,!0,s,u),e=o[u].newDocument;return o.newDocument=e,o}function e4(e,t,n){const r=Ps(e,t);if(r.test===!1)throw new Et("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function hf(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Et("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Hi[e.op]){if(typeof e.path!="string")throw new Et("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Et('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Et("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Et("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&xg(e.value))throw new Et("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var s=e.path.split("/").length,o=r.split("/").length;if(s!==o+1&&s!==o)throw new Et("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Et("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var u=ox([{op:"_get",path:e.from,value:void 0}],n);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE")throw new Et("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Et("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function ox(e,t,n){try{if(!Array.isArray(e))throw new Et("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Ml(Tr(t),Tr(e),n||!0);else{n=n||hf;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(s){if(s instanceof Et)return s;throw s}}function jl(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),s,o,u;if(n&&r){if(o=e.length,o!=t.length)return!1;for(s=o;s--!==0;)if(!jl(e[s],t[s]))return!1;return!0}if(n!=r)return!1;var f=Object.keys(e);if(o=f.length,o!==Object.keys(t).length)return!1;for(s=o;s--!==0;)if(!t.hasOwnProperty(f[s]))return!1;for(s=o;s--!==0;)if(u=f[s],!jl(e[u],t[u]))return!1;return!0}return e!==e&&t!==t}function lx(e,t,n,r,s){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=Eg(t),u=Eg(e),f=!1,d=u.length-1;d>=0;d--){var h=u[d],m=e[h];if(Sg(t,h)&&!(t[h]===void 0&&m!==void 0&&Array.isArray(t)===!1)){var _=t[h];typeof m=="object"&&m!=null&&typeof _=="object"&&_!=null&&Array.isArray(m)===Array.isArray(_)?lx(m,_,n,r+"/"+ji(h),s):m!==_&&(s&&n.push({op:"test",path:r+"/"+ji(h),value:Tr(m)}),n.push({op:"replace",path:r+"/"+ji(h),value:Tr(_)}))}else Array.isArray(e)===Array.isArray(t)?(s&&n.push({op:"test",path:r+"/"+ji(h),value:Tr(m)}),n.push({op:"remove",path:r+"/"+ji(h)}),f=!0):(s&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!f&&o.length==u.length))for(var d=0;d<o.length;d++){var h=o[d];!Sg(e,h)&&t[h]!==void 0&&n.push({op:"add",path:r+"/"+ji(h),value:Tr(t[h])})}}}function t4(e,t,n=!1){var r=[];return lx(e,t,r,"",n),r}({...QM});var Xa=class{ops;constructor(e){this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),n=Ml({},t);return new ux({ops:t,state:n[n.length-1].newDocument})}},ux=class Og extends Xa{state;constructor(t){super(t),this.state=t.state}concat(t){const n=this.ops.concat(t.ops),r=Ml(this.state,t.ops);return new Og({ops:n,state:r[r.length-1].newDocument})}static fromRunLogPatch(t){const n=Ml({},t.ops);return new Og({ops:t.ops,state:n[n.length-1].newDocument})}};const n4=e=>e.name==="log_stream_tracer";async function wE(e,t){if(t==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:n}=e;if(["retriever","llm","prompt"].includes(e.run_type))return n;if(!(Object.keys(n).length===1&&n?.input===""))return n.input}async function SE(e,t){const{outputs:n}=e;return t==="original"||["retriever","llm","prompt"].includes(e.run_type)?n:n!==void 0&&Object.keys(n).length===1&&n?.output!==void 0?n.output:n}function r4(e){return e!==void 0&&e.message!==void 0}var EE=class extends ql{autoClose=!0;includeNames;includeTypes;includeTags;excludeNames;excludeTypes;excludeTags;_schemaFormat="original";rootId;keyMapByRunId={};counterMapByRunName={};transformStream;writer;receiveStream;name="log_stream_tracer";lc_prefer_streaming=!0;constructor(e){super({_awaitHandler:!0,...e}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Pr.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(n=n||t.find(r=>this.includeTags?.includes(r))!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(n=n&&t.every(r=>!this.excludeTags?.includes(r))),n}async*tapOutputIterable(e,t){for await(const n of t){if(e!==this.rootId){const r=this.keyMapByRunId[e];r&&await this.writer.write(new Xa({ops:[{op:"add",path:`/logs/${r}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new Xa({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(n.inputs=await wE(e,this._schemaFormat)),await this.writer.write(new Xa({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const n=[];this._schemaFormat==="streaming_events"&&n.push({op:"replace",path:`/logs/${t}/inputs`,value:await wE(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${t}/final_output`,value:await SE(e,this._schemaFormat)}),e.end_time!==void 0&&n.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const r=new Xa({ops:n});await this.writer.write(r)}finally{if(e.id===this.rootId){const t=new Xa({ops:[{op:"replace",path:"/final_output",value:await SE(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,n){const r=this.keyMapByRunId[e.id];if(r===void 0)return;const s=e.inputs.messages!==void 0;let o;s?r4(n?.chunk)?o=n?.chunk:o=new Vs({id:`run-${e.id}`,content:t}):o=t;const u=new Xa({ops:[{op:"add",path:`/logs/${r}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${r}/streamed_output/-`,value:o}]});await this.writer.write(u)}};const TE="__run";var pf=class cx{text;generationInfo;constructor(t){this.text=t.text,this.generationInfo=t.generationInfo}concat(t){return new cx({text:this.text+t.text,generationInfo:{...this.generationInfo,...t.generationInfo}})}},Ll=class fx extends pf{message;constructor(t){super(t),this.message=t.message}concat(t){return new fx({text:this.text+t.text,generationInfo:{...this.generationInfo,...t.generationInfo},message:this.message.concat(t.message)})}};function Oc({name:e,serialized:t}){return e!==void 0?e:t?.name!==void 0?t.name:t?.id!==void 0&&Array.isArray(t?.id)?t.id[t.id.length-1]:"Unnamed"}const a4=e=>e.name==="event_stream_tracer";var s4=class extends ql{autoClose=!0;includeNames;includeTypes;includeTags;excludeNames;excludeTypes;excludeTags;runInfoMap=new Map;tappedPromises=new Map;transformStream;writer;receiveStream;readableStreamClosed=!1;name="event_stream_tracer";lc_prefer_streaming=!0;constructor(e){super({_awaitHandler:!0,...e}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this.transformStream=new TransformStream({flush:()=>{this.readableStreamClosed=!0}}),this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Pr.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(n=n||t.find(r=>this.includeTags?.includes(r))!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(n=n&&t.every(r=>!this.excludeTags?.includes(r))),n}async*tapOutputIterable(e,t){const n=await t.next();if(n.done)return;const r=this.runInfoMap.get(e);if(r===void 0){yield n.value;return}function s(u,f){return u==="llm"&&typeof f=="string"?new pf({text:f}):f}let o=this.tappedPromises.get(e);if(o===void 0){let u;o=new Promise(f=>{u=f}),this.tappedPromises.set(e,o);try{const f={event:`on_${r.runType}_stream`,run_id:e,name:r.name,tags:r.tags,metadata:r.metadata,data:{}};await this.send({...f,data:{chunk:s(r.runType,n.value)}},r),yield n.value;for await(const d of t)r.runType!=="tool"&&r.runType!=="retriever"&&await this.send({...f,data:{chunk:s(r.runType,d)}},r),yield d}finally{u?.()}}else{yield n.value;for await(const u of t)yield u}}async send(e,t){this.readableStreamClosed||this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const n=this.tappedPromises.get(e.run_id);n!==void 0?n.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){const t=Oc(e),n=e.inputs.messages!==void 0?"chat_model":"llm",r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,r);const s=`on_${n}_start`;await this.send({event:s,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onLLMNewToken(e,t,n){const r=this.runInfoMap.get(e.id);let s,o;if(r===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(r.runType==="chat_model")o="on_chat_model_stream",n?.chunk===void 0?s=new Vs({content:t,id:`run-${e.id}`}):s=n.chunk.message;else if(r.runType==="llm")o="on_llm_stream",n?.chunk===void 0?s=new pf({text:t}):s=n.chunk;else throw new Error(`Unexpected run type ${r.runType}`);await this.send({event:o,data:{chunk:s},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}}async onLLMEnd(e){const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let n;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const r=e.outputs?.generations;let s;if(t.runType==="chat_model"){for(const o of r??[]){if(s!==void 0)break;s=o[0]?.message}n="on_chat_model_end"}else if(t.runType==="llm")s={generations:r?.map(o=>o.map(u=>({text:u.text,generationInfo:u.generationInfo}))),llmOutput:e.outputs?.llmOutput??{}},n="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:n,data:{output:s,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){const t=Oc(e),n=e.run_type??"chain",r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:e.run_type};let s={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(s={},r.inputs={}):e.inputs.input!==void 0?(s.input=e.inputs.input,r.inputs=e.inputs.input):(s.input=e.inputs,r.inputs=e.inputs),this.runInfoMap.set(e.id,r),await this.send({event:`on_${n}_start`,data:s,name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onChainEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const n=`on_${e.run_type}_end`,r=e.inputs??t.inputs??{},s={output:e.outputs?.output??e.outputs,input:r};r.input&&Object.keys(r).length===1&&(s.input=r.input,t.inputs=r.input),await this.sendEndEvent({event:n,data:s,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){const t=Oc(e),n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:e.extra?.metadata??{}},n)}async onToolEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const n=e.outputs?.output===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onToolError(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);await this.sendEndEvent({event:"on_tool_error",data:{input:t.inputs,error:e.error},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){const t=Oc(e),n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,n),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},n)}async onRetrieverEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:e.outputs?.documents??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,n){const r=this.runInfoMap.get(n);if(r===void 0)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:r.tags,metadata:r.metadata,data:t},r)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}};const i4=Object.prototype.toString,o4=e=>i4.call(e)==="[object Error]",l4=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function u4(e){if(!(e&&o4(e)&&e.name==="TypeError"&&typeof e.message=="string"))return!1;const{message:t,stack:n}=e;return t==="Load failed"?n===void 0||"__sentry_captured__"in e:t.startsWith("error sending request for url")?!0:l4.has(t)}function c4(e){if(typeof e=="number"){if(e<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(e))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(e!==void 0)throw new TypeError("Expected `retries` to be a number or Infinity.")}function Ac(e,t,{min:n=0,allowInfinity:r=!1}={}){if(t!==void 0){if(typeof t!="number"||Number.isNaN(t))throw new TypeError(`Expected \`${e}\` to be a number${r?" or Infinity":""}.`);if(!r&&!Number.isFinite(t))throw new TypeError(`Expected \`${e}\` to be a finite number.`);if(t<n)throw new TypeError(`Expected \`${e}\` to be  ${n}.`)}}var f4=class extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}};function d4(e,t){const n=Math.max(1,e+1),r=t.randomize?Math.random()+1:1;let s=Math.round(r*t.minTimeout*t.factor**(n-1));return s=Math.min(s,t.maxTimeout),s}function xE(e,t){return Number.isFinite(t)?t-(performance.now()-e):t}async function h4({error:e,attemptNumber:t,retriesConsumed:n,startTime:r,options:s}){const o=e instanceof Error?e:new TypeError(`Non-error was thrown: "${e}". You should only throw errors.`);if(o instanceof f4)throw o.originalError;const u=Number.isFinite(s.retries)?Math.max(0,s.retries-n):s.retries,f=s.maxRetryTime??Number.POSITIVE_INFINITY,d=Object.freeze({error:o,attemptNumber:t,retriesLeft:u,retriesConsumed:n});if(await s.onFailedAttempt(d),xE(r,f)<=0)throw o;const h=await s.shouldConsumeRetry(d),m=xE(r,f);if(m<=0||u<=0)throw o;if(o instanceof TypeError&&!u4(o)){if(h)throw o;return s.signal?.throwIfAborted(),!1}if(!await s.shouldRetry(d))throw o;if(!h)return s.signal?.throwIfAborted(),!1;const _=d4(n,s),y=Math.min(_,m);return y>0&&await new Promise((v,w)=>{const x=()=>{clearTimeout(R),s.signal?.removeEventListener("abort",x),w(s.signal.reason)},R=setTimeout(()=>{s.signal?.removeEventListener("abort",x),v()},y);s.unref&&R.unref?.(),s.signal?.addEventListener("abort",x,{once:!0})}),s.signal?.throwIfAborted(),!0}async function Ag(e,t={}){if(t={...t},c4(t.retries),Object.hasOwn(t,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");t.retries??=10,t.factor??=2,t.minTimeout??=1e3,t.maxTimeout??=Number.POSITIVE_INFINITY,t.maxRetryTime??=Number.POSITIVE_INFINITY,t.randomize??=!1,t.onFailedAttempt??=()=>{},t.shouldRetry??=()=>!0,t.shouldConsumeRetry??=()=>!0,Ac("factor",t.factor,{min:0,allowInfinity:!1}),Ac("minTimeout",t.minTimeout,{min:0,allowInfinity:!1}),Ac("maxTimeout",t.maxTimeout,{min:0,allowInfinity:!0}),Ac("maxRetryTime",t.maxRetryTime,{min:0,allowInfinity:!0}),t.factor>0||(t.factor=1),t.signal?.throwIfAborted();let n=0,r=0;const s=performance.now();for(;!Number.isFinite(t.retries)||r<=t.retries;){n++;try{t.signal?.throwIfAborted();const o=await e(n);return t.signal?.throwIfAborted(),o}catch(o){await h4({error:o,attemptNumber:n,retriesConsumed:r,startTime:s,options:t})&&r++}}throw new Error("Retry attempts exhausted without throwing an error.")}const p4=[400,401,402,403,404,405,406,407,409],m4=e=>{if(typeof e!="object"||e===null)return;if("message"in e&&typeof e.message=="string"&&(e.message.startsWith("Cancel")||e.message.startsWith("AbortError"))||"name"in e&&typeof e.name=="string"&&e.name==="AbortError"||"code"in e&&typeof e.code=="string"&&e.code==="ECONNABORTED")throw e;const t="response"in e&&typeof e.response=="object"&&e.response!==null&&"status"in e.response&&typeof e.response.status=="number"?e.response.status:void 0,n="status"in e&&typeof e.status=="number"?e.status:void 0,r=t??n;if(r&&p4.includes(+r))throw e;if(("error"in e&&typeof e.error=="object"&&e.error!==null&&"code"in e.error&&typeof e.error.code=="string"?e.error.code:void 0)==="insufficient_quota"){const s=new Error("message"in e&&typeof e.message=="string"?e.message:"Insufficient quota");throw s.name="InsufficientQuotaError",s}};var R_=class{maxConcurrency;maxRetries;onFailedAttempt;queue;constructor(e){this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??m4,this.queue=new("default"in pa?pa.default:pa)({concurrency:this.maxConcurrency})}async call(e,...t){return this.queue.add(()=>Ag(()=>e(...t).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:({error:n})=>this.onFailedAttempt?.(n),retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){if(e.signal){let r;return Promise.race([this.call(t,...n),new Promise((s,o)=>{r=()=>{o(ff(e.signal))},e.signal?.addEventListener("abort",r,{once:!0})})]).finally(()=>{e.signal&&r&&e.signal.removeEventListener("abort",r)})}return this.call(t,...n)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}},dx=class extends ql{name="RootListenersTracer";rootId;config;argOnStart;argOnEnd;argOnError;constructor({config:e,onStart:t,onEnd:n,onError:r}){super({_awaitHandler:!0}),this.config=e,this.argOnStart=t,this.argOnEnd=n,this.argOnError=r}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}};function N_(e){return e?e.lc_runnable:!1}var g4=class{includeNames;includeTypes;includeTags;excludeNames;excludeTypes;excludeTags;constructor(e){this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const r=e.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(t)),this.includeTags!==void 0&&(n=n||r.some(s=>this.includeTags?.includes(s))),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(n=n&&r.every(s=>!this.excludeTags?.includes(s))),n}};const _4=e=>btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");function ee(e,t,n){function r(f,d){if(f._zod||Object.defineProperty(f,"_zod",{value:{def:d,constr:u,traits:new Set},enumerable:!1}),f._zod.traits.has(e))return;f._zod.traits.add(e),t(f,d);const h=u.prototype,m=Object.keys(h);for(let _=0;_<m.length;_++){const y=m[_];y in f||(f[y]=h[y].bind(f))}}const s=n?.Parent??Object;class o extends s{}Object.defineProperty(o,"name",{value:e});function u(f){var d;const h=n?.Parent?new o:this;r(h,f),(d=h._zod).deferred??(d.deferred=[]);for(const m of h._zod.deferred)m();return h}return Object.defineProperty(u,"init",{value:r}),Object.defineProperty(u,Symbol.hasInstance,{value:f=>n?.Parent&&f instanceof n.Parent?!0:f?._zod?.traits?.has(e)}),Object.defineProperty(u,"name",{value:e}),u}class Yi extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class hx extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const px={};function ss(e){return px}function mx(e){const t=Object.values(e).filter(r=>typeof r=="number");return Object.entries(e).filter(([r,s])=>t.indexOf(+r)===-1).map(([r,s])=>s)}function Cg(e,t){return typeof t=="bigint"?t.toString():t}function I_(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function k_(e){return e==null}function $_(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function y4(e,t){const n=(e.toString().split(".")[1]||"").length,r=t.toString();let s=(r.split(".")[1]||"").length;if(s===0&&/\d?e-\d?/.test(r)){const d=r.match(/\d?e-(\d?)/);d?.[1]&&(s=Number.parseInt(d[1]))}const o=n>s?n:s,u=Number.parseInt(e.toFixed(o).replace(".","")),f=Number.parseInt(t.toFixed(o).replace(".",""));return u%f/10**o}const OE=Symbol("evaluating");function lt(e,t,n){let r;Object.defineProperty(e,t,{get(){if(r!==OE)return r===void 0&&(r=OE,r=n()),r},set(s){Object.defineProperty(e,t,{value:s})},configurable:!0})}function Js(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function us(...e){const t={};for(const n of e){const r=Object.getOwnPropertyDescriptors(n);Object.assign(t,r)}return Object.defineProperties({},t)}function AE(e){return JSON.stringify(e)}function v4(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const gx="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function mf(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const b4=I_(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function eo(e){if(mf(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(mf(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function _x(e){return eo(e)?{...e}:Array.isArray(e)?[...e]:e}const w4=new Set(["string","number","symbol"]);function to(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function On(e,t,n){const r=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(r._zod.parent=e),r}function Ce(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function S4(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const E4={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function T4(e,t){const n=e._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const o=us(e._zod.def,{get shape(){const u={};for(const f in t){if(!(f in n.shape))throw new Error(`Unrecognized key: "${f}"`);t[f]&&(u[f]=n.shape[f])}return Js(this,"shape",u),u},checks:[]});return On(e,o)}function x4(e,t){const n=e._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const o=us(e._zod.def,{get shape(){const u={...e._zod.def.shape};for(const f in t){if(!(f in n.shape))throw new Error(`Unrecognized key: "${f}"`);t[f]&&delete u[f]}return Js(this,"shape",u),u},checks:[]});return On(e,o)}function O4(e,t){if(!eo(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0){const o=e._zod.def.shape;for(const u in t)if(Object.getOwnPropertyDescriptor(o,u)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const s=us(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return Js(this,"shape",o),o}});return On(e,s)}function A4(e,t){if(!eo(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n=us(e._zod.def,{get shape(){const r={...e._zod.def.shape,...t};return Js(this,"shape",r),r}});return On(e,n)}function C4(e,t){const n=us(e._zod.def,{get shape(){const r={...e._zod.def.shape,...t._zod.def.shape};return Js(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return On(e,n)}function R4(e,t,n){const s=t._zod.def.checks;if(s&&s.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const u=us(t._zod.def,{get shape(){const f=t._zod.def.shape,d={...f};if(n)for(const h in n){if(!(h in f))throw new Error(`Unrecognized key: "${h}"`);n[h]&&(d[h]=e?new e({type:"optional",innerType:f[h]}):f[h])}else for(const h in f)d[h]=e?new e({type:"optional",innerType:f[h]}):f[h];return Js(this,"shape",d),d},checks:[]});return On(t,u)}function N4(e,t,n){const r=us(t._zod.def,{get shape(){const s=t._zod.def.shape,o={...s};if(n)for(const u in n){if(!(u in o))throw new Error(`Unrecognized key: "${u}"`);n[u]&&(o[u]=new e({type:"nonoptional",innerType:s[u]}))}else for(const u in s)o[u]=new e({type:"nonoptional",innerType:s[u]});return Js(this,"shape",o),o}});return On(t,r)}function Gi(e,t=0){if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function Vi(e,t){return t.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(e),n})}function Cc(e){return typeof e=="string"?e:e?.message}function is(e,t,n){const r={...e,path:e.path??[]};if(!e.message){const s=Cc(e.inst?._zod.def?.error?.(e))??Cc(t?.error?.(e))??Cc(n.customError?.(e))??Cc(n.localeError?.(e))??"Invalid input";r.message=s}return delete r.inst,delete r.continue,t?.reportInput||delete r.input,r}function M_(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function zl(...e){const[t,n,r]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:r}:{...t}}const yx=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,Cg,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},vx=ee("$ZodError",yx),Wf=ee("$ZodError",yx,{Parent:Error});function I4(e,t=n=>n.message){const n={},r=[];for(const s of e.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}function k4(e,t=n=>n.message){const n={_errors:[]},r=s=>{for(const o of s.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(u=>r({issues:u}));else if(o.code==="invalid_key")r({issues:o.issues});else if(o.code==="invalid_element")r({issues:o.issues});else if(o.path.length===0)n._errors.push(t(o));else{let u=n,f=0;for(;f<o.path.length;){const d=o.path[f];f===o.path.length-1?(u[d]=u[d]||{_errors:[]},u[d]._errors.push(t(o))):u[d]=u[d]||{_errors:[]},u=u[d],f++}}};return r(e),n}const ed=e=>(t,n,r,s)=>{const o=r?Object.assign(r,{async:!1}):{async:!1},u=t._zod.run({value:n,issues:[]},o);if(u instanceof Promise)throw new Yi;if(u.issues.length){const f=new(s?.Err??e)(u.issues.map(d=>is(d,o,ss())));throw gx(f,s?.callee),f}return u.value},$4=ed(Wf),td=e=>async(t,n,r,s)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let u=t._zod.run({value:n,issues:[]},o);if(u instanceof Promise&&(u=await u),u.issues.length){const f=new(s?.Err??e)(u.issues.map(d=>is(d,o,ss())));throw gx(f,s?.callee),f}return u.value},bx=td(Wf),nd=e=>(t,n,r)=>{const s=r?{...r,async:!1}:{async:!1},o=t._zod.run({value:n,issues:[]},s);if(o instanceof Promise)throw new Yi;return o.issues.length?{success:!1,error:new(e??vx)(o.issues.map(u=>is(u,s,ss())))}:{success:!0,data:o.value}},M4=nd(Wf),rd=e=>async(t,n,r)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let o=t._zod.run({value:n,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(u=>is(u,s,ss())))}:{success:!0,data:o.value}},j4=rd(Wf),L4=e=>(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ed(e)(t,n,s)},z4=e=>(t,n,r)=>ed(e)(t,n,r),D4=e=>async(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return td(e)(t,n,s)},U4=e=>async(t,n,r)=>td(e)(t,n,r),P4=e=>(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return nd(e)(t,n,s)},B4=e=>(t,n,r)=>nd(e)(t,n,r),Z4=e=>async(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rd(e)(t,n,s)},q4=e=>async(t,n,r)=>rd(e)(t,n,r),F4=/^[cC][^\s-]{8,}$/,H4=/^[0-9a-z]+$/,G4=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,V4=/^[0-9a-vA-V]{20}$/,J4=/^[A-Za-z0-9]{27}$/,X4=/^[a-zA-Z0-9_-]{21}$/,Y4=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Q4=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,CE=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,K4=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,W4="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function ej(){return new RegExp(W4,"u")}const tj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,nj=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,rj=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,aj=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,sj=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,wx=/^[A-Za-z0-9_-]*$/,ij=/^\+[1-9]\d{6,14}$/,Sx="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",oj=new RegExp(`^${Sx}$`);function Ex(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function lj(e){return new RegExp(`^${Ex(e)}$`)}function uj(e){const t=Ex({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${t}(?:${n.join("|")})`;return new RegExp(`^${Sx}T(?:${r})$`)}const cj=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},fj=/^-?\d+$/,Tx=/^-?\d+(?:\.\d+)?$/,dj=/^[^A-Z]*$/,hj=/^[^a-z]*$/,An=ee("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),xx={number:"number",bigint:"bigint",object:"date"},Ox=ee("$ZodCheckLessThan",(e,t)=>{An.init(e,t);const n=xx[typeof t.value];e._zod.onattach.push(r=>{const s=r._zod.bag,o=(t.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?s.maximum=t.value:s.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:typeof t.value=="object"?t.value.getTime():t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Ax=ee("$ZodCheckGreaterThan",(e,t)=>{An.init(e,t);const n=xx[typeof t.value];e._zod.onattach.push(r=>{const s=r._zod.bag,o=(t.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?s.minimum=t.value:s.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:typeof t.value=="object"?t.value.getTime():t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),pj=ee("$ZodCheckMultipleOf",(e,t)=>{An.init(e,t),e._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):y4(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),mj=ee("$ZodCheckNumberFormat",(e,t)=>{An.init(e,t),t.format=t.format||"float64";const n=t.format?.includes("int"),r=n?"int":"number",[s,o]=E4[t.format];e._zod.onattach.push(u=>{const f=u._zod.bag;f.format=t.format,f.minimum=s,f.maximum=o,n&&(f.pattern=fj)}),e._zod.check=u=>{const f=u.value;if(n){if(!Number.isInteger(f)){u.issues.push({expected:r,format:t.format,code:"invalid_type",continue:!1,input:f,inst:e});return}if(!Number.isSafeInteger(f)){f>0?u.issues.push({input:f,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,inclusive:!0,continue:!t.abort}):u.issues.push({input:f,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,inclusive:!0,continue:!t.abort});return}}f<s&&u.issues.push({origin:"number",input:f,code:"too_small",minimum:s,inclusive:!0,inst:e,continue:!t.abort}),f>o&&u.issues.push({origin:"number",input:f,code:"too_big",maximum:o,inclusive:!0,inst:e,continue:!t.abort})}}),gj=ee("$ZodCheckMaxLength",(e,t)=>{var n;An.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!k_(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(r._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{const s=r.value;if(s.length<=t.maximum)return;const u=M_(s);r.issues.push({origin:u,code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),_j=ee("$ZodCheckMinLength",(e,t)=>{var n;An.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!k_(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(r._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{const s=r.value;if(s.length>=t.minimum)return;const u=M_(s);r.issues.push({origin:u,code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),yj=ee("$ZodCheckLengthEquals",(e,t)=>{var n;An.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!k_(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag;s.minimum=t.length,s.maximum=t.length,s.length=t.length}),e._zod.check=r=>{const s=r.value,o=s.length;if(o===t.length)return;const u=M_(s),f=o>t.length;r.issues.push({origin:u,...f?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),ad=ee("$ZodCheckStringFormat",(e,t)=>{var n,r;An.init(e,t),e._zod.onattach.push(s=>{const o=s._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=s=>{t.pattern.lastIndex=0,!t.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:t.format,input:s.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(r=e._zod).check??(r.check=()=>{})}),vj=ee("$ZodCheckRegex",(e,t)=>{ad.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),bj=ee("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=dj),ad.init(e,t)}),wj=ee("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=hj),ad.init(e,t)}),Sj=ee("$ZodCheckIncludes",(e,t)=>{An.init(e,t);const n=to(t.includes),r=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(s=>{const o=s._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=s=>{s.value.includes(t.includes,t.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:s.value,inst:e,continue:!t.abort})}}),Ej=ee("$ZodCheckStartsWith",(e,t)=>{An.init(e,t);const n=new RegExp(`^${to(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),Tj=ee("$ZodCheckEndsWith",(e,t)=>{An.init(e,t);const n=new RegExp(`.*${to(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),xj=ee("$ZodCheckOverwrite",(e,t)=>{An.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class Oj{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const r=t.split(`
`).filter(u=>u),s=Math.min(...r.map(u=>u.length-u.trimStart().length)),o=r.map(u=>u.slice(s)).map(u=>" ".repeat(this.indent*2)+u);for(const u of o)this.content.push(u)}compile(){const t=Function,n=this?.args,s=[...(this?.content??[""]).map(o=>`  ${o}`)];return new t(...n,s.join(`
`))}}const Aj={major:4,minor:3,patch:6},xt=ee("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Aj;const r=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&r.unshift(e);for(const s of r)for(const o of s._zod.onattach)o(e);if(r.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const s=(u,f,d)=>{let h=Gi(u),m;for(const _ of f){if(_._zod.def.when){if(!_._zod.def.when(u))continue}else if(h)continue;const y=u.issues.length,v=_._zod.check(u);if(v instanceof Promise&&d?.async===!1)throw new Yi;if(m||v instanceof Promise)m=(m??Promise.resolve()).then(async()=>{await v,u.issues.length!==y&&(h||(h=Gi(u,y)))});else{if(u.issues.length===y)continue;h||(h=Gi(u,y))}}return m?m.then(()=>u):u},o=(u,f,d)=>{if(Gi(u))return u.aborted=!0,u;const h=s(f,r,d);if(h instanceof Promise){if(d.async===!1)throw new Yi;return h.then(m=>e._zod.parse(m,d))}return e._zod.parse(h,d)};e._zod.run=(u,f)=>{if(f.skipChecks)return e._zod.parse(u,f);if(f.direction==="backward"){const h=e._zod.parse({value:u.value,issues:[]},{...f,skipChecks:!0});return h instanceof Promise?h.then(m=>o(m,u,f)):o(h,u,f)}const d=e._zod.parse(u,f);if(d instanceof Promise){if(f.async===!1)throw new Yi;return d.then(h=>s(h,r,f))}return s(d,r,f)}}lt(e,"~standard",()=>({validate:s=>{try{const o=M4(e,s);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return j4(e,s).then(u=>u.success?{value:u.data}:{issues:u.error?.issues})}},vendor:"zod",version:1}))}),j_=ee("$ZodString",(e,t)=>{xt.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??cj(e._zod.bag),e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),vt=ee("$ZodStringFormat",(e,t)=>{ad.init(e,t),j_.init(e,t)}),Cj=ee("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Q4),vt.init(e,t)}),Rj=ee("$ZodUUID",(e,t)=>{if(t.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(r===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=CE(r))}else t.pattern??(t.pattern=CE());vt.init(e,t)}),Nj=ee("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=K4),vt.init(e,t)}),Ij=ee("$ZodURL",(e,t)=>{vt.init(e,t),e._zod.check=n=>{try{const r=n.value.trim(),s=new URL(r);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(s.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=s.href:n.value=r;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),kj=ee("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=ej()),vt.init(e,t)}),$j=ee("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=X4),vt.init(e,t)}),Mj=ee("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=F4),vt.init(e,t)}),jj=ee("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=H4),vt.init(e,t)}),Lj=ee("$ZodULID",(e,t)=>{t.pattern??(t.pattern=G4),vt.init(e,t)}),zj=ee("$ZodXID",(e,t)=>{t.pattern??(t.pattern=V4),vt.init(e,t)}),Dj=ee("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=J4),vt.init(e,t)}),Uj=ee("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=uj(t)),vt.init(e,t)}),Pj=ee("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=oj),vt.init(e,t)}),Bj=ee("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=lj(t)),vt.init(e,t)}),Zj=ee("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Y4),vt.init(e,t)}),qj=ee("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=tj),vt.init(e,t),e._zod.bag.format="ipv4"}),Fj=ee("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=nj),vt.init(e,t),e._zod.bag.format="ipv6",e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),Hj=ee("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=rj),vt.init(e,t)}),Gj=ee("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=aj),vt.init(e,t),e._zod.check=n=>{const r=n.value.split("/");try{if(r.length!==2)throw new Error;const[s,o]=r;if(!o)throw new Error;const u=Number(o);if(`${u}`!==o)throw new Error;if(u<0||u>128)throw new Error;new URL(`http://[${s}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function Cx(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Vj=ee("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=sj),vt.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=n=>{Cx(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function Jj(e){if(!wx.test(e))return!1;const t=e.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return Cx(n)}const Xj=ee("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=wx),vt.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=n=>{Jj(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),Yj=ee("$ZodE164",(e,t)=>{t.pattern??(t.pattern=ij),vt.init(e,t)});function Qj(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const s=JSON.parse(atob(r));return!("typ"in s&&s?.typ!=="JWT"||!s.alg||t&&(!("alg"in s)||s.alg!==t))}catch{return!1}}const Kj=ee("$ZodJWT",(e,t)=>{vt.init(e,t),e._zod.check=n=>{Qj(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),Rx=ee("$ZodNumber",(e,t)=>{xt.init(e,t),e._zod.pattern=e._zod.bag.pattern??Tx,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const s=n.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return n;const o=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:s,inst:e,...o?{received:o}:{}}),n}}),Wj=ee("$ZodNumberFormat",(e,t)=>{mj.init(e,t),Rx.init(e,t)}),eL=ee("$ZodUnknown",(e,t)=>{xt.init(e,t),e._zod.parse=n=>n}),Nx=ee("$ZodNever",(e,t)=>{xt.init(e,t),e._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function RE(e,t,n){e.issues.length&&t.issues.push(...Vi(n,e.issues)),t.value[n]=e.value}const tL=ee("$ZodArray",(e,t)=>{xt.init(e,t),e._zod.parse=(n,r)=>{const s=n.value;if(!Array.isArray(s))return n.issues.push({expected:"array",code:"invalid_type",input:s,inst:e}),n;n.value=Array(s.length);const o=[];for(let u=0;u<s.length;u++){const f=s[u],d=t.element._zod.run({value:f,issues:[]},r);d instanceof Promise?o.push(d.then(h=>RE(h,n,u))):RE(d,n,u)}return o.length?Promise.all(o).then(()=>n):n}});function gf(e,t,n,r,s){if(e.issues.length){if(s&&!(n in r))return;t.issues.push(...Vi(n,e.issues))}e.value===void 0?n in r&&(t.value[n]=void 0):t.value[n]=e.value}function Ix(e){const t=Object.keys(e.shape);for(const r of t)if(!e.shape?.[r]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);const n=S4(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function kx(e,t,n,r,s,o){const u=[],f=s.keySet,d=s.catchall._zod,h=d.def.type,m=d.optout==="optional";for(const _ in t){if(f.has(_))continue;if(h==="never"){u.push(_);continue}const y=d.run({value:t[_],issues:[]},r);y instanceof Promise?e.push(y.then(v=>gf(v,n,_,t,m))):gf(y,n,_,t,m)}return u.length&&n.issues.push({code:"unrecognized_keys",keys:u,input:t,inst:o}),e.length?Promise.all(e).then(()=>n):n}const nL=ee("$ZodObject",(e,t)=>{if(xt.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const f=t.shape;Object.defineProperty(t,"shape",{get:()=>{const d={...f};return Object.defineProperty(t,"shape",{value:d}),d}})}const r=I_(()=>Ix(t));lt(e._zod,"propValues",()=>{const f=t.shape,d={};for(const h in f){const m=f[h]._zod;if(m.values){d[h]??(d[h]=new Set);for(const _ of m.values)d[h].add(_)}}return d});const s=mf,o=t.catchall;let u;e._zod.parse=(f,d)=>{u??(u=r.value);const h=f.value;if(!s(h))return f.issues.push({expected:"object",code:"invalid_type",input:h,inst:e}),f;f.value={};const m=[],_=u.shape;for(const y of u.keys){const v=_[y],w=v._zod.optout==="optional",x=v._zod.run({value:h[y],issues:[]},d);x instanceof Promise?m.push(x.then(R=>gf(R,f,y,h,w))):gf(x,f,y,h,w)}return o?kx(m,h,f,d,r.value,e):m.length?Promise.all(m).then(()=>f):f}}),rL=ee("$ZodObjectJIT",(e,t)=>{nL.init(e,t);const n=e._zod.parse,r=I_(()=>Ix(t)),s=y=>{const v=new Oj(["shape","payload","ctx"]),w=r.value,x=N=>{const M=AE(N);return`shape[${M}]._zod.run({ value: input[${M}], issues: [] }, ctx)`};v.write("const input = payload.value;");const R=Object.create(null);let E=0;for(const N of w.keys)R[N]=`key_${E++}`;v.write("const newResult = {};");for(const N of w.keys){const M=R[N],B=AE(N),W=y[N]?._zod?.optout==="optional";v.write(`const ${M} = ${x(N)};`),W?v.write(`
        if (${M}.issues.length) {
          if (${B} in input) {
            payload.issues = payload.issues.concat(${M}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${B}, ...iss.path] : [${B}]
            })));
          }
        }
        
        if (${M}.value === undefined) {
          if (${B} in input) {
            newResult[${B}] = undefined;
          }
        } else {
          newResult[${B}] = ${M}.value;
        }
        
      `):v.write(`
        if (${M}.issues.length) {
          payload.issues = payload.issues.concat(${M}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${B}, ...iss.path] : [${B}]
          })));
        }
        
        if (${M}.value === undefined) {
          if (${B} in input) {
            newResult[${B}] = undefined;
          }
        } else {
          newResult[${B}] = ${M}.value;
        }
        
      `)}v.write("payload.value = newResult;"),v.write("return payload;");const A=v.compile();return(N,M)=>A(y,N,M)};let o;const u=mf,f=!px.jitless,h=f&&b4.value,m=t.catchall;let _;e._zod.parse=(y,v)=>{_??(_=r.value);const w=y.value;return u(w)?f&&h&&v?.async===!1&&v.jitless!==!0?(o||(o=s(t.shape)),y=o(y,v),m?kx([],w,y,v,_,e):y):n(y,v):(y.issues.push({expected:"object",code:"invalid_type",input:w,inst:e}),y)}});function NE(e,t,n,r){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const s=e.filter(o=>!Gi(o));return s.length===1?(t.value=s[0].value,s[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(o=>o.issues.map(u=>is(u,r,ss())))}),t)}const aL=ee("$ZodUnion",(e,t)=>{xt.init(e,t),lt(e._zod,"optin",()=>t.options.some(s=>s._zod.optin==="optional")?"optional":void 0),lt(e._zod,"optout",()=>t.options.some(s=>s._zod.optout==="optional")?"optional":void 0),lt(e._zod,"values",()=>{if(t.options.every(s=>s._zod.values))return new Set(t.options.flatMap(s=>Array.from(s._zod.values)))}),lt(e._zod,"pattern",()=>{if(t.options.every(s=>s._zod.pattern)){const s=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${s.map(o=>$_(o.source)).join("|")})$`)}});const n=t.options.length===1,r=t.options[0]._zod.run;e._zod.parse=(s,o)=>{if(n)return r(s,o);let u=!1;const f=[];for(const d of t.options){const h=d._zod.run({value:s.value,issues:[]},o);if(h instanceof Promise)f.push(h),u=!0;else{if(h.issues.length===0)return h;f.push(h)}}return u?Promise.all(f).then(d=>NE(d,s,e,o)):NE(f,s,e,o)}}),sL=ee("$ZodIntersection",(e,t)=>{xt.init(e,t),e._zod.parse=(n,r)=>{const s=n.value,o=t.left._zod.run({value:s,issues:[]},r),u=t.right._zod.run({value:s,issues:[]},r);return o instanceof Promise||u instanceof Promise?Promise.all([o,u]).then(([d,h])=>IE(n,d,h)):IE(n,o,u)}});function Rg(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(eo(e)&&eo(t)){const n=Object.keys(t),r=Object.keys(e).filter(o=>n.indexOf(o)!==-1),s={...e,...t};for(const o of r){const u=Rg(e[o],t[o]);if(!u.valid)return{valid:!1,mergeErrorPath:[o,...u.mergeErrorPath]};s[o]=u.data}return{valid:!0,data:s}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const s=e[r],o=t[r],u=Rg(s,o);if(!u.valid)return{valid:!1,mergeErrorPath:[r,...u.mergeErrorPath]};n.push(u.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function IE(e,t,n){const r=new Map;let s;for(const f of t.issues)if(f.code==="unrecognized_keys"){s??(s=f);for(const d of f.keys)r.has(d)||r.set(d,{}),r.get(d).l=!0}else e.issues.push(f);for(const f of n.issues)if(f.code==="unrecognized_keys")for(const d of f.keys)r.has(d)||r.set(d,{}),r.get(d).r=!0;else e.issues.push(f);const o=[...r].filter(([,f])=>f.l&&f.r).map(([f])=>f);if(o.length&&s&&e.issues.push({...s,keys:o}),Gi(e))return e;const u=Rg(t.value,n.value);if(!u.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(u.mergeErrorPath)}`);return e.value=u.data,e}const iL=ee("$ZodRecord",(e,t)=>{xt.init(e,t),e._zod.parse=(n,r)=>{const s=n.value;if(!eo(s))return n.issues.push({expected:"record",code:"invalid_type",input:s,inst:e}),n;const o=[],u=t.keyType._zod.values;if(u){n.value={};const f=new Set;for(const h of u)if(typeof h=="string"||typeof h=="number"||typeof h=="symbol"){f.add(typeof h=="number"?h.toString():h);const m=t.valueType._zod.run({value:s[h],issues:[]},r);m instanceof Promise?o.push(m.then(_=>{_.issues.length&&n.issues.push(...Vi(h,_.issues)),n.value[h]=_.value})):(m.issues.length&&n.issues.push(...Vi(h,m.issues)),n.value[h]=m.value)}let d;for(const h in s)f.has(h)||(d=d??[],d.push(h));d&&d.length>0&&n.issues.push({code:"unrecognized_keys",input:s,inst:e,keys:d})}else{n.value={};for(const f of Reflect.ownKeys(s)){if(f==="__proto__")continue;let d=t.keyType._zod.run({value:f,issues:[]},r);if(d instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(typeof f=="string"&&Tx.test(f)&&d.issues.length){const _=t.keyType._zod.run({value:Number(f),issues:[]},r);if(_ instanceof Promise)throw new Error("Async schemas not supported in object keys currently");_.issues.length===0&&(d=_)}if(d.issues.length){t.mode==="loose"?n.value[f]=s[f]:n.issues.push({code:"invalid_key",origin:"record",issues:d.issues.map(_=>is(_,r,ss())),input:f,path:[f],inst:e});continue}const m=t.valueType._zod.run({value:s[f],issues:[]},r);m instanceof Promise?o.push(m.then(_=>{_.issues.length&&n.issues.push(...Vi(f,_.issues)),n.value[d.value]=_.value})):(m.issues.length&&n.issues.push(...Vi(f,m.issues)),n.value[d.value]=m.value)}}return o.length?Promise.all(o).then(()=>n):n}}),oL=ee("$ZodEnum",(e,t)=>{xt.init(e,t);const n=mx(t.entries),r=new Set(n);e._zod.values=r,e._zod.pattern=new RegExp(`^(${n.filter(s=>w4.has(typeof s)).map(s=>typeof s=="string"?to(s):s.toString()).join("|")})$`),e._zod.parse=(s,o)=>{const u=s.value;return r.has(u)||s.issues.push({code:"invalid_value",values:n,input:u,inst:e}),s}}),lL=ee("$ZodLiteral",(e,t)=>{if(xt.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(t.values);e._zod.values=n,e._zod.pattern=new RegExp(`^(${t.values.map(r=>typeof r=="string"?to(r):r?to(r.toString()):String(r)).join("|")})$`),e._zod.parse=(r,s)=>{const o=r.value;return n.has(o)||r.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),r}}),uL=ee("$ZodTransform",(e,t)=>{xt.init(e,t),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new hx(e.constructor.name);const s=t.transform(n.value,n);if(r.async)return(s instanceof Promise?s:Promise.resolve(s)).then(u=>(n.value=u,n));if(s instanceof Promise)throw new Yi;return n.value=s,n}});function kE(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const $x=ee("$ZodOptional",(e,t)=>{xt.init(e,t),e._zod.optin="optional",e._zod.optout="optional",lt(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),lt(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${$_(n.source)})?$`):void 0}),e._zod.parse=(n,r)=>{if(t.innerType._zod.optin==="optional"){const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>kE(o,n.value)):kE(s,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,r)}}),cL=ee("$ZodExactOptional",(e,t)=>{$x.init(e,t),lt(e._zod,"values",()=>t.innerType._zod.values),lt(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(n,r)=>t.innerType._zod.run(n,r)}),fL=ee("$ZodNullable",(e,t)=>{xt.init(e,t),lt(e._zod,"optin",()=>t.innerType._zod.optin),lt(e._zod,"optout",()=>t.innerType._zod.optout),lt(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${$_(n.source)}|null)$`):void 0}),lt(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,r)=>n.value===null?n:t.innerType._zod.run(n,r)}),dL=ee("$ZodDefault",(e,t)=>{xt.init(e,t),e._zod.optin="optional",lt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);if(n.value===void 0)return n.value=t.defaultValue,n;const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>$E(o,t)):$E(s,t)}});function $E(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const hL=ee("$ZodPrefault",(e,t)=>{xt.init(e,t),e._zod.optin="optional",lt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>(r.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,r))}),pL=ee("$ZodNonOptional",(e,t)=>{xt.init(e,t),lt(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),e._zod.parse=(n,r)=>{const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>ME(o,e)):ME(s,e)}});function ME(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const mL=ee("$ZodCatch",(e,t)=>{xt.init(e,t),lt(e._zod,"optin",()=>t.innerType._zod.optin),lt(e._zod,"optout",()=>t.innerType._zod.optout),lt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>(n.value=o.value,o.issues.length&&(n.value=t.catchValue({...n,error:{issues:o.issues.map(u=>is(u,r,ss()))},input:n.value}),n.issues=[]),n)):(n.value=s.value,s.issues.length&&(n.value=t.catchValue({...n,error:{issues:s.issues.map(o=>is(o,r,ss()))},input:n.value}),n.issues=[]),n)}}),gL=ee("$ZodPipe",(e,t)=>{xt.init(e,t),lt(e._zod,"values",()=>t.in._zod.values),lt(e._zod,"optin",()=>t.in._zod.optin),lt(e._zod,"optout",()=>t.out._zod.optout),lt(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,r)=>{if(r.direction==="backward"){const o=t.out._zod.run(n,r);return o instanceof Promise?o.then(u=>Rc(u,t.in,r)):Rc(o,t.in,r)}const s=t.in._zod.run(n,r);return s instanceof Promise?s.then(o=>Rc(o,t.out,r)):Rc(s,t.out,r)}});function Rc(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const _L=ee("$ZodReadonly",(e,t)=>{xt.init(e,t),lt(e._zod,"propValues",()=>t.innerType._zod.propValues),lt(e._zod,"values",()=>t.innerType._zod.values),lt(e._zod,"optin",()=>t.innerType?._zod?.optin),lt(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(jE):jE(s)}});function jE(e){return e.value=Object.freeze(e.value),e}const yL=ee("$ZodCustom",(e,t)=>{An.init(e,t),xt.init(e,t),e._zod.parse=(n,r)=>n,e._zod.check=n=>{const r=n.value,s=t.fn(r);if(s instanceof Promise)return s.then(o=>LE(o,n,r,e));LE(s,n,r,e)}});function LE(e,t,n,r){if(!e){const s={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(s.params=r._zod.def.params),t.issues.push(zl(s))}}var zE;class vL{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const r=n[0];return this._map.set(t,r),r&&typeof r=="object"&&"id"in r&&this._idmap.set(r.id,t),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const r={...this.get(n)??{}};delete r.id;const s={...r,...this._map.get(t)};return Object.keys(s).length?s:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function bL(){return new vL}(zE=globalThis).__zod_globalRegistry??(zE.__zod_globalRegistry=bL());const lr=globalThis.__zod_globalRegistry;function wL(e,t){return new e({type:"string",...Ce(t)})}function SL(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...Ce(t)})}function DE(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...Ce(t)})}function EL(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...Ce(t)})}function TL(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Ce(t)})}function xL(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Ce(t)})}function OL(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Ce(t)})}function AL(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...Ce(t)})}function CL(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...Ce(t)})}function RL(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...Ce(t)})}function NL(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...Ce(t)})}function IL(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...Ce(t)})}function kL(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...Ce(t)})}function $L(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...Ce(t)})}function ML(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...Ce(t)})}function jL(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...Ce(t)})}function LL(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...Ce(t)})}function zL(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Ce(t)})}function DL(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Ce(t)})}function UL(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...Ce(t)})}function PL(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...Ce(t)})}function BL(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...Ce(t)})}function ZL(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...Ce(t)})}function qL(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Ce(t)})}function FL(e,t){return new e({type:"string",format:"date",check:"string_format",...Ce(t)})}function HL(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...Ce(t)})}function GL(e,t){return new e({type:"string",format:"duration",check:"string_format",...Ce(t)})}function VL(e,t){return new e({type:"number",checks:[],...Ce(t)})}function JL(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...Ce(t)})}function XL(e){return new e({type:"unknown"})}function Mx(e,t){return new e({type:"never",...Ce(t)})}function UE(e,t){return new Ox({check:"less_than",...Ce(t),value:e,inclusive:!1})}function Ym(e,t){return new Ox({check:"less_than",...Ce(t),value:e,inclusive:!0})}function PE(e,t){return new Ax({check:"greater_than",...Ce(t),value:e,inclusive:!1})}function Qm(e,t){return new Ax({check:"greater_than",...Ce(t),value:e,inclusive:!0})}function BE(e,t){return new pj({check:"multiple_of",...Ce(t),value:e})}function jx(e,t){return new gj({check:"max_length",...Ce(t),maximum:e})}function _f(e,t){return new _j({check:"min_length",...Ce(t),minimum:e})}function Lx(e,t){return new yj({check:"length_equals",...Ce(t),length:e})}function YL(e,t){return new vj({check:"string_format",format:"regex",...Ce(t),pattern:e})}function QL(e){return new bj({check:"string_format",format:"lowercase",...Ce(e)})}function KL(e){return new wj({check:"string_format",format:"uppercase",...Ce(e)})}function WL(e,t){return new Sj({check:"string_format",format:"includes",...Ce(t),includes:e})}function ez(e,t){return new Ej({check:"string_format",format:"starts_with",...Ce(t),prefix:e})}function tz(e,t){return new Tj({check:"string_format",format:"ends_with",...Ce(t),suffix:e})}function uo(e){return new xj({check:"overwrite",tx:e})}function nz(e){return uo(t=>t.normalize(e))}function rz(){return uo(e=>e.trim())}function az(){return uo(e=>e.toLowerCase())}function sz(){return uo(e=>e.toUpperCase())}function iz(){return uo(e=>v4(e))}function oz(e,t,n){return new e({type:"array",element:t,...Ce(n)})}function lz(e,t,n){return new e({type:"custom",check:"custom",fn:t,...Ce(n)})}function uz(e){const t=cz(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(zl(r,n.value,t._zod.def));else{const s=r;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=t),s.continue??(s.continue=!t._zod.def.abort),n.issues.push(zl(s))}},e(n.value,n)));return t}function cz(e,t){const n=new An({check:"custom",...Ce(t)});return n._zod.check=e,n}function yf(e){let t=e?.target??"draft-2020-12";return t==="draft-4"&&(t="draft-04"),t==="draft-7"&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??lr,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function pt(e,t,n={path:[],schemaPath:[]}){var r;const s=e._zod.def,o=t.seen.get(e);if(o)return o.count++,n.schemaPath.includes(e)&&(o.cycle=n.path),o.schema;const u={schema:{},count:1,cycle:void 0,path:n.path};t.seen.set(e,u);const f=e._zod.toJSONSchema?.();if(f)u.schema=f;else{const m={...n,schemaPath:[...n.schemaPath,e],path:n.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,u.schema,m);else{const y=u.schema,v=t.processors[s.type];if(!v)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${s.type}`);v(e,t,y,m)}const _=e._zod.parent;_&&(u.ref||(u.ref=_),pt(_,t,m),t.seen.get(_).isParent=!0)}const d=t.metadataRegistry.get(e);return d&&Object.assign(u.schema,d),t.io==="input"&&cn(e)&&(delete u.schema.examples,delete u.schema.default),t.io==="input"&&u.schema._prefault&&((r=u.schema).default??(r.default=u.schema._prefault)),delete u.schema._prefault,t.seen.get(e).schema}function vf(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=new Map;for(const u of e.seen.entries()){const f=e.metadataRegistry.get(u[0])?.id;if(f){const d=r.get(f);if(d&&d!==u[0])throw new Error(`Duplicate schema id "${f}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);r.set(f,u[0])}}const s=u=>{const f=e.target==="draft-2020-12"?"$defs":"definitions";if(e.external){const _=e.external.registry.get(u[0])?.id,y=e.external.uri??(w=>w);if(_)return{ref:y(_)};const v=u[1].defId??u[1].schema.id??`schema${e.counter++}`;return u[1].defId=v,{defId:v,ref:`${y("__shared")}#/${f}/${v}`}}if(u[1]===n)return{ref:"#"};const h=`#/${f}/`,m=u[1].schema.id??`__schema${e.counter++}`;return{defId:m,ref:h+m}},o=u=>{if(u[1].schema.$ref)return;const f=u[1],{ref:d,defId:h}=s(u);f.def={...f.schema},h&&(f.defId=h);const m=f.schema;for(const _ in m)delete m[_];m.$ref=d};if(e.cycles==="throw")for(const u of e.seen.entries()){const f=u[1];if(f.cycle)throw new Error(`Cycle detected: #/${f.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const u of e.seen.entries()){const f=u[1];if(t===u[0]){o(u);continue}if(e.external){const h=e.external.registry.get(u[0])?.id;if(t!==u[0]&&h){o(u);continue}}if(e.metadataRegistry.get(u[0])?.id){o(u);continue}if(f.cycle){o(u);continue}if(f.count>1&&e.reused==="ref"){o(u);continue}}}function bf(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=u=>{const f=e.seen.get(u);if(f.ref===null)return;const d=f.def??f.schema,h={...d},m=f.ref;if(f.ref=null,m){r(m);const y=e.seen.get(m),v=y.schema;if(v.$ref&&(e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0")?(d.allOf=d.allOf??[],d.allOf.push(v)):Object.assign(d,v),Object.assign(d,h),u._zod.parent===m)for(const x in d)x==="$ref"||x==="allOf"||x in h||delete d[x];if(v.$ref&&y.def)for(const x in d)x==="$ref"||x==="allOf"||x in y.def&&JSON.stringify(d[x])===JSON.stringify(y.def[x])&&delete d[x]}const _=u._zod.parent;if(_&&_!==m){r(_);const y=e.seen.get(_);if(y?.schema.$ref&&(d.$ref=y.schema.$ref,y.def))for(const v in d)v==="$ref"||v==="allOf"||v in y.def&&JSON.stringify(d[v])===JSON.stringify(y.def[v])&&delete d[v]}e.override({zodSchema:u,jsonSchema:d,path:f.path??[]})};for(const u of[...e.seen.entries()].reverse())r(u[0]);const s={};if(e.target==="draft-2020-12"?s.$schema="https://json-schema.org/draft/2020-12/schema":e.target==="draft-07"?s.$schema="http://json-schema.org/draft-07/schema#":e.target==="draft-04"?s.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){const u=e.external.registry.get(t)?.id;if(!u)throw new Error("Schema is missing an `id` property");s.$id=e.external.uri(u)}Object.assign(s,n.def??n.schema);const o=e.external?.defs??{};for(const u of e.seen.entries()){const f=u[1];f.def&&f.defId&&(o[f.defId]=f.def)}e.external||Object.keys(o).length>0&&(e.target==="draft-2020-12"?s.$defs=o:s.definitions=o);try{const u=JSON.parse(JSON.stringify(s));return Object.defineProperty(u,"~standard",{value:{...t["~standard"],jsonSchema:{input:wf(t,"input",e.processors),output:wf(t,"output",e.processors)}},enumerable:!1,writable:!1}),u}catch{throw new Error("Error converting schema to JSON.")}}function cn(e,t){const n=t??{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);const r=e._zod.def;if(r.type==="transform")return!0;if(r.type==="array")return cn(r.element,n);if(r.type==="set")return cn(r.valueType,n);if(r.type==="lazy")return cn(r.getter(),n);if(r.type==="promise"||r.type==="optional"||r.type==="nonoptional"||r.type==="nullable"||r.type==="readonly"||r.type==="default"||r.type==="prefault")return cn(r.innerType,n);if(r.type==="intersection")return cn(r.left,n)||cn(r.right,n);if(r.type==="record"||r.type==="map")return cn(r.keyType,n)||cn(r.valueType,n);if(r.type==="pipe")return cn(r.in,n)||cn(r.out,n);if(r.type==="object"){for(const s in r.shape)if(cn(r.shape[s],n))return!0;return!1}if(r.type==="union"){for(const s of r.options)if(cn(s,n))return!0;return!1}if(r.type==="tuple"){for(const s of r.items)if(cn(s,n))return!0;return!!(r.rest&&cn(r.rest,n))}return!1}const fz=(e,t={})=>n=>{const r=yf({...n,processors:t});return pt(e,r),vf(r,e),bf(r,e)},wf=(e,t,n={})=>r=>{const{libraryOptions:s,target:o}=r??{},u=yf({...s??{},target:o,io:t,processors:n});return pt(e,u),vf(u,e),bf(u,e)},dz={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},zx=(e,t,n,r)=>{const s=n;s.type="string";const{minimum:o,maximum:u,format:f,patterns:d,contentEncoding:h}=e._zod.bag;if(typeof o=="number"&&(s.minLength=o),typeof u=="number"&&(s.maxLength=u),f&&(s.format=dz[f]??f,s.format===""&&delete s.format,f==="time"&&delete s.format),h&&(s.contentEncoding=h),d&&d.size>0){const m=[...d];m.length===1?s.pattern=m[0].source:m.length>1&&(s.allOf=[...m.map(_=>({...t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0"?{type:"string"}:{},pattern:_.source}))])}},Dx=(e,t,n,r)=>{const s=n,{minimum:o,maximum:u,format:f,multipleOf:d,exclusiveMaximum:h,exclusiveMinimum:m}=e._zod.bag;typeof f=="string"&&f.includes("int")?s.type="integer":s.type="number",typeof m=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.minimum=m,s.exclusiveMinimum=!0):s.exclusiveMinimum=m),typeof o=="number"&&(s.minimum=o,typeof m=="number"&&t.target!=="draft-04"&&(m>=o?delete s.minimum:delete s.exclusiveMinimum)),typeof h=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.maximum=h,s.exclusiveMaximum=!0):s.exclusiveMaximum=h),typeof u=="number"&&(s.maximum=u,typeof h=="number"&&t.target!=="draft-04"&&(h<=u?delete s.maximum:delete s.exclusiveMaximum)),typeof d=="number"&&(s.multipleOf=d)},hz=(e,t,n,r)=>{n.type="boolean"},pz=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema")},mz=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema")},gz=(e,t,n,r)=>{t.target==="openapi-3.0"?(n.type="string",n.nullable=!0,n.enum=[null]):n.type="null"},_z=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema")},yz=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema")},Ux=(e,t,n,r)=>{n.not={}},vz=(e,t,n,r)=>{},Px=(e,t,n,r)=>{},bz=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema")},Bx=(e,t,n,r)=>{const s=e._zod.def,o=mx(s.entries);o.every(u=>typeof u=="number")&&(n.type="number"),o.every(u=>typeof u=="string")&&(n.type="string"),n.enum=o},Zx=(e,t,n,r)=>{const s=e._zod.def,o=[];for(const u of s.values)if(u===void 0){if(t.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof u=="bigint"){if(t.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");o.push(Number(u))}else o.push(u);if(o.length!==0)if(o.length===1){const u=o[0];n.type=u===null?"null":typeof u,t.target==="draft-04"||t.target==="openapi-3.0"?n.enum=[u]:n.const=u}else o.every(u=>typeof u=="number")&&(n.type="number"),o.every(u=>typeof u=="string")&&(n.type="string"),o.every(u=>typeof u=="boolean")&&(n.type="boolean"),o.every(u=>u===null)&&(n.type="null"),n.enum=o},wz=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema")},Sz=(e,t,n,r)=>{const s=n,o=e._zod.pattern;if(!o)throw new Error("Pattern not found in template literal");s.type="string",s.pattern=o.source},Ez=(e,t,n,r)=>{const s=n,o={type:"string",format:"binary",contentEncoding:"binary"},{minimum:u,maximum:f,mime:d}=e._zod.bag;u!==void 0&&(o.minLength=u),f!==void 0&&(o.maxLength=f),d?d.length===1?(o.contentMediaType=d[0],Object.assign(s,o)):(Object.assign(s,o),s.anyOf=d.map(h=>({contentMediaType:h}))):Object.assign(s,o)},Tz=(e,t,n,r)=>{n.type="boolean"},qx=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},xz=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema")},Fx=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},Oz=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema")},Az=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema")},Hx=(e,t,n,r)=>{const s=n,o=e._zod.def,{minimum:u,maximum:f}=e._zod.bag;typeof u=="number"&&(s.minItems=u),typeof f=="number"&&(s.maxItems=f),s.type="array",s.items=pt(o.element,t,{...r,path:[...r.path,"items"]})},Gx=(e,t,n,r)=>{const s=n,o=e._zod.def;s.type="object",s.properties={};const u=o.shape;for(const h in u)s.properties[h]=pt(u[h],t,{...r,path:[...r.path,"properties",h]});const f=new Set(Object.keys(u)),d=new Set([...f].filter(h=>{const m=o.shape[h]._zod;return t.io==="input"?m.optin===void 0:m.optout===void 0}));d.size>0&&(s.required=Array.from(d)),o.catchall?._zod.def.type==="never"?s.additionalProperties=!1:o.catchall?o.catchall&&(s.additionalProperties=pt(o.catchall,t,{...r,path:[...r.path,"additionalProperties"]})):t.io==="output"&&(s.additionalProperties=!1)},Vx=(e,t,n,r)=>{const s=e._zod.def,o=s.inclusive===!1,u=s.options.map((f,d)=>pt(f,t,{...r,path:[...r.path,o?"oneOf":"anyOf",d]}));o?n.oneOf=u:n.anyOf=u},Jx=(e,t,n,r)=>{const s=e._zod.def,o=pt(s.left,t,{...r,path:[...r.path,"allOf",0]}),u=pt(s.right,t,{...r,path:[...r.path,"allOf",1]}),f=h=>"allOf"in h&&Object.keys(h).length===1,d=[...f(o)?o.allOf:[o],...f(u)?u.allOf:[u]];n.allOf=d},Cz=(e,t,n,r)=>{const s=n,o=e._zod.def;s.type="array";const u=t.target==="draft-2020-12"?"prefixItems":"items",f=t.target==="draft-2020-12"||t.target==="openapi-3.0"?"items":"additionalItems",d=o.items.map((y,v)=>pt(y,t,{...r,path:[...r.path,u,v]})),h=o.rest?pt(o.rest,t,{...r,path:[...r.path,f,...t.target==="openapi-3.0"?[o.items.length]:[]]}):null;t.target==="draft-2020-12"?(s.prefixItems=d,h&&(s.items=h)):t.target==="openapi-3.0"?(s.items={anyOf:d},h&&s.items.anyOf.push(h),s.minItems=d.length,h||(s.maxItems=d.length)):(s.items=d,h&&(s.additionalItems=h));const{minimum:m,maximum:_}=e._zod.bag;typeof m=="number"&&(s.minItems=m),typeof _=="number"&&(s.maxItems=_)},Xx=(e,t,n,r)=>{const s=n,o=e._zod.def;s.type="object";const u=o.keyType,d=u._zod.bag?.patterns;if(o.mode==="loose"&&d&&d.size>0){const m=pt(o.valueType,t,{...r,path:[...r.path,"patternProperties","*"]});s.patternProperties={};for(const _ of d)s.patternProperties[_.source]=m}else(t.target==="draft-07"||t.target==="draft-2020-12")&&(s.propertyNames=pt(o.keyType,t,{...r,path:[...r.path,"propertyNames"]})),s.additionalProperties=pt(o.valueType,t,{...r,path:[...r.path,"additionalProperties"]});const h=u._zod.values;if(h){const m=[...h].filter(_=>typeof _=="string"||typeof _=="number");m.length>0&&(s.required=m)}},Yx=(e,t,n,r)=>{const s=e._zod.def,o=pt(s.innerType,t,r),u=t.seen.get(e);t.target==="openapi-3.0"?(u.ref=s.innerType,n.nullable=!0):n.anyOf=[o,{type:"null"}]},Qx=(e,t,n,r)=>{const s=e._zod.def;pt(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType},Kx=(e,t,n,r)=>{const s=e._zod.def;pt(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType,n.default=JSON.parse(JSON.stringify(s.defaultValue))},Wx=(e,t,n,r)=>{const s=e._zod.def;pt(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType,t.io==="input"&&(n._prefault=JSON.parse(JSON.stringify(s.defaultValue)))},eO=(e,t,n,r)=>{const s=e._zod.def;pt(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType;let u;try{u=s.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=u},tO=(e,t,n,r)=>{const s=e._zod.def,o=t.io==="input"?s.in._zod.def.type==="transform"?s.out:s.in:s.out;pt(o,t,r);const u=t.seen.get(e);u.ref=o},nO=(e,t,n,r)=>{const s=e._zod.def;pt(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType,n.readOnly=!0},Rz=(e,t,n,r)=>{const s=e._zod.def;pt(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType},L_=(e,t,n,r)=>{const s=e._zod.def;pt(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType},Nz=(e,t,n,r)=>{const s=e._zod.innerType;pt(s,t,r);const o=t.seen.get(e);o.ref=s},ZE={string:zx,number:Dx,boolean:hz,bigint:pz,symbol:mz,null:gz,undefined:_z,void:yz,never:Ux,any:vz,unknown:Px,date:bz,enum:Bx,literal:Zx,nan:wz,template_literal:Sz,file:Ez,success:Tz,custom:qx,function:xz,transform:Fx,map:Oz,set:Az,array:Hx,object:Gx,union:Vx,intersection:Jx,tuple:Cz,record:Xx,nullable:Yx,nonoptional:Qx,default:Kx,prefault:Wx,catch:eO,pipe:tO,readonly:nO,promise:Rz,optional:L_,lazy:Nz};function Ng(e,t){if("_idmap"in e){const r=e,s=yf({...t,processors:ZE}),o={};for(const d of r._idmap.entries()){const[h,m]=d;pt(m,s)}const u={},f={registry:r,uri:t?.uri,defs:o};s.external=f;for(const d of r._idmap.entries()){const[h,m]=d;vf(s,m),u[h]=bf(s,m)}if(Object.keys(o).length>0){const d=s.target==="draft-2020-12"?"$defs":"definitions";u.__shared={[d]:o}}return{schemas:u}}const n=yf({...t,processors:ZE});return pt(e,n),vf(n,e),bf(n,e)}function Xn(e){if(typeof e!="object"||e===null)return!1;const t=e;if(!("_zod"in t))return!1;const n=t._zod;return typeof n=="object"&&n!==null&&"def"in n}function Br(e){if(typeof e!="object"||e===null)return!1;const t=e;if(!("_def"in t)||"_zod"in t)return!1;const n=t._def;return typeof n=="object"&&n!=null&&"typeName"in n}function Ls(e){return!e||typeof e!="object"||Array.isArray(e)?!1:!!(Xn(e)||Br(e))}async function Iz(e,t){if(Xn(e))try{return{success:!0,data:await bx(e,t)}}catch(n){return{success:!1,error:n}}if(Br(e))return await e.safeParseAsync(t);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}async function rO(e,t){if(Xn(e))return await bx(e,t);if(Br(e))return await e.parseAsync(t);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function z_(e){if(Xn(e))return lr.get(e)?.description;if(Br(e)||"description"in e&&typeof e.description=="string")return e.description}function kz(e){return Ls(e)?Br(e)?e._def.typeName==="ZodString":Xn(e)?e._zod.def.type==="string":!1:!1}function Ol(e){return Xn(e)?typeof e=="object"&&e!==null&&"_zod"in e&&typeof e._zod=="object"&&e._zod!==null&&"def"in e._zod&&typeof e._zod.def=="object"&&e._zod.def!==null&&"type"in e._zod.def&&e._zod.def.type==="object":!1}function aO(e){return Xn(e)?typeof e=="object"&&e!==null&&"_zod"in e&&typeof e._zod=="object"&&e._zod!==null&&"def"in e._zod&&typeof e._zod.def=="object"&&e._zod.def!==null&&"type"in e._zod.def&&e._zod.def.type==="array":!1}function $z(e){return Xn(e)?typeof e=="object"&&e!==null&&"_zod"in e&&typeof e._zod=="object"&&e._zod!==null&&"def"in e._zod&&typeof e._zod.def=="object"&&e._zod.def!==null&&"type"in e._zod.def&&e._zod.def.type==="optional":!1}function Mz(e){return Xn(e)?typeof e=="object"&&e!==null&&"_zod"in e&&typeof e._zod=="object"&&e._zod!==null&&"def"in e._zod&&typeof e._zod.def=="object"&&e._zod.def!==null&&"type"in e._zod.def&&e._zod.def.type==="nullable":!1}function Ig(e,t=!1){if(Br(e))return e.strict();if(Ol(e)){const n=e._zod.def.shape;if(t)for(const[o,u]of Object.entries(e._zod.def.shape)){if(Ol(u))n[o]=Ig(u,t);else if(aO(u)){let d=u._zod.def.element;Ol(d)&&(d=Ig(d,t)),n[o]=On(u,{...u._zod.def,element:d})}else n[o]=u;const f=lr.get(u);f&&lr.add(n[o],f)}const r=On(e,{...e._zod.def,shape:n,catchall:Mx(Nx)}),s=lr.get(e);return s&&lr.add(r,s),r}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function jz(e){return Br(e)&&"typeName"in e._def&&e._def.typeName==="ZodEffects"}function Lz(e){return Xn(e)&&e._zod.def.type==="pipe"}function Ns(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(Br(e))return jz(e)?Ns(e._def.schema,t,n):e;if(Xn(e)){let s=e;if(Lz(e)&&(s=Ns(e._zod.def.in,t,n)),t){if(Ol(s)){const u={};for(const[f,d]of Object.entries(s._zod.def.shape))u[f]=Ns(d,t,n);s=On(s,{...s._zod.def,shape:u})}else if(aO(s)){const u=Ns(s._zod.def.element,t,n);s=On(s,{...s._zod.def,element:u})}else if($z(s)){const u=Ns(s._zod.def.innerType,t,n);s=On(s,{...s._zod.def,innerType:u})}else if(Mz(s)){const u=Ns(s._zod.def.innerType,t,n);s=On(s,{...s._zod.def,innerType:u})}}const o=lr.get(e);return o&&lr.add(s,o),n.set(e,s),s}throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function zz(e,t=!1){return Ns(e,t,new WeakMap)}function Km(e){return e.replace(/[^a-zA-Z-_0-9]/g,"_")}const Dz=["*","_","`"];function Uz(e){let t="";for(const[n,r]of Object.entries(e))t+=`	classDef ${n} ${r};
`;return t}function Pz(e,t,n){const{firstNode:r,lastNode:s,nodeColors:o,withStyles:u=!0,curveStyle:f="linear",wrapLabelNWords:d=9}=n??{};let h=u?`%%{init: {'flowchart': {'curve': '${f}'}}}%%
graph TD;
`:`graph TD;
`;if(u){const w="default",x={[w]:"{0}({1})"};r!==void 0&&(x[r]="{0}([{1}]):::first"),s!==void 0&&(x[s]="{0}([{1}]):::last");for(const[R,E]of Object.entries(e)){const A=E.name.split(":").pop()??"";let N=Dz.some(B=>A.startsWith(B)&&A.endsWith(B))?`<p>${A}</p>`:A;Object.keys(E.metadata??{}).length&&(N+=`<hr/><small><em>${Object.entries(E.metadata??{}).map(([B,Y])=>`${B} = ${Y}`).join(`
`)}</em></small>`);const M=(x[R]??x[w]).replace("{0}",Km(R)).replace("{1}",N);h+=`	${M}
`}}const m={};for(const w of t){const x=w.source.split(":"),R=w.target.split(":"),E=x.filter((A,N)=>A===R[N]).join(":");m[E]||(m[E]=[]),m[E].push(w)}const _=new Set;function y(w){return[...w].sort((x,R)=>x.split(":").length-R.split(":").length)}function v(w,x){const R=w.length===1&&w[0].source===w[0].target;if(x&&!R){const A=x.split(":").pop();if(_.has(x))throw new Error(`Found duplicate subgraph '${A}' at '${x} -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);_.add(x),h+=`	subgraph ${A}
`}const E=y(Object.keys(m).filter(A=>A.startsWith(`${x}:`)&&A!==x&&A.split(":").length===x.split(":").length+1));for(const A of E)v(m[A],A);for(const A of w){const{source:N,target:M,data:B,conditional:Y}=A;let W="";if(B!==void 0){let C=B;const Te=C.split(" ");Te.length>d&&(C=Array.from({length:Math.ceil(Te.length/d)},(xe,me)=>Te.slice(me*d,(me+1)*d).join(" ")).join("&nbsp;<br>&nbsp;")),W=Y?` -. &nbsp;${C}&nbsp; .-> `:` -- &nbsp;${C}&nbsp; --> `}else W=Y?" -.-> ":" --> ";h+=`	${Km(N)}${W}${Km(M)};
`}x&&!R&&(h+=`	end
`)}v(m[""]??[],"");for(const w in m)!w.includes(":")&&w!==""&&v(m[w],w);return u&&(h+=Uz(o??{})),h}async function Bz(e,t){let n=t?.backgroundColor??"white";const r=t?.imageType??"png",s=_4(e);n!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(n)||(n=`!${n}`));const o=`https://mermaid.ink/img/${s}?bgColor=${n}&type=${r}`,u=await fetch(o);if(!u.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${u.status}`,`Status text: ${u.statusText}`].join(`
`));return await u.blob()}const Zz=Symbol("Let zodToJsonSchema decide on which parser to use"),qz={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Fz=e=>({...qz,...e}),Hz=e=>{const t=Fz(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}},sO=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")};function Vn(e){if(e.target!=="openAi")return{};const t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:e.$refStrategy==="relative"?sO(t,e.currentPath):t.join("/")}}function iO(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function it(e,t,n,r,s){e[t]=n,iO(e,t,r,s)}var Ke;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const o={};for(const u of s)o[u]=u;return o},e.getValidEnumValues=s=>{const o=e.objectKeys(s).filter(f=>typeof s[s[f]]!="number"),u={};for(const f of o)u[f]=s[f];return e.objectValues(u)},e.objectValues=s=>e.objectKeys(s).map(function(o){return s[o]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const o=[];for(const u in s)Object.prototype.hasOwnProperty.call(s,u)&&o.push(u);return o},e.find=(s,o)=>{for(const u of s)if(o(u))return u},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,o=" | "){return s.map(u=>typeof u=="string"?`'${u}'`:u).join(o)}e.joinValues=r,e.jsonStringifyReplacer=(s,o)=>typeof o=="bigint"?o.toString():o})(Ke||(Ke={}));var qE;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(qE||(qE={}));const ve=Ke.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ya=e=>{switch(typeof e){case"undefined":return ve.undefined;case"string":return ve.string;case"number":return Number.isNaN(e)?ve.nan:ve.number;case"boolean":return ve.boolean;case"function":return ve.function;case"bigint":return ve.bigint;case"symbol":return ve.symbol;case"object":return Array.isArray(e)?ve.array:e===null?ve.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ve.promise:typeof Map<"u"&&e instanceof Map?ve.map:typeof Set<"u"&&e instanceof Set?ve.set:typeof Date<"u"&&e instanceof Date?ve.date:ve.object;default:return ve.unknown}},ce=Ke.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class _a extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(o){return o.message},r={_errors:[]},s=o=>{for(const u of o.issues)if(u.code==="invalid_union")u.unionErrors.map(s);else if(u.code==="invalid_return_type")s(u.returnTypeError);else if(u.code==="invalid_arguments")s(u.argumentsError);else if(u.path.length===0)r._errors.push(n(u));else{let f=r,d=0;for(;d<u.path.length;){const h=u.path[d];d===u.path.length-1?(f[h]=f[h]||{_errors:[]},f[h]._errors.push(n(u))):f[h]=f[h]||{_errors:[]},f=f[h],d++}}};return s(this),r}static assert(t){if(!(t instanceof _a))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ke.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n=Object.create(null),r=[];for(const s of this.issues)if(s.path.length>0){const o=s.path[0];n[o]=n[o]||[],n[o].push(t(s))}else r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}_a.create=e=>new _a(e);const kg=(e,t)=>{let n;switch(e.code){case ce.invalid_type:e.received===ve.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case ce.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Ke.jsonStringifyReplacer)}`;break;case ce.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ke.joinValues(e.keys,", ")}`;break;case ce.invalid_union:n="Invalid input";break;case ce.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ke.joinValues(e.options)}`;break;case ce.invalid_enum_value:n=`Invalid enum value. Expected ${Ke.joinValues(e.options)}, received '${e.received}'`;break;case ce.invalid_arguments:n="Invalid function arguments";break;case ce.invalid_return_type:n="Invalid function return type";break;case ce.invalid_date:n="Invalid date";break;case ce.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Ke.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case ce.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case ce.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case ce.custom:n="Invalid input";break;case ce.invalid_intersection_types:n="Intersection results could not be merged";break;case ce.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case ce.not_finite:n="Number must be finite";break;default:n=t.defaultError,Ke.assertNever(e)}return{message:n}};let Gz=kg;function Vz(){return Gz}const Jz=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,o=[...n,...s.path||[]],u={...s,path:o};if(s.message!==void 0)return{...s,path:o,message:s.message};let f="";const d=r.filter(h=>!!h).slice().reverse();for(const h of d)f=h(u,{data:t,defaultError:f}).message;return{...s,path:o,message:f}};function de(e,t){const n=Vz(),r=Jz({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===kg?void 0:kg].filter(s=>!!s)});e.common.issues.push(r)}class Jn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return je;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const o=await s.key,u=await s.value;r.push({key:o,value:u})}return Jn.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:o,value:u}=s;if(o.status==="aborted"||u.status==="aborted")return je;o.status==="dirty"&&t.dirty(),u.status==="dirty"&&t.dirty(),o.value!=="__proto__"&&(typeof u.value<"u"||s.alwaysSet)&&(r[o.value]=u.value)}return{status:t.value,value:r}}}const je=Object.freeze({status:"aborted"}),dl=e=>({status:"dirty",value:e}),ur=e=>({status:"valid",value:e}),FE=e=>e.status==="aborted",HE=e=>e.status==="dirty",no=e=>e.status==="valid",Sf=e=>typeof Promise<"u"&&e instanceof Promise;var Ee;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(Ee||(Ee={}));class os{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const GE=(e,t)=>{if(no(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new _a(e.common.issues);return this._error=n,this._error}}};function Ze(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(u,f)=>{const{message:d}=e;return u.code==="invalid_enum_value"?{message:d??f.defaultError}:typeof f.data>"u"?{message:d??r??f.defaultError}:u.code!=="invalid_type"?{message:f.defaultError}:{message:d??n??f.defaultError}},description:s}}let Xe=class{get description(){return this._def.description}_getType(t){return Ya(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Ya(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Jn,ctx:{common:t.parent.common,data:t.data,parsedType:Ya(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Sf(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ya(t)},s=this._parseSync({data:t,path:r.path,parent:r});return GE(r,s)}"~validate"(t){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ya(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:n});return no(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>no(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ya(t)},s=this._parse({data:t,path:r.path,parent:r}),o=await(Sf(s)?s:Promise.resolve(s));return GE(r,o)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,o)=>{const u=t(s),f=()=>o.addIssue({code:ce.custom,...r(s)});return typeof Promise<"u"&&u instanceof Promise?u.then(d=>d?!0:(f(),!1)):u?!0:(f(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new ao({schema:this,typeName:X.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Wa.create(this,this._def)}nullable(){return so.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ro.create(this)}promise(){return Of.create(this,this._def)}or(t){return Tf.create([this,t],this._def)}and(t){return xf.create(this,t,this._def)}transform(t){return new ao({...Ze(this._def),schema:this,typeName:X.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Dg({...Ze(this._def),innerType:this,defaultValue:n,typeName:X.ZodDefault})}brand(){return new _3({typeName:X.ZodBranded,type:this,...Ze(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Ug({...Ze(this._def),innerType:this,catchValue:n,typeName:X.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return U_.create(this,t)}readonly(){return Pg.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};const Xz=/^c[^\s-]{8,}$/i,Yz=/^[0-9a-z]+$/,Qz=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Kz=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Wz=/^[a-z0-9_-]{21}$/i,e3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,t3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,n3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,r3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Wm;const a3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,s3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,i3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,l3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,u3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,oO="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",c3=new RegExp(`^${oO}$`);function lO(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function f3(e){return new RegExp(`^${lO(e)}$`)}function d3(e){let t=`${oO}T${lO(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function h3(e,t){return!!((t==="v4"||!t)&&a3.test(e)||(t==="v6"||!t)&&i3.test(e))}function p3(e,t){if(!e3.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function m3(e,t){return!!((t==="v4"||!t)&&s3.test(e)||(t==="v6"||!t)&&o3.test(e))}let $g=class hl extends Xe{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ve.string){const o=this._getOrReturnCtx(t);return de(o,{code:ce.invalid_type,expected:ve.string,received:o.parsedType}),je}const r=new Jn;let s;for(const o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ce.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="max")t.data.length>o.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ce.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="length"){const u=t.data.length>o.value,f=t.data.length<o.value;(u||f)&&(s=this._getOrReturnCtx(t,s),u?de(s,{code:ce.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):f&&de(s,{code:ce.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if(o.kind==="email")n3.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"email",code:ce.invalid_string,message:o.message}),r.dirty());else if(o.kind==="emoji")Wm||(Wm=new RegExp(r3,"u")),Wm.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"emoji",code:ce.invalid_string,message:o.message}),r.dirty());else if(o.kind==="uuid")Kz.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"uuid",code:ce.invalid_string,message:o.message}),r.dirty());else if(o.kind==="nanoid")Wz.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"nanoid",code:ce.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid")Xz.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"cuid",code:ce.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid2")Yz.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"cuid2",code:ce.invalid_string,message:o.message}),r.dirty());else if(o.kind==="ulid")Qz.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"ulid",code:ce.invalid_string,message:o.message}),r.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),de(s,{validation:"url",code:ce.invalid_string,message:o.message}),r.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"regex",code:ce.invalid_string,message:o.message}),r.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(t,s),de(s,{code:ce.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(s=this._getOrReturnCtx(t,s),de(s,{code:ce.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(s=this._getOrReturnCtx(t,s),de(s,{code:ce.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):o.kind==="datetime"?d3(o).test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{code:ce.invalid_string,validation:"datetime",message:o.message}),r.dirty()):o.kind==="date"?c3.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{code:ce.invalid_string,validation:"date",message:o.message}),r.dirty()):o.kind==="time"?f3(o).test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{code:ce.invalid_string,validation:"time",message:o.message}),r.dirty()):o.kind==="duration"?t3.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"duration",code:ce.invalid_string,message:o.message}),r.dirty()):o.kind==="ip"?h3(t.data,o.version)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"ip",code:ce.invalid_string,message:o.message}),r.dirty()):o.kind==="jwt"?p3(t.data,o.alg)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"jwt",code:ce.invalid_string,message:o.message}),r.dirty()):o.kind==="cidr"?m3(t.data,o.version)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"cidr",code:ce.invalid_string,message:o.message}),r.dirty()):o.kind==="base64"?l3.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"base64",code:ce.invalid_string,message:o.message}),r.dirty()):o.kind==="base64url"?u3.test(t.data)||(s=this._getOrReturnCtx(t,s),de(s,{validation:"base64url",code:ce.invalid_string,message:o.message}),r.dirty()):Ke.assertNever(o);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:ce.invalid_string,...Ee.errToObj(r)})}_addCheck(t){return new hl({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ee.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ee.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ee.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ee.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ee.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ee.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ee.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ee.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ee.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ee.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ee.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ee.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ee.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...Ee.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...Ee.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...Ee.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Ee.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n?.position,...Ee.errToObj(n?.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Ee.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Ee.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Ee.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Ee.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Ee.errToObj(n)})}nonempty(t){return this.min(1,Ee.errToObj(t))}trim(){return new hl({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new hl({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new hl({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}};$g.create=e=>new $g({checks:[],typeName:X.ZodString,coerce:e?.coerce??!1,...Ze(e)});function g3(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,o=Number.parseInt(e.toFixed(s).replace(".","")),u=Number.parseInt(t.toFixed(s).replace(".",""));return o%u/10**s}let VE=class Mg extends Xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ve.number){const o=this._getOrReturnCtx(t);return de(o,{code:ce.invalid_type,expected:ve.number,received:o.parsedType}),je}let r;const s=new Jn;for(const o of this._def.checks)o.kind==="int"?Ke.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),de(r,{code:ce.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),de(r,{code:ce.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),de(r,{code:ce.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?g3(t.data,o.value)!==0&&(r=this._getOrReturnCtx(t,r),de(r,{code:ce.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),de(r,{code:ce.not_finite,message:o.message}),s.dirty()):Ke.assertNever(o);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Ee.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ee.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ee.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ee.toString(n))}setLimit(t,n,r,s){return new Mg({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ee.toString(s)}]})}_addCheck(t){return new Mg({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ee.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ee.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ee.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ee.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ee.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ee.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Ee.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ee.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ee.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ke.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}};VE.create=e=>new VE({checks:[],typeName:X.ZodNumber,coerce:e?.coerce||!1,...Ze(e)});class Dl extends Xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ve.bigint)return this._getInvalidInput(t);let r;const s=new Jn;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),de(r,{code:ce.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),de(r,{code:ce.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),de(r,{code:ce.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):Ke.assertNever(o);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return de(n,{code:ce.invalid_type,expected:ve.bigint,received:n.parsedType}),je}gte(t,n){return this.setLimit("min",t,!0,Ee.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ee.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ee.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ee.toString(n))}setLimit(t,n,r,s){return new Dl({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ee.toString(s)}]})}_addCheck(t){return new Dl({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ee.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ee.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ee.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ee.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ee.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Dl.create=e=>new Dl({checks:[],typeName:X.ZodBigInt,coerce:e?.coerce??!1,...Ze(e)});class JE extends Xe{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ve.boolean){const r=this._getOrReturnCtx(t);return de(r,{code:ce.invalid_type,expected:ve.boolean,received:r.parsedType}),je}return ur(t.data)}}JE.create=e=>new JE({typeName:X.ZodBoolean,coerce:e?.coerce||!1,...Ze(e)});class Ef extends Xe{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ve.date){const o=this._getOrReturnCtx(t);return de(o,{code:ce.invalid_type,expected:ve.date,received:o.parsedType}),je}if(Number.isNaN(t.data.getTime())){const o=this._getOrReturnCtx(t);return de(o,{code:ce.invalid_date}),je}const r=new Jn;let s;for(const o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ce.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),r.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(s=this._getOrReturnCtx(t,s),de(s,{code:ce.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),r.dirty()):Ke.assertNever(o);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Ef({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Ee.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Ee.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Ef.create=e=>new Ef({checks:[],coerce:e?.coerce||!1,typeName:X.ZodDate,...Ze(e)});class XE extends Xe{_parse(t){if(this._getType(t)!==ve.symbol){const r=this._getOrReturnCtx(t);return de(r,{code:ce.invalid_type,expected:ve.symbol,received:r.parsedType}),je}return ur(t.data)}}XE.create=e=>new XE({typeName:X.ZodSymbol,...Ze(e)});class YE extends Xe{_parse(t){if(this._getType(t)!==ve.undefined){const r=this._getOrReturnCtx(t);return de(r,{code:ce.invalid_type,expected:ve.undefined,received:r.parsedType}),je}return ur(t.data)}}YE.create=e=>new YE({typeName:X.ZodUndefined,...Ze(e)});class QE extends Xe{_parse(t){if(this._getType(t)!==ve.null){const r=this._getOrReturnCtx(t);return de(r,{code:ce.invalid_type,expected:ve.null,received:r.parsedType}),je}return ur(t.data)}}QE.create=e=>new QE({typeName:X.ZodNull,...Ze(e)});class jg extends Xe{constructor(){super(...arguments),this._any=!0}_parse(t){return ur(t.data)}}jg.create=e=>new jg({typeName:X.ZodAny,...Ze(e)});let KE=class extends Xe{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ur(t.data)}};KE.create=e=>new KE({typeName:X.ZodUnknown,...Ze(e)});let ls=class extends Xe{_parse(t){const n=this._getOrReturnCtx(t);return de(n,{code:ce.invalid_type,expected:ve.never,received:n.parsedType}),je}};ls.create=e=>new ls({typeName:X.ZodNever,...Ze(e)});class WE extends Xe{_parse(t){if(this._getType(t)!==ve.undefined){const r=this._getOrReturnCtx(t);return de(r,{code:ce.invalid_type,expected:ve.void,received:r.parsedType}),je}return ur(t.data)}}WE.create=e=>new WE({typeName:X.ZodVoid,...Ze(e)});let ro=class Vc extends Xe{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==ve.array)return de(n,{code:ce.invalid_type,expected:ve.array,received:n.parsedType}),je;if(s.exactLength!==null){const u=n.data.length>s.exactLength.value,f=n.data.length<s.exactLength.value;(u||f)&&(de(n,{code:u?ce.too_big:ce.too_small,minimum:f?s.exactLength.value:void 0,maximum:u?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(de(n,{code:ce.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(de(n,{code:ce.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((u,f)=>s.type._parseAsync(new os(n,u,n.path,f)))).then(u=>Jn.mergeArray(r,u));const o=[...n.data].map((u,f)=>s.type._parseSync(new os(n,u,n.path,f)));return Jn.mergeArray(r,o)}get element(){return this._def.type}min(t,n){return new Vc({...this._def,minLength:{value:t,message:Ee.toString(n)}})}max(t,n){return new Vc({...this._def,maxLength:{value:t,message:Ee.toString(n)}})}length(t,n){return new Vc({...this._def,exactLength:{value:t,message:Ee.toString(n)}})}nonempty(t){return this.min(1,t)}};ro.create=(e,t)=>new ro({type:e,minLength:null,maxLength:null,exactLength:null,typeName:X.ZodArray,...Ze(t)});function Ui(e){if(e instanceof ya){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Wa.create(Ui(r))}return new ya({...e._def,shape:()=>t})}else return e instanceof ro?new ro({...e._def,type:Ui(e.element)}):e instanceof Wa?Wa.create(Ui(e.unwrap())):e instanceof so?so.create(Ui(e.unwrap())):e instanceof qs?qs.create(e.items.map(t=>Ui(t))):e}let ya=class wr extends Xe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Ke.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==ve.object){const h=this._getOrReturnCtx(t);return de(h,{code:ce.invalid_type,expected:ve.object,received:h.parsedType}),je}const{status:r,ctx:s}=this._processInputParams(t),{shape:o,keys:u}=this._getCached(),f=[];if(!(this._def.catchall instanceof ls&&this._def.unknownKeys==="strip"))for(const h in s.data)u.includes(h)||f.push(h);const d=[];for(const h of u){const m=o[h],_=s.data[h];d.push({key:{status:"valid",value:h},value:m._parse(new os(s,_,s.path,h)),alwaysSet:h in s.data})}if(this._def.catchall instanceof ls){const h=this._def.unknownKeys;if(h==="passthrough")for(const m of f)d.push({key:{status:"valid",value:m},value:{status:"valid",value:s.data[m]}});else if(h==="strict")f.length>0&&(de(s,{code:ce.unrecognized_keys,keys:f}),r.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const m of f){const _=s.data[m];d.push({key:{status:"valid",value:m},value:h._parse(new os(s,_,s.path,m)),alwaysSet:m in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const h=[];for(const m of d){const _=await m.key,y=await m.value;h.push({key:_,value:y,alwaysSet:m.alwaysSet})}return h}).then(h=>Jn.mergeObjectSync(r,h)):Jn.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(t){return Ee.errToObj,new wr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:Ee.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new wr({...this._def,unknownKeys:"strip"})}passthrough(){return new wr({...this._def,unknownKeys:"passthrough"})}extend(t){return new wr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new wr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:X.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new wr({...this._def,catchall:t})}pick(t){const n={};for(const r of Ke.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new wr({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Ke.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new wr({...this._def,shape:()=>n})}deepPartial(){return Ui(this)}partial(t){const n={};for(const r of Ke.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new wr({...this._def,shape:()=>n})}required(t){const n={};for(const r of Ke.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof Wa;)o=o._def.innerType;n[r]=o}return new wr({...this._def,shape:()=>n})}keyof(){return uO(Ke.objectKeys(this.shape))}};ya.create=(e,t)=>new ya({shape:()=>e,unknownKeys:"strip",catchall:ls.create(),typeName:X.ZodObject,...Ze(t)});ya.strictCreate=(e,t)=>new ya({shape:()=>e,unknownKeys:"strict",catchall:ls.create(),typeName:X.ZodObject,...Ze(t)});ya.lazycreate=(e,t)=>new ya({shape:e,unknownKeys:"strip",catchall:ls.create(),typeName:X.ZodObject,...Ze(t)});let Tf=class extends Xe{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(o){for(const f of o)if(f.result.status==="valid")return f.result;for(const f of o)if(f.result.status==="dirty")return n.common.issues.push(...f.ctx.common.issues),f.result;const u=o.map(f=>new _a(f.ctx.common.issues));return de(n,{code:ce.invalid_union,unionErrors:u}),je}if(n.common.async)return Promise.all(r.map(async o=>{const u={...n,common:{...n.common,issues:[]},parent:null};return{result:await o._parseAsync({data:n.data,path:n.path,parent:u}),ctx:u}})).then(s);{let o;const u=[];for(const d of r){const h={...n,common:{...n.common,issues:[]},parent:null},m=d._parseSync({data:n.data,path:n.path,parent:h});if(m.status==="valid")return m;m.status==="dirty"&&!o&&(o={result:m,ctx:h}),h.common.issues.length&&u.push(h.common.issues)}if(o)return n.common.issues.push(...o.ctx.common.issues),o.result;const f=u.map(d=>new _a(d));return de(n,{code:ce.invalid_union,unionErrors:f}),je}}get options(){return this._def.options}};Tf.create=(e,t)=>new Tf({options:e,typeName:X.ZodUnion,...Ze(t)});function Lg(e,t){const n=Ya(e),r=Ya(t);if(e===t)return{valid:!0,data:e};if(n===ve.object&&r===ve.object){const s=Ke.objectKeys(t),o=Ke.objectKeys(e).filter(f=>s.indexOf(f)!==-1),u={...e,...t};for(const f of o){const d=Lg(e[f],t[f]);if(!d.valid)return{valid:!1};u[f]=d.data}return{valid:!0,data:u}}else if(n===ve.array&&r===ve.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let o=0;o<e.length;o++){const u=e[o],f=t[o],d=Lg(u,f);if(!d.valid)return{valid:!1};s.push(d.data)}return{valid:!0,data:s}}else return n===ve.date&&r===ve.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}let xf=class extends Xe{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(o,u)=>{if(FE(o)||FE(u))return je;const f=Lg(o.value,u.value);return f.valid?((HE(o)||HE(u))&&n.dirty(),{status:n.value,value:f.data}):(de(r,{code:ce.invalid_intersection_types}),je)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,u])=>s(o,u)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};xf.create=(e,t,n)=>new xf({left:e,right:t,typeName:X.ZodIntersection,...Ze(n)});class qs extends Xe{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ve.array)return de(r,{code:ce.invalid_type,expected:ve.array,received:r.parsedType}),je;if(r.data.length<this._def.items.length)return de(r,{code:ce.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),je;!this._def.rest&&r.data.length>this._def.items.length&&(de(r,{code:ce.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const o=[...r.data].map((u,f)=>{const d=this._def.items[f]||this._def.rest;return d?d._parse(new os(r,u,r.path,f)):null}).filter(u=>!!u);return r.common.async?Promise.all(o).then(u=>Jn.mergeArray(n,u)):Jn.mergeArray(n,o)}get items(){return this._def.items}rest(t){return new qs({...this._def,rest:t})}}qs.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new qs({items:e,typeName:X.ZodTuple,rest:null,...Ze(t)})};class eT extends Xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ve.map)return de(r,{code:ce.invalid_type,expected:ve.map,received:r.parsedType}),je;const s=this._def.keyType,o=this._def.valueType,u=[...r.data.entries()].map(([f,d],h)=>({key:s._parse(new os(r,f,r.path,[h,"key"])),value:o._parse(new os(r,d,r.path,[h,"value"]))}));if(r.common.async){const f=new Map;return Promise.resolve().then(async()=>{for(const d of u){const h=await d.key,m=await d.value;if(h.status==="aborted"||m.status==="aborted")return je;(h.status==="dirty"||m.status==="dirty")&&n.dirty(),f.set(h.value,m.value)}return{status:n.value,value:f}})}else{const f=new Map;for(const d of u){const h=d.key,m=d.value;if(h.status==="aborted"||m.status==="aborted")return je;(h.status==="dirty"||m.status==="dirty")&&n.dirty(),f.set(h.value,m.value)}return{status:n.value,value:f}}}}eT.create=(e,t,n)=>new eT({valueType:t,keyType:e,typeName:X.ZodMap,...Ze(n)});class Ul extends Xe{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ve.set)return de(r,{code:ce.invalid_type,expected:ve.set,received:r.parsedType}),je;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(de(r,{code:ce.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(de(r,{code:ce.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const o=this._def.valueType;function u(d){const h=new Set;for(const m of d){if(m.status==="aborted")return je;m.status==="dirty"&&n.dirty(),h.add(m.value)}return{status:n.value,value:h}}const f=[...r.data.values()].map((d,h)=>o._parse(new os(r,d,r.path,h)));return r.common.async?Promise.all(f).then(d=>u(d)):u(f)}min(t,n){return new Ul({...this._def,minSize:{value:t,message:Ee.toString(n)}})}max(t,n){return new Ul({...this._def,maxSize:{value:t,message:Ee.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Ul.create=(e,t)=>new Ul({valueType:e,minSize:null,maxSize:null,typeName:X.ZodSet,...Ze(t)});class tT extends Xe{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}tT.create=(e,t)=>new tT({getter:e,typeName:X.ZodLazy,...Ze(t)});let nT=class extends Xe{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return de(n,{received:n.data,code:ce.invalid_literal,expected:this._def.value}),je}return{status:"valid",value:t.data}}get value(){return this._def.value}};nT.create=(e,t)=>new nT({value:e,typeName:X.ZodLiteral,...Ze(t)});function uO(e,t){return new D_({values:e,typeName:X.ZodEnum,...Ze(t)})}let D_=class zg extends Xe{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return de(n,{expected:Ke.joinValues(r),received:n.parsedType,code:ce.invalid_type}),je}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return de(n,{received:n.data,code:ce.invalid_enum_value,options:r}),je}return ur(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return zg.create(t,{...this._def,...n})}exclude(t,n=this._def){return zg.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}};D_.create=uO;class rT extends Xe{_parse(t){const n=Ke.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==ve.string&&r.parsedType!==ve.number){const s=Ke.objectValues(n);return de(r,{expected:Ke.joinValues(s),received:r.parsedType,code:ce.invalid_type}),je}if(this._cache||(this._cache=new Set(Ke.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Ke.objectValues(n);return de(r,{received:r.data,code:ce.invalid_enum_value,options:s}),je}return ur(t.data)}get enum(){return this._def.values}}rT.create=(e,t)=>new rT({values:e,typeName:X.ZodNativeEnum,...Ze(t)});class Of extends Xe{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==ve.promise&&n.common.async===!1)return de(n,{code:ce.invalid_type,expected:ve.promise,received:n.parsedType}),je;const r=n.parsedType===ve.promise?n.data:Promise.resolve(n.data);return ur(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Of.create=(e,t)=>new Of({type:e,typeName:X.ZodPromise,...Ze(t)});class ao extends Xe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===X.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,o={addIssue:u=>{de(r,u),u.fatal?n.abort():n.dirty()},get path(){return r.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){const u=s.transform(r.data,o);if(r.common.async)return Promise.resolve(u).then(async f=>{if(n.value==="aborted")return je;const d=await this._def.schema._parseAsync({data:f,path:r.path,parent:r});return d.status==="aborted"?je:d.status==="dirty"||n.value==="dirty"?dl(d.value):d});{if(n.value==="aborted")return je;const f=this._def.schema._parseSync({data:u,path:r.path,parent:r});return f.status==="aborted"?je:f.status==="dirty"||n.value==="dirty"?dl(f.value):f}}if(s.type==="refinement"){const u=f=>{const d=s.refinement(f,o);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return f};if(r.common.async===!1){const f=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return f.status==="aborted"?je:(f.status==="dirty"&&n.dirty(),u(f.value),{status:n.value,value:f.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(f=>f.status==="aborted"?je:(f.status==="dirty"&&n.dirty(),u(f.value).then(()=>({status:n.value,value:f.value}))))}if(s.type==="transform")if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!no(u))return je;const f=s.transform(u.value,o);if(f instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:f}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>no(u)?Promise.resolve(s.transform(u.value,o)).then(f=>({status:n.value,value:f})):je);Ke.assertNever(s)}}ao.create=(e,t,n)=>new ao({schema:e,typeName:X.ZodEffects,effect:t,...Ze(n)});ao.createWithPreprocess=(e,t,n)=>new ao({schema:t,effect:{type:"preprocess",transform:e},typeName:X.ZodEffects,...Ze(n)});let Wa=class extends Xe{_parse(t){return this._getType(t)===ve.undefined?ur(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Wa.create=(e,t)=>new Wa({innerType:e,typeName:X.ZodOptional,...Ze(t)});let so=class extends Xe{_parse(t){return this._getType(t)===ve.null?ur(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};so.create=(e,t)=>new so({innerType:e,typeName:X.ZodNullable,...Ze(t)});let Dg=class extends Xe{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===ve.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}};Dg.create=(e,t)=>new Dg({innerType:e,typeName:X.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ze(t)});let Ug=class extends Xe{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Sf(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new _a(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new _a(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};Ug.create=(e,t)=>new Ug({innerType:e,typeName:X.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ze(t)});class aT extends Xe{_parse(t){if(this._getType(t)!==ve.nan){const r=this._getOrReturnCtx(t);return de(r,{code:ce.invalid_type,expected:ve.nan,received:r.parsedType}),je}return{status:"valid",value:t.data}}}aT.create=e=>new aT({typeName:X.ZodNaN,...Ze(e)});class _3 extends Xe{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class U_ extends Xe{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?je:o.status==="dirty"?(n.dirty(),dl(o.value)):this._def.out._parseAsync({data:o.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?je:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new U_({in:t,out:n,typeName:X.ZodPipeline})}}let Pg=class extends Xe{_parse(t){const n=this._def.innerType._parse(t),r=s=>(no(s)&&(s.value=Object.freeze(s.value)),s);return Sf(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}};Pg.create=(e,t)=>new Pg({innerType:e,typeName:X.ZodReadonly,...Ze(t)});var X;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(X||(X={}));const cO=$g.create,sT=jg.create;ls.create;ro.create;const fO=ya.create;Tf.create;xf.create;qs.create;D_.create;Of.create;Wa.create;so.create;function y3(e,t){const n={type:"array"};return e.type?._def&&e.type?._def?.typeName!==X.ZodAny&&(n.items=tt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&it(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&it(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(it(n,"minItems",e.exactLength.value,e.exactLength.message,t),it(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function v3(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?it(n,"minimum",r.value,r.message,t):it(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),it(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?it(n,"maximum",r.value,r.message,t):it(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),it(n,"maximum",r.value,r.message,t));break;case"multipleOf":it(n,"multipleOf",r.value,r.message,t);break}return n}function b3(){return{type:"boolean"}}function dO(e,t){return tt(e.type._def,t)}const w3=(e,t)=>tt(e.innerType._def,t);function hO(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map(s=>hO(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return S3(e,t)}}const S3=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":it(n,"minimum",r.value,r.message,t);break;case"max":it(n,"maximum",r.value,r.message,t);break}return n};function E3(e,t){return{...tt(e.innerType._def,t),default:e.defaultValue()}}function T3(e,t){return t.effectStrategy==="input"?tt(e.schema._def,t):Vn(t)}function x3(e){return{type:"string",enum:Array.from(e.values)}}const O3=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function A3(e,t){const n=[tt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),tt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(o=>{if(O3(o))s.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let u=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:f,...d}=o;u=d}else r=void 0;s.push(u)}}),s.length?{allOf:s,...r}:void 0}function C3(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let eg;const gr={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(eg===void 0&&(eg=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),eg),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function pO(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":it(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":it(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":_r(n,"email",r.message,t);break;case"format:idn-email":_r(n,"idn-email",r.message,t);break;case"pattern:zod":un(n,gr.email,r.message,t);break}break;case"url":_r(n,"uri",r.message,t);break;case"uuid":_r(n,"uuid",r.message,t);break;case"regex":un(n,r.regex,r.message,t);break;case"cuid":un(n,gr.cuid,r.message,t);break;case"cuid2":un(n,gr.cuid2,r.message,t);break;case"startsWith":un(n,RegExp(`^${tg(r.value,t)}`),r.message,t);break;case"endsWith":un(n,RegExp(`${tg(r.value,t)}$`),r.message,t);break;case"datetime":_r(n,"date-time",r.message,t);break;case"date":_r(n,"date",r.message,t);break;case"time":_r(n,"time",r.message,t);break;case"duration":_r(n,"duration",r.message,t);break;case"length":it(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),it(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":un(n,RegExp(tg(r.value,t)),r.message,t);break;case"ip":r.version!=="v6"&&_r(n,"ipv4",r.message,t),r.version!=="v4"&&_r(n,"ipv6",r.message,t);break;case"base64url":un(n,gr.base64url,r.message,t);break;case"jwt":un(n,gr.jwt,r.message,t);break;case"cidr":r.version!=="v6"&&un(n,gr.ipv4Cidr,r.message,t),r.version!=="v4"&&un(n,gr.ipv6Cidr,r.message,t);break;case"emoji":un(n,gr.emoji(),r.message,t);break;case"ulid":un(n,gr.ulid,r.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":_r(n,"binary",r.message,t);break;case"contentEncoding:base64":it(n,"contentEncoding","base64",r.message,t);break;case"pattern:zod":un(n,gr.base64,r.message,t);break}break;case"nanoid":un(n,gr.nanoid,r.message,t);break}return n}function tg(e,t){return t.patternStrategy==="escape"?N3(e):e}const R3=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function N3(e){let t="";for(let n=0;n<e.length;n++)R3.has(e[n])||(t+="\\"),t+=e[n];return t}function _r(e,t,n,r){e.format||e.anyOf?.some(s=>s.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):it(e,"format",t,n,r)}function un(e,t,n,r){e.pattern||e.allOf?.some(s=>s.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:iT(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):it(e,"pattern",iT(t,r),n,r)}function iT(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",o=!1,u=!1,f=!1;for(let d=0;d<r.length;d++){if(o){s+=r[d],o=!1;continue}if(n.i){if(u){if(r[d].match(/[a-z]/)){f?(s+=r[d],s+=`${r[d-2]}-${r[d]}`.toUpperCase(),f=!1):r[d+1]==="-"&&r[d+2]?.match(/[a-z]/)?(s+=r[d],f=!0):s+=`${r[d]}${r[d].toUpperCase()}`;continue}}else if(r[d].match(/[a-z]/)){s+=`[${r[d]}${r[d].toUpperCase()}]`;continue}}if(n.m){if(r[d]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[d]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[d]==="."){s+=u?`${r[d]}\r
`:`[${r[d]}\r
]`;continue}s+=r[d],r[d]==="\\"?o=!0:u&&r[d]==="]"?u=!1:!u&&r[d]==="["&&(u=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function mO(e,t){if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&e.keyType?._def.typeName===X.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,s)=>({...r,[s]:tt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",s]})??Vn(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:tt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(e.keyType?._def.typeName===X.ZodString&&e.keyType._def.checks?.length){const{type:r,...s}=pO(e.keyType._def,t);return{...n,propertyNames:s}}else{if(e.keyType?._def.typeName===X.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===X.ZodBranded&&e.keyType._def.type._def.typeName===X.ZodString&&e.keyType._def.type._def.checks?.length){const{type:r,...s}=dO(e.keyType._def,t);return{...n,propertyNames:s}}}return n}function I3(e,t){return t.mapStrategy==="record"?mO(e,t):{type:"array",maxItems:125,items:{type:"array",items:[tt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||Vn(t),tt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||Vn(t)],minItems:2,maxItems:2}}}function k3(e){const t=e.values,n=Object.keys(e.values).filter(s=>typeof t[t[s]]!="number").map(s=>t[s]),r=Array.from(new Set(n.map(s=>typeof s)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function $3(e){return e.target==="openAi"?void 0:{not:Vn({...e,currentPath:[...e.currentPath,"not"]})}}function M3(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Af={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function j3(e,t){if(t.target==="openApi3")return oT(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Af&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,o)=>{const u=Af[o._def.typeName];return u&&!s.includes(u)?[...s,u]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,o)=>{const u=typeof o._def.value;switch(u){case"string":case"number":case"boolean":return[...s,u];case"bigint":return[...s,"integer"];case"object":return o._def.value===null?[...s,"null"]:s;default:return s}},[]);if(r.length===n.length){const s=r.filter((o,u,f)=>f.indexOf(o)===u);return{type:s.length>1?s:s[0],enum:n.reduce((o,u)=>o.includes(u._def.value)?o:[...o,u._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(o=>!r.includes(o))],[])};return oT(e,t)}const oT=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>tt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function L3(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Af[e.innerType._def.typeName],nullable:!0}:{type:[Af[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=tt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=tt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function z3(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",iO(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?it(n,"minimum",r.value,r.message,t):it(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),it(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?it(n,"maximum",r.value,r.message,t):it(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),it(n,"maximum",r.value,r.message,t));break;case"multipleOf":it(n,"multipleOf",r.value,r.message,t);break}return n}function D3(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],o=e.shape();for(const f in o){let d=o[f];if(d===void 0||d._def===void 0)continue;let h=P3(d);h&&n&&(d._def.typeName==="ZodOptional"&&(d=d._def.innerType),d.isNullable()||(d=d.nullable()),h=!1);const m=tt(d._def,{...t,currentPath:[...t.currentPath,"properties",f],propertyPath:[...t.currentPath,"properties",f]});m!==void 0&&(r.properties[f]=m,h||s.push(f))}s.length&&(r.required=s);const u=U3(e,t);return u!==void 0&&(r.additionalProperties=u),r}function U3(e,t){if(e.catchall._def.typeName!=="ZodNever")return tt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function P3(e){try{return e.isOptional()}catch{return!0}}const B3=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return tt(e.innerType._def,t);const n=tt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:Vn(t)},n]}:Vn(t)},Z3=(e,t)=>{if(t.pipeStrategy==="input")return tt(e.in._def,t);if(t.pipeStrategy==="output")return tt(e.out._def,t);const n=tt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]});return{allOf:[n,tt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]})].filter(r=>r!==void 0)}};function q3(e,t){return tt(e.type._def,t)}function F3(e,t){const n={type:"array",uniqueItems:!0,items:tt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&it(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&it(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function H3(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>tt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:tt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>tt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function G3(e){return{not:Vn(e)}}function V3(e){return Vn(e)}const J3=(e,t)=>tt(e.innerType._def,t),X3=(e,t,n)=>{switch(t){case X.ZodString:return pO(e,n);case X.ZodNumber:return z3(e,n);case X.ZodObject:return D3(e,n);case X.ZodBigInt:return v3(e,n);case X.ZodBoolean:return b3();case X.ZodDate:return hO(e,n);case X.ZodUndefined:return G3(n);case X.ZodNull:return M3(n);case X.ZodArray:return y3(e,n);case X.ZodUnion:case X.ZodDiscriminatedUnion:return j3(e,n);case X.ZodIntersection:return A3(e,n);case X.ZodTuple:return H3(e,n);case X.ZodRecord:return mO(e,n);case X.ZodLiteral:return C3(e,n);case X.ZodEnum:return x3(e);case X.ZodNativeEnum:return k3(e);case X.ZodNullable:return L3(e,n);case X.ZodOptional:return B3(e,n);case X.ZodMap:return I3(e,n);case X.ZodSet:return F3(e,n);case X.ZodLazy:return()=>e.getter()._def;case X.ZodPromise:return q3(e,n);case X.ZodNaN:case X.ZodNever:return $3(n);case X.ZodEffects:return T3(e,n);case X.ZodAny:return Vn(n);case X.ZodUnknown:return V3(n);case X.ZodDefault:return E3(e,n);case X.ZodBranded:return dO(e,n);case X.ZodReadonly:return J3(e,n);case X.ZodCatch:return w3(e,n);case X.ZodPipeline:return Z3(e,n);case X.ZodFunction:case X.ZodVoid:case X.ZodSymbol:return;default:return(r=>{})()}};function tt(e,t,n=!1){const r=t.seen.get(e);if(t.override){const f=t.override?.(e,t,r,n);if(f!==Zz)return f}if(r&&!n){const f=Y3(r,t);if(f!==void 0)return f}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const o=X3(e,e.typeName,t),u=typeof o=="function"?tt(o(),t):o;if(u&&Q3(e,t,u),t.postProcess){const f=t.postProcess(u,e,t);return s.jsonSchema=u,f}return s.jsonSchema=u,u}const Y3=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:sO(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),Vn(t)):t.$refStrategy==="seen"?Vn(t):void 0}},Q3=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),K3=(e,t)=>{const n=Hz(t);let r;const s=t?.name,o=tt(e._def,n,!1)??Vn(n);n.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[n.openAiAnyTypeName]||(r[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:n.$refStrategy==="relative"?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));const u=s===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:o}};return n.target==="jsonSchema7"?u.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in u||"oneOf"in u||"allOf"in u||"type"in u&&Array.isArray(u.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),u};function Bg(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let s=0;s<r;s++)if(!Bg(e[s],t[s]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(const u of r)if(!Bg(e[u],t[u]))return!1;return!0}return e===t}function da(e,t){if(Xn(e)){const n=zz(e,!0);return Ol(n)?Ng(Ig(n,!0),t):Ng(e,t)}return Br(e)?K3(e):e}function W3(e,t){if(e!==void 0&&!Tl(e))return e;if(N_(t))try{let n=t.getName();return n=n.startsWith("Runnable")?n.slice(8):n,n}catch{return t.getName()}else return t.name??"UnknownSchema"}function eD(e){return N_(e.data)?{type:"runnable",data:{id:e.data.lc_id,name:e.data.getName()}}:{type:"schema",data:{...da(e.data.schema),title:e.data.name}}}var gO=class _O{nodes={};edges=[];constructor(t){this.nodes=t?.nodes??this.nodes,this.edges=t?.edges??this.edges}toJSON(){const t={};return Object.values(this.nodes).forEach((n,r)=>{t[n.id]=Tl(n.id)?r:n.id}),{nodes:Object.values(this.nodes).map(n=>({id:t[n.id],...eD(n)})),edges:this.edges.map(n=>{const r={source:t[n.source],target:t[n.target]};return typeof n.data<"u"&&(r.data=n.data),typeof n.conditional<"u"&&(r.conditional=n.conditional),r})}}addNode(t,n,r){if(n!==void 0&&this.nodes[n]!==void 0)throw new Error(`Node with id ${n} already exists`);const s=n??Ms(),o={id:s,data:t,name:W3(n,t),metadata:r};return this.nodes[s]=o,o}removeNode(t){delete this.nodes[t.id],this.edges=this.edges.filter(n=>n.source!==t.id&&n.target!==t.id)}addEdge(t,n,r,s){if(this.nodes[t.id]===void 0)throw new Error(`Source node ${t.id} not in graph`);if(this.nodes[n.id]===void 0)throw new Error(`Target node ${n.id} not in graph`);const o={source:t.id,target:n.id,data:r,conditional:s};return this.edges.push(o),o}firstNode(){return lT(this)}lastNode(){return uT(this)}extend(t,n=""){let r=n;Object.values(t.nodes).map(d=>d.id).every(Tl)&&(r="");const s=d=>r?`${r}:${d}`:d;Object.entries(t.nodes).forEach(([d,h])=>{this.nodes[s(d)]={...h,id:s(d)}});const o=t.edges.map(d=>({...d,source:s(d.source),target:s(d.target)}));this.edges=[...this.edges,...o];const u=t.firstNode(),f=t.lastNode();return[u?{id:s(u.id),data:u.data}:void 0,f?{id:s(f.id),data:f.data}:void 0]}trimFirstNode(){const t=this.firstNode();t&&lT(this,[t.id])&&this.removeNode(t)}trimLastNode(){const t=this.lastNode();t&&uT(this,[t.id])&&this.removeNode(t)}reid(){const t=Object.fromEntries(Object.values(this.nodes).map(s=>[s.id,s.name])),n=new Map;Object.values(t).forEach(s=>{n.set(s,(n.get(s)||0)+1)});const r=s=>{const o=t[s];return Tl(s)&&n.get(o)===1?o:s};return new _O({nodes:Object.fromEntries(Object.entries(this.nodes).map(([s,o])=>[r(s),{...o,id:r(s)}])),edges:this.edges.map(s=>({...s,source:r(s.source),target:r(s.target)}))})}drawMermaid(t){const{withStyles:n,curveStyle:r,nodeColors:s={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:o}=t??{},u=this.reid(),f=u.firstNode(),d=u.lastNode();return Pz(u.nodes,u.edges,{firstNode:f?.id,lastNode:d?.id,withStyles:n,curveStyle:r,nodeColors:s,wrapLabelNWords:o})}async drawMermaidPng(t){return Bz(this.drawMermaid(t),{backgroundColor:t?.backgroundColor})}};function lT(e,t=[]){const n=new Set(e.edges.filter(s=>!t.includes(s.source)).map(s=>s.target)),r=[];for(const s of Object.values(e.nodes))!t.includes(s.id)&&!n.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function uT(e,t=[]){const n=new Set(e.edges.filter(s=>!t.includes(s.target)).map(s=>s.source)),r=[];for(const s of Object.values(e.nodes))!t.includes(s.id)&&!n.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function tD(e){const t=new TextEncoder,n=new ReadableStream({async start(r){for await(const s of e)r.enqueue(t.encode(`event: data
data: ${JSON.stringify(s)}

`));r.enqueue(t.encode(`event: end

`)),r.close()}});return Pr.fromReadableStream(n)}function cT(e){return typeof e=="object"&&e!==null&&typeof e[Symbol.iterator]=="function"&&typeof e.next=="function"}const nD=e=>e!=null&&typeof e=="object"&&"next"in e&&typeof e.next=="function";function Zg(e){return typeof e=="object"&&e!==null&&typeof e[Symbol.asyncIterator]=="function"}function*fT(e,t){for(;;){const{value:n,done:r}=rs.runWithConfig(Wi(e),t.next.bind(t),!0);if(r)break;yield n}}async function*qg(e,t){const n=t[Symbol.asyncIterator]();for(;;){const{value:r,done:s}=await rs.runWithConfig(Wi(e),n.next.bind(t),!0);if(s)break;yield r}}function Gt(e,t){return e&&!Array.isArray(e)&&!(e instanceof Date)&&typeof e=="object"?e:{[t]:e}}var tn=class extends Nl{lc_runnable=!0;name;getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}withRetry(e){return new vO({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new Cf({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new sD({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(st);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(e).filter(([r])=>r!=="runId"));return Array.from({length:t},(r,s)=>st(s===0?e:n))}return Array.from({length:t},()=>st(e))}async batch(e,t,n){const r=this._getOptionsList(t??{},e.length),s=new R_({maxConcurrency:r[0]?.maxConcurrency??n?.maxConcurrency,onFailedAttempt:u=>{throw u}}),o=e.map((u,f)=>s.call(async()=>{try{return await this.invoke(u,r[f])}catch(d){if(n?.returnExceptions)return d;throw d}}));return Promise.all(o)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const n=st(t),r=new lo({generator:this._streamIterator(e,n),config:n});return await r.setup,Pr.fromAsyncGenerator(r)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=st(e):t=st({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[t,n]}async _callWithConfig(e,t,n){const r=st(n),s=await(await xr(r))?.handleChainStart(this.toJSON(),Gt(t,"input"),r.runId,r?.runType,void 0,void 0,r?.runName??this.getName());delete r.runId;let o;try{o=await as(e.call(this,t,r,s),n?.signal)}catch(u){throw await s?.handleChainError(u),u}return await s?.handleChainEnd(Gt(o,"output")),o}async _batchWithConfig(e,t,n,r){const s=this._getOptionsList(n??{},t.length),o=await Promise.all(s.map(xr)),u=await Promise.all(o.map(async(d,h)=>{const m=await d?.handleChainStart(this.toJSON(),Gt(t[h],"input"),s[h].runId,s[h].runType,void 0,void 0,s[h].runName??this.getName());return delete s[h].runId,m}));let f;try{f=await as(e.call(this,t,s,u,r),s?.[0]?.signal)}catch(d){throw await Promise.all(u.map(h=>h?.handleChainError(d))),d}return await Promise.all(u.map(d=>d?.handleChainEnd(Gt(f,"output")))),f}_concatOutputChunks(e,t){return Kf(e,t)}async*_transformStreamWithConfig(e,t,n){let r,s=!0,o,u=!0;const f=st(n),d=await xr(f),h=this;async function*m(){for await(const y of e){if(s)if(r===void 0)r=y;else try{r=h._concatOutputChunks(r,y)}catch{r=void 0,s=!1}yield y}}let _;try{const y=await VM(t.bind(this),m(),async()=>d?.handleChainStart(this.toJSON(),{input:""},f.runId,f.runType,void 0,void 0,f.runName??this.getName(),void 0,{lc_defers_inputs:!0}),n?.signal,f);delete f.runId,_=y.setup;const v=_?.handlers.find(a4);let w=y.output;v!==void 0&&_!==void 0&&(w=v.tapOutputIterable(_.runId,w));const x=_?.handlers.find(n4);x!==void 0&&_!==void 0&&(w=x.tapOutputIterable(_.runId,w));for await(const R of w)if(yield R,u)if(o===void 0)o=R;else try{o=this._concatOutputChunks(o,R)}catch{o=void 0,u=!1}}catch(y){throw await _?.handleChainError(y,void 0,void 0,void 0,{inputs:Gt(r,"input")}),y}await _?.handleChainEnd(o??{},void 0,void 0,void 0,{inputs:Gt(r,"input")})}getGraph(e){const t=new gO,n=t.addNode({name:`${this.getName()}Input`,schema:sT()}),r=t.addNode(this),s=t.addNode({name:`${this.getName()}Output`,schema:sT()});return t.addEdge(n,r),t.addEdge(r,s),t}pipe(e){return new sd({first:this,last:zs(e)})}pick(e){return this.pipe(new iD(e))}assign(e){return this.pipe(new EO(new id({steps:e})))}async*transform(e,t){let n;for await(const r of e)n===void 0?n=r:n=this._concatOutputChunks(n,r);yield*this._streamIterator(n,st(t))}async*streamLog(e,t,n){const r=new EE({...n,autoClose:!1,_schemaFormat:"original"}),s=st(t);yield*this._streamLog(e,r,s)}async*_streamLog(e,t,n){const{callbacks:r}=n;if(r===void 0)n.callbacks=[t];else if(Array.isArray(r))n.callbacks=r.concat([t]);else{const f=r.copy();f.addHandler(t,!0),n.callbacks=f}const s=this.stream(e,n);async function o(){try{const f=await s;for await(const d of f){const h=new Xa({ops:[{op:"add",path:"/streamed_output/-",value:d}]});await t.writer.write(h)}}finally{await t.writer.close()}}const u=o();try{for await(const f of t)yield f}finally{await u}}streamEvents(e,t,n){let r;if(t.version==="v1")r=this._streamEventsV1(e,t,n);else if(t.version==="v2")r=this._streamEventsV2(e,t,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?tD(r):Pr.fromAsyncGenerator(r)}async*_streamEventsV2(e,t,n){const r=new s4({...n,autoClose:!1}),s=st(t),o=s.runId??Ms();s.runId=o;const u=s.callbacks;if(u===void 0)s.callbacks=[r];else if(Array.isArray(u))s.callbacks=u.concat(r);else{const v=u.copy();v.addHandler(r,!0),s.callbacks=v}const f=new AbortController,d=this;async function h(){let v,w=null;try{t?.signal?"any"in AbortSignal?v=AbortSignal.any([f.signal,t.signal]):(v=t.signal,w=()=>{f.abort()},t.signal.addEventListener("abort",w,{once:!0})):v=f.signal;const x=await d.stream(e,{...s,signal:v}),R=r.tapOutputIterable(o,x);for await(const E of R)if(f.signal.aborted)break}finally{await r.finish(),v&&w&&v.removeEventListener("abort",w)}}const m=h();let _=!1,y;try{for await(const v of r){if(!_){v.data.input=e,_=!0,y=v.run_id,yield v;continue}v.run_id===y&&v.event.endsWith("_end")&&v.data?.input&&delete v.data.input,yield v}}finally{f.abort(),await m}}async*_streamEventsV1(e,t,n){let r,s=!1;const o=st(t),u=o.tags??[],f=o.metadata??{},d=o.runName??this.getName(),h=new EE({...n,autoClose:!1,_schemaFormat:"streaming_events"}),m=new g4({...n}),_=this._streamLog(e,h,o);for await(const v of _){if(r?r=r.concat(v):r=ux.fromRunLogPatch(v),r.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!s){s=!0;const E={...r.state},A={run_id:E.id,event:`on_${E.type}_start`,name:d,tags:u,metadata:f,data:{input:e}};m.includeEvent(A,E.type)&&(yield A)}const w=v.ops.filter(E=>E.path.startsWith("/logs/")).map(E=>E.path.split("/")[2]),x=[...new Set(w)];for(const E of x){let A,N={};const M=r.state.logs[E];if(M.end_time===void 0?M.streamed_output.length>0?A="stream":A="start":A="end",A==="start")M.inputs!==void 0&&(N.input=M.inputs);else if(A==="end")M.inputs!==void 0&&(N.input=M.inputs),N.output=M.final_output;else if(A==="stream"){const B=M.streamed_output.length;if(B!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${B} instead. Encountered in: "${M.name}"`);N={chunk:M.streamed_output[0]},M.streamed_output=[]}yield{event:`on_${M.type}_${A}`,name:M.name,run_id:M.id,tags:M.tags,metadata:M.metadata,data:N}}const{state:R}=r;if(R.streamed_output.length>0){const E=R.streamed_output.length;if(E!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${E} instead. Encountered in: "${R.name}"`);const A={chunk:R.streamed_output[0]};R.streamed_output=[];const N={event:`on_${R.type}_stream`,run_id:R.id,tags:u,metadata:f,name:d,data:A};m.includeEvent(N,R.type)&&(yield N)}}const y=r?.state;if(y!==void 0){const v={event:`on_${y.type}_end`,name:d,run_id:y.id,tags:u,metadata:f,data:{output:y.final_output}};m.includeEvent(v,y.type)&&(yield v)}}static isRunnable(e){return N_(e)}withListeners({onStart:e,onEnd:t,onError:n}){return new Cf({bound:this,config:{},configFactories:[r=>({callbacks:[new dx({config:r,onStart:e,onEnd:t,onError:n})]})]})}asTool(e){return oD(this,e)}},Cf=class yO extends tn{static lc_name(){return"RunnableBinding"}lc_namespace=["langchain_core","runnables"];lc_serializable=!0;bound;config;kwargs;configFactories;constructor(t){super(t),this.bound=t.bound,this.kwargs=t.kwargs,this.config=t.config,this.configFactories=t.configFactories}getName(t){return this.bound.getName(t)}async _mergeConfig(...t){const n=vE(this.config,...t);return vE(n,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(n))):[])}withConfig(t){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...t}})}withRetry(t){return new vO({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:t?.stopAfterAttempt,...t})}async invoke(t,n){return this.bound.invoke(t,await this._mergeConfig(n,this.kwargs))}async batch(t,n,r){const s=Array.isArray(n)?await Promise.all(n.map(async o=>this._mergeConfig(st(o),this.kwargs))):await this._mergeConfig(st(n),this.kwargs);return this.bound.batch(t,s,r)}_concatOutputChunks(t,n){return this.bound._concatOutputChunks(t,n)}async*_streamIterator(t,n){yield*this.bound._streamIterator(t,await this._mergeConfig(st(n),this.kwargs))}async stream(t,n){return this.bound.stream(t,await this._mergeConfig(st(n),this.kwargs))}async*transform(t,n){yield*this.bound.transform(t,await this._mergeConfig(st(n),this.kwargs))}streamEvents(t,n,r){const s=this,o=async function*(){yield*s.bound.streamEvents(t,{...await s._mergeConfig(st(n),s.kwargs),version:n.version},r)};return Pr.fromAsyncGenerator(o())}static isRunnableBinding(t){return t.bound&&tn.isRunnable(t.bound)}withListeners({onStart:t,onEnd:n,onError:r}){return new yO({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[s=>({callbacks:[new dx({config:s,onStart:t,onEnd:n,onError:r})]})]})}},vO=class extends Cf{static lc_name(){return"RunnableRetry"}lc_namespace=["langchain_core","runnables"];maxAttemptNumber=3;onFailedAttempt=()=>{};constructor(e){super(e),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,n){const r=e>1?`retry:attempt:${e}`:void 0;return hn(t,{callbacks:n?.getChild(r)})}async _invoke(e,t,n){return Ag(r=>super.invoke(e,this._patchConfigForRetry(r,t,n)),{onFailedAttempt:({error:r})=>this.onFailedAttempt(r,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,n,r){const s={};try{await Ag(async o=>{const u=e.map((_,y)=>y).filter(_=>s[_.toString()]===void 0||s[_.toString()]instanceof Error),f=u.map(_=>e[_]),d=u.map(_=>this._patchConfigForRetry(o,t?.[_],n?.[_])),h=await super.batch(f,d,{...r,returnExceptions:!0});let m;for(let _=0;_<h.length;_+=1){const y=h[_],v=u[_];y instanceof Error&&m===void 0&&(m=y,m.input=f[_]),s[v.toString()]=y}if(m)throw m;return h},{onFailedAttempt:({error:o})=>this.onFailedAttempt(o,o.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(o){if(r?.returnExceptions!==!0)throw o}return Object.keys(s).sort((o,u)=>parseInt(o,10)-parseInt(u,10)).map(o=>s[parseInt(o,10)])}async batch(e,t,n){return this._batchWithConfig(this._batch.bind(this),e,t,n)}},sd=class pl extends tn{static lc_name(){return"RunnableSequence"}first;middle=[];last;omitSequenceTags=!1;lc_serializable=!0;lc_namespace=["langchain_core","runnables"];constructor(t){super(t),this.first=t.first,this.middle=t.middle??this.middle,this.last=t.last,this.name=t.name,this.omitSequenceTags=t.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(t,n){const r=st(n),s=await(await xr(r))?.handleChainStart(this.toJSON(),Gt(t,"input"),r.runId,void 0,void 0,void 0,r?.runName);delete r.runId;let o=t,u;try{const f=[this.first,...this.middle];for(let d=0;d<f.length;d+=1)o=await as(f[d].invoke(o,hn(r,{callbacks:s?.getChild(this.omitSequenceTags?void 0:`seq:step:${d+1}`)})),n?.signal);if(n?.signal?.aborted)throw ff(n.signal);u=await this.last.invoke(o,hn(r,{callbacks:s?.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(f){throw await s?.handleChainError(f),f}return await s?.handleChainEnd(Gt(u,"output")),u}async batch(t,n,r){const s=this._getOptionsList(n??{},t.length),o=await Promise.all(s.map(xr)),u=await Promise.all(o.map(async(d,h)=>{const m=await d?.handleChainStart(this.toJSON(),Gt(t[h],"input"),s[h].runId,void 0,void 0,void 0,s[h].runName);return delete s[h].runId,m}));let f=t;try{for(let d=0;d<this.steps.length;d+=1)f=await as(this.steps[d].batch(f,u.map((h,m)=>{const _=h?.getChild(this.omitSequenceTags?void 0:`seq:step:${d+1}`);return hn(s[m],{callbacks:_})}),r),s[0]?.signal)}catch(d){throw await Promise.all(u.map(h=>h?.handleChainError(d))),d}return await Promise.all(u.map(d=>d?.handleChainEnd(Gt(f,"output")))),f}_concatOutputChunks(t,n){return this.last._concatOutputChunks(t,n)}async*_streamIterator(t,n){const r=await xr(n),{runId:s,...o}=n??{},u=await r?.handleChainStart(this.toJSON(),Gt(t,"input"),s,void 0,void 0,void 0,o?.runName),f=[this.first,...this.middle,this.last];let d=!0,h;async function*m(){yield t}try{let _=f[0].transform(m(),hn(o,{callbacks:u?.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let y=1;y<f.length;y+=1)_=await f[y].transform(_,hn(o,{callbacks:u?.getChild(this.omitSequenceTags?void 0:`seq:step:${y+1}`)}));for await(const y of _)if(n?.signal?.throwIfAborted(),yield y,d)if(h===void 0)h=y;else try{h=this._concatOutputChunks(h,y)}catch{h=void 0,d=!1}}catch(_){throw await u?.handleChainError(_),_}await u?.handleChainEnd(Gt(h,"output"))}getGraph(t){const n=new gO;let r=null;return this.steps.forEach((s,o)=>{const u=s.getGraph(t);o!==0&&u.trimFirstNode(),o!==this.steps.length-1&&u.trimLastNode(),n.extend(u);const f=u.firstNode();if(!f)throw new Error(`Runnable ${s} has no first node`);r&&n.addEdge(r,f),r=u.lastNode()}),n}pipe(t){return pl.isRunnableSequence(t)?new pl({first:this.first,middle:this.middle.concat([this.last,t.first,...t.middle]),last:t.last,name:this.name??t.name}):new pl({first:this.first,middle:[...this.middle,this.last],last:zs(t),name:this.name})}static isRunnableSequence(t){return Array.isArray(t.middle)&&tn.isRunnable(t)}static from([t,...n],r){let s={};return typeof r=="string"?s.name=r:r!==void 0&&(s=r),new pl({...s,first:zs(t),middle:n.slice(0,-1).map(zs),last:zs(n[n.length-1])})}},id=class bO extends tn{static lc_name(){return"RunnableMap"}lc_namespace=["langchain_core","runnables"];lc_serializable=!0;steps;getStepsKeys(){return Object.keys(this.steps)}constructor(t){super(t),this.steps={};for(const[n,r]of Object.entries(t.steps))this.steps[n]=zs(r)}static from(t){return new bO({steps:t})}async invoke(t,n){const r=st(n),s=await(await xr(r))?.handleChainStart(this.toJSON(),{input:t},r.runId,void 0,void 0,void 0,r?.runName);delete r.runId;const o={};try{const u=Object.entries(this.steps).map(async([f,d])=>{o[f]=await d.invoke(t,hn(r,{callbacks:s?.getChild(`map:key:${f}`)}))});await as(Promise.all(u),n?.signal)}catch(u){throw await s?.handleChainError(u),u}return await s?.handleChainEnd(o),o}async*_transform(t,n,r){const s={...this.steps},o=ix(t,Object.keys(s).length),u=new Map(Object.entries(s).map(([f,d],h)=>{const m=d.transform(o[h],hn(r,{callbacks:n?.getChild(`map:key:${f}`)}));return[f,m.next().then(_=>({key:f,gen:m,result:_}))]}));for(;u.size;){const{key:f,result:d,gen:h}=await as(Promise.race(u.values()),r?.signal);u.delete(f),d.done||(yield{[f]:d.value},u.set(f,h.next().then(m=>({key:f,gen:h,result:m}))))}}transform(t,n){return this._transformStreamWithConfig(t,this._transform.bind(this),n)}async stream(t,n){async function*r(){yield t}const s=st(n),o=new lo({generator:this.transform(r(),s),config:s});return await o.setup,Pr.fromAsyncGenerator(o)}},rD=class wO extends tn{lc_serializable=!1;lc_namespace=["langchain_core","runnables"];func;constructor(t){if(super(t),!C_(t.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=t.func}async invoke(t,n){const[r]=this._getOptionsList(n??{},1),s=await xr(r);return as(this.func(hn(r,{callbacks:s}),t),r?.signal)}async*_streamIterator(t,n){const[r]=this._getOptionsList(n??{},1),s=await this.invoke(t,n);if(Zg(s)){for await(const o of s)r?.signal?.throwIfAborted(),yield o;return}if(nD(s)){for(;;){r?.signal?.throwIfAborted();const o=s.next();if(o.done)break;yield o.value}return}yield s}static from(t){return new wO({func:t})}};function aD(e){if(C_(e))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}var od=class SO extends tn{static lc_name(){return"RunnableLambda"}lc_namespace=["langchain_core","runnables"];func;constructor(t){if(C_(t.func))return rD.from(t.func);super(t),aD(t.func),this.func=t.func}static from(t){return new SO({func:t})}async _invoke(t,n,r){return new Promise((s,o)=>{const u=hn(n,{callbacks:r?.getChild(),recursionLimit:(n?.recursionLimit??Xm)-1});rs.runWithConfig(Wi(u),async()=>{try{let f=await this.func(t,{...u});if(f&&tn.isRunnable(f)){if(n?.recursionLimit===0)throw new Error("Recursion limit reached.");f=await f.invoke(t,{...u,recursionLimit:(u.recursionLimit??Xm)-1})}else if(Zg(f)){let d;for await(const h of qg(u,f))if(n?.signal?.throwIfAborted(),d===void 0)d=h;else try{d=this._concatOutputChunks(d,h)}catch{d=h}f=d}else if(cT(f)){let d;for(const h of fT(u,f))if(n?.signal?.throwIfAborted(),d===void 0)d=h;else try{d=this._concatOutputChunks(d,h)}catch{d=h}f=d}s(f)}catch(f){o(f)}})})}async invoke(t,n){return this._callWithConfig(this._invoke.bind(this),t,n)}async*_transform(t,n,r){let s;for await(const f of t)if(s===void 0)s=f;else try{s=this._concatOutputChunks(s,f)}catch{s=f}const o=hn(r,{callbacks:n?.getChild(),recursionLimit:(r?.recursionLimit??Xm)-1}),u=await new Promise((f,d)=>{rs.runWithConfig(Wi(o),async()=>{try{f(await this.func(s,{...o,config:o}))}catch(h){d(h)}})});if(u&&tn.isRunnable(u)){if(r?.recursionLimit===0)throw new Error("Recursion limit reached.");const f=await u.stream(s,o);for await(const d of f)yield d}else if(Zg(u))for await(const f of qg(o,u))r?.signal?.throwIfAborted(),yield f;else if(cT(u))for(const f of fT(o,u))r?.signal?.throwIfAborted(),yield f;else yield u}transform(t,n){return this._transformStreamWithConfig(t,this._transform.bind(this),n)}async stream(t,n){async function*r(){yield t}const s=st(n),o=new lo({generator:this.transform(r(),s),config:s});return await o.setup,Pr.fromAsyncGenerator(o)}},sD=class extends tn{static lc_name(){return"RunnableWithFallbacks"}lc_namespace=["langchain_core","runnables"];lc_serializable=!0;runnable;fallbacks;constructor(e){super(e),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const n=st(t),r=await xr(n),{runId:s,...o}=n,u=await r?.handleChainStart(this.toJSON(),Gt(e,"input"),s,void 0,void 0,void 0,o?.runName),f=hn(o,{callbacks:u?.getChild()});return await rs.runWithConfig(f,async()=>{let d;for(const h of this.runnables()){n?.signal?.throwIfAborted();try{const m=await h.invoke(e,f);return await u?.handleChainEnd(Gt(m,"output")),m}catch(m){d===void 0&&(d=m)}}throw d===void 0?new Error("No error stored at end of fallback."):(await u?.handleChainError(d),d)})}async*_streamIterator(e,t){const n=st(t),r=await xr(n),{runId:s,...o}=n,u=await r?.handleChainStart(this.toJSON(),Gt(e,"input"),s,void 0,void 0,void 0,o?.runName);let f,d;for(const m of this.runnables()){n?.signal?.throwIfAborted();const _=hn(o,{callbacks:u?.getChild()});try{d=qg(_,await m.stream(e,_));break}catch(y){f===void 0&&(f=y)}}if(d===void 0){const m=f??new Error("No error stored at end of fallback.");throw await u?.handleChainError(m),m}let h;try{for await(const m of d){yield m;try{h=h===void 0?h:this._concatOutputChunks(h,m)}catch{h=void 0}}}catch(m){throw await u?.handleChainError(m),m}await u?.handleChainEnd(Gt(h,"output"))}async batch(e,t,n){if(n?.returnExceptions)throw new Error("Not implemented.");const r=this._getOptionsList(t??{},e.length),s=await Promise.all(r.map(f=>xr(f))),o=await Promise.all(s.map(async(f,d)=>{const h=await f?.handleChainStart(this.toJSON(),Gt(e[d],"input"),r[d].runId,void 0,void 0,void 0,r[d].runName);return delete r[d].runId,h}));let u;for(const f of this.runnables()){r[0].signal?.throwIfAborted();try{const d=await f.batch(e,o.map((h,m)=>hn(r[m],{callbacks:h?.getChild()})),n);return await Promise.all(o.map((h,m)=>h?.handleChainEnd(Gt(d[m],"output")))),d}catch(d){u===void 0&&(u=d)}}throw u?(await Promise.all(o.map(f=>f?.handleChainError(u))),u):new Error("No error stored at end of fallbacks.")}};function zs(e){if(typeof e=="function")return new od({func:e});if(tn.isRunnable(e))return e;if(!Array.isArray(e)&&typeof e=="object"){const t={};for(const[n,r]of Object.entries(e))t[n]=zs(r);return new id({steps:t})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}var EO=class extends tn{static lc_name(){return"RunnableAssign"}lc_namespace=["langchain_core","runnables"];lc_serializable=!0;mapper;constructor(e){e instanceof id&&(e={mapper:e}),super(e),this.mapper=e.mapper}async invoke(e,t){const n=await this.mapper.invoke(e,t);return{...e,...n}}async*_transform(e,t,n){const r=this.mapper.getStepsKeys(),[s,o]=ix(e),u=this.mapper.transform(o,hn(n,{callbacks:t?.getChild()})),f=u.next();for await(const d of s){if(typeof d!="object"||Array.isArray(d))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof d}`);const h=Object.fromEntries(Object.entries(d).filter(([m])=>!r.includes(m)));Object.keys(h).length>0&&(yield h)}yield(await f).value;for await(const d of u)yield d}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const r=st(t),s=new lo({generator:this.transform(n(),r),config:r});return await s.setup,Pr.fromAsyncGenerator(s)}},iD=class extends tn{static lc_name(){return"RunnablePick"}lc_namespace=["langchain_core","runnables"];lc_serializable=!0;keys;constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(n=>[n,e[n]]).filter(n=>n[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const n=await this._pick(t);n!==void 0&&(yield n)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const r=st(t),s=new lo({generator:this.transform(n(),r),config:r});return await s.setup,Pr.fromAsyncGenerator(s)}},dT=class extends Cf{name;description;schema;constructor(e){const t=sd.from([od.from(async n=>{let r;if(S1(n))try{r=await rO(this.schema,n.args)}catch{throw new ik("Received tool input did not match expected schema",JSON.stringify(n.args))}else r=n;return r}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}};function oD(e,t){const n=t.name??e.getName(),r=t.description??z_(t.schema);return kz(t.schema)?new dT({name:n,description:r,schema:fO({input:cO()}).transform(s=>s.input),bound:e}):new dT({name:n,description:r,schema:t.schema,bound:e})}function Nc(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://docs.langchain.com/oss/javascript/langchain/errors/${t}/
`,e}function ke(e,t,n,r,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}function Z(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}let TO=function(){const{crypto:e}=globalThis;if(e?.randomUUID)return TO=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function Fg(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const Hg=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};class Ae extends Error{}class nn extends Ae{constructor(t,n,r,s){super(`${nn.makeMessage(t,n,r)}`),this.status=t,this.headers=s,this.requestID=s?.get("x-request-id"),this.error=n;const o=n;this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(t,n,r){const s=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&s?`${t} ${s}`:t?`${t} status code (no body)`:s||"(no status code or body)"}static generate(t,n,r,s){if(!t||!s)return new ld({message:r,cause:Hg(n)});const o=n?.error;return t===400?new xO(t,o,r,s):t===401?new OO(t,o,r,s):t===403?new AO(t,o,r,s):t===404?new CO(t,o,r,s):t===409?new RO(t,o,r,s):t===422?new NO(t,o,r,s):t===429?new IO(t,o,r,s):t>=500?new kO(t,o,r,s):new nn(t,o,r,s)}}class Gn extends nn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class ld extends nn{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class ud extends ld{constructor({message:t}={}){super({message:t??"Request timed out."})}}class xO extends nn{}class OO extends nn{}class AO extends nn{}class CO extends nn{}class RO extends nn{}class NO extends nn{}class IO extends nn{}class kO extends nn{}class $O extends Ae{constructor(){super("Could not parse response content as the length limit was reached")}}class MO extends Ae{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class ml extends Error{constructor(t){super(t)}}const lD=/^[a-z][a-z0-9+.-]*:/i,uD=e=>lD.test(e);let xn=e=>(xn=Array.isArray,xn(e)),hT=xn;function jO(e){return typeof e!="object"?{}:e??{}}function cD(e){if(!e)return!0;for(const t in e)return!1;return!0}function fD(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ng(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}const dD=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Ae(`${e} must be an integer`);if(t<0)throw new Ae(`${e} must be a positive integer`);return t},hD=e=>{try{return JSON.parse(e)}catch{return}},Fl=e=>new Promise(t=>setTimeout(t,e)),Pi="6.25.0",pD=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function mD(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const gD=()=>{const e=mD();if(e==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pi,"X-Stainless-OS":mT(Deno.build.os),"X-Stainless-Arch":pT(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(e==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pi,"X-Stainless-OS":mT(globalThis.process.platform??"unknown"),"X-Stainless-Arch":pT(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=_D();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function _D(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,o=r[2]||0,u=r[3]||0;return{browser:t,version:`${s}.${o}.${u}`}}}return null}const pT=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",mT=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let gT;const yD=()=>gT??(gT=gD());function vD(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function LO(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function zO(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return LO({start(){},async pull(n){const{done:r,value:s}=await t.next();r?n.close():n.enqueue(s)},async cancel(){await t.return?.()}})}function DO(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n?.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function bD(e){if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await e[Symbol.asyncIterator]().return?.();return}const t=e.getReader(),n=t.cancel();t.releaseLock(),await n}const wD=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),UO="RFC3986",PO=e=>String(e),_T={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:PO},SD="RFC1738";let Gg=(e,t)=>(Gg=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),Gg(e,t));const Mr=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),rg=1024,ED=(e,t,n,r,s)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});let u="";for(let f=0;f<o.length;f+=rg){const d=o.length>=rg?o.slice(f,f+rg):o,h=[];for(let m=0;m<d.length;++m){let _=d.charCodeAt(m);if(_===45||_===46||_===95||_===126||_>=48&&_<=57||_>=65&&_<=90||_>=97&&_<=122||s===SD&&(_===40||_===41)){h[h.length]=d.charAt(m);continue}if(_<128){h[h.length]=Mr[_];continue}if(_<2048){h[h.length]=Mr[192|_>>6]+Mr[128|_&63];continue}if(_<55296||_>=57344){h[h.length]=Mr[224|_>>12]+Mr[128|_>>6&63]+Mr[128|_&63];continue}m+=1,_=65536+((_&1023)<<10|d.charCodeAt(m)&1023),h[h.length]=Mr[240|_>>18]+Mr[128|_>>12&63]+Mr[128|_>>6&63]+Mr[128|_&63]}u+=h.join("")}return u};function TD(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function yT(e,t){if(xn(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const BO={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},ZO=function(e,t){Array.prototype.push.apply(e,xn(t)?t:[t])};let vT;const Pt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ED,encodeValuesOnly:!1,format:UO,formatter:PO,indices:!1,serializeDate(e){return(vT??(vT=Function.prototype.call.bind(Date.prototype.toISOString)))(e)},skipNulls:!1,strictNullHandling:!1};function xD(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const ag={};function qO(e,t,n,r,s,o,u,f,d,h,m,_,y,v,w,x,R,E){let A=e,N=E,M=0,B=!1;for(;(N=N.get(ag))!==void 0&&!B;){const xe=N.get(e);if(M+=1,typeof xe<"u"){if(xe===M)throw new RangeError("Cyclic object value");B=!0}typeof N.get(ag)>"u"&&(M=0)}if(typeof h=="function"?A=h(t,A):A instanceof Date?A=y?.(A):n==="comma"&&xn(A)&&(A=yT(A,function(xe){return xe instanceof Date?y?.(xe):xe})),A===null){if(o)return d&&!x?d(t,Pt.encoder,R,"key",v):t;A=""}if(xD(A)||TD(A)){if(d){const xe=x?t:d(t,Pt.encoder,R,"key",v);return[w?.(xe)+"="+w?.(d(A,Pt.encoder,R,"value",v))]}return[w?.(t)+"="+w?.(String(A))]}const Y=[];if(typeof A>"u")return Y;let W;if(n==="comma"&&xn(A))x&&d&&(A=yT(A,d)),W=[{value:A.length>0?A.join(",")||null:void 0}];else if(xn(h))W=h;else{const xe=Object.keys(A);W=m?xe.sort(m):xe}const C=f?String(t).replace(/\./g,"%2E"):String(t),Te=r&&xn(A)&&A.length===1?C+"[]":C;if(s&&xn(A)&&A.length===0)return Te+"[]";for(let xe=0;xe<W.length;++xe){const me=W[xe],Je=typeof me=="object"&&typeof me.value<"u"?me.value:A[me];if(u&&Je===null)continue;const At=_&&f?me.replace(/\./g,"%2E"):me,ue=xn(A)?typeof n=="function"?n(Te,At):Te:Te+(_?"."+At:"["+At+"]");E.set(e,M);const se=new WeakMap;se.set(ag,E),ZO(Y,qO(Je,ue,n,r,s,o,u,f,n==="comma"&&x&&xn(A)?null:d,h,m,_,y,v,w,x,R,se))}return Y}function OD(e=Pt){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||Pt.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=UO;if(typeof e.format<"u"){if(!Gg(_T,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=_T[n];let s=Pt.filter;(typeof e.filter=="function"||xn(e.filter))&&(s=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in BO?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Pt.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const u=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:Pt.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Pt.addQueryPrefix,allowDots:u,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Pt.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Pt.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Pt.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Pt.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Pt.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Pt.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Pt.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Pt.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Pt.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Pt.strictNullHandling}}function AD(e,t={}){let n=e;const r=OD(t);let s,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):xn(r.filter)&&(o=r.filter,s=o);const u=[];if(typeof n!="object"||n===null)return"";const f=BO[r.arrayFormat],d=f==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const h=new WeakMap;for(let y=0;y<s.length;++y){const v=s[y];r.skipNulls&&n[v]===null||ZO(u,qO(n[v],v,f,d,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,h))}const m=u.join(r.delimiter);let _=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),m.length>0?_+m:""}function CD(e){let t=0;for(const s of e)t+=s.length;const n=new Uint8Array(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return n}let bT;function P_(e){let t;return(bT??(t=new globalThis.TextEncoder,bT=t.encode.bind(t)))(e)}let wT;function ST(e){let t;return(wT??(t=new globalThis.TextDecoder,wT=t.decode.bind(t)))(e)}var Bn,Zn;class cd{constructor(){Bn.set(this,void 0),Zn.set(this,void 0),ke(this,Bn,new Uint8Array),ke(this,Zn,null)}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?P_(t):t;ke(this,Bn,CD([Z(this,Bn,"f"),n]));const r=[];let s;for(;(s=RD(Z(this,Bn,"f"),Z(this,Zn,"f")))!=null;){if(s.carriage&&Z(this,Zn,"f")==null){ke(this,Zn,s.index);continue}if(Z(this,Zn,"f")!=null&&(s.index!==Z(this,Zn,"f")+1||s.carriage)){r.push(ST(Z(this,Bn,"f").subarray(0,Z(this,Zn,"f")-1))),ke(this,Bn,Z(this,Bn,"f").subarray(Z(this,Zn,"f"))),ke(this,Zn,null);continue}const o=Z(this,Zn,"f")!==null?s.preceding-1:s.preceding,u=ST(Z(this,Bn,"f").subarray(0,o));r.push(u),ke(this,Bn,Z(this,Bn,"f").subarray(s.index)),ke(this,Zn,null)}return r}flush(){return Z(this,Bn,"f").length?this.decode(`
`):[]}}Bn=new WeakMap,Zn=new WeakMap;cd.NEWLINE_CHARS=new Set([`
`,"\r"]);cd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function RD(e,t){for(let s=t??0;s<e.length;s++){if(e[s]===10)return{preceding:s,index:s+1,carriage:!1};if(e[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function ND(e){for(let r=0;r<e.length-1;r++){if(e[r]===10&&e[r+1]===10||e[r]===13&&e[r+1]===13)return r+2;if(e[r]===13&&e[r+1]===10&&r+3<e.length&&e[r+2]===13&&e[r+3]===10)return r+4}return-1}const Rf={off:0,error:200,warn:300,info:400,debug:500},ET=(e,t,n)=>{if(e){if(fD(Rf,e))return e;Wt(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(Rf))}`)}};function gl(){}function Ic(e,t,n){return!t||Rf[e]>Rf[n]?gl:t[e].bind(t)}const ID={error:gl,warn:gl,info:gl,debug:gl};let TT=new WeakMap;function Wt(e){const t=e.logger,n=e.logLevel??"off";if(!t)return ID;const r=TT.get(t);if(r&&r[0]===n)return r[1];const s={error:Ic("error",t,n),warn:Ic("warn",t,n),info:Ic("info",t,n),debug:Ic("debug",t,n)};return TT.set(t,[n,s]),s}const Is=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);var ul;class Dr{constructor(t,n,r){this.iterator=t,ul.set(this,void 0),this.controller=n,ke(this,ul,r)}static fromSSEResponse(t,n,r,s){let o=!1;const u=r?Wt(r):console;async function*f(){if(o)throw new Ae("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let d=!1;try{for await(const h of kD(t,n))if(!d){if(h.data.startsWith("[DONE]")){d=!0;continue}if(h.event===null||!h.event.startsWith("thread.")){let m;try{m=JSON.parse(h.data)}catch(_){throw u.error("Could not parse message into JSON:",h.data),u.error("From chunk:",h.raw),_}if(m&&m.error)throw new nn(void 0,m.error,void 0,t.headers);yield s?{event:h.event,data:m}:m}else{let m;try{m=JSON.parse(h.data)}catch(_){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),_}if(h.event=="error")throw new nn(void 0,m.error,m.message,void 0);yield{event:h.event,data:m}}}d=!0}catch(h){if(Fg(h))return;throw h}finally{d||n.abort()}}return new Dr(f,n,r)}static fromReadableStream(t,n,r){let s=!1;async function*o(){const f=new cd,d=DO(t);for await(const h of d)for(const m of f.decode(h))yield m;for(const h of f.flush())yield h}async function*u(){if(s)throw new Ae("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let f=!1;try{for await(const d of o())f||d&&(yield JSON.parse(d));f=!0}catch(d){if(Fg(d))return;throw d}finally{f||n.abort()}}return new Dr(u,n,r)}[(ul=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),s=o=>({next:()=>{if(o.length===0){const u=r.next();t.push(u),n.push(u)}return o.shift()}});return[new Dr(()=>s(t),this.controller,Z(this,ul,"f")),new Dr(()=>s(n),this.controller,Z(this,ul,"f"))]}toReadableStream(){const t=this;let n;return LO({async start(){n=t[Symbol.asyncIterator]()},async pull(r){try{const{value:s,done:o}=await n.next();if(o)return r.close();const u=P_(JSON.stringify(s)+`
`);r.enqueue(u)}catch(s){r.error(s)}},async cancel(){await n.return?.()}})}}async function*kD(e,t){if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Ae("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Ae("Attempted to iterate over a response with no body");const n=new MD,r=new cd,s=DO(e.body);for await(const o of $D(s))for(const u of r.decode(o)){const f=n.decode(u);f&&(yield f)}for(const o of r.flush()){const u=n.decode(o);u&&(yield u)}}async function*$D(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?P_(n):n;let s=new Uint8Array(t.length+r.length);s.set(t),s.set(r,t.length),t=s;let o;for(;(o=ND(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}class MD{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,s]=jD(t,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function jD(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}async function FO(e,t){const{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:o}=t,u=await(async()=>{if(t.options.stream)return Wt(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e,t.options.__synthesizeEventData):Dr.fromSSEResponse(n,t.controller,e,t.options.__synthesizeEventData);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const d=n.headers.get("content-type")?.split(";")[0]?.trim();if(d?.includes("application/json")||d?.endsWith("+json")){if(n.headers.get("content-length")==="0")return;const y=await n.json();return HO(y,n)}return await n.text()})();return Wt(e).debug(`[${r}] response parsed`,Is({retryOfRequestLogID:s,url:n.url,status:n.status,body:u,durationMs:Date.now()-o})),u}function HO(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}var _l;class fd extends Promise{constructor(t,n,r=FO){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=r,_l.set(this,void 0),ke(this,_l,t)}_thenUnwrap(t){return new fd(Z(this,_l,"f"),this.responsePromise,async(n,r)=>HO(t(await this.parseResponse(n,r),r),r.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(Z(this,_l,"f"),t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}_l=new WeakMap;var kc;class B_{constructor(t,n,r,s){kc.set(this,void 0),ke(this,kc,t),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new Ae("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await Z(this,kc,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(kc=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class LD extends fd{constructor(t,n,r){super(t,n,async(s,o)=>new r(s,o.response,await FO(s,o),o.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}class dd extends B_{constructor(t,n,r,s){super(t,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Tt extends B_{constructor(t,n,r,s){super(t,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const t=this.getPaginatedItems(),n=t[t.length-1]?.id;return n?{...this.options,query:{...jO(this.options.query),after:n}}:null}}class Nf extends B_{constructor(t,n,r,s){super(t,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const t=this.last_id;return t?{...this.options,query:{...jO(this.options.query),after:t}}:null}}const GO=()=>{if(typeof File>"u"){const{process:e}=globalThis,t=typeof e?.versions?.node=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Al(e,t,n){return GO(),new File(e,t??"unknown_file",n)}function Jc(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const Z_=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",Pl=async(e,t)=>Vg(e.body)?{...e,body:await VO(e.body,t)}:e,io=async(e,t)=>({...e,body:await VO(e.body,t)}),xT=new WeakMap;function zD(e){const t=typeof e=="function"?e:e.fetch,n=xT.get(t);if(n)return n;const r=(async()=>{try{const s="Response"in t?t.Response:(await t("data:,")).constructor,o=new FormData;return o.toString()!==await new s(o).text()}catch{return!0}})();return xT.set(t,r),r}const VO=async(e,t)=>{if(!await zD(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(e||{}).map(([r,s])=>Jg(n,r,s))),n},JO=e=>e instanceof Blob&&"name"in e,DD=e=>typeof e=="object"&&e!==null&&(e instanceof Response||Z_(e)||JO(e)),Vg=e=>{if(DD(e))return!0;if(Array.isArray(e))return e.some(Vg);if(e&&typeof e=="object"){for(const t in e)if(Vg(e[t]))return!0}return!1},Jg=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(n instanceof Response)e.append(t,Al([await n.blob()],Jc(n)));else if(Z_(n))e.append(t,Al([await new Response(zO(n)).blob()],Jc(n)));else if(JO(n))e.append(t,n,Jc(n));else if(Array.isArray(n))await Promise.all(n.map(r=>Jg(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>Jg(e,`${t}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},XO=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",UD=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&XO(e),PD=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function BD(e,t,n){if(GO(),e=await e,UD(e))return e instanceof File?e:Al([await e.arrayBuffer()],e.name);if(PD(e)){const s=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Al(await Xg(s),t,n)}const r=await Xg(e);if(t||(t=Jc(e)),!n?.type){const s=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(n={...n,type:s})}return Al(r,t,n)}async function Xg(e){let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(XO(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(Z_(e))for await(const n of e)t.push(...await Xg(n));else{const n=e?.constructor?.name;throw new Error(`Unexpected data type: ${typeof e}${n?`; constructor: ${n}`:""}${ZD(e)}`)}return t}function ZD(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(n=>`"${n}"`).join(", ")}]`}class Se{constructor(t){this._client=t}}function YO(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const OT=Object.freeze(Object.create(null)),qD=(e=YO)=>function(n,...r){if(n.length===1)return n[0];let s=!1;const o=[],u=n.reduce((m,_,y)=>{/[?#]/.test(_)&&(s=!0);const v=r[y];let w=(s?encodeURIComponent:e)(""+v);return y!==r.length&&(v==null||typeof v=="object"&&v.toString===Object.getPrototypeOf(Object.getPrototypeOf(v.hasOwnProperty??OT)??OT)?.toString)&&(w=v+"",o.push({start:m.length+_.length,length:w.length,error:`Value of type ${Object.prototype.toString.call(v).slice(8,-1)} is not a valid path parameter`})),m+_+(y===r.length?"":w)},""),f=u.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=d.exec(f))!==null;)o.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(o.sort((m,_)=>m.start-_.start),o.length>0){let m=0;const _=o.reduce((y,v)=>{const w=" ".repeat(v.start-m),x="^".repeat(v.length);return m=v.start+v.length,y+w+x},"");throw new Ae(`Path parameters result in path with invalid segments:
${o.map(y=>y.error).join(`
`)}
${u}
${_}`)}return u},ae=qD(YO);let QO=class extends Se{list(t,n={},r){return this._client.getAPIList(ae`/chat/completions/${t}/messages`,Tt,{query:n,...r})}};function If(e){return e!==void 0&&"function"in e&&e.function!==void 0}function FD(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function q_(e){return e?.$brand==="auto-parseable-response-format"}function Hl(e){return e?.$brand==="auto-parseable-tool"}function HD(e,t){return!t||!KO(t)?{...e,choices:e.choices.map(n=>(WO(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:F_(e,t)}function F_(e,t){const n=e.choices.map(r=>{if(r.finish_reason==="length")throw new $O;if(r.finish_reason==="content_filter")throw new MO;return WO(r.message.tool_calls),{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:r.message.tool_calls?.map(s=>VD(t,s))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?GD(t,r.message.content):null}}});return{...e,choices:n}}function GD(e,t){return e.response_format?.type!=="json_schema"?null:e.response_format?.type==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function VD(e,t){const n=e.tools?.find(r=>If(r)&&r.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:Hl(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}}function JD(e,t){if(!e||!("tools"in e)||!e.tools)return!1;const n=e.tools?.find(r=>If(r)&&r.function?.name===t.function.name);return If(n)&&(Hl(n)||n?.function.strict||!1)}function KO(e){return q_(e.response_format)?!0:e.tools?.some(t=>Hl(t)||t.type==="function"&&t.function.strict===!0)??!1}function WO(e){for(const t of e||[])if(t.type!=="function")throw new Ae(`Currently only \`function\` tool calls are supported; Received \`${t.type}\``)}function XD(e){for(const t of e??[]){if(t.type!=="function")throw new Ae(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new Ae(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const kf=e=>e?.role==="assistant",eA=e=>e?.role==="tool";var Yg,Xc,Yc,yl,vl,Qc,bl,ua,wl,$f,Mf,Bi,tA;class H_{constructor(){Yg.add(this),this.controller=new AbortController,Xc.set(this,void 0),Yc.set(this,()=>{}),yl.set(this,()=>{}),vl.set(this,void 0),Qc.set(this,()=>{}),bl.set(this,()=>{}),ua.set(this,{}),wl.set(this,!1),$f.set(this,!1),Mf.set(this,!1),Bi.set(this,!1),ke(this,Xc,new Promise((t,n)=>{ke(this,Yc,t,"f"),ke(this,yl,n,"f")})),ke(this,vl,new Promise((t,n)=>{ke(this,Qc,t,"f"),ke(this,bl,n,"f")})),Z(this,Xc,"f").catch(()=>{}),Z(this,vl,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Z(this,Yg,"m",tA).bind(this))},0)}_connected(){this.ended||(Z(this,Yc,"f").call(this),this._emit("connect"))}get ended(){return Z(this,wl,"f")}get errored(){return Z(this,$f,"f")}get aborted(){return Z(this,Mf,"f")}abort(){this.controller.abort()}on(t,n){return(Z(this,ua,"f")[t]||(Z(this,ua,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Z(this,ua,"f")[t];if(!r)return this;const s=r.findIndex(o=>o.listener===n);return s>=0&&r.splice(s,1),this}once(t,n){return(Z(this,ua,"f")[t]||(Z(this,ua,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{ke(this,Bi,!0),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){ke(this,Bi,!0),await Z(this,vl,"f")}_emit(t,...n){if(Z(this,wl,"f"))return;t==="end"&&(ke(this,wl,!0),Z(this,Qc,"f").call(this));const r=Z(this,ua,"f")[t];if(r&&(Z(this,ua,"f")[t]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),t==="abort"){const s=n[0];!Z(this,Bi,"f")&&!r?.length&&Promise.reject(s),Z(this,yl,"f").call(this,s),Z(this,bl,"f").call(this,s),this._emit("end");return}if(t==="error"){const s=n[0];!Z(this,Bi,"f")&&!r?.length&&Promise.reject(s),Z(this,yl,"f").call(this,s),Z(this,bl,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Xc=new WeakMap,Yc=new WeakMap,yl=new WeakMap,vl=new WeakMap,Qc=new WeakMap,bl=new WeakMap,ua=new WeakMap,wl=new WeakMap,$f=new WeakMap,Mf=new WeakMap,Bi=new WeakMap,Yg=new WeakSet,tA=function(t){if(ke(this,$f,!0),t instanceof Error&&t.name==="AbortError"&&(t=new Gn),t instanceof Gn)return ke(this,Mf,!0),this._emit("abort",t);if(t instanceof Ae)return this._emit("error",t);if(t instanceof Error){const n=new Ae(t.message);return n.cause=t,this._emit("error",n)}return this._emit("error",new Ae(String(t)))};function YD(e){return typeof e.parse=="function"}var fn,Qg,jf,Kg,Wg,e_,nA,rA;const QD=10;class aA extends H_{constructor(){super(...arguments),fn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=t.choices[0]?.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),eA(t)&&t.content)this._emit("functionToolCallResult",t.content);else if(kf(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new Ae("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),Z(this,fn,"m",Qg).call(this)}async finalMessage(){return await this.done(),Z(this,fn,"m",jf).call(this)}async finalFunctionToolCall(){return await this.done(),Z(this,fn,"m",Kg).call(this)}async finalFunctionToolCallResult(){return await this.done(),Z(this,fn,"m",Wg).call(this)}async totalUsage(){return await this.done(),Z(this,fn,"m",e_).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=Z(this,fn,"m",jf).call(this);n&&this._emit("finalMessage",n);const r=Z(this,fn,"m",Qg).call(this);r&&this._emit("finalContent",r);const s=Z(this,fn,"m",Kg).call(this);s&&this._emit("finalFunctionToolCall",s);const o=Z(this,fn,"m",Wg).call(this);o!=null&&this._emit("finalFunctionToolCallResult",o),this._chatCompletions.some(u=>u.usage)&&this._emit("totalUsage",Z(this,fn,"m",e_).call(this))}async _createChatCompletion(t,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Z(this,fn,"m",nA).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(F_(o,n))}async _runChatCompletion(t,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(t,n,r)}async _runTools(t,n,r){const s="tool",{tool_choice:o="auto",stream:u,...f}=n,d=typeof o!="string"&&o.type==="function"&&o?.function?.name,{maxChatCompletions:h=QD}=r||{},m=n.tools.map(v=>{if(Hl(v)){if(!v.$callback)throw new Ae("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),_={};for(const v of m)v.type==="function"&&(_[v.function.name||v.function.function.name]=v.function);const y="tools"in n?m.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<h;++v){const x=(await this._createChatCompletion(t,{...f,tool_choice:o,tools:y,messages:[...this.messages]},r)).choices[0]?.message;if(!x)throw new Ae("missing message in ChatCompletion response");if(!x.tool_calls?.length)return;for(const R of x.tool_calls){if(R.type!=="function")continue;const E=R.id,{name:A,arguments:N}=R.function,M=_[A];if(M){if(d&&d!==A){const C=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:s,tool_call_id:E,content:C});continue}}else{const C=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${Object.keys(_).map(Te=>JSON.stringify(Te)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:E,content:C});continue}let B;try{B=YD(M)?await M.parse(N):N}catch(C){const Te=C instanceof Error?C.message:String(C);this._addMessage({role:s,tool_call_id:E,content:Te});continue}const Y=await M.function(B,this),W=Z(this,fn,"m",rA).call(this,Y);if(this._addMessage({role:s,tool_call_id:E,content:W}),d)return}}}}fn=new WeakSet,Qg=function(){return Z(this,fn,"m",jf).call(this).content??null},jf=function(){let t=this.messages.length;for(;t-- >0;){const n=this.messages[t];if(kf(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new Ae("stream ended without producing a ChatCompletionMessage with role=assistant")},Kg=function(){for(let t=this.messages.length-1;t>=0;t--){const n=this.messages[t];if(kf(n)&&n?.tool_calls?.length)return n.tool_calls.filter(r=>r.type==="function").at(-1)?.function}},Wg=function(){for(let t=this.messages.length-1;t>=0;t--){const n=this.messages[t];if(eA(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>r.role==="assistant"&&r.tool_calls?.some(s=>s.type==="function"&&s.id===n.tool_call_id)))return n.content}},e_=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(t.completion_tokens+=n.completion_tokens,t.prompt_tokens+=n.prompt_tokens,t.total_tokens+=n.total_tokens);return t},nA=function(t){if(t.n!=null&&t.n>1)throw new Ae("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},rA=function(t){return typeof t=="string"?t:t===void 0?"undefined":JSON.stringify(t)};class G_ extends aA{static runTools(t,n,r){const s=new G_,o={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(t,n,o)),s}_addMessage(t,n=!0){super._addMessage(t,n),kf(t)&&t.content&&this._emit("content",t.content)}}const sA=1,iA=2,oA=4,lA=8,uA=16,cA=32,fA=64,dA=128,hA=256,pA=dA|hA,mA=uA|cA|pA|fA,gA=sA|iA|mA,_A=oA|lA,KD=gA|_A,Ht={STR:sA,NUM:iA,ARR:oA,OBJ:lA,NULL:uA,BOOL:cA,NAN:fA,INFINITY:dA,MINUS_INFINITY:hA,INF:pA,SPECIAL:mA,ATOM:gA,COLLECTION:_A,ALL:KD};class WD extends Error{}class eU extends Error{}function tU(e,t=Ht.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return nU(e.trim(),t)}const nU=(e,t)=>{const n=e.length;let r=0;const s=y=>{throw new WD(`${y} at position ${r}`)},o=y=>{throw new eU(`${y} at position ${r}`)},u=()=>(_(),r>=n&&s("Unexpected end of input"),e[r]==='"'?f():e[r]==="{"?d():e[r]==="["?h():e.substring(r,r+4)==="null"||Ht.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||Ht.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||Ht.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||Ht.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||Ht.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||Ht.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):m()),f=()=>{const y=r;let v=!1;for(r++;r<n&&(e[r]!=='"'||v&&e[r-1]==="\\");)v=e[r]==="\\"?!v:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(y,++r-Number(v)))}catch(w){o(String(w))}else if(Ht.STR&t)try{return JSON.parse(e.substring(y,r-Number(v))+'"')}catch{return JSON.parse(e.substring(y,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},d=()=>{r++,_();const y={};try{for(;e[r]!=="}";){if(_(),r>=n&&Ht.OBJ&t)return y;const v=f();_(),r++;try{const w=u();Object.defineProperty(y,v,{value:w,writable:!0,enumerable:!0,configurable:!0})}catch(w){if(Ht.OBJ&t)return y;throw w}_(),e[r]===","&&r++}}catch{if(Ht.OBJ&t)return y;s("Expected '}' at end of object")}return r++,y},h=()=>{r++;const y=[];try{for(;e[r]!=="]";)y.push(u()),_(),e[r]===","&&r++}catch{if(Ht.ARR&t)return y;s("Expected ']' at end of array")}return r++,y},m=()=>{if(r===0){e==="-"&&Ht.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(v){if(Ht.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(v))}}const y=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(Ht.NUM&t)&&s("Unterminated number literal");try{return JSON.parse(e.substring(y,r))}catch{e.substring(y,r)==="-"&&Ht.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e.substring(y,e.lastIndexOf("e")))}catch(w){o(String(w))}}},_=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return u()},AT=e=>tU(e,Ht.ALL^Ht.NUM);var Ut,oa,Li,Ga,sg,$c,ig,og,lg,Mc,ug,CT;class Bl extends aA{constructor(t){super(),Ut.add(this),oa.set(this,void 0),Li.set(this,void 0),Ga.set(this,void 0),ke(this,oa,t),ke(this,Li,[])}get currentChatCompletionSnapshot(){return Z(this,Ga,"f")}static fromReadableStream(t){const n=new Bl(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const s=new Bl(n);return s._run(()=>s._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(t,n,r){super._createChatCompletion;const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Z(this,Ut,"m",sg).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const u of o)Z(this,Ut,"m",ig).call(this,u);if(o.controller.signal?.aborted)throw new Gn;return this._addChatCompletion(Z(this,Ut,"m",Mc).call(this))}async _fromReadableStream(t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Z(this,Ut,"m",sg).call(this),this._connected();const s=Dr.fromReadableStream(t,this.controller);let o;for await(const u of s)o&&o!==u.id&&this._addChatCompletion(Z(this,Ut,"m",Mc).call(this)),Z(this,Ut,"m",ig).call(this,u),o=u.id;if(s.controller.signal?.aborted)throw new Gn;return this._addChatCompletion(Z(this,Ut,"m",Mc).call(this))}[(oa=new WeakMap,Li=new WeakMap,Ga=new WeakMap,Ut=new WeakSet,sg=function(){this.ended||ke(this,Ga,void 0)},$c=function(n){let r=Z(this,Li,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Z(this,Li,"f")[n.index]=r,r)},ig=function(n){if(this.ended)return;const r=Z(this,Ut,"m",CT).call(this,n);this._emit("chunk",n,r);for(const s of n.choices){const o=r.choices[s.index];s.delta.content!=null&&o.message?.role==="assistant"&&o.message?.content&&(this._emit("content",s.delta.content,o.message.content),this._emit("content.delta",{delta:s.delta.content,snapshot:o.message.content,parsed:o.message.parsed})),s.delta.refusal!=null&&o.message?.role==="assistant"&&o.message?.refusal&&this._emit("refusal.delta",{delta:s.delta.refusal,snapshot:o.message.refusal}),s.logprobs?.content!=null&&o.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:s.logprobs?.content,snapshot:o.logprobs?.content??[]}),s.logprobs?.refusal!=null&&o.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:s.logprobs?.refusal,snapshot:o.logprobs?.refusal??[]});const u=Z(this,Ut,"m",$c).call(this,o);o.finish_reason&&(Z(this,Ut,"m",lg).call(this,o),u.current_tool_call_index!=null&&Z(this,Ut,"m",og).call(this,o,u.current_tool_call_index));for(const f of s.delta.tool_calls??[])u.current_tool_call_index!==f.index&&(Z(this,Ut,"m",lg).call(this,o),u.current_tool_call_index!=null&&Z(this,Ut,"m",og).call(this,o,u.current_tool_call_index)),u.current_tool_call_index=f.index;for(const f of s.delta.tool_calls??[]){const d=o.message.tool_calls?.[f.index];d?.type&&(d?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:d.function?.name,index:f.index,arguments:d.function.arguments,parsed_arguments:d.function.parsed_arguments,arguments_delta:f.function?.arguments??""}):(d?.type,void 0))}}},og=function(n,r){if(Z(this,Ut,"m",$c).call(this,n).done_tool_calls.has(r))return;const o=n.message.tool_calls?.[r];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if(o.type==="function"){const u=Z(this,oa,"f")?.tools?.find(f=>If(f)&&f.function.name===o.function.name);this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:r,arguments:o.function.arguments,parsed_arguments:Hl(u)?u.$parseRaw(o.function.arguments):u?.function.strict?JSON.parse(o.function.arguments):null})}else o.type},lg=function(n){const r=Z(this,Ut,"m",$c).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const s=Z(this,Ut,"m",ug).call(this);this._emit("content.done",{content:n.message.content,parsed:s?s.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},Mc=function(){if(this.ended)throw new Ae("stream has ended, this shouldn't happen");const n=Z(this,Ga,"f");if(!n)throw new Ae("request ended without sending any chunks");return ke(this,Ga,void 0),ke(this,Li,[]),rU(n,Z(this,oa,"f"))},ug=function(){const n=Z(this,oa,"f")?.response_format;return q_(n)?n:null},CT=function(n){var r,s,o,u;let f=Z(this,Ga,"f");const{choices:d,...h}=n;f?Object.assign(f,h):f=ke(this,Ga,{...h,choices:[]});for(const{delta:m,finish_reason:_,index:y,logprobs:v=null,...w}of n.choices){let x=f.choices[y];if(x||(x=f.choices[y]={finish_reason:_,index:y,message:{},logprobs:v,...w}),v)if(!x.logprobs)x.logprobs=Object.assign({},v);else{const{content:Y,refusal:W,...C}=v;Object.assign(x.logprobs,C),Y&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...Y)),W&&((s=x.logprobs).refusal??(s.refusal=[]),x.logprobs.refusal.push(...W))}if(_&&(x.finish_reason=_,Z(this,oa,"f")&&KO(Z(this,oa,"f")))){if(_==="length")throw new $O;if(_==="content_filter")throw new MO}if(Object.assign(x,w),!m)continue;const{content:R,refusal:E,function_call:A,role:N,tool_calls:M,...B}=m;if(Object.assign(x.message,B),E&&(x.message.refusal=(x.message.refusal||"")+E),N&&(x.message.role=N),A&&(x.message.function_call?(A.name&&(x.message.function_call.name=A.name),A.arguments&&((o=x.message.function_call).arguments??(o.arguments=""),x.message.function_call.arguments+=A.arguments)):x.message.function_call=A),R&&(x.message.content=(x.message.content||"")+R,!x.message.refusal&&Z(this,Ut,"m",ug).call(this)&&(x.message.parsed=AT(x.message.content))),M){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:Y,id:W,type:C,function:Te,...xe}of M){const me=(u=x.message.tool_calls)[Y]??(u[Y]={});Object.assign(me,xe),W&&(me.id=W),C&&(me.type=C),Te&&(me.function??(me.function={name:Te.name??"",arguments:""})),Te?.name&&(me.function.name=Te.name),Te?.arguments&&(me.function.arguments+=Te.arguments,JD(Z(this,oa,"f"),me)&&(me.function.parsed_arguments=AT(me.function.arguments)))}}}return f},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",s=>{const o=n.shift();o?o.resolve(s):t.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,u)=>n.push({resolve:o,reject:u})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Dr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function rU(e,t){const{id:n,choices:r,created:s,model:o,system_fingerprint:u,...f}=e,d={...f,id:n,choices:r.map(({message:h,finish_reason:m,index:_,logprobs:y,...v})=>{if(!m)throw new Ae(`missing finish_reason for choice ${_}`);const{content:w=null,function_call:x,tool_calls:R,...E}=h,A=h.role;if(!A)throw new Ae(`missing role for choice ${_}`);if(x){const{arguments:N,name:M}=x;if(N==null)throw new Ae(`missing function_call.arguments for choice ${_}`);if(!M)throw new Ae(`missing function_call.name for choice ${_}`);return{...v,message:{content:w,function_call:{arguments:N,name:M},role:A,refusal:h.refusal??null},finish_reason:m,index:_,logprobs:y}}return R?{...v,index:_,finish_reason:m,logprobs:y,message:{...E,role:A,content:w,refusal:h.refusal??null,tool_calls:R.map((N,M)=>{const{function:B,type:Y,id:W,...C}=N,{arguments:Te,name:xe,...me}=B||{};if(W==null)throw new Ae(`missing choices[${_}].tool_calls[${M}].id
${jc(e)}`);if(Y==null)throw new Ae(`missing choices[${_}].tool_calls[${M}].type
${jc(e)}`);if(xe==null)throw new Ae(`missing choices[${_}].tool_calls[${M}].function.name
${jc(e)}`);if(Te==null)throw new Ae(`missing choices[${_}].tool_calls[${M}].function.arguments
${jc(e)}`);return{...C,id:W,type:Y,function:{...me,name:xe,arguments:Te}}})}}:{...v,message:{...E,content:w,role:A,refusal:h.refusal??null},finish_reason:m,index:_,logprobs:y}}),created:s,model:o,object:"chat.completion",...u?{system_fingerprint:u}:{}};return HD(d,t)}function jc(e){return JSON.stringify(e)}class Lf extends Bl{static fromReadableStream(t){const n=new Lf(null);return n._run(()=>n._fromReadableStream(t)),n}static runTools(t,n,r){const s=new Lf(n),o={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(t,n,o)),s}}let V_=class extends Se{constructor(){super(...arguments),this.messages=new QO(this._client)}create(t,n){return this._client.post("/chat/completions",{body:t,...n,stream:t.stream??!1})}retrieve(t,n){return this._client.get(ae`/chat/completions/${t}`,n)}update(t,n,r){return this._client.post(ae`/chat/completions/${t}`,{body:n,...r})}list(t={},n){return this._client.getAPIList("/chat/completions",Tt,{query:t,...n})}delete(t,n){return this._client.delete(ae`/chat/completions/${t}`,n)}parse(t,n){return XD(t.tools),this._client.chat.completions.create(t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(r=>F_(r,t))}runTools(t,n){return t.stream?Lf.runTools(this._client,t,n):G_.runTools(this._client,t,n)}stream(t,n){return Bl.createChatCompletion(this._client,t,n)}};V_.Messages=QO;class J_ extends Se{constructor(){super(...arguments),this.completions=new V_(this._client)}}J_.Completions=V_;const yA=Symbol("brand.privateNullableHeaders");function*aU(e){if(!e)return;if(yA in e){const{values:r,nulls:s}=e;yield*r.entries();for(const o of s)yield[o,null];return}let t=!1,n;e instanceof Headers?n=e.entries():hT(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let r of n){const s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const o=hT(r[1])?r[1]:[r[1]];let u=!1;for(const f of o)f!==void 0&&(t&&!u&&(u=!0,yield[s,null]),yield[s,f])}}const pe=e=>{const t=new Headers,n=new Set;for(const r of e){const s=new Set;for(const[o,u]of aU(r)){const f=o.toLowerCase();s.has(f)||(t.delete(o),s.add(f)),u===null?(t.delete(o),n.add(f)):(t.append(o,u),n.delete(f))}}return{[yA]:!0,values:t,nulls:n}};class vA extends Se{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:pe([{Accept:"application/octet-stream"},n?.headers]),__binaryResponse:!0})}}class bA extends Se{create(t,n){return this._client.post("/audio/transcriptions",io({body:t,...n,stream:t.stream??!1,__metadata:{model:t.model}},this._client))}}class wA extends Se{create(t,n){return this._client.post("/audio/translations",io({body:t,...n,__metadata:{model:t.model}},this._client))}}class Gl extends Se{constructor(){super(...arguments),this.transcriptions=new bA(this._client),this.translations=new wA(this._client),this.speech=new vA(this._client)}}Gl.Transcriptions=bA;Gl.Translations=wA;Gl.Speech=vA;class SA extends Se{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(ae`/batches/${t}`,n)}list(t={},n){return this._client.getAPIList("/batches",Tt,{query:t,...n})}cancel(t,n){return this._client.post(ae`/batches/${t}/cancel`,n)}}class EA extends Se{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,n){return this._client.get(ae`/assistants/${t}`,{...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,n,r){return this._client.post(ae`/assistants/${t}`,{body:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(t={},n){return this._client.getAPIList("/assistants",Tt,{query:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(t,n){return this._client.delete(ae`/assistants/${t}`,{...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let TA=class extends Se{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};class xA extends Se{create(t,n){return this._client.post("/realtime/transcription_sessions",{body:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let hd=class extends Se{constructor(){super(...arguments),this.sessions=new TA(this._client),this.transcriptionSessions=new xA(this._client)}};hd.Sessions=TA;hd.TranscriptionSessions=xA;class OA extends Se{create(t,n){return this._client.post("/chatkit/sessions",{body:t,...n,headers:pe([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}cancel(t,n){return this._client.post(ae`/chatkit/sessions/${t}/cancel`,{...n,headers:pe([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}}let AA=class extends Se{retrieve(t,n){return this._client.get(ae`/chatkit/threads/${t}`,{...n,headers:pe([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}list(t={},n){return this._client.getAPIList("/chatkit/threads",Nf,{query:t,...n,headers:pe([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}delete(t,n){return this._client.delete(ae`/chatkit/threads/${t}`,{...n,headers:pe([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}listItems(t,n={},r){return this._client.getAPIList(ae`/chatkit/threads/${t}/items`,Nf,{query:n,...r,headers:pe([{"OpenAI-Beta":"chatkit_beta=v1"},r?.headers])})}};class pd extends Se{constructor(){super(...arguments),this.sessions=new OA(this._client),this.threads=new AA(this._client)}}pd.Sessions=OA;pd.Threads=AA;class CA extends Se{create(t,n,r){return this._client.post(ae`/threads/${t}/messages`,{body:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(t,n,r){const{thread_id:s}=n;return this._client.get(ae`/threads/${s}/messages/${t}`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(t,n,r){const{thread_id:s,...o}=n;return this._client.post(ae`/threads/${s}/messages/${t}`,{body:o,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(t,n={},r){return this._client.getAPIList(ae`/threads/${t}/messages`,Tt,{query:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(t,n,r){const{thread_id:s}=n;return this._client.delete(ae`/threads/${s}/messages/${t}`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class RA extends Se{retrieve(t,n,r){const{thread_id:s,run_id:o,...u}=n;return this._client.get(ae`/threads/${s}/runs/${o}/steps/${t}`,{query:u,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(t,n,r){const{thread_id:s,...o}=n;return this._client.getAPIList(ae`/threads/${s}/runs/${t}/steps`,Tt,{query:o,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}const sU=e=>{if(typeof Buffer<"u"){const t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}else{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};var iU={};const zi=e=>{if(typeof globalThis.process<"u")return iU?.[e]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(e)?.trim()};var en,Ds,t_,Lr,Kc,Er,Us,Ji,js,zf,qn,Wc,ef,Cl,Sl,El,RT,NT,IT,kT,$T,MT,jT;class Rl extends H_{constructor(){super(...arguments),en.add(this),t_.set(this,[]),Lr.set(this,{}),Kc.set(this,{}),Er.set(this,void 0),Us.set(this,void 0),Ji.set(this,void 0),js.set(this,void 0),zf.set(this,void 0),qn.set(this,void 0),Wc.set(this,void 0),ef.set(this,void 0),Cl.set(this,void 0)}[(t_=new WeakMap,Lr=new WeakMap,Kc=new WeakMap,Er=new WeakMap,Us=new WeakMap,Ji=new WeakMap,js=new WeakMap,zf=new WeakMap,qn=new WeakMap,Wc=new WeakMap,ef=new WeakMap,Cl=new WeakMap,en=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",s=>{const o=n.shift();o?o.resolve(s):t.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,u)=>n.push({resolve:o,reject:u})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new Ds;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Dr.fromReadableStream(t,this.controller);for await(const o of s)Z(this,en,"m",Sl).call(this,o);if(s.controller.signal?.aborted)throw new Gn;return this._addRun(Z(this,en,"m",El).call(this))}toReadableStream(){return new Dr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,s){const o=new Ds;return o._run(()=>o._runToolAssistantStream(t,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(t,n,r,s){const o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const u={...r,stream:!0},f=await t.submitToolOutputs(n,u,{...s,signal:this.controller.signal});this._connected();for await(const d of f)Z(this,en,"m",Sl).call(this,d);if(f.controller.signal?.aborted)throw new Gn;return this._addRun(Z(this,en,"m",El).call(this))}static createThreadAssistantStream(t,n,r){const s=new Ds;return s._run(()=>s._threadAssistantStream(t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(t,n,r,s){const o=new Ds;return o._run(()=>o._runAssistantStream(t,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Z(this,Wc,"f")}currentRun(){return Z(this,ef,"f")}currentMessageSnapshot(){return Z(this,Er,"f")}currentRunStepSnapshot(){return Z(this,Cl,"f")}async finalRunSteps(){return await this.done(),Object.values(Z(this,Lr,"f"))}async finalMessages(){return await this.done(),Object.values(Z(this,Kc,"f"))}async finalRun(){if(await this.done(),!Z(this,Us,"f"))throw Error("Final run was not received.");return Z(this,Us,"f")}async _createThreadAssistantStream(t,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},u=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const f of u)Z(this,en,"m",Sl).call(this,f);if(u.controller.signal?.aborted)throw new Gn;return this._addRun(Z(this,en,"m",El).call(this))}async _createAssistantStream(t,n,r,s){const o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const u={...r,stream:!0},f=await t.create(n,u,{...s,signal:this.controller.signal});this._connected();for await(const d of f)Z(this,en,"m",Sl).call(this,d);if(f.controller.signal?.aborted)throw new Gn;return this._addRun(Z(this,en,"m",El).call(this))}static accumulateDelta(t,n){for(const[r,s]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=s;continue}let o=t[r];if(o==null){t[r]=s;continue}if(r==="index"||r==="type"){t[r]=s;continue}if(typeof o=="string"&&typeof s=="string")o+=s;else if(typeof o=="number"&&typeof s=="number")o+=s;else if(ng(o)&&ng(s))o=this.accumulateDelta(o,s);else if(Array.isArray(o)&&Array.isArray(s)){if(o.every(u=>typeof u=="string"||typeof u=="number")){o.push(...s);continue}for(const u of s){if(!ng(u))throw new Error(`Expected array delta entry to be an object but got: ${u}`);const f=u.index;if(f==null)throw console.error(u),new Error("Expected array delta entry to have an `index` property");if(typeof f!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${f}`);const d=o[f];d==null?o.push(u):o[f]=this.accumulateDelta(d,u)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,s){return await this._createAssistantStream(n,t,r,s)}async _runToolAssistantStream(t,n,r,s){return await this._createToolAssistantStream(n,t,r,s)}}Ds=Rl,Sl=function(t){if(!this.ended)switch(ke(this,Wc,t),Z(this,en,"m",IT).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Z(this,en,"m",jT).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Z(this,en,"m",NT).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Z(this,en,"m",RT).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},El=function(){if(this.ended)throw new Ae("stream has ended, this shouldn't happen");if(!Z(this,Us,"f"))throw Error("Final run has not been received");return Z(this,Us,"f")},RT=function(t){const[n,r]=Z(this,en,"m",$T).call(this,t,Z(this,Er,"f"));ke(this,Er,n),Z(this,Kc,"f")[n.id]=n;for(const s of r){const o=n.content[s.index];o?.type=="text"&&this._emit("textCreated",o.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,n),t.data.delta.content)for(const s of t.data.delta.content){if(s.type=="text"&&s.text){let o=s.text,u=n.content[s.index];if(u&&u.type=="text")this._emit("textDelta",o,u.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=Z(this,Ji,"f")){if(Z(this,js,"f"))switch(Z(this,js,"f").type){case"text":this._emit("textDone",Z(this,js,"f").text,Z(this,Er,"f"));break;case"image_file":this._emit("imageFileDone",Z(this,js,"f").image_file,Z(this,Er,"f"));break}ke(this,Ji,s.index)}ke(this,js,n.content[s.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(Z(this,Ji,"f")!==void 0){const s=t.data.content[Z(this,Ji,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,Z(this,Er,"f"));break;case"text":this._emit("textDone",s.text,Z(this,Er,"f"));break}}Z(this,Er,"f")&&this._emit("messageDone",t.data),ke(this,Er,void 0)}},NT=function(t){const n=Z(this,en,"m",kT).call(this,t);switch(ke(this,Cl,n),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const r=t.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const o of r.step_details.tool_calls)o.index==Z(this,zf,"f")?this._emit("toolCallDelta",o,n.step_details.tool_calls[o.index]):(Z(this,qn,"f")&&this._emit("toolCallDone",Z(this,qn,"f")),ke(this,zf,o.index),ke(this,qn,n.step_details.tool_calls[o.index]),Z(this,qn,"f")&&this._emit("toolCallCreated",Z(this,qn,"f")));this._emit("runStepDelta",t.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ke(this,Cl,void 0),t.data.step_details.type=="tool_calls"&&Z(this,qn,"f")&&(this._emit("toolCallDone",Z(this,qn,"f")),ke(this,qn,void 0)),this._emit("runStepDone",t.data,n);break}},IT=function(t){Z(this,t_,"f").push(t),this._emit("event",t)},kT=function(t){switch(t.event){case"thread.run.step.created":return Z(this,Lr,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let n=Z(this,Lr,"f")[t.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=t.data;if(r.delta){const s=Ds.accumulateDelta(n,r.delta);Z(this,Lr,"f")[t.data.id]=s}return Z(this,Lr,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Z(this,Lr,"f")[t.data.id]=t.data;break}if(Z(this,Lr,"f")[t.data.id])return Z(this,Lr,"f")[t.data.id];throw new Error("No snapshot available")},$T=function(t,n){let r=[];switch(t.event){case"thread.message.created":return[t.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=t.data;if(s.delta.content)for(const o of s.delta.content)if(o.index in n.content){let u=n.content[o.index];n.content[o.index]=Z(this,en,"m",MT).call(this,o,u)}else n.content[o.index]=o,r.push(o);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},MT=function(t,n){return Ds.accumulateDelta(n,t)},jT=function(t){switch(ke(this,ef,t.data),t.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":ke(this,Us,t.data),Z(this,qn,"f")&&(this._emit("toolCallDone",Z(this,qn,"f")),ke(this,qn,void 0));break}};let X_=class extends Se{constructor(){super(...arguments),this.steps=new RA(this._client)}create(t,n,r){const{include:s,...o}=n;return this._client.post(ae`/threads/${t}/runs`,{query:{include:s},body:o,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:n.stream??!1,__synthesizeEventData:!0})}retrieve(t,n,r){const{thread_id:s}=n;return this._client.get(ae`/threads/${s}/runs/${t}`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(t,n,r){const{thread_id:s,...o}=n;return this._client.post(ae`/threads/${s}/runs/${t}`,{body:o,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(t,n={},r){return this._client.getAPIList(ae`/threads/${t}/runs`,Tt,{query:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(t,n,r){const{thread_id:s}=n;return this._client.post(ae`/threads/${s}/runs/${t}/cancel`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(t,n,r){const s=await this.create(t,n,r);return await this.poll(s.id,{thread_id:t},r)}createAndStream(t,n,r){return Rl.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const s=pe([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:o,response:u}=await this.retrieve(t,n,{...r,headers:{...r?.headers,...s}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let f=5e3;if(r?.pollIntervalMs)f=r.pollIntervalMs;else{const d=u.headers.get("openai-poll-after-ms");if(d){const h=parseInt(d);isNaN(h)||(f=h)}}await Fl(f);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return Rl.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r){const{thread_id:s,...o}=n;return this._client.post(ae`/threads/${s}/runs/${t}/submit_tool_outputs`,{body:o,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:n.stream??!1,__synthesizeEventData:!0})}async submitToolOutputsAndPoll(t,n,r){const s=await this.submitToolOutputs(t,n,r);return await this.poll(s.id,n,r)}submitToolOutputsStream(t,n,r){return Rl.createToolAssistantStream(t,this._client.beta.threads.runs,n,r)}};X_.Steps=RA;class md extends Se{constructor(){super(...arguments),this.runs=new X_(this._client),this.messages=new CA(this._client)}create(t={},n){return this._client.post("/threads",{body:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,n){return this._client.get(ae`/threads/${t}`,{...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,n,r){return this._client.post(ae`/threads/${t}`,{body:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(t,n){return this._client.delete(ae`/threads/${t}`,{...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:t.stream??!1,__synthesizeEventData:!0})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.id,{thread_id:r.thread_id},n)}createAndRunStream(t,n){return Rl.createThreadAssistantStream(t,this._client.beta.threads,n)}}md.Runs=X_;md.Messages=CA;class co extends Se{constructor(){super(...arguments),this.realtime=new hd(this._client),this.chatkit=new pd(this._client),this.assistants=new EA(this._client),this.threads=new md(this._client)}}co.Realtime=hd;co.ChatKit=pd;co.Assistants=EA;co.Threads=md;class NA extends Se{create(t,n){return this._client.post("/completions",{body:t,...n,stream:t.stream??!1})}}let IA=class extends Se{retrieve(t,n,r){const{container_id:s}=n;return this._client.get(ae`/containers/${s}/files/${t}/content`,{...r,headers:pe([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}},Y_=class extends Se{constructor(){super(...arguments),this.content=new IA(this._client)}create(t,n,r){return this._client.post(ae`/containers/${t}/files`,Pl({body:n,...r},this._client))}retrieve(t,n,r){const{container_id:s}=n;return this._client.get(ae`/containers/${s}/files/${t}`,r)}list(t,n={},r){return this._client.getAPIList(ae`/containers/${t}/files`,Tt,{query:n,...r})}delete(t,n,r){const{container_id:s}=n;return this._client.delete(ae`/containers/${s}/files/${t}`,{...r,headers:pe([{Accept:"*/*"},r?.headers])})}};Y_.Content=IA;class Q_ extends Se{constructor(){super(...arguments),this.files=new Y_(this._client)}create(t,n){return this._client.post("/containers",{body:t,...n})}retrieve(t,n){return this._client.get(ae`/containers/${t}`,n)}list(t={},n){return this._client.getAPIList("/containers",Tt,{query:t,...n})}delete(t,n){return this._client.delete(ae`/containers/${t}`,{...n,headers:pe([{Accept:"*/*"},n?.headers])})}}Q_.Files=Y_;class kA extends Se{create(t,n,r){const{include:s,...o}=n;return this._client.post(ae`/conversations/${t}/items`,{query:{include:s},body:o,...r})}retrieve(t,n,r){const{conversation_id:s,...o}=n;return this._client.get(ae`/conversations/${s}/items/${t}`,{query:o,...r})}list(t,n={},r){return this._client.getAPIList(ae`/conversations/${t}/items`,Nf,{query:n,...r})}delete(t,n,r){const{conversation_id:s}=n;return this._client.delete(ae`/conversations/${s}/items/${t}`,r)}}class K_ extends Se{constructor(){super(...arguments),this.items=new kA(this._client)}create(t={},n){return this._client.post("/conversations",{body:t,...n})}retrieve(t,n){return this._client.get(ae`/conversations/${t}`,n)}update(t,n,r){return this._client.post(ae`/conversations/${t}`,{body:n,...r})}delete(t,n){return this._client.delete(ae`/conversations/${t}`,n)}}K_.Items=kA;class $A extends Se{create(t,n){const r=!!t.encoding_format;let s=r?t.encoding_format:"base64";r&&Wt(this._client).debug("embeddings/user defined encoding_format:",t.encoding_format);const o=this._client.post("/embeddings",{body:{...t,encoding_format:s},...n});return r?o:(Wt(this._client).debug("embeddings/decoding base64 embeddings from base64"),o._thenUnwrap(u=>(u&&u.data&&u.data.forEach(f=>{const d=f.embedding;f.embedding=sU(d)}),u)))}}class MA extends Se{retrieve(t,n,r){const{eval_id:s,run_id:o}=n;return this._client.get(ae`/evals/${s}/runs/${o}/output_items/${t}`,r)}list(t,n,r){const{eval_id:s,...o}=n;return this._client.getAPIList(ae`/evals/${s}/runs/${t}/output_items`,Tt,{query:o,...r})}}class W_ extends Se{constructor(){super(...arguments),this.outputItems=new MA(this._client)}create(t,n,r){return this._client.post(ae`/evals/${t}/runs`,{body:n,...r})}retrieve(t,n,r){const{eval_id:s}=n;return this._client.get(ae`/evals/${s}/runs/${t}`,r)}list(t,n={},r){return this._client.getAPIList(ae`/evals/${t}/runs`,Tt,{query:n,...r})}delete(t,n,r){const{eval_id:s}=n;return this._client.delete(ae`/evals/${s}/runs/${t}`,r)}cancel(t,n,r){const{eval_id:s}=n;return this._client.post(ae`/evals/${s}/runs/${t}`,r)}}W_.OutputItems=MA;class ey extends Se{constructor(){super(...arguments),this.runs=new W_(this._client)}create(t,n){return this._client.post("/evals",{body:t,...n})}retrieve(t,n){return this._client.get(ae`/evals/${t}`,n)}update(t,n,r){return this._client.post(ae`/evals/${t}`,{body:n,...r})}list(t={},n){return this._client.getAPIList("/evals",Tt,{query:t,...n})}delete(t,n){return this._client.delete(ae`/evals/${t}`,n)}}ey.Runs=W_;let jA=class extends Se{create(t,n){return this._client.post("/files",io({body:t,...n},this._client))}retrieve(t,n){return this._client.get(ae`/files/${t}`,n)}list(t={},n){return this._client.getAPIList("/files",Tt,{query:t,...n})}delete(t,n){return this._client.delete(ae`/files/${t}`,n)}content(t,n){return this._client.get(ae`/files/${t}/content`,{...n,headers:pe([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=1800*1e3}={}){const s=new Set(["processed","error","deleted"]),o=Date.now();let u=await this.retrieve(t);for(;!u.status||!s.has(u.status);)if(await Fl(n),u=await this.retrieve(t),Date.now()-o>r)throw new ud({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return u}};class LA extends Se{}let zA=class extends Se{run(t,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:t,...n})}validate(t,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:t,...n})}};class ty extends Se{constructor(){super(...arguments),this.graders=new zA(this._client)}}ty.Graders=zA;class DA extends Se{create(t,n,r){return this._client.getAPIList(ae`/fine_tuning/checkpoints/${t}/permissions`,dd,{body:n,method:"post",...r})}retrieve(t,n={},r){return this._client.get(ae`/fine_tuning/checkpoints/${t}/permissions`,{query:n,...r})}delete(t,n,r){const{fine_tuned_model_checkpoint:s}=n;return this._client.delete(ae`/fine_tuning/checkpoints/${s}/permissions/${t}`,r)}}let ny=class extends Se{constructor(){super(...arguments),this.permissions=new DA(this._client)}};ny.Permissions=DA;class UA extends Se{list(t,n={},r){return this._client.getAPIList(ae`/fine_tuning/jobs/${t}/checkpoints`,Tt,{query:n,...r})}}class ry extends Se{constructor(){super(...arguments),this.checkpoints=new UA(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(ae`/fine_tuning/jobs/${t}`,n)}list(t={},n){return this._client.getAPIList("/fine_tuning/jobs",Tt,{query:t,...n})}cancel(t,n){return this._client.post(ae`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return this._client.getAPIList(ae`/fine_tuning/jobs/${t}/events`,Tt,{query:n,...r})}pause(t,n){return this._client.post(ae`/fine_tuning/jobs/${t}/pause`,n)}resume(t,n){return this._client.post(ae`/fine_tuning/jobs/${t}/resume`,n)}}ry.Checkpoints=UA;class fo extends Se{constructor(){super(...arguments),this.methods=new LA(this._client),this.jobs=new ry(this._client),this.checkpoints=new ny(this._client),this.alpha=new ty(this._client)}}fo.Methods=LA;fo.Jobs=ry;fo.Checkpoints=ny;fo.Alpha=ty;class PA extends Se{}class ay extends Se{constructor(){super(...arguments),this.graderModels=new PA(this._client)}}ay.GraderModels=PA;class BA extends Se{createVariation(t,n){return this._client.post("/images/variations",io({body:t,...n},this._client))}edit(t,n){return this._client.post("/images/edits",io({body:t,...n,stream:t.stream??!1},this._client))}generate(t,n){return this._client.post("/images/generations",{body:t,...n,stream:t.stream??!1})}}class ZA extends Se{retrieve(t,n){return this._client.get(ae`/models/${t}`,n)}list(t){return this._client.getAPIList("/models",dd,t)}delete(t,n){return this._client.delete(ae`/models/${t}`,n)}}class qA extends Se{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class FA extends Se{accept(t,n,r){return this._client.post(ae`/realtime/calls/${t}/accept`,{body:n,...r,headers:pe([{Accept:"*/*"},r?.headers])})}hangup(t,n){return this._client.post(ae`/realtime/calls/${t}/hangup`,{...n,headers:pe([{Accept:"*/*"},n?.headers])})}refer(t,n,r){return this._client.post(ae`/realtime/calls/${t}/refer`,{body:n,...r,headers:pe([{Accept:"*/*"},r?.headers])})}reject(t,n={},r){return this._client.post(ae`/realtime/calls/${t}/reject`,{body:n,...r,headers:pe([{Accept:"*/*"},r?.headers])})}}class HA extends Se{create(t,n){return this._client.post("/realtime/client_secrets",{body:t,...n})}}class gd extends Se{constructor(){super(...arguments),this.clientSecrets=new HA(this._client),this.calls=new FA(this._client)}}gd.ClientSecrets=HA;gd.Calls=FA;function oU(e,t){return!t||!uU(t)?{...e,output_parsed:null,output:e.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:GA(e,t)}function GA(e,t){const n=e.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:dU(t,s)};if(s.type==="message"){const o=s.content.map(u=>u.type==="output_text"?{...u,parsed:lU(t,u.text)}:u);return{...s,content:o}}return s}),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||n_(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const o of s.content)if(o.type==="output_text"&&o.parsed!==null)return o.parsed}return null}}),r}function lU(e,t){return e.text?.format?.type!=="json_schema"?null:"$parseRaw"in e.text?.format?(e.text?.format).$parseRaw(t):JSON.parse(t)}function uU(e){return!!q_(e.text?.format)}function cU(e){return e?.$brand==="auto-parseable-tool"}function fU(e,t){return e.find(n=>n.type==="function"&&n.name===t)}function dU(e,t){const n=fU(e.tools??[],t.name);return{...t,...t,parsed_arguments:cU(n)?n.$parseRaw(t.arguments):n?.strict?JSON.parse(t.arguments):null}}function n_(e){const t=[];for(const n of e.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&t.push(r.text);e.output_text=t.join("")}var Di,Lc,Va,zc,LT,zT,DT,UT;class sy extends H_{constructor(t){super(),Di.add(this),Lc.set(this,void 0),Va.set(this,void 0),zc.set(this,void 0),ke(this,Lc,t)}static createResponse(t,n,r){const s=new sy(n);return s._run(()=>s._createOrRetrieveResponse(t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(t,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Z(this,Di,"m",LT).call(this);let o,u=null;"response_id"in n?(o=await t.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),u=n.starting_after??null):o=await t.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const f of o)Z(this,Di,"m",zT).call(this,f,u);if(o.controller.signal?.aborted)throw new Gn;return Z(this,Di,"m",DT).call(this)}[(Lc=new WeakMap,Va=new WeakMap,zc=new WeakMap,Di=new WeakSet,LT=function(){this.ended||ke(this,Va,void 0)},zT=function(n,r){if(this.ended)return;const s=(u,f)=>{(r==null||f.sequence_number>r)&&this._emit(u,f)},o=Z(this,Di,"m",UT).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const u=o.output[n.output_index];if(!u)throw new Ae(`missing output at index ${n.output_index}`);if(u.type==="message"){const f=u.content[n.content_index];if(!f)throw new Ae(`missing content at index ${n.content_index}`);if(f.type!=="output_text")throw new Ae(`expected content to be 'output_text', got ${f.type}`);s("response.output_text.delta",{...n,snapshot:f.text})}break}case"response.function_call_arguments.delta":{const u=o.output[n.output_index];if(!u)throw new Ae(`missing output at index ${n.output_index}`);u.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:u.arguments});break}default:s(n.type,n);break}},DT=function(){if(this.ended)throw new Ae("stream has ended, this shouldn't happen");const n=Z(this,Va,"f");if(!n)throw new Ae("request ended without sending any events");ke(this,Va,void 0);const r=hU(n,Z(this,Lc,"f"));return ke(this,zc,r),r},UT=function(n){let r=Z(this,Va,"f");if(!r){if(n.type!=="response.created")throw new Ae(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=ke(this,Va,n.response),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const s=r.output[n.output_index];if(!s)throw new Ae(`missing output at index ${n.output_index}`);const o=s.type,u=n.part;o==="message"&&u.type!=="reasoning_text"?s.content.push(u):o==="reasoning"&&u.type==="reasoning_text"&&(s.content||(s.content=[]),s.content.push(u));break}case"response.output_text.delta":{const s=r.output[n.output_index];if(!s)throw new Ae(`missing output at index ${n.output_index}`);if(s.type==="message"){const o=s.content[n.content_index];if(!o)throw new Ae(`missing content at index ${n.content_index}`);if(o.type!=="output_text")throw new Ae(`expected content to be 'output_text', got ${o.type}`);o.text+=n.delta}break}case"response.function_call_arguments.delta":{const s=r.output[n.output_index];if(!s)throw new Ae(`missing output at index ${n.output_index}`);s.type==="function_call"&&(s.arguments+=n.delta);break}case"response.reasoning_text.delta":{const s=r.output[n.output_index];if(!s)throw new Ae(`missing output at index ${n.output_index}`);if(s.type==="reasoning"){const o=s.content?.[n.content_index];if(!o)throw new Ae(`missing content at index ${n.content_index}`);if(o.type!=="reasoning_text")throw new Ae(`expected content to be 'reasoning_text', got ${o.type}`);o.text+=n.delta}break}case"response.completed":{ke(this,Va,n.response);break}}return r},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",s=>{const o=n.shift();o?o.resolve(s):t.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,u)=>n.push({resolve:o,reject:u})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=Z(this,zc,"f");if(!t)throw new Ae("stream ended without producing a ChatCompletion");return t}}function hU(e,t){return oU(e,t)}class VA extends Se{list(t,n={},r){return this._client.getAPIList(ae`/responses/${t}/input_items`,Tt,{query:n,...r})}}class JA extends Se{count(t={},n){return this._client.post("/responses/input_tokens",{body:t,...n})}}class _d extends Se{constructor(){super(...arguments),this.inputItems=new VA(this._client),this.inputTokens=new JA(this._client)}create(t,n){return this._client.post("/responses",{body:t,...n,stream:t.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&n_(r),r))}retrieve(t,n={},r){return this._client.get(ae`/responses/${t}`,{query:n,...r,stream:n?.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&n_(s),s))}delete(t,n){return this._client.delete(ae`/responses/${t}`,{...n,headers:pe([{Accept:"*/*"},n?.headers])})}parse(t,n){return this._client.responses.create(t,n)._thenUnwrap(r=>GA(r,t))}stream(t,n){return sy.createResponse(this._client,t,n)}cancel(t,n){return this._client.post(ae`/responses/${t}/cancel`,n)}compact(t,n){return this._client.post("/responses/compact",{body:t,...n})}}_d.InputItems=VA;_d.InputTokens=JA;let XA=class extends Se{retrieve(t,n){return this._client.get(ae`/skills/${t}/content`,{...n,headers:pe([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}};class YA extends Se{retrieve(t,n,r){const{skill_id:s}=n;return this._client.get(ae`/skills/${s}/versions/${t}/content`,{...r,headers:pe([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}}class iy extends Se{constructor(){super(...arguments),this.content=new YA(this._client)}create(t,n={},r){return this._client.post(ae`/skills/${t}/versions`,Pl({body:n,...r},this._client))}retrieve(t,n,r){const{skill_id:s}=n;return this._client.get(ae`/skills/${s}/versions/${t}`,r)}list(t,n={},r){return this._client.getAPIList(ae`/skills/${t}/versions`,Tt,{query:n,...r})}delete(t,n,r){const{skill_id:s}=n;return this._client.delete(ae`/skills/${s}/versions/${t}`,r)}}iy.Content=YA;class yd extends Se{constructor(){super(...arguments),this.content=new XA(this._client),this.versions=new iy(this._client)}create(t={},n){return this._client.post("/skills",Pl({body:t,...n},this._client))}retrieve(t,n){return this._client.get(ae`/skills/${t}`,n)}update(t,n,r){return this._client.post(ae`/skills/${t}`,{body:n,...r})}list(t={},n){return this._client.getAPIList("/skills",Tt,{query:t,...n})}delete(t,n){return this._client.delete(ae`/skills/${t}`,n)}}yd.Content=XA;yd.Versions=iy;class QA extends Se{create(t,n,r){return this._client.post(ae`/uploads/${t}/parts`,io({body:n,...r},this._client))}}class oy extends Se{constructor(){super(...arguments),this.parts=new QA(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(ae`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(ae`/uploads/${t}/complete`,{body:n,...r})}}oy.Parts=QA;const pU=async e=>{const t=await Promise.allSettled(e),n=t.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of t)s.status==="fulfilled"&&r.push(s.value);return r};class KA extends Se{create(t,n,r){return this._client.post(ae`/vector_stores/${t}/file_batches`,{body:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(t,n,r){const{vector_store_id:s}=n;return this._client.get(ae`/vector_stores/${s}/file_batches/${t}`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(t,n,r){const{vector_store_id:s}=n;return this._client.post(ae`/vector_stores/${s}/file_batches/${t}/cancel`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(t,n,r){const s=await this.create(t,n);return await this.poll(t,s.id,r)}listFiles(t,n,r){const{vector_store_id:s,...o}=n;return this._client.getAPIList(ae`/vector_stores/${s}/file_batches/${t}/files`,Tt,{query:o,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async poll(t,n,r){const s=pe([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:o,response:u}=await this.retrieve(n,{vector_store_id:t},{...r,headers:s}).withResponse();switch(o.status){case"in_progress":let f=5e3;if(r?.pollIntervalMs)f=r.pollIntervalMs;else{const d=u.headers.get("openai-poll-after-ms");if(d){const h=parseInt(d);isNaN(h)||(f=h)}}await Fl(f);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=s?.maxConcurrency??5,u=Math.min(o,n.length),f=this._client,d=n.values(),h=[...r];async function m(y){for(let v of y){const w=await f.files.create({file:v,purpose:"assistants"},s);h.push(w.id)}}const _=Array(u).fill(d).map(m);return await pU(_),await this.createAndPoll(t,{file_ids:h})}}class WA extends Se{create(t,n,r){return this._client.post(ae`/vector_stores/${t}/files`,{body:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(t,n,r){const{vector_store_id:s}=n;return this._client.get(ae`/vector_stores/${s}/files/${t}`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(t,n,r){const{vector_store_id:s,...o}=n;return this._client.post(ae`/vector_stores/${s}/files/${t}`,{body:o,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(t,n={},r){return this._client.getAPIList(ae`/vector_stores/${t}/files`,Tt,{query:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(t,n,r){const{vector_store_id:s}=n;return this._client.delete(ae`/vector_stores/${s}/files/${t}`,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(t,n,r){const s=await this.create(t,n,r);return await this.poll(t,s.id,r)}async poll(t,n,r){const s=pe([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){const o=await this.retrieve(n,{vector_store_id:t},{...r,headers:s}).withResponse(),u=o.data;switch(u.status){case"in_progress":let f=5e3;if(r?.pollIntervalMs)f=r.pollIntervalMs;else{const d=o.response.headers.get("openai-poll-after-ms");if(d){const h=parseInt(d);isNaN(h)||(f=h)}}await Fl(f);break;case"failed":case"completed":return u}}}async upload(t,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(t,{file_id:s.id},r)}async uploadAndPoll(t,n,r){const s=await this.upload(t,n,r);return await this.poll(t,s.id,r)}content(t,n,r){const{vector_store_id:s}=n;return this._client.getAPIList(ae`/vector_stores/${s}/files/${t}/content`,dd,{...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class vd extends Se{constructor(){super(...arguments),this.files=new WA(this._client),this.fileBatches=new KA(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,n){return this._client.get(ae`/vector_stores/${t}`,{...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,n,r){return this._client.post(ae`/vector_stores/${t}`,{body:n,...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(t={},n){return this._client.getAPIList("/vector_stores",Tt,{query:t,...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(t,n){return this._client.delete(ae`/vector_stores/${t}`,{...n,headers:pe([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}search(t,n,r){return this._client.getAPIList(ae`/vector_stores/${t}/search`,dd,{body:n,method:"post",...r,headers:pe([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}vd.Files=WA;vd.FileBatches=KA;class eC extends Se{create(t,n){return this._client.post("/videos",Pl({body:t,...n},this._client))}retrieve(t,n){return this._client.get(ae`/videos/${t}`,n)}list(t={},n){return this._client.getAPIList("/videos",Nf,{query:t,...n})}delete(t,n){return this._client.delete(ae`/videos/${t}`,n)}downloadContent(t,n={},r){return this._client.get(ae`/videos/${t}/content`,{query:n,...r,headers:pe([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}remix(t,n,r){return this._client.post(ae`/videos/${t}/remix`,Pl({body:n,...r},this._client))}}var Zi,tC,tf;class nC extends Se{constructor(){super(...arguments),Zi.add(this)}async unwrap(t,n,r=this._client.webhookSecret,s=300){return await this.verifySignature(t,n,r,s),JSON.parse(t)}async verifySignature(t,n,r=this._client.webhookSecret,s=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");Z(this,Zi,"m",tC).call(this,r);const o=pe([n]).values,u=Z(this,Zi,"m",tf).call(this,o,"webhook-signature"),f=Z(this,Zi,"m",tf).call(this,o,"webhook-timestamp"),d=Z(this,Zi,"m",tf).call(this,o,"webhook-id"),h=parseInt(f,10);if(isNaN(h))throw new ml("Invalid webhook timestamp format");const m=Math.floor(Date.now()/1e3);if(m-h>s)throw new ml("Webhook timestamp is too old");if(h>m+s)throw new ml("Webhook timestamp is too new");const _=u.split(" ").map(x=>x.startsWith("v1,")?x.substring(3):x),y=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),v=d?`${d}.${f}.${t}`:`${f}.${t}`,w=await crypto.subtle.importKey("raw",y,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const x of _)try{const R=Buffer.from(x,"base64");if(await crypto.subtle.verify("HMAC",w,R,new TextEncoder().encode(v)))return}catch{continue}throw new ml("The given webhook signature does not match the expected signature")}}Zi=new WeakSet,tC=function(t){if(typeof t!="string"||t.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},tf=function(t,n){if(!t)throw new Error("Headers are required");const r=t.get(n);if(r==null)throw new Error(`Missing required header: ${n}`);return r};var r_,ly,nf,rC;class Ue{constructor({baseURL:t=zi("OPENAI_BASE_URL"),apiKey:n=zi("OPENAI_API_KEY"),organization:r=zi("OPENAI_ORG_ID")??null,project:s=zi("OPENAI_PROJECT_ID")??null,webhookSecret:o=zi("OPENAI_WEBHOOK_SECRET")??null,...u}={}){if(r_.add(this),nf.set(this,void 0),this.completions=new NA(this),this.chat=new J_(this),this.embeddings=new $A(this),this.files=new jA(this),this.images=new BA(this),this.audio=new Gl(this),this.moderations=new qA(this),this.models=new ZA(this),this.fineTuning=new fo(this),this.graders=new ay(this),this.vectorStores=new vd(this),this.webhooks=new nC(this),this.beta=new co(this),this.batches=new SA(this),this.uploads=new oy(this),this.responses=new _d(this),this.realtime=new gd(this),this.conversations=new K_(this),this.evals=new ey(this),this.containers=new Q_(this),this.skills=new yd(this),this.videos=new eC(this),n===void 0)throw new Ae("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const f={apiKey:n,organization:r,project:s,webhookSecret:o,...u,baseURL:t||"https://api.openai.com/v1"};if(!f.dangerouslyAllowBrowser&&pD())throw new Ae(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=f.baseURL,this.timeout=f.timeout??ly.DEFAULT_TIMEOUT,this.logger=f.logger??console;const d="warn";this.logLevel=d,this.logLevel=ET(f.logLevel,"ClientOptions.logLevel",this)??ET(zi("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??d,this.fetchOptions=f.fetchOptions,this.maxRetries=f.maxRetries??2,this.fetch=f.fetch??vD(),ke(this,nf,wD),this._options=f,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=r,this.project=s,this.webhookSecret=o}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){}async authHeaders(t){return pe([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(t){return AD(t,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Pi}`}defaultIdempotencyKey(){return`stainless-node-retry-${TO()}`}makeStatusError(t,n,r,s){return nn.generate(t,n,r,s)}async _callApiKey(){const t=this._options.apiKey;if(typeof t!="function")return!1;let n;try{n=await t()}catch(r){throw r instanceof Ae?r:new Ae(`Failed to get token from 'apiKey' function: ${r.message}`,{cause:r})}if(typeof n!="string"||!n)throw new Ae(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(t,n,r){const s=!Z(this,r_,"m",rC).call(this)&&r||this.baseURL,o=uD(t)?new URL(t):new URL(s+(s.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),u=this.defaultQuery();return cD(u)||(n={...u,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(o.search=this.stringifyQuery(n)),o.toString()}async prepareOptions(t){await this._callApiKey()}async prepareRequest(t,{url:n,options:r}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(s=>({method:t,path:n,...s})))}request(t,n=null){return new fd(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,r){const s=await t,o=s.maxRetries??this.maxRetries;n==null&&(n=o),await this.prepareOptions(s);const{req:u,url:f,timeout:d}=await this.buildRequest(s,{retryCount:o-n});await this.prepareRequest(u,{url:f,options:s});const h="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=r===void 0?"":`, retryOf: ${r}`,_=Date.now();if(Wt(this).debug(`[${h}] sending request`,Is({retryOfRequestLogID:r,method:s.method,url:f,options:s,headers:u.headers})),s.signal?.aborted)throw new Gn;const y=new AbortController,v=await this.fetchWithTimeout(f,u,d,y).catch(Hg),w=Date.now();if(v instanceof globalThis.Error){const E=`retrying, ${n} attempts remaining`;if(s.signal?.aborted)throw new Gn;const A=Fg(v)||/timed? ?out/i.test(String(v)+("cause"in v?String(v.cause):""));if(n)return Wt(this).info(`[${h}] connection ${A?"timed out":"failed"} - ${E}`),Wt(this).debug(`[${h}] connection ${A?"timed out":"failed"} (${E})`,Is({retryOfRequestLogID:r,url:f,durationMs:w-_,message:v.message})),this.retryRequest(s,n,r??h);throw Wt(this).info(`[${h}] connection ${A?"timed out":"failed"} - error; no more retries left`),Wt(this).debug(`[${h}] connection ${A?"timed out":"failed"} (error; no more retries left)`,Is({retryOfRequestLogID:r,url:f,durationMs:w-_,message:v.message})),A?new ud:new ld({cause:v})}const x=[...v.headers.entries()].filter(([E])=>E==="x-request-id").map(([E,A])=>", "+E+": "+JSON.stringify(A)).join(""),R=`[${h}${m}${x}] ${u.method} ${f} ${v.ok?"succeeded":"failed"} with status ${v.status} in ${w-_}ms`;if(!v.ok){const E=await this.shouldRetry(v);if(n&&E){const W=`retrying, ${n} attempts remaining`;return await bD(v.body),Wt(this).info(`${R} - ${W}`),Wt(this).debug(`[${h}] response error (${W})`,Is({retryOfRequestLogID:r,url:v.url,status:v.status,headers:v.headers,durationMs:w-_})),this.retryRequest(s,n,r??h,v.headers)}const A=E?"error; no more retries left":"error; not retryable";Wt(this).info(`${R} - ${A}`);const N=await v.text().catch(W=>Hg(W).message),M=hD(N),B=M?void 0:N;throw Wt(this).debug(`[${h}] response error (${A})`,Is({retryOfRequestLogID:r,url:v.url,status:v.status,headers:v.headers,message:B,durationMs:Date.now()-_})),this.makeStatusError(v.status,M,B,v.headers)}return Wt(this).info(R),Wt(this).debug(`[${h}] response start`,Is({retryOfRequestLogID:r,url:v.url,status:v.status,headers:v.headers,durationMs:w-_})),{response:v,options:s,controller:y,requestLogID:h,retryOfRequestLogID:r,startTime:_}}getAPIList(t,n,r){return this.requestAPIList(n,r&&"then"in r?r.then(s=>({method:"get",path:t,...s})):{method:"get",path:t,...r})}requestAPIList(t,n){const r=this.makeRequest(n,null,void 0);return new LD(this,r,t)}async fetchWithTimeout(t,n,r,s){const{signal:o,method:u,...f}=n||{},d=this._makeAbort(s);o&&o.addEventListener("abort",d,{once:!0});const h=setTimeout(d,r),m=globalThis.ReadableStream&&f.body instanceof globalThis.ReadableStream||typeof f.body=="object"&&f.body!==null&&Symbol.asyncIterator in f.body,_={signal:s.signal,...m?{duplex:"half"}:{},method:"GET",...f};u&&(_.method=u.toUpperCase());try{return await this.fetch.call(void 0,t,_)}finally{clearTimeout(h)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r,s){let o;const u=s?.get("retry-after-ms");if(u){const d=parseFloat(u);Number.isNaN(d)||(o=d)}const f=s?.get("retry-after");if(f&&!o){const d=parseFloat(f);Number.isNaN(d)?o=Date.parse(f)-Date.now():o=d*1e3}if(!(o&&0<=o&&o<60*1e3)){const d=t.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,d)}return await Fl(o),this.makeRequest(t,n-1,r)}calculateDefaultRetryTimeoutMillis(t,n){const o=n-t,u=Math.min(.5*Math.pow(2,o),8),f=1-Math.random()*.25;return u*f*1e3}async buildRequest(t,{retryCount:n=0}={}){const r={...t},{method:s,path:o,query:u,defaultBaseURL:f}=r,d=this.buildURL(o,u,f);"timeout"in r&&dD("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:h,body:m}=this.buildBody({options:r}),_=await this.buildHeaders({options:t,method:s,bodyHeaders:h,retryCount:n});return{req:{method:s,headers:_,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"},...m&&{body:m},...this.fetchOptions??{},...r.fetchOptions??{}},url:d,timeout:r.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:r,retryCount:s}){let o={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const u=pe([o,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...yD(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(t),this._options.defaultHeaders,r,t.headers]);return this.validateHeaders(u),u.values}_makeAbort(t){return()=>t.abort()}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const r=pe([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&r.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:zO(t)}:typeof t=="object"&&r.values.get("content-type")==="application/x-www-form-urlencoded"?{bodyHeaders:{"content-type":"application/x-www-form-urlencoded"},body:this.stringifyQuery(t)}:Z(this,nf,"f").call(this,{body:t,headers:r})}}ly=Ue,nf=new WeakMap,r_=new WeakSet,rC=function(){return this.baseURL!=="https://api.openai.com/v1"};Ue.OpenAI=ly;Ue.DEFAULT_TIMEOUT=6e5;Ue.OpenAIError=Ae;Ue.APIError=nn;Ue.APIConnectionError=ld;Ue.APIConnectionTimeoutError=ud;Ue.APIUserAbortError=Gn;Ue.NotFoundError=CO;Ue.ConflictError=RO;Ue.RateLimitError=IO;Ue.BadRequestError=xO;Ue.AuthenticationError=OO;Ue.InternalServerError=kO;Ue.PermissionDeniedError=AO;Ue.UnprocessableEntityError=NO;Ue.InvalidWebhookSignatureError=ml;Ue.toFile=BD;Ue.Completions=NA;Ue.Chat=J_;Ue.Embeddings=$A;Ue.Files=jA;Ue.Images=BA;Ue.Audio=Gl;Ue.Moderations=qA;Ue.Models=ZA;Ue.FineTuning=fo;Ue.Graders=ay;Ue.VectorStores=vd;Ue.Webhooks=nC;Ue.Beta=co;Ue.Batches=SA;Ue.Uploads=oy;Ue.Responses=_d;Ue.Realtime=gd;Ue.Conversations=K_;Ue.Evals=ey;Ue.Containers=Q_;Ue.Skills=yd;Ue.Videos=eC;function mU(e){return!!(String(e).includes("context_length_exceeded")||"message"in e&&typeof e.message=="string"&&(e.message.includes("Input tokens exceed the configured limit")||e.message.includes("exceeds the context window")))}function uy(e){if(!e||typeof e!="object")return e;let t;return e.constructor.name===ud.name&&"message"in e&&typeof e.message=="string"?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===Gn.name&&"message"in e&&typeof e.message=="string"?(t=new Error(e.message),t.name="AbortError"):mU(e)?t=sk.fromError(e):"status"in e&&e.status===400&&"message"in e&&typeof e.message=="string"&&e.message.includes("tool_calls")?t=Nc(e,"INVALID_TOOL_RESULTS"):"status"in e&&e.status===401?t=Nc(e,"MODEL_AUTHENTICATION"):"status"in e&&e.status===429?t=Nc(e,"MODEL_RATE_LIMIT"):"status"in e&&e.status===404?t=Nc(e,"MODEL_NOT_FOUND"):t=e,t}const Bs=e=>e();function Vl(e){return e?!!(/^o\d/.test(e??"")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-chat")):!1}function gU(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function PT(e){return e.metadata?.filename??e.metadata?.name??e.metadata?.title}function Df(e){const t=e.metadata?.filename??e.metadata?.name??e.metadata?.title;if(!t)throw new Error("a filename or name or title is needed via meta-data for OpenAI when working with multimodal blocks");return t}function Jl(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":if(!g_.isInstance(e))throw new Error("Invalid generic chat message");return gU(e);default:throw new Error(`Unknown message type: ${t}`)}}function _U(e){return!!(e.includes("gpt-5.2-pro")||e.includes("codex"))}function yU(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:s,baseURL:o,azureADTokenProvider:u,azureOpenAIEndpoint:f}=e;if((r||u)&&s&&t)return`${s}/${t}`;if((r||u)&&f&&t)return`${f}/openai/deployments/${t}`;if(r||u){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function BT(e){return typeof Headers<"u"&&e!==null&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Headers]"}function vU(e){const t=Bs(()=>{if(BT(e))return e;if(Array.isArray(e))return new Headers(e);if(typeof e=="object"&&e!==null&&"values"in e&&BT(e.values))return e.values;if(typeof e=="object"&&e!==null){const n=Object.entries(e).filter(([,r])=>typeof r=="string").map(([r,s])=>[r,s]);return new Headers(n)}return new Headers});return Object.fromEntries(t.entries())}function bU(){let e=R1();return(e==="node"||e==="deno")&&(e=`(${e}/${process.version}; ${process.platform}; ${process.arch})`),e}function wU(e,t=!1,n="1.0.0"){const r=vU(e),s=bU(),o=`langchainjs${t?"-azure":""}-openai`;return{...r,"User-Agent":r["User-Agent"]?`${o}/${n} (${s})${r["User-Agent"]}`:`${o}/${n} (${s})`}}function SU(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function EU(e){return e!==void 0&&tn.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function TU(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&(Ls(e.schema)||e.schema!=null&&typeof e.schema=="object"&&"type"in e.schema&&typeof e.schema.type=="string"&&["null","boolean","object","array","number","string"].includes(e.schema.type))}function aC(e){return TU(e)||EU(e)||SU(e)}function xU(e,t){return{name:e.name,description:e.description,parameters:da(e.schema)}}function OU(e,t){let n;return aC(e)?n={type:"function",function:xU(e)}:n=e,n}function AU(e,t){let n;return aC(e)?n=OU(e):n=e,t?.strict!==void 0&&(n.function.strict=t.strict),n}function CU(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function RU(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(sC(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function sC(e,t){const n=[];for(const[r,s]of Object.entries(e.properties??{}))s.description&&t<2&&n.push(`// ${s.description}`),e.required?.includes(r)?n.push(`${r}: ${Uf(s,t)},`):n.push(`${r}?: ${Uf(s,t)},`);return n.map(r=>" ".repeat(t)+r).join(`
`)}function Uf(e,t){if(CU(e))return e.anyOf.map(n=>Uf(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",sC(e,t+2),"}"].join(`
`);case"array":return e.items?`${Uf(e.items,t)}[]`:"any[]";default:return""}}function iC(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function cy(e){return"type"in e&&e.type!=="function"}function NU(e){return typeof e=="object"&&e!==null&&"extras"in e&&typeof e.extras=="object"&&e.extras!==null&&"providerToolDefinition"in e.extras&&typeof e.extras.providerToolDefinition=="object"&&e.extras.providerToolDefinition!==null}function IU(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type!=="function"}function Pf(e){return typeof e=="object"&&e!==null&&"metadata"in e&&typeof e.metadata=="object"&&e.metadata!==null&&"customTool"in e.metadata&&typeof e.metadata.customTool=="object"&&e.metadata.customTool!==null}function oC(e){return"type"in e&&e.type==="custom"&&"custom"in e&&typeof e.custom=="object"&&e.custom!==null}function kU(e){if(e.type==="custom_tool_call")return{...e,type:"tool_call",call_id:e.id,id:e.call_id,name:e.name,isCustomTool:!0,args:{input:e.input}}}function $U(e){if(e.type==="computer_call")return{...e,type:"tool_call",call_id:e.id,id:e.call_id,name:"computer_use",isComputerTool:!0,args:{action:e.action}}}function MU(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="tool_call"&&"isComputerTool"in e&&e.isComputerTool===!0}function jU(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="tool_call"&&"isCustomTool"in e&&e.isCustomTool===!0}function LU(e){const t=()=>{if(e.custom.format){if(e.custom.format.type==="grammar")return{type:"grammar",definition:e.custom.format.grammar.definition,syntax:e.custom.format.grammar.syntax};if(e.custom.format.type==="text")return{type:"text"}}};return{type:"custom",name:e.custom.name,description:e.custom.description,format:t()}}function zU(e){const t=()=>{if(e.format){if(e.format.type==="grammar")return{type:"grammar",grammar:{definition:e.format.definition,syntax:e.format.syntax}};if(e.format.type==="text")return{type:"text"}}};return{type:"custom",custom:{name:e.name,description:e.description,format:t()}}}const DU=ee("ZodISODateTime",(e,t)=>{Uj.init(e,t),bt.init(e,t)});function UU(e){return qL(DU,e)}const PU=ee("ZodISODate",(e,t)=>{Pj.init(e,t),bt.init(e,t)});function BU(e){return FL(PU,e)}const ZU=ee("ZodISOTime",(e,t)=>{Bj.init(e,t),bt.init(e,t)});function qU(e){return HL(ZU,e)}const FU=ee("ZodISODuration",(e,t)=>{Zj.init(e,t),bt.init(e,t)});function HU(e){return GL(FU,e)}const GU=(e,t)=>{vx.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>k4(e,n)},flatten:{value:n=>I4(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,Cg,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,Cg,2)}},isEmpty:{get(){return e.issues.length===0}}})},cr=ee("ZodError",GU,{Parent:Error}),VU=ed(cr),JU=td(cr),XU=nd(cr),YU=rd(cr),QU=L4(cr),KU=z4(cr),WU=D4(cr),eP=U4(cr),tP=P4(cr),nP=B4(cr),rP=Z4(cr),aP=q4(cr),Ot=ee("ZodType",(e,t)=>(xt.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:wf(e,"input"),output:wf(e,"output")}}),e.toJSONSchema=fz(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(us(t,{checks:[...t.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),{parent:!0}),e.with=e.check,e.clone=(n,r)=>On(e,n,r),e.brand=()=>e,e.register=((n,r)=>(n.add(e,r),e)),e.parse=(n,r)=>VU(e,n,r,{callee:e.parse}),e.safeParse=(n,r)=>XU(e,n,r),e.parseAsync=async(n,r)=>JU(e,n,r,{callee:e.parseAsync}),e.safeParseAsync=async(n,r)=>YU(e,n,r),e.spa=e.safeParseAsync,e.encode=(n,r)=>QU(e,n,r),e.decode=(n,r)=>KU(e,n,r),e.encodeAsync=async(n,r)=>WU(e,n,r),e.decodeAsync=async(n,r)=>eP(e,n,r),e.safeEncode=(n,r)=>tP(e,n,r),e.safeDecode=(n,r)=>nP(e,n,r),e.safeEncodeAsync=async(n,r)=>rP(e,n,r),e.safeDecodeAsync=async(n,r)=>aP(e,n,r),e.refine=(n,r)=>e.check(QP(n,r)),e.superRefine=n=>e.check(KP(n)),e.overwrite=n=>e.check(uo(n)),e.optional=()=>HT(e),e.exactOptional=()=>DP(e),e.nullable=()=>GT(e),e.nullish=()=>HT(GT(e)),e.nonoptional=n=>FP(e,n),e.array=()=>Xl(e),e.or=n=>bd([e,n]),e.and=n=>IP(e,n),e.transform=n=>VT(e,LP(n)),e.default=n=>BP(e,n),e.prefault=n=>qP(e,n),e.catch=n=>GP(e,n),e.pipe=n=>VT(e,n),e.readonly=()=>XP(e),e.describe=n=>{const r=e.clone();return lr.add(r,{description:n}),r},Object.defineProperty(e,"description",{get(){return lr.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return lr.get(e);const r=e.clone();return lr.add(r,n[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=n=>n(e),e)),lC=ee("_ZodString",(e,t)=>{j_.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(r,s,o)=>zx(e,r,s);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...r)=>e.check(YL(...r)),e.includes=(...r)=>e.check(WL(...r)),e.startsWith=(...r)=>e.check(ez(...r)),e.endsWith=(...r)=>e.check(tz(...r)),e.min=(...r)=>e.check(_f(...r)),e.max=(...r)=>e.check(jx(...r)),e.length=(...r)=>e.check(Lx(...r)),e.nonempty=(...r)=>e.check(_f(1,...r)),e.lowercase=r=>e.check(QL(r)),e.uppercase=r=>e.check(KL(r)),e.trim=()=>e.check(rz()),e.normalize=(...r)=>e.check(nz(...r)),e.toLowerCase=()=>e.check(az()),e.toUpperCase=()=>e.check(sz()),e.slugify=()=>e.check(iz())}),sP=ee("ZodString",(e,t)=>{j_.init(e,t),lC.init(e,t),e.email=n=>e.check(SL(iP,n)),e.url=n=>e.check(AL(oP,n)),e.jwt=n=>e.check(ZL(SP,n)),e.emoji=n=>e.check(CL(lP,n)),e.guid=n=>e.check(DE(ZT,n)),e.uuid=n=>e.check(EL(Dc,n)),e.uuidv4=n=>e.check(TL(Dc,n)),e.uuidv6=n=>e.check(xL(Dc,n)),e.uuidv7=n=>e.check(OL(Dc,n)),e.nanoid=n=>e.check(RL(uP,n)),e.guid=n=>e.check(DE(ZT,n)),e.cuid=n=>e.check(NL(cP,n)),e.cuid2=n=>e.check(IL(fP,n)),e.ulid=n=>e.check(kL(dP,n)),e.base64=n=>e.check(UL(vP,n)),e.base64url=n=>e.check(PL(bP,n)),e.xid=n=>e.check($L(hP,n)),e.ksuid=n=>e.check(ML(pP,n)),e.ipv4=n=>e.check(jL(mP,n)),e.ipv6=n=>e.check(LL(gP,n)),e.cidrv4=n=>e.check(zL(_P,n)),e.cidrv6=n=>e.check(DL(yP,n)),e.e164=n=>e.check(BL(wP,n)),e.datetime=n=>e.check(UU(n)),e.date=n=>e.check(BU(n)),e.time=n=>e.check(qU(n)),e.duration=n=>e.check(HU(n))});function Hn(e){return wL(sP,e)}const bt=ee("ZodStringFormat",(e,t)=>{vt.init(e,t),lC.init(e,t)}),iP=ee("ZodEmail",(e,t)=>{Nj.init(e,t),bt.init(e,t)}),ZT=ee("ZodGUID",(e,t)=>{Cj.init(e,t),bt.init(e,t)}),Dc=ee("ZodUUID",(e,t)=>{Rj.init(e,t),bt.init(e,t)}),oP=ee("ZodURL",(e,t)=>{Ij.init(e,t),bt.init(e,t)}),lP=ee("ZodEmoji",(e,t)=>{kj.init(e,t),bt.init(e,t)}),uP=ee("ZodNanoID",(e,t)=>{$j.init(e,t),bt.init(e,t)}),cP=ee("ZodCUID",(e,t)=>{Mj.init(e,t),bt.init(e,t)}),fP=ee("ZodCUID2",(e,t)=>{jj.init(e,t),bt.init(e,t)}),dP=ee("ZodULID",(e,t)=>{Lj.init(e,t),bt.init(e,t)}),hP=ee("ZodXID",(e,t)=>{zj.init(e,t),bt.init(e,t)}),pP=ee("ZodKSUID",(e,t)=>{Dj.init(e,t),bt.init(e,t)}),mP=ee("ZodIPv4",(e,t)=>{qj.init(e,t),bt.init(e,t)}),gP=ee("ZodIPv6",(e,t)=>{Fj.init(e,t),bt.init(e,t)}),_P=ee("ZodCIDRv4",(e,t)=>{Hj.init(e,t),bt.init(e,t)}),yP=ee("ZodCIDRv6",(e,t)=>{Gj.init(e,t),bt.init(e,t)}),vP=ee("ZodBase64",(e,t)=>{Vj.init(e,t),bt.init(e,t)}),bP=ee("ZodBase64URL",(e,t)=>{Xj.init(e,t),bt.init(e,t)}),wP=ee("ZodE164",(e,t)=>{Yj.init(e,t),bt.init(e,t)}),SP=ee("ZodJWT",(e,t)=>{Kj.init(e,t),bt.init(e,t)}),uC=ee("ZodNumber",(e,t)=>{Rx.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(r,s,o)=>Dx(e,r,s),e.gt=(r,s)=>e.check(PE(r,s)),e.gte=(r,s)=>e.check(Qm(r,s)),e.min=(r,s)=>e.check(Qm(r,s)),e.lt=(r,s)=>e.check(UE(r,s)),e.lte=(r,s)=>e.check(Ym(r,s)),e.max=(r,s)=>e.check(Ym(r,s)),e.int=r=>e.check(qT(r)),e.safe=r=>e.check(qT(r)),e.positive=r=>e.check(PE(0,r)),e.nonnegative=r=>e.check(Qm(0,r)),e.negative=r=>e.check(UE(0,r)),e.nonpositive=r=>e.check(Ym(0,r)),e.multipleOf=(r,s)=>e.check(BE(r,s)),e.step=(r,s)=>e.check(BE(r,s)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function an(e){return VL(uC,e)}const EP=ee("ZodNumberFormat",(e,t)=>{Wj.init(e,t),uC.init(e,t)});function qT(e){return JL(EP,e)}const TP=ee("ZodUnknown",(e,t)=>{eL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Px()});function FT(){return XL(TP)}const xP=ee("ZodNever",(e,t)=>{Nx.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Ux(e,n,r)});function OP(e){return Mx(xP,e)}const AP=ee("ZodArray",(e,t)=>{tL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Hx(e,n,r,s),e.element=t.element,e.min=(n,r)=>e.check(_f(n,r)),e.nonempty=n=>e.check(_f(1,n)),e.max=(n,r)=>e.check(jx(n,r)),e.length=(n,r)=>e.check(Lx(n,r)),e.unwrap=()=>e.element});function Xl(e,t){return oz(AP,e,t)}const CP=ee("ZodObject",(e,t)=>{rL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Gx(e,n,r,s),lt(e,"shape",()=>t.shape),e.keyof=()=>fy(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:FT()}),e.loose=()=>e.clone({...e._zod.def,catchall:FT()}),e.strict=()=>e.clone({...e._zod.def,catchall:OP()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>O4(e,n),e.safeExtend=n=>A4(e,n),e.merge=n=>C4(e,n),e.pick=n=>T4(e,n),e.omit=n=>x4(e,n),e.partial=(...n)=>R4(cC,e,n[0]),e.required=(...n)=>N4(fC,e,n[0])});function sn(e,t){const n={type:"object",shape:e??{},...Ce(t)};return new CP(n)}const RP=ee("ZodUnion",(e,t)=>{aL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Vx(e,n,r,s),e.options=t.options});function bd(e,t){return new RP({type:"union",options:e,...Ce(t)})}const NP=ee("ZodIntersection",(e,t)=>{sL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Jx(e,n,r,s)});function IP(e,t){return new NP({type:"intersection",left:e,right:t})}const kP=ee("ZodRecord",(e,t)=>{iL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Xx(e,n,r,s),e.keyType=t.keyType,e.valueType=t.valueType});function $P(e,t,n){return new kP({type:"record",keyType:e,valueType:t,...Ce(n)})}const a_=ee("ZodEnum",(e,t)=>{oL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(r,s,o)=>Bx(e,r,s),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(r,s)=>{const o={};for(const u of r)if(n.has(u))o[u]=t.entries[u];else throw new Error(`Key ${u} not found in enum`);return new a_({...t,checks:[],...Ce(s),entries:o})},e.exclude=(r,s)=>{const o={...t.entries};for(const u of r)if(n.has(u))delete o[u];else throw new Error(`Key ${u} not found in enum`);return new a_({...t,checks:[],...Ce(s),entries:o})}});function fy(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(r=>[r,r])):e;return new a_({type:"enum",entries:n,...Ce(t)})}const MP=ee("ZodLiteral",(e,t)=>{lL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Zx(e,n,r),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function Yn(e,t){return new MP({type:"literal",values:Array.isArray(e)?e:[e],...Ce(t)})}const jP=ee("ZodTransform",(e,t)=>{uL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Fx(e,n),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new hx(e.constructor.name);n.addIssue=o=>{if(typeof o=="string")n.issues.push(zl(o,n.value,t));else{const u=o;u.fatal&&(u.continue=!1),u.code??(u.code="custom"),u.input??(u.input=n.value),u.inst??(u.inst=e),n.issues.push(zl(u))}};const s=t.transform(n.value,n);return s instanceof Promise?s.then(o=>(n.value=o,n)):(n.value=s,n)}});function LP(e){return new jP({type:"transform",transform:e})}const cC=ee("ZodOptional",(e,t)=>{$x.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>L_(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function HT(e){return new cC({type:"optional",innerType:e})}const zP=ee("ZodExactOptional",(e,t)=>{cL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>L_(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function DP(e){return new zP({type:"optional",innerType:e})}const UP=ee("ZodNullable",(e,t)=>{fL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Yx(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function GT(e){return new UP({type:"nullable",innerType:e})}const PP=ee("ZodDefault",(e,t)=>{dL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Kx(e,n,r,s),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function BP(e,t){return new PP({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():_x(t)}})}const ZP=ee("ZodPrefault",(e,t)=>{hL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Wx(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function qP(e,t){return new ZP({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():_x(t)}})}const fC=ee("ZodNonOptional",(e,t)=>{pL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Qx(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function FP(e,t){return new fC({type:"nonoptional",innerType:e,...Ce(t)})}const HP=ee("ZodCatch",(e,t)=>{mL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>eO(e,n,r,s),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function GP(e,t){return new HP({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const VP=ee("ZodPipe",(e,t)=>{gL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>tO(e,n,r,s),e.in=t.in,e.out=t.out});function VT(e,t){return new VP({type:"pipe",in:e,out:t})}const JP=ee("ZodReadonly",(e,t)=>{_L.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>nO(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function XP(e){return new JP({type:"readonly",innerType:e})}const YP=ee("ZodCustom",(e,t)=>{yL.init(e,t),Ot.init(e,t),e._zod.processJSONSchema=(n,r,s)=>qx(e,n)});function QP(e,t={}){return lz(YP,e,t)}function KP(e){return uz(e)}const WP=Symbol("Let zodToJsonSchema decide on which parser to use"),JT={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},e6=e=>typeof e=="string"?{...JT,basePath:["#"],definitions:{},name:e}:{...JT,basePath:["#"],definitions:{},...e},s_=e=>"_def"in e?e._def:e;function t6(e){if(!e)return!0;for(const t in e)return!1;return!0}const n6=e=>{const t=e6(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s_(s),{def:s_(s),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function dC(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function ot(e,t,n,r,s){e[t]=n,dC(e,t,r,s)}function r6(){return{}}function a6(e,t){const n={type:"array"};return e.type?._def?.typeName!==X.ZodAny&&(n.items=We(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&ot(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&ot(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(ot(n,"minItems",e.exactLength.value,e.exactLength.message,t),ot(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function s6(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?ot(n,"minimum",r.value,r.message,t):ot(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ot(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ot(n,"maximum",r.value,r.message,t):ot(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ot(n,"maximum",r.value,r.message,t));break;case"multipleOf":ot(n,"multipleOf",r.value,r.message,t);break}return n}function i6(){return{type:"boolean"}}function o6(e,t){return We(e.type._def,t)}const l6=(e,t)=>We(e.innerType._def,t);function hC(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,o)=>hC(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return u6(e,t)}}const u6=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":ot(n,"minimum",r.value,r.message,t);break;case"max":ot(n,"maximum",r.value,r.message,t);break}return n};function c6(e,t){return{...We(e.innerType._def,t),default:e.defaultValue()}}function f6(e,t,n){return t.effectStrategy==="input"?We(e.schema._def,t,n):{}}function d6(e){return{type:"string",enum:[...e.values]}}const h6=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function p6(e,t){const n=[We(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),We(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(o=>{if(h6(o))s.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let u=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:f,...d}=o;u=d}else r=void 0;s.push(u)}}),s.length?{allOf:s,...r}:void 0}function m6(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let cg;const Rs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(cg===void 0&&(cg=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),cg),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function pC(e,t){const n={type:"string"};function r(s){return t.patternStrategy==="escape"?g6(s):s}if(e.checks)for(const s of e.checks)switch(s.kind){case"min":ot(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,t);break;case"max":ot(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,t);break;case"email":switch(t.emailStrategy){case"format:email":yr(n,"email",s.message,t);break;case"format:idn-email":yr(n,"idn-email",s.message,t);break;case"pattern:zod":vr(n,Rs.email,s.message,t);break}break;case"url":yr(n,"uri",s.message,t);break;case"uuid":yr(n,"uuid",s.message,t);break;case"regex":vr(n,s.regex,s.message,t);break;case"cuid":vr(n,Rs.cuid,s.message,t);break;case"cuid2":vr(n,Rs.cuid2,s.message,t);break;case"startsWith":vr(n,RegExp(`^${r(s.value)}`),s.message,t);break;case"endsWith":vr(n,RegExp(`${r(s.value)}$`),s.message,t);break;case"datetime":yr(n,"date-time",s.message,t);break;case"date":yr(n,"date",s.message,t);break;case"time":yr(n,"time",s.message,t);break;case"duration":yr(n,"duration",s.message,t);break;case"length":ot(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,t),ot(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,t);break;case"includes":{vr(n,RegExp(r(s.value)),s.message,t);break}case"ip":{s.version!=="v6"&&yr(n,"ipv4",s.message,t),s.version!=="v4"&&yr(n,"ipv6",s.message,t);break}case"emoji":vr(n,Rs.emoji,s.message,t);break;case"ulid":{vr(n,Rs.ulid,s.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{yr(n,"binary",s.message,t);break}case"contentEncoding:base64":{ot(n,"contentEncoding","base64",s.message,t);break}case"pattern:zod":{vr(n,Rs.base64,s.message,t);break}}break}case"nanoid":vr(n,Rs.nanoid,s.message,t)}return n}const g6=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),yr=(e,t,n,r)=>{e.format||e.anyOf?.some(s=>s.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):ot(e,"format",t,n,r)},vr=(e,t,n,r)=>{e.pattern||e.allOf?.some(s=>s.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:XT(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):ot(e,"pattern",XT(t,r),n,r)},XT=(e,t)=>{const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},s=r.i?n.source.toLowerCase():n.source;let o="",u=!1,f=!1,d=!1;for(let h=0;h<s.length;h++){if(u){o+=s[h],u=!1;continue}if(r.i){if(f){if(s[h].match(/[a-z]/)){d?(o+=s[h],o+=`${s[h-2]}-${s[h]}`.toUpperCase(),d=!1):s[h+1]==="-"&&s[h+2]?.match(/[a-z]/)?(o+=s[h],d=!0):o+=`${s[h]}${s[h].toUpperCase()}`;continue}}else if(s[h].match(/[a-z]/)){o+=`[${s[h]}${s[h].toUpperCase()}]`;continue}}if(r.m){if(s[h]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(s[h]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&s[h]==="."){o+=f?`${s[h]}\r
`:`[${s[h]}\r
]`;continue}o+=s[h],s[h]==="\\"?u=!0:f&&s[h]==="]"?f=!1:!f&&s[h]==="["&&(f=!0)}try{const h=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function mC(e,t){if(t.target==="openApi3"&&e.keyType?._def.typeName===X.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,s)=>({...r,[s]:We(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",s]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:We(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(e.keyType?._def.typeName===X.ZodString&&e.keyType._def.checks?.length){const r=Object.entries(pC(e.keyType._def,t)).reduce((s,[o,u])=>o==="type"?s:{...s,[o]:u},{});return{...n,propertyNames:r}}else if(e.keyType?._def.typeName===X.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function _6(e,t){if(t.mapStrategy==="record")return mC(e,t);const n=We(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=We(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function y6(e){const t=e.values,r=Object.keys(e.values).filter(o=>typeof t[t[o]]!="number").map(o=>t[o]),s=Array.from(new Set(r.map(o=>typeof o)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function v6(){return{not:{}}}function b6(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Bf={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function w6(e,t){if(t.target==="openApi3")return YT(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Bf&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,o)=>{const u=Bf[o._def.typeName];return u&&!s.includes(u)?[...s,u]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,o)=>{const u=typeof o._def.value;switch(u){case"string":case"number":case"boolean":return[...s,u];case"bigint":return[...s,"integer"];case"object":if(o._def.value===null)return[...s,"null"];default:return s}},[]);if(r.length===n.length){const s=r.filter((o,u,f)=>f.indexOf(o)===u);return{type:s.length>1?s:s[0],enum:n.reduce((o,u)=>o.includes(u._def.value)?o:[...o,u._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(o=>!r.includes(o))],[])};return YT(e,t)}const YT=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>We(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function S6(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:Bf[e.innerType._def.typeName],nullable:!0}:{type:[Bf[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=We(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=We(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function E6(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",dC(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?ot(n,"minimum",r.value,r.message,t):ot(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ot(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ot(n,"maximum",r.value,r.message,t):ot(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ot(n,"maximum",r.value,r.message,t));break;case"multipleOf":ot(n,"multipleOf",r.value,r.message,t);break}return n}function T6(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":We(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":We(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function x6(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[s,o])=>{if(o===void 0||o._def===void 0)return r;const u=[...t.currentPath,"properties",s],f=We(o._def,{...t,currentPath:u,propertyPath:u});if(f===void 0)return r;if(t.openaiStrictMode&&o.isOptional()&&!o.isNullable()&&typeof o._def?.defaultValue>"u")throw new Error(`Zod field at \`${u.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);return{properties:{...r.properties,[s]:f},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,s]}},{properties:{},required:[]}),additionalProperties:T6(e,t)};return n.required.length||delete n.required,n}const O6=(e,t)=>{if(t.propertyPath&&t.currentPath.slice(0,t.propertyPath.length).toString()===t.propertyPath.toString())return We(e.innerType._def,{...t,currentPath:t.currentPath});const n=We(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},A6=(e,t)=>{if(t.pipeStrategy==="input")return We(e.in._def,t);if(t.pipeStrategy==="output")return We(e.out._def,t);const n=We(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=We(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function C6(e,t){return We(e.type._def,t)}function R6(e,t){const r={type:"array",uniqueItems:!0,items:We(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&ot(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&ot(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function N6(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>We(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:We(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>We(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function I6(){return{not:{}}}function k6(){return{}}const $6=(e,t)=>We(e.innerType._def,t);function We(e,t,n=!1){const r=t.seen.get(e);if(t.override){const u=t.override?.(e,t,r,n);if(u!==WP)return u}if(r&&!n){const u=M6(r,t);if(u!==void 0)return"$ref"in u&&t.seenRefs.add(u.$ref),u}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const o=L6(e,e.typeName,t,n);return o&&z6(e,t,o),s.jsonSchema=o,o}const M6=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:j6(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,s)=>t.currentPath[s]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},j6=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},L6=(e,t,n,r)=>{switch(t){case X.ZodString:return pC(e,n);case X.ZodNumber:return E6(e,n);case X.ZodObject:return x6(e,n);case X.ZodBigInt:return s6(e,n);case X.ZodBoolean:return i6();case X.ZodDate:return hC(e,n);case X.ZodUndefined:return I6();case X.ZodNull:return b6(n);case X.ZodArray:return a6(e,n);case X.ZodUnion:case X.ZodDiscriminatedUnion:return w6(e,n);case X.ZodIntersection:return p6(e,n);case X.ZodTuple:return N6(e,n);case X.ZodRecord:return mC(e,n);case X.ZodLiteral:return m6(e,n);case X.ZodEnum:return d6(e);case X.ZodNativeEnum:return y6(e);case X.ZodNullable:return S6(e,n);case X.ZodOptional:return O6(e,n);case X.ZodMap:return _6(e,n);case X.ZodSet:return R6(e,n);case X.ZodLazy:return We(e.getter()._def,n);case X.ZodPromise:return C6(e,n);case X.ZodNaN:case X.ZodNever:return v6();case X.ZodEffects:return f6(e,n,r);case X.ZodAny:return r6();case X.ZodUnknown:return k6();case X.ZodDefault:return c6(e,n);case X.ZodBranded:return o6(e,n);case X.ZodReadonly:return $6(e,n);case X.ZodCatch:return l6(e,n);case X.ZodPipeline:return A6(e,n);case X.ZodFunction:case X.ZodVoid:case X.ZodSymbol:return;default:return(s=>{})()}},z6=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),D6=(e,t)=>{const n=n6(t),r=typeof t=="string"?t:t?.nameStrategy==="title"?void 0:t?.name,s=We(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(s.title=o);const u=(()=>{if(t6(n.definitions))return;const d={},h=new Set;for(let m=0;m<500;m++){const _=Object.entries(n.definitions).filter(([y])=>!h.has(y));if(_.length===0)break;for(const[y,v]of _)d[y]=We(s_(v),{...n,currentPath:[...n.basePath,n.definitionPath,y]},!0)??{},h.add(y)}return d})(),f=r===void 0?u?{...s,[n.definitionPath]:u}:s:n.nameStrategy==="duplicate-ref"?{...s,...u||n.seenRefs.size?{[n.definitionPath]:{...u,...n.seenRefs.size?{[r]:s}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...u,[r]:s}};return n.target==="jsonSchema7"?f.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(f.$schema="https://json-schema.org/draft/2019-09/schema#"),f};function U6(e){if(e.type!=="object")throw new Error(`Root schema must have type: 'object' but got type: ${e.type?`'${e.type}'`:"undefined"}`);const t=structuredClone(e);return ca(t,[],t)}function i_(e){if(typeof e=="boolean")return!1;if(e.type==="null")return!0;for(const t of e.oneOf??[])if(i_(t))return!0;for(const t of e.anyOf??[])if(i_(t))return!0;return!1}function ca(e,t,n){if(typeof e=="boolean")throw new TypeError(`Expected object schema but got boolean; path=${t.join("/")}`);if(!ks(e))throw new TypeError(`Expected ${JSON.stringify(e)} to be an object; path=${t.join("/")}`);const r=e.$defs;if(ks(r))for(const[y,v]of Object.entries(r))ca(v,[...t,"$defs",y],n);const s=e.definitions;if(ks(s))for(const[y,v]of Object.entries(s))ca(v,[...t,"definitions",y],n);e.type==="object"&&!("additionalProperties"in e)&&(e.additionalProperties=!1);const u=e.required??[],f=e.properties;if(ks(f)){for(const[y,v]of Object.entries(f))if(!i_(v)&&!u.includes(y))throw new Error(`Zod field at \`${[...t,"properties",y].join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);e.required=Object.keys(f),e.properties=Object.fromEntries(Object.entries(f).map(([y,v])=>[y,ca(v,[...t,"properties",y],n)]))}const d=e.items;ks(d)&&(e.items=ca(d,[...t,"items"],n));const h=e.anyOf;Array.isArray(h)&&(e.anyOf=h.map((y,v)=>ca(y,[...t,"anyOf",String(v)],n)));const m=e.allOf;if(Array.isArray(m))if(m.length===1){const y=ca(m[0],[...t,"allOf","0"],n);Object.assign(e,y),delete e.allOf}else e.allOf=m.map((y,v)=>ca(y,[...t,"allOf",String(v)],n));e.default===null&&delete e.default;const _=e.$ref;if(_&&B6(e,1)){if(typeof _!="string")throw new TypeError(`Received non-string $ref - ${_}; path=${t.join("/")}`);const y=P6(n,_);if(typeof y=="boolean")throw new Error(`Expected \`$ref: ${_}\` to resolve to an object schema but got boolean`);if(!ks(y))throw new Error(`Expected \`$ref: ${_}\` to resolve to an object but got ${JSON.stringify(y)}`);return Object.assign(e,{...y,...e}),delete e.$ref,ca(e,t,n)}return e}function P6(e,t){if(!t.startsWith("#/"))throw new Error(`Unexpected $ref format ${JSON.stringify(t)}; Does not start with #/`);const n=t.slice(2).split("/");let r=e;for(const s of n){if(!ks(r))throw new Error(`encountered non-object entry while resolving ${t} - ${JSON.stringify(r)}`);const o=r[s];if(o===void 0)throw new Error(`Key ${s} not found while resolving ${t}`);r=o}return r}function ks(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function B6(e,t){let n=0;for(const r in e)if(n++,n>t)return!0;return!1}function Z6(e,t){return D6(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function q6(e){return U6(Ng(e,{target:"draft-7"}))}function F6(e){return"_zod"in e}function H6(e,t,n){return FD({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:F6(e)?q6(e):Z6(e,{name:t})}},r=>e.parse(JSON.parse(r)))}const QT=["jsonSchema","functionCalling","jsonMode"];function G6(e,t){if(typeof t<"u"&&!QT.includes(t))throw new Error(`Invalid method: ${t}. Supported methods are: ${QT.join(", ")}`);const n=!e.startsWith("gpt-3")&&!e.startsWith("gpt-4-")&&e!=="gpt-4";if(n&&!t)return"jsonSchema";if(!n&&t==="jsonSchema")throw new Error(`JSON Schema is not supported for model "${e}". Please use a different method, e.g. "functionCalling" or "jsonMode".`);return t??"functionCalling"}function V6(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function J6(e,t,n){if(Br(e))return H6(e,t,n);if(Xn(e))return V6({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:da(e,{cycles:"ref",reused:"ref",override(r){r.jsonSchema.title=t}})}},r=>$4(e,JSON.parse(r)));throw new Error("Unsupported schema response format")}function X6(e,t){if(t&&typeof t=="object"&&"images"in t&&Array.isArray(t.images)){const n=t.images.filter(r=>typeof r?.image_url?.url=="string").map(r=>({type:"image",url:r.image_url.url}));return[{type:"text",text:e},...n]}return e}const Y6={"gpt-4o-2024-11-20":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.3-codex":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-codex":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-pro":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:272e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o-mini":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"text-embedding-ada-002":{maxInputTokens:8192,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1536,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-chat-latest":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"codex-mini-latest":{maxInputTokens:2e5,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.1-codex-max":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o-2024-05-13":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:4096,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.2-chat-latest":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.2-codex":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o3-deep-research":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},o1:{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.1":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o4-mini-deep-research":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.3-codex-spark":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},o3:{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"text-embedding-3-small":{maxInputTokens:8191,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1536,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4.1-nano":{maxInputTokens:1047576,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"text-embedding-3-large":{maxInputTokens:8191,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:3072,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-3.5-turbo":{maxInputTokens:16385,imageInputs:!1,audioInputs:!1,pdfInputs:!1,videoInputs:!1,maxOutputTokens:4096,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!1,imageUrlInputs:!1,pdfToolMessage:!1,imageToolMessage:!1,toolChoice:!0},"gpt-5.1-codex-mini":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.2":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4.1":{maxInputTokens:1047576,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o3-pro":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4-turbo":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:4096,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o4-mini":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4.1-mini":{maxInputTokens:1047576,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o1-preview":{maxInputTokens:128e3,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o1-pro":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.1-codex":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.2-pro":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o3-mini":{maxInputTokens:2e5,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o-2024-08-06":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-mini":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5.1-chat-latest":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4":{maxInputTokens:8192,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:8192,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-nano":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o1-mini":{maxInputTokens:128e3,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:65536,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0}};var _e="0123456789abcdef".split(""),Q6=[-2147483648,8388608,32768,128],br=[24,16,8,0],Uc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ft=[];function Or(e,t){t?(Ft[0]=Ft[16]=Ft[1]=Ft[2]=Ft[3]=Ft[4]=Ft[5]=Ft[6]=Ft[7]=Ft[8]=Ft[9]=Ft[10]=Ft[11]=Ft[12]=Ft[13]=Ft[14]=Ft[15]=0,this.blocks=Ft):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}Or.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if(n!=="string"){if(n==="object"){if(e===null)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(e)))throw new Error(ERROR)}else throw new Error(ERROR);t=!0}for(var r,s=0,o,u=e.length,f=this.blocks;s<u;){if(this.hashed&&(this.hashed=!1,f[0]=this.block,this.block=f[16]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=0),t)for(o=this.start;s<u&&o<64;++s)f[o>>>2]|=e[s]<<br[o++&3];else for(o=this.start;s<u&&o<64;++s)r=e.charCodeAt(s),r<128?f[o>>>2]|=r<<br[o++&3]:r<2048?(f[o>>>2]|=(192|r>>>6)<<br[o++&3],f[o>>>2]|=(128|r&63)<<br[o++&3]):r<55296||r>=57344?(f[o>>>2]|=(224|r>>>12)<<br[o++&3],f[o>>>2]|=(128|r>>>6&63)<<br[o++&3],f[o>>>2]|=(128|r&63)<<br[o++&3]):(r=65536+((r&1023)<<10|e.charCodeAt(++s)&1023),f[o>>>2]|=(240|r>>>18)<<br[o++&3],f[o>>>2]|=(128|r>>>12&63)<<br[o++&3],f[o>>>2]|=(128|r>>>6&63)<<br[o++&3],f[o>>>2]|=(128|r&63)<<br[o++&3]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.block=f[16],this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Or.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>>2]|=Q6[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}};Or.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,s=this.h4,o=this.h5,u=this.h6,f=this.h7,d=this.blocks,h,m,_,y,v,w,x,R,E,A,N;for(h=16;h<64;++h)v=d[h-15],m=(v>>>7|v<<25)^(v>>>18|v<<14)^v>>>3,v=d[h-2],_=(v>>>17|v<<15)^(v>>>19|v<<13)^v>>>10,d[h]=d[h-16]+m+d[h-7]+_<<0;for(N=t&n,h=0;h<64;h+=4)this.first?(this.is224?(R=300032,v=d[0]-1413257819,f=v-150054599<<0,r=v+24177077<<0):(R=704751109,v=d[0]-210244248,f=v-1521486534<<0,r=v+143694565<<0),this.first=!1):(m=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),_=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),R=e&t,y=R^e&n^N,x=s&o^~s&u,v=f+_+x+Uc[h]+d[h],w=m+y,f=r+v<<0,r=v+w<<0),m=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),_=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7),E=r&e,y=E^r&t^R,x=u&f^~u&s,v=o+_+x+Uc[h+1]+d[h+1],w=m+y,u=n+v<<0,n=v+w<<0,m=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),_=(u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7),A=n&r,y=A^n&e^E,x=o&u^~o&f,v=s+_+x+Uc[h+2]+d[h+2],w=m+y,o=t+v<<0,t=v+w<<0,m=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),_=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),N=t&n,y=N^t&r^A,x=o&u^~o&f,v=s+_+x+Uc[h+3]+d[h+3],w=m+y,s=e+v<<0,e=v+w<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+s<<0,this.h5=this.h5+o<<0,this.h6=this.h6+u<<0,this.h7=this.h7+f<<0};Or.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,s=this.h4,o=this.h5,u=this.h6,f=this.h7,d=_e[e>>>28&15]+_e[e>>>24&15]+_e[e>>>20&15]+_e[e>>>16&15]+_e[e>>>12&15]+_e[e>>>8&15]+_e[e>>>4&15]+_e[e&15]+_e[t>>>28&15]+_e[t>>>24&15]+_e[t>>>20&15]+_e[t>>>16&15]+_e[t>>>12&15]+_e[t>>>8&15]+_e[t>>>4&15]+_e[t&15]+_e[n>>>28&15]+_e[n>>>24&15]+_e[n>>>20&15]+_e[n>>>16&15]+_e[n>>>12&15]+_e[n>>>8&15]+_e[n>>>4&15]+_e[n&15]+_e[r>>>28&15]+_e[r>>>24&15]+_e[r>>>20&15]+_e[r>>>16&15]+_e[r>>>12&15]+_e[r>>>8&15]+_e[r>>>4&15]+_e[r&15]+_e[s>>>28&15]+_e[s>>>24&15]+_e[s>>>20&15]+_e[s>>>16&15]+_e[s>>>12&15]+_e[s>>>8&15]+_e[s>>>4&15]+_e[s&15]+_e[o>>>28&15]+_e[o>>>24&15]+_e[o>>>20&15]+_e[o>>>16&15]+_e[o>>>12&15]+_e[o>>>8&15]+_e[o>>>4&15]+_e[o&15]+_e[u>>>28&15]+_e[u>>>24&15]+_e[u>>>20&15]+_e[u>>>16&15]+_e[u>>>12&15]+_e[u>>>8&15]+_e[u>>>4&15]+_e[u&15];return this.is224||(d+=_e[f>>>28&15]+_e[f>>>24&15]+_e[f>>>20&15]+_e[f>>>16&15]+_e[f>>>12&15]+_e[f>>>8&15]+_e[f>>>4&15]+_e[f&15]),d};Or.prototype.toString=Or.prototype.hex;Or.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,s=this.h4,o=this.h5,u=this.h6,f=this.h7,d=[e>>>24&255,e>>>16&255,e>>>8&255,e&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255,s>>>24&255,s>>>16&255,s>>>8&255,s&255,o>>>24&255,o>>>16&255,o>>>8&255,o&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255];return this.is224||d.push(f>>>24&255,f>>>16&255,f>>>8&255,f&255),d};Or.prototype.array=Or.prototype.digest;Or.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e};const K6=(...e)=>new Or(!1,!0).update(e.join("")).hex(),W6=(...e)=>K6(e.join("_"));var e5=class{keyEncoder=W6;makeDefaultKeyEncoder(e){this.keyEncoder=e}};const t5=new Map;var n5=class gC extends e5{cache;constructor(t){super(),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(this.keyEncoder(t,n))??null)}async update(t,n,r){this.cache.set(this.keyEncoder(t,n),r)}static global(){return new gC(t5)}},_C=class extends Nl{},r5=class extends _C{static lc_name(){return"StringPromptValue"}lc_namespace=["langchain_core","prompt_values"];lc_serializable=!0;value;constructor(e){super({value:e}),this.value=e}toString(){return this.value}toChatMessages(){return[new Gs(this.value)]}},a5=class extends _C{lc_namespace=["langchain_core","prompt_values"];lc_serializable=!0;static lc_name(){return"ChatPromptValue"}messages;constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),this.messages=e.messages}toString(){return A1(this.messages)}toChatMessages(){return this.messages}},cl={},KT;function s5(){if(KT)return cl;KT=1,cl.byteLength=f,cl.toByteArray=h,cl.fromByteArray=y;for(var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=r.length;s<o;++s)e[s]=r[s],t[r.charCodeAt(s)]=s;t[45]=62,t[95]=63;function u(v){var w=v.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=v.indexOf("=");x===-1&&(x=w);var R=x===w?0:4-x%4;return[x,R]}function f(v){var w=u(v),x=w[0],R=w[1];return(x+R)*3/4-R}function d(v,w,x){return(w+x)*3/4-x}function h(v){var w,x=u(v),R=x[0],E=x[1],A=new n(d(v,R,E)),N=0,M=E>0?R-4:R,B;for(B=0;B<M;B+=4)w=t[v.charCodeAt(B)]<<18|t[v.charCodeAt(B+1)]<<12|t[v.charCodeAt(B+2)]<<6|t[v.charCodeAt(B+3)],A[N++]=w>>16&255,A[N++]=w>>8&255,A[N++]=w&255;return E===2&&(w=t[v.charCodeAt(B)]<<2|t[v.charCodeAt(B+1)]>>4,A[N++]=w&255),E===1&&(w=t[v.charCodeAt(B)]<<10|t[v.charCodeAt(B+1)]<<4|t[v.charCodeAt(B+2)]>>2,A[N++]=w>>8&255,A[N++]=w&255),A}function m(v){return e[v>>18&63]+e[v>>12&63]+e[v>>6&63]+e[v&63]}function _(v,w,x){for(var R,E=[],A=w;A<x;A+=3)R=(v[A]<<16&16711680)+(v[A+1]<<8&65280)+(v[A+2]&255),E.push(m(R));return E.join("")}function y(v){for(var w,x=v.length,R=x%3,E=[],A=16383,N=0,M=x-R;N<M;N+=A)E.push(_(v,N,N+A>M?M:N+A));return R===1?(w=v[x-1],E.push(e[w>>2]+e[w<<4&63]+"==")):R===2&&(w=(v[x-2]<<8)+v[x-1],E.push(e[w>>10]+e[w>>4&63]+e[w<<2&63]+"=")),E.join("")}return cl}var i5=s5();const o5=Ff(i5);var l5=Object.defineProperty,u5=(e,t,n)=>t in e?l5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,c5=(e,t,n)=>(u5(e,t+"",n),n);function f5(e,t){let n=Array.from({length:e.length},(r,s)=>({start:s,end:s+1}));for(;n.length>1;){let r=null;for(let s=0;s<n.length-1;s++){const o=e.slice(n[s].start,n[s+1].end),u=t.get(o.join(","));u!=null&&(r==null||u<r[0])&&(r=[u,s])}if(r!=null){const s=r[1];n[s]={start:n[s].start,end:n[s+1].end},n.splice(s+1,1)}else break}return n}function d5(e,t){return e.length===1?[t.get(e.join(","))]:f5(e,t).map(n=>t.get(e.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function h5(e){return e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var o_=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(e,t){this.patStr=e.pat_str;const n=e.bpe_ranks.split(`
`).filter(Boolean).reduce((r,s)=>{const[o,u,...f]=s.split(" "),d=Number.parseInt(u,10);return f.forEach((h,m)=>r[h]=d+m),r},{});for(const[r,s]of Object.entries(n)){const o=o5.toByteArray(r);this.rankMap.set(o.join(","),s),this.textMap.set(s,o)}this.specialTokens={...e.special_tokens,...t},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[s,o])=>(r[o]=this.textEncoder.encode(s),r),{})}encode(e,t=[],n="all"){const r=new RegExp(this.patStr,"ug"),s=o_.specialTokenRegex(Object.keys(this.specialTokens)),o=[],u=new Set(t==="all"?Object.keys(this.specialTokens):t),f=new Set(n==="all"?Object.keys(this.specialTokens).filter(h=>!u.has(h)):n);if(f.size>0){const h=o_.specialTokenRegex([...f]),m=e.match(h);if(m!=null)throw new Error(`The text contains a special token that is not allowed: ${m[0]}`)}let d=0;for(;;){let h=null,m=d;for(;s.lastIndex=m,h=s.exec(e),!(h==null||u.has(h[0]));)m=h.index+1;const _=h?.index??e.length;for(const v of e.substring(d,_).matchAll(r)){const w=this.textEncoder.encode(v[0]),x=this.rankMap.get(w.join(","));if(x!=null){o.push(x);continue}o.push(...d5(w,this.rankMap))}if(h==null)break;let y=this.specialTokens[h[0]];o.push(y),d=h.index+h[0].length}return o}decode(e){const t=[];let n=0;for(let o=0;o<e.length;++o){const u=e[o],f=this.textMap.get(u)??this.inverseSpecialTokens[u];f!=null&&(t.push(f),n+=f.length)}const r=new Uint8Array(n);let s=0;for(const o of t)r.set(o,s),s+=o.length;return this.textDecoder.decode(r)}},yC=o_;c5(yC,"specialTokenRegex",e=>new RegExp(e.map(t=>h5(t)).join("|"),"g"));function p5(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":case"gpt-5":case"gpt-5-2025-08-07":case"gpt-5-nano":case"gpt-5-nano-2025-08-07":case"gpt-5-mini":case"gpt-5-mini-2025-08-07":case"gpt-5-chat-latest":return"o200k_base";default:throw new Error("Unknown model")}}const Pc={},m5=new R_({});async function g5(e){return e in Pc||(Pc[e]=m5.fetch(`https://tiktoken.pages.dev/js/${e}.json`).then(t=>t.json()).then(t=>new yC(t)).catch(t=>{throw delete Pc[e],t})),await Pc[e]}async function _5(e){return g5(p5(e))}const y5=e=>e.startsWith("gpt-5")?"gpt-5":e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function vC(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const v5=()=>!1;var b5=class extends tn{verbose;callbacks;tags;metadata;get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),this.verbose=e.verbose??v5(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}},w5=class extends b5{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}caller;cache;constructor({callbacks:e,callbackManager:t,...n}){const{cache:r,...s}=n;super({callbacks:e??t,...s}),typeof r=="object"?this.cache=r:r?this.cache=n5.global():this.cache=void 0,this.caller=new R_(n??{})}_encoding;async getNumTokens(e){let t;typeof e=="string"?t=e:t=e.map(r=>typeof r=="string"?r:r.type==="text"&&"text"in r?r.text:"").join("");let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await _5("modelName"in this?y5(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(e){return typeof e=="string"?new r5(e):Array.isArray(e)?new a5(e.map(Zc)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const n={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([r,s])=>s!==void 0).map(([r,s])=>`${r}:${JSON.stringify(s)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}get profile(){return{}}},Zf=class extends tn{static lc_name(){return"RunnablePassthrough"}lc_namespace=["langchain_core","runnables"];lc_serializable=!0;func;constructor(e){super(e),e&&(this.func=e.func)}async invoke(e,t){const n=st(t);return this.func&&await this.func(e,n),this._callWithConfig(r=>Promise.resolve(r),e,n)}async*transform(e,t){const n=st(t);let r,s=!0;for await(const o of this._transformStreamWithConfig(e,u=>u,n))if(yield o,s)if(r===void 0)r=o;else try{r=Kf(r,o)}catch{r=void 0,s=!1}this.func&&r!==void 0&&await this.func(r,n)}static assign(e){return new EO(new id({steps:e}))}};const S5=e=>e();function fg(e){const t=e.constructor;return new t({...e,content:e.contentBlocks,response_metadata:{...e.response_metadata,output_version:"v1"}})}function dg(e){const t=[];for(const n of e){let r=n;if(Array.isArray(n.content))for(let s=0;s<n.content.length;s++){const o=n.content[s];(i1(o)||o1(o))&&r===n&&(r=new n.constructor({...r,content:[...n.content.slice(0,s),oI(o),...n.content.slice(s+1)]}))}t.push(r)}return t}var E5=class $s extends w5{lc_namespace=["langchain","chat_models",this._llmType()];disableStreaming=!1;outputVersion;get callKeys(){return[...super.callKeys,"outputVersion"]}constructor(t){super(t),this.outputVersion=S5(()=>{const n=t.outputVersion??ha("LC_OUTPUT_VERSION");return n&&["v0","v1"].includes(n)?n:"v0"})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=$s._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n?.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){if(this._streamResponseChunks===$s.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(t,n);else{const r=$s._convertInputToPromptValue(t).toChatMessages(),[s,o]=this._separateRunnableConfigFromCallOptionsCompat(n),u={...s.metadata,...this.getLsParams(o)},f=await ma.configure(s.callbacks,this.callbacks,s.tags,this.tags,u,this.metadata,{verbose:this.verbose}),d={options:o,invocation_params:this?.invocationParams(o),batch_size:1},h=o.outputVersion??this.outputVersion,m=await f?.handleChatModelStart(this.toJSON(),[dg(r)],s.runId,void 0,d,void 0,void 0,s.runName);let _,y;try{for await(const v of this._streamResponseChunks(r,o,m?.[0])){if(o.signal?.throwIfAborted(),v.message.id==null){const w=m?.at(0)?.runId;w!=null&&v.message._updateId(`run-${w}`)}v.message.response_metadata={...v.generationInfo,...v.message.response_metadata},h==="v1"?yield fg(v.message):yield v.message,_?_=_.concat(v):_=v,qw(v.message)&&v.message.usage_metadata!==void 0&&(y={tokenUsage:{promptTokens:v.message.usage_metadata.input_tokens,completionTokens:v.message.usage_metadata.output_tokens,totalTokens:v.message.usage_metadata.total_tokens}})}o.signal?.throwIfAborted()}catch(v){throw await Promise.all((m??[]).map(w=>w?.handleLLMError(v))),v}await Promise.all((m??[]).map(v=>v?.handleLLMEnd({generations:[[_]],llmOutput:y})))}}getLsParams(t){const n=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:t.stop,ls_provider:n}}async _generateUncached(t,n,r,s){const o=t.map(_=>_.map(Zc));let u;if(s!==void 0&&s.length===o.length)u=s;else{const _={...r.metadata,...this.getLsParams(n)},y=await ma.configure(r.callbacks,this.callbacks,r.tags,this.tags,_,this.metadata,{verbose:this.verbose}),v={options:n,invocation_params:this?.invocationParams(n),batch_size:1};u=await y?.handleChatModelStart(this.toJSON(),o.map(dg),r.runId,void 0,v,void 0,void 0,r.runName)}const f=n.outputVersion??this.outputVersion,d=[],h=[];if(u?.[0].handlers.find($k)&&!this.disableStreaming&&o.length===1&&this._streamResponseChunks!==$s.prototype._streamResponseChunks)try{const _=await this._streamResponseChunks(o[0],n,u?.[0]);let y,v;for await(const w of _){if(n.signal?.aborted){const x=y?.message;throw new Bw("Model invocation was aborted.",x)}if(w.message.id==null){const x=u?.at(0)?.runId;x!=null&&w.message._updateId(`run-${x}`)}y===void 0?y=w:y=Kf(y,w),qw(w.message)&&w.message.usage_metadata!==void 0&&(v={tokenUsage:{promptTokens:w.message.usage_metadata.input_tokens,completionTokens:w.message.usage_metadata.output_tokens,totalTokens:w.message.usage_metadata.total_tokens}})}if(n.signal?.aborted){const w=y?.message;throw new Bw("Model invocation was aborted.",w)}if(y===void 0)throw new Error("Received empty response from chat model call.");d.push([y]),await u?.[0].handleLLMEnd({generations:d,llmOutput:v})}catch(_){throw await u?.[0].handleLLMError(_),_}else{const _=await Promise.allSettled(o.map(async(y,v)=>{const w=await this._generate(y,{...n,promptIndex:v},u?.[v]);if(f==="v1")for(const x of w.generations)x.message=fg(x.message);return w}));await Promise.all(_.map(async(y,v)=>{if(y.status==="fulfilled"){const w=y.value;for(const x of w.generations){if(x.message.id==null){const R=u?.at(0)?.runId;R!=null&&x.message._updateId(`run-${R}`)}x.message.response_metadata={...x.generationInfo,...x.message.response_metadata}}return w.generations.length===1&&(w.generations[0].message.response_metadata={...w.llmOutput,...w.generations[0].message.response_metadata}),d[v]=w.generations,h[v]=w.llmOutput,u?.[v]?.handleLLMEnd({generations:[w.generations],llmOutput:w.llmOutput})}else return await u?.[v]?.handleLLMError(y.reason),Promise.reject(y.reason)}))}const m={generations:d,llmOutput:h.length?this._combineLLMOutput?.(...h):void 0};return Object.defineProperty(m,TE,{value:u?{runIds:u?.map(_=>_.runId)}:void 0,configurable:!0}),m}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:s,handledOptions:o}){const u=t.map(R=>R.map(Zc)),f={...o.metadata,...this.getLsParams(s)},d=await ma.configure(o.callbacks,this.callbacks,o.tags,this.tags,f,this.metadata,{verbose:this.verbose}),h={options:s,invocation_params:this?.invocationParams(s),batch_size:1},m=await d?.handleChatModelStart(this.toJSON(),u.map(dg),o.runId,void 0,h,void 0,void 0,o.runName),_=[],y=(await Promise.allSettled(u.map(async(R,E)=>{const A=$s._convertInputToPromptValue(R).toString(),N=await n.lookup(A,r);return N==null&&_.push(E),N}))).map((R,E)=>({result:R,runManager:m?.[E]})).filter(({result:R})=>R.status==="fulfilled"&&R.value!=null||R.status==="rejected"),v=s.outputVersion??this.outputVersion,w=[];await Promise.all(y.map(async({result:R,runManager:E},A)=>{if(R.status==="fulfilled"){const N=R.value;return w[A]=N.map(M=>("message"in M&&f_(M.message)&&__(M.message)&&(M.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0},v==="v1"&&(M.message=fg(M.message))),M.generationInfo={...M.generationInfo,tokenUsage:{}},M)),N.length&&await E?.handleLLMNewToken(N[0].text),E?.handleLLMEnd({generations:[N]},void 0,void 0,void 0,{cached:!0})}else return await E?.handleLLMError(R.reason,void 0,void 0,void 0,{cached:!0}),Promise.reject(R.reason)}));const x={generations:w,missingPromptIndices:_,startedRunManagers:m};return Object.defineProperty(x,TE,{value:m?{runIds:m?.map(R=>R.runId)}:void 0,configurable:!0}),x}async generate(t,n,r){let s;Array.isArray(n)?s={stop:n}:s=n;const o=t.map(w=>w.map(Zc)),[u,f]=this._separateRunnableConfigFromCallOptionsCompat(s);if(u.callbacks=u.callbacks??r,!this.cache)return this._generateUncached(o,f,u);const{cache:d}=this,h=this._getSerializedCacheKeyParametersForCall(f),{generations:m,missingPromptIndices:_,startedRunManagers:y}=await this._generateCached({messages:o,cache:d,llmStringKey:h,parsedOptions:f,handledOptions:u});let v={};if(_.length>0){const w=await this._generateUncached(_.map(x=>o[x]),f,u,y!==void 0?_.map(x=>y?.[x]):void 0);await Promise.all(w.generations.map(async(x,R)=>{const E=_[R];m[E]=x;const A=$s._convertInputToPromptValue(o[E]).toString();return d.update(A,h,x)})),v=w.llmOutput??{}}return{generations:m,llmOutput:v}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}async generatePrompt(t,n,r){const s=t.map(o=>o.toChatMessages());return this.generate(s,n,r)}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(n?.strict)throw new Error('"strict" mode is not supported for this model by default.');const r=t,s=n?.name,o=z_(r)??"A function available to call.",u=n?.method,f=n?.includeRaw;if(u==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let d=s??"extract",h;Ls(r)?h=[{type:"function",function:{name:d,description:o,parameters:da(r)}}]:("name"in r&&(d=r.name),h=[{type:"function",function:{name:d,description:o,parameters:r}}]);const m=this.bindTools(h),_=od.from(x=>{if(!Vs.isInstance(x))throw new Error("Input is not an AIMessageChunk.");if(!x.tool_calls||x.tool_calls.length===0)throw new Error("No tool calls found in the response.");const R=x.tool_calls.find(E=>E.name===d);if(!R)throw new Error(`No tool call found with name ${d}.`);return R.args});if(!f)return m.pipe(_).withConfig({runName:"StructuredOutput"});const y=Zf.assign({parsed:(x,R)=>_.invoke(x.raw,R)}),v=Zf.assign({parsed:()=>null}),w=y.withFallbacks({fallbacks:[v]});return sd.from([{raw:m},w]).withConfig({runName:"StructuredOutputRunnable"})}},T5=class extends tn{parseResultWithPrompt(e,t,n){return this.parseResult(e,n)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(n,r)=>this.parseResult([{text:n}],r?.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(n,r)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],r?.callbacks),e,{...t,runType:"parser"})}},bC=class extends T5{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}},dy=class extends Error{llmOutput;observation;sendToLLM;constructor(e,t,n,r=!1){if(super(e),this.llmOutput=t,this.observation=n,this.sendToLLM=r,r&&(n===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");v1(this,"OUTPUT_PARSING_FAILURE")}},x5=class extends bC{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}},wC=class extends x5{diff=!1;constructor(e){super(e),this.diff=e?.diff??this.diff}async*_transform(e){let t,n;for await(const r of e){if(typeof r!="string"&&typeof r.content!="string")throw new Error("Cannot handle non-string output.");let s;if(BI(r)){if(typeof r.content!="string")throw new Error("Cannot handle non-string message output.");s=new Ll({message:r,text:r.content})}else if(f_(r)){if(typeof r.content!="string")throw new Error("Cannot handle non-string message output.");s=new Ll({message:dk(r),text:r.content})}else s=new pf({text:r});n===void 0?n=s:n=n.concat(s);const o=await this.parsePartialResult([n]);o!=null&&!Bg(o,t)&&(this.diff?yield this._diff(t,o):yield o,t=o)}}getFormatInstructions(){return""}},WT=class extends bC{static lc_name(){return"StructuredOutputParser"}lc_namespace=["langchain","output_parsers","structured"];toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),this.schema=e}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const t=fO(Object.fromEntries(Object.entries(e).map(([n,r])=>[n,cO().describe(r)])));return new this(t)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(da(this.schema))}
\`\`\`
`}async parse(e){try{const t=e.trim(),n=(t.match(/^```(?:json)?\s*([\s\S]*?)```/)?.[1]||t.match(/```json\s*([\s\S]*?)```/)?.[1]||t).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,s)=>`"${s.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await rO(this.schema,JSON.parse(n))}catch(t){throw new dy(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}},e1=class extends wC{static lc_name(){return"JsonOutputParser"}lc_namespace=["langchain_core","output_parsers"];lc_serializable=!0;_concatOutputChunks(e,t){return this.diff?super._concatOutputChunks(e,t):t}_diff(e,t){if(t)return e?t4(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return Zw(e[0].text)}async parse(e){return Zw(e,JSON.parse)}getFormatInstructions(){return""}_baseMessageToString(e){return e.text}};const O5=function(){const e={};e.parser=function(O,S){return new n(O,S)},e.SAXParser=n,e.SAXStream=h,e.createStream=d,e.MAX_BUFFER_LENGTH=64*1024;const t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(O,S){if(!(this instanceof n))return new n(O,S);var Q=this;s(Q),Q.q=Q.c="",Q.bufferCheckPosition=e.MAX_BUFFER_LENGTH,Q.opt=S||{},Q.opt.lowercase=Q.opt.lowercase||Q.opt.lowercasetags,Q.looseCase=Q.opt.lowercase?"toLowerCase":"toUpperCase",Q.tags=[],Q.closed=Q.closedRoot=Q.sawRoot=!1,Q.tag=Q.error=null,Q.strict=!!O,Q.noscript=!!(O||Q.opt.noscript),Q.state=C.BEGIN,Q.strictEntities=Q.opt.strictEntities,Q.ENTITIES=Q.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),Q.attribList=[],Q.opt.xmlns&&(Q.ns=Object.create(w)),Q.trackPosition=Q.opt.position!==!1,Q.trackPosition&&(Q.position=Q.line=Q.column=0),xe(Q,"onready")}Object.create||(Object.create=function(O){function S(){}return S.prototype=O,new S}),Object.keys||(Object.keys=function(O){var S=[];for(var Q in O)O.hasOwnProperty(Q)&&S.push(Q);return S});function r(O){for(var S=Math.max(e.MAX_BUFFER_LENGTH,10),Q=0,L=0,Pe=t.length;L<Pe;L++){var nt=O[t[L]].length;if(nt>S)switch(t[L]){case"textNode":Je(O);break;case"cdata":me(O,"oncdata",O.cdata),O.cdata="";break;case"script":me(O,"onscript",O.script),O.script="";break;default:ue(O,"Max buffer length exceeded: "+t[L])}Q=Math.max(Q,nt)}O.bufferCheckPosition=e.MAX_BUFFER_LENGTH-Q+O.position}function s(O){for(var S=0,Q=t.length;S<Q;S++)O[t[S]]=""}function o(O){Je(O),O.cdata!==""&&(me(O,"oncdata",O.cdata),O.cdata=""),O.script!==""&&(me(O,"onscript",O.script),O.script="")}n.prototype={end:function(){se(this)},write:he,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){o(this)}};var u=ReadableStream;u||(u=function(){});var f=e.EVENTS.filter(function(O){return O!=="error"&&O!=="end"});function d(O,S){return new h(O,S)}function h(O,S){if(!(this instanceof h))return new h(O,S);u.apply(this),this._parser=new n(O,S),this.writable=!0,this.readable=!0;var Q=this;this._parser.onend=function(){Q.emit("end")},this._parser.onerror=function(L){Q.emit("error",L),Q._parser.error=null},this._decoder=null,f.forEach(function(L){Object.defineProperty(Q,"on"+L,{get:function(){return Q._parser["on"+L]},set:function(Pe){if(!Pe)return Q.removeAllListeners(L),Q._parser["on"+L]=Pe,Pe;Q.on(L,Pe)},enumerable:!0,configurable:!1})})}h.prototype=Object.create(u.prototype,{constructor:{value:h}}),h.prototype.write=function(O){return this._parser.write(O.toString()),this.emit("data",O),!0},h.prototype.end=function(O){return O&&O.length&&this.write(O),this._parser.end(),!0},h.prototype.on=function(O,S){var Q=this;return!Q._parser["on"+O]&&f.indexOf(O)!==-1&&(Q._parser["on"+O]=function(){var L=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);L.splice(0,0,O),Q.emit.apply(Q,L)}),u.prototype.on.call(Q,O,S)};var m="[CDATA[",_="DOCTYPE",y="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",w={xml:y,xmlns:v},x=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,E=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,A=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function N(O){return O===" "||O===`
`||O==="\r"||O==="	"}function M(O){return O==='"'||O==="'"}function B(O){return O===">"||N(O)}function Y(O,S){return O.test(S)}function W(O,S){return!Y(O,S)}var C=0;e.STATE={BEGIN:C++,BEGIN_WHITESPACE:C++,TEXT:C++,TEXT_ENTITY:C++,OPEN_WAKA:C++,SGML_DECL:C++,SGML_DECL_QUOTED:C++,DOCTYPE:C++,DOCTYPE_QUOTED:C++,DOCTYPE_DTD:C++,DOCTYPE_DTD_QUOTED:C++,COMMENT_STARTING:C++,COMMENT:C++,COMMENT_ENDING:C++,COMMENT_ENDED:C++,CDATA:C++,CDATA_ENDING:C++,CDATA_ENDING_2:C++,PROC_INST:C++,PROC_INST_BODY:C++,PROC_INST_ENDING:C++,OPEN_TAG:C++,OPEN_TAG_SLASH:C++,ATTRIB:C++,ATTRIB_NAME:C++,ATTRIB_NAME_SAW_WHITE:C++,ATTRIB_VALUE:C++,ATTRIB_VALUE_QUOTED:C++,ATTRIB_VALUE_CLOSED:C++,ATTRIB_VALUE_UNQUOTED:C++,ATTRIB_VALUE_ENTITY_Q:C++,ATTRIB_VALUE_ENTITY_U:C++,CLOSE_TAG:C++,CLOSE_TAG_SAW_WHITE:C++,SCRIPT:C++,SCRIPT_ENDING:C++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(O){var S=e.ENTITIES[O],Q=typeof S=="number"?String.fromCharCode(S):S;e.ENTITIES[O]=Q});for(var Te in e.STATE)e.STATE[e.STATE[Te]]=Te;C=e.STATE;function xe(O,S,Q){O[S]&&O[S](Q)}function me(O,S,Q){O.textNode&&Je(O),xe(O,S,Q)}function Je(O){O.textNode=At(O.opt,O.textNode),O.textNode&&xe(O,"ontext",O.textNode),O.textNode=""}function At(O,S){return O.trim&&(S=S.trim()),O.normalize&&(S=S.replace(/\s+/g," ")),S}function ue(O,S){return Je(O),O.trackPosition&&(S+=`
Line: `+O.line+`
Column: `+O.column+`
Char: `+O.c),S=new Error(S),O.error=S,xe(O,"onerror",S),O}function se(O){return O.sawRoot&&!O.closedRoot&&$(O,"Unclosed root tag"),O.state!==C.BEGIN&&O.state!==C.BEGIN_WHITESPACE&&O.state!==C.TEXT&&ue(O,"Unexpected end"),Je(O),O.c="",O.closed=!0,xe(O,"onend"),n.call(O,O.strict,O.opt),O}function $(O,S){if(typeof O!="object"||!(O instanceof n))throw new Error("bad call to strictFail");O.strict&&ue(O,S)}function F(O){O.strict||(O.tagName=O.tagName[O.looseCase]());var S=O.tags[O.tags.length-1]||O,Q=O.tag={name:O.tagName,attributes:{}};O.opt.xmlns&&(Q.ns=S.ns),O.attribList.length=0,me(O,"onopentagstart",Q)}function ne(O,S){var Q=O.indexOf(":")<0?["",O]:O.split(":"),L=Q[0],Pe=Q[1];return S&&O==="xmlns"&&(L="xmlns",Pe=""),{prefix:L,local:Pe}}function oe(O){if(O.strict||(O.attribName=O.attribName[O.looseCase]()),O.attribList.indexOf(O.attribName)!==-1||O.tag.attributes.hasOwnProperty(O.attribName)){O.attribName=O.attribValue="";return}if(O.opt.xmlns){var S=ne(O.attribName,!0),Q=S.prefix,L=S.local;if(Q==="xmlns")if(L==="xml"&&O.attribValue!==y)$(O,"xml: prefix must be bound to "+y+`
Actual: `+O.attribValue);else if(L==="xmlns"&&O.attribValue!==v)$(O,"xmlns: prefix must be bound to "+v+`
Actual: `+O.attribValue);else{var Pe=O.tag,nt=O.tags[O.tags.length-1]||O;Pe.ns===nt.ns&&(Pe.ns=Object.create(nt.ns)),Pe.ns[L]=O.attribValue}O.attribList.push([O.attribName,O.attribValue])}else O.tag.attributes[O.attribName]=O.attribValue,me(O,"onattribute",{name:O.attribName,value:O.attribValue});O.attribName=O.attribValue=""}function fe(O,S){if(O.opt.xmlns){var Q=O.tag,L=ne(O.tagName);Q.prefix=L.prefix,Q.local=L.local,Q.uri=Q.ns[L.prefix]||"",Q.prefix&&!Q.uri&&($(O,"Unbound namespace prefix: "+JSON.stringify(O.tagName)),Q.uri=L.prefix);var Pe=O.tags[O.tags.length-1]||O;Q.ns&&Pe.ns!==Q.ns&&Object.keys(Q.ns).forEach(function(Ys){me(O,"onopennamespace",{prefix:Ys,uri:Q.ns[Ys]})});for(var nt=0,Nt=O.attribList.length;nt<Nt;nt++){var Bt=O.attribList[nt],zt=Bt[0],fr=Bt[1],It=ne(zt,!0),Zr=It.prefix,Yl=It.local,Xs=Zr===""?"":Q.ns[Zr]||"",cs={name:zt,value:fr,prefix:Zr,local:Yl,uri:Xs};Zr&&Zr!=="xmlns"&&!Xs&&($(O,"Unbound namespace prefix: "+JSON.stringify(Zr)),cs.uri=Zr),O.tag.attributes[zt]=cs,me(O,"onattribute",cs)}O.attribList.length=0}O.tag.isSelfClosing=!!S,O.sawRoot=!0,O.tags.push(O.tag),me(O,"onopentag",O.tag),S||(!O.noscript&&O.tagName.toLowerCase()==="script"?O.state=C.SCRIPT:O.state=C.TEXT,O.tag=null,O.tagName=""),O.attribName=O.attribValue="",O.attribList.length=0}function I(O){if(!O.tagName){$(O,"Weird empty close tag."),O.textNode+="</>",O.state=C.TEXT;return}if(O.script){if(O.tagName!=="script"){O.script+="</"+O.tagName+">",O.tagName="",O.state=C.SCRIPT;return}me(O,"onscript",O.script),O.script=""}var S=O.tags.length,Q=O.tagName;O.strict||(Q=Q[O.looseCase]());for(var L=Q;S--&&O.tags[S].name!==L;)$(O,"Unexpected close tag");if(S<0){$(O,"Unmatched closing tag: "+O.tagName),O.textNode+="</"+O.tagName+">",O.state=C.TEXT;return}O.tagName=Q;for(var Pe=O.tags.length;Pe-- >S;){var nt=O.tag=O.tags.pop();O.tagName=O.tag.name,me(O,"onclosetag",O.tagName);var Nt={};for(var Bt in nt.ns)Nt[Bt]=nt.ns[Bt];var zt=O.tags[O.tags.length-1]||O;O.opt.xmlns&&nt.ns!==zt.ns&&Object.keys(nt.ns).forEach(function(fr){var It=nt.ns[fr];me(O,"onclosenamespace",{prefix:fr,uri:It})})}S===0&&(O.closedRoot=!0),O.tagName=O.attribValue=O.attribName="",O.attribList.length=0,O.state=C.TEXT}function D(O){var S=O.entity,Q=S.toLowerCase(),L,Pe="";return O.ENTITIES[S]?O.ENTITIES[S]:O.ENTITIES[Q]?O.ENTITIES[Q]:(S=Q,S.charAt(0)==="#"&&(S.charAt(1)==="x"?(S=S.slice(2),L=parseInt(S,16),Pe=L.toString(16)):(S=S.slice(1),L=parseInt(S,10),Pe=L.toString(10))),S=S.replace(/^0+/,""),isNaN(L)||Pe.toLowerCase()!==S?($(O,"Invalid character entity"),"&"+O.entity+";"):String.fromCodePoint(L))}function V(O,S){S==="<"?(O.state=C.OPEN_WAKA,O.startTagPosition=O.position):N(S)||($(O,"Non-whitespace before first tag."),O.textNode=S,O.state=C.TEXT)}function ie(O,S){var Q="";return S<O.length&&(Q=O.charAt(S)),Q}function he(O){var S=this;if(this.error)throw this.error;if(S.closed)return ue(S,"Cannot write after close. Assign an onready handler.");if(O===null)return se(S);typeof O=="object"&&(O=O.toString());for(var Q=0,L="";L=ie(O,Q++),S.c=L,!!L;)switch(S.trackPosition&&(S.position++,L===`
`?(S.line++,S.column=0):S.column++),S.state){case C.BEGIN:if(S.state=C.BEGIN_WHITESPACE,L==="\uFEFF")continue;V(S,L);continue;case C.BEGIN_WHITESPACE:V(S,L);continue;case C.TEXT:if(S.sawRoot&&!S.closedRoot){for(var Pe=Q-1;L&&L!=="<"&&L!=="&";)L=ie(O,Q++),L&&S.trackPosition&&(S.position++,L===`
`?(S.line++,S.column=0):S.column++);S.textNode+=O.substring(Pe,Q-1)}L==="<"&&!(S.sawRoot&&S.closedRoot&&!S.strict)?(S.state=C.OPEN_WAKA,S.startTagPosition=S.position):(!N(L)&&(!S.sawRoot||S.closedRoot)&&$(S,"Text data outside of root node."),L==="&"?S.state=C.TEXT_ENTITY:S.textNode+=L);continue;case C.SCRIPT:L==="<"?S.state=C.SCRIPT_ENDING:S.script+=L;continue;case C.SCRIPT_ENDING:L==="/"?S.state=C.CLOSE_TAG:(S.script+="<"+L,S.state=C.SCRIPT);continue;case C.OPEN_WAKA:if(L==="!")S.state=C.SGML_DECL,S.sgmlDecl="";else if(!N(L))if(Y(x,L))S.state=C.OPEN_TAG,S.tagName=L;else if(L==="/")S.state=C.CLOSE_TAG,S.tagName="";else if(L==="?")S.state=C.PROC_INST,S.procInstName=S.procInstBody="";else{if($(S,"Unencoded <"),S.startTagPosition+1<S.position){var nt=S.position-S.startTagPosition;L=new Array(nt).join(" ")+L}S.textNode+="<"+L,S.state=C.TEXT}continue;case C.SGML_DECL:(S.sgmlDecl+L).toUpperCase()===m?(me(S,"onopencdata"),S.state=C.CDATA,S.sgmlDecl="",S.cdata=""):S.sgmlDecl+L==="--"?(S.state=C.COMMENT,S.comment="",S.sgmlDecl=""):(S.sgmlDecl+L).toUpperCase()===_?(S.state=C.DOCTYPE,(S.doctype||S.sawRoot)&&$(S,"Inappropriately located doctype declaration"),S.doctype="",S.sgmlDecl=""):L===">"?(me(S,"onsgmldeclaration",S.sgmlDecl),S.sgmlDecl="",S.state=C.TEXT):(M(L)&&(S.state=C.SGML_DECL_QUOTED),S.sgmlDecl+=L);continue;case C.SGML_DECL_QUOTED:L===S.q&&(S.state=C.SGML_DECL,S.q=""),S.sgmlDecl+=L;continue;case C.DOCTYPE:L===">"?(S.state=C.TEXT,me(S,"ondoctype",S.doctype),S.doctype=!0):(S.doctype+=L,L==="["?S.state=C.DOCTYPE_DTD:M(L)&&(S.state=C.DOCTYPE_QUOTED,S.q=L));continue;case C.DOCTYPE_QUOTED:S.doctype+=L,L===S.q&&(S.q="",S.state=C.DOCTYPE);continue;case C.DOCTYPE_DTD:S.doctype+=L,L==="]"?S.state=C.DOCTYPE:M(L)&&(S.state=C.DOCTYPE_DTD_QUOTED,S.q=L);continue;case C.DOCTYPE_DTD_QUOTED:S.doctype+=L,L===S.q&&(S.state=C.DOCTYPE_DTD,S.q="");continue;case C.COMMENT:L==="-"?S.state=C.COMMENT_ENDING:S.comment+=L;continue;case C.COMMENT_ENDING:L==="-"?(S.state=C.COMMENT_ENDED,S.comment=At(S.opt,S.comment),S.comment&&me(S,"oncomment",S.comment),S.comment=""):(S.comment+="-"+L,S.state=C.COMMENT);continue;case C.COMMENT_ENDED:L!==">"?($(S,"Malformed comment"),S.comment+="--"+L,S.state=C.COMMENT):S.state=C.TEXT;continue;case C.CDATA:L==="]"?S.state=C.CDATA_ENDING:S.cdata+=L;continue;case C.CDATA_ENDING:L==="]"?S.state=C.CDATA_ENDING_2:(S.cdata+="]"+L,S.state=C.CDATA);continue;case C.CDATA_ENDING_2:L===">"?(S.cdata&&me(S,"oncdata",S.cdata),me(S,"onclosecdata"),S.cdata="",S.state=C.TEXT):L==="]"?S.cdata+="]":(S.cdata+="]]"+L,S.state=C.CDATA);continue;case C.PROC_INST:L==="?"?S.state=C.PROC_INST_ENDING:N(L)?S.state=C.PROC_INST_BODY:S.procInstName+=L;continue;case C.PROC_INST_BODY:if(!S.procInstBody&&N(L))continue;L==="?"?S.state=C.PROC_INST_ENDING:S.procInstBody+=L;continue;case C.PROC_INST_ENDING:L===">"?(me(S,"onprocessinginstruction",{name:S.procInstName,body:S.procInstBody}),S.procInstName=S.procInstBody="",S.state=C.TEXT):(S.procInstBody+="?"+L,S.state=C.PROC_INST_BODY);continue;case C.OPEN_TAG:Y(R,L)?S.tagName+=L:(F(S),L===">"?fe(S):L==="/"?S.state=C.OPEN_TAG_SLASH:(N(L)||$(S,"Invalid character in tag name"),S.state=C.ATTRIB));continue;case C.OPEN_TAG_SLASH:L===">"?(fe(S,!0),I(S)):($(S,"Forward-slash in opening tag not followed by >"),S.state=C.ATTRIB);continue;case C.ATTRIB:if(N(L))continue;L===">"?fe(S):L==="/"?S.state=C.OPEN_TAG_SLASH:Y(x,L)?(S.attribName=L,S.attribValue="",S.state=C.ATTRIB_NAME):$(S,"Invalid attribute name");continue;case C.ATTRIB_NAME:L==="="?S.state=C.ATTRIB_VALUE:L===">"?($(S,"Attribute without value"),S.attribValue=S.attribName,oe(S),fe(S)):N(L)?S.state=C.ATTRIB_NAME_SAW_WHITE:Y(R,L)?S.attribName+=L:$(S,"Invalid attribute name");continue;case C.ATTRIB_NAME_SAW_WHITE:if(L==="=")S.state=C.ATTRIB_VALUE;else{if(N(L))continue;$(S,"Attribute without value"),S.tag.attributes[S.attribName]="",S.attribValue="",me(S,"onattribute",{name:S.attribName,value:""}),S.attribName="",L===">"?fe(S):Y(x,L)?(S.attribName=L,S.state=C.ATTRIB_NAME):($(S,"Invalid attribute name"),S.state=C.ATTRIB)}continue;case C.ATTRIB_VALUE:if(N(L))continue;M(L)?(S.q=L,S.state=C.ATTRIB_VALUE_QUOTED):($(S,"Unquoted attribute value"),S.state=C.ATTRIB_VALUE_UNQUOTED,S.attribValue=L);continue;case C.ATTRIB_VALUE_QUOTED:if(L!==S.q){L==="&"?S.state=C.ATTRIB_VALUE_ENTITY_Q:S.attribValue+=L;continue}oe(S),S.q="",S.state=C.ATTRIB_VALUE_CLOSED;continue;case C.ATTRIB_VALUE_CLOSED:N(L)?S.state=C.ATTRIB:L===">"?fe(S):L==="/"?S.state=C.OPEN_TAG_SLASH:Y(x,L)?($(S,"No whitespace between attributes"),S.attribName=L,S.attribValue="",S.state=C.ATTRIB_NAME):$(S,"Invalid attribute name");continue;case C.ATTRIB_VALUE_UNQUOTED:if(!B(L)){L==="&"?S.state=C.ATTRIB_VALUE_ENTITY_U:S.attribValue+=L;continue}oe(S),L===">"?fe(S):S.state=C.ATTRIB;continue;case C.CLOSE_TAG:if(S.tagName)L===">"?I(S):Y(R,L)?S.tagName+=L:S.script?(S.script+="</"+S.tagName,S.tagName="",S.state=C.SCRIPT):(N(L)||$(S,"Invalid tagname in closing tag"),S.state=C.CLOSE_TAG_SAW_WHITE);else{if(N(L))continue;W(x,L)?S.script?(S.script+="</"+L,S.state=C.SCRIPT):$(S,"Invalid tagname in closing tag."):S.tagName=L}continue;case C.CLOSE_TAG_SAW_WHITE:if(N(L))continue;L===">"?I(S):$(S,"Invalid characters in closing tag");continue;case C.TEXT_ENTITY:case C.ATTRIB_VALUE_ENTITY_Q:case C.ATTRIB_VALUE_ENTITY_U:var Nt,Bt;switch(S.state){case C.TEXT_ENTITY:Nt=C.TEXT,Bt="textNode";break;case C.ATTRIB_VALUE_ENTITY_Q:Nt=C.ATTRIB_VALUE_QUOTED,Bt="attribValue";break;case C.ATTRIB_VALUE_ENTITY_U:Nt=C.ATTRIB_VALUE_UNQUOTED,Bt="attribValue";break}if(L===";")if(S.opt.unparsedEntities){var zt=D(S);S.entity="",S.state=Nt,S.write(zt)}else S[Bt]+=D(S),S.entity="",S.state=Nt;else Y(S.entity.length?A:E,L)?S.entity+=L:($(S,"Invalid character in entity name"),S[Bt]+="&"+S.entity+L,S.entity="",S.state=Nt);continue;default:throw new Error(S,"Unknown state: "+S.state)}return S.position>=S.bufferCheckPosition&&r(S),S}return String.fromCodePoint||(function(){var O=String.fromCharCode,S=Math.floor,Q=function(){var L=16384,Pe=[],nt,Nt,Bt=-1,zt=arguments.length;if(!zt)return"";for(var fr="";++Bt<zt;){var It=Number(arguments[Bt]);if(!isFinite(It)||It<0||It>1114111||S(It)!==It)throw RangeError("Invalid code point: "+It);It<=65535?Pe.push(It):(It-=65536,nt=(It>>10)+55296,Nt=It%1024+56320,Pe.push(nt,Nt)),(Bt+1===zt||Pe.length>L)&&(fr+=O.apply(null,Pe),Pe.length=0)}return fr};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Q,configurable:!0,writable:!0}):String.fromCodePoint=Q})(),e};O5();function hy(e,t){if(e.function===void 0)return;let n;if(t?.partial)try{n=m_(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(s){throw new dy([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${s.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t?.returnId&&(r.id=e.id),r}function A5(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function rf(e,t){return{name:e.function?.name,args:e.function?.arguments,id:e.id,error:t,type:"invalid_tool_call"}}var C5=class extends wC{static lc_name(){return"JsonOutputToolsParser"}returnId=!1;lc_namespace=["langchain","output_parsers","openai_tools"];lc_serializable=!0;constructor(e){super(e),this.returnId=e?.returnId??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){const n=e[0].message;let r;if(__(n)&&n.tool_calls?.length?r=n.tool_calls.map(o=>{const{id:u,...f}=o;return this.returnId?{id:u,...f}:f}):n.additional_kwargs.tool_calls!==void 0&&(r=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map(o=>hy(o,{returnId:this.returnId,partial:t}))),!r)return[];const s=[];for(const o of r)if(o!==void 0){const u={type:o.name,args:o.args,id:o.id};s.push(u)}return s}},t1=class extends C5{static lc_name(){return"JsonOutputKeyToolsParser"}lc_namespace=["langchain","output_parsers","openai_tools"];lc_serializable=!0;returnId=!1;keyName;returnSingle=!1;zodSchema;constructor(e){super(e),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await Iz(this.zodSchema,e);if(t.success)return t.data;throw new dy(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error?.issues)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const t=(await super.parsePartialResult(e)).filter(r=>r.type===this.keyName);let n=t;if(t.length)return this.returnId||(n=t.map(r=>r.args)),this.returnSingle?n[0]:n}async parseResult(e){const t=(await super.parsePartialResult(e,!1)).filter(r=>r.type===this.keyName);let n=t;if(t.length)return this.returnId||(n=t.map(r=>r.args)),this.returnSingle?this._validateResult(n[0]):await Promise.all(n.map(r=>this._validateResult(r)))}};function py(e,t){return typeof e=="string"?{model:e,...t??{}}:e??t}var my=class extends E5{temperature;topP;frequencyPenalty;presencePenalty;n;logitBias;model="gpt-3.5-turbo";modelKwargs;stop;stopSequences;user;timeout;streaming=!1;streamUsage=!0;maxTokens;logprobs;topLogprobs;apiKey;organization;__includeRawResponse;client;clientConfig;supportsStrictToolCalling;audio;modalities;reasoning;zdrEnabled;service_tier;promptCacheKey;promptCacheRetention;verbosity;defaultOptions;_llmType(){return"openai"}static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning","reasoning_effort","service_tier"]}lc_serializable=!0;get lc_secrets(){return{apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{apiKey:"openai_api_key",modelName:"model"}}get lc_serializable_keys(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","model","modelName","modelKwargs","stop","stopSequences","timeout","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming","zdrEnabled","reasoning","promptCacheKey","promptCacheRetention","verbosity"]}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}constructor(e){super(e??{});const t=typeof e?.configuration?.apiKey=="string"||typeof e?.configuration?.apiKey=="function"?e?.configuration?.apiKey:void 0;this.apiKey=e?.apiKey??t??ha("OPENAI_API_KEY"),this.organization=e?.configuration?.organization??ha("OPENAI_ORGANIZATION"),this.model=e?.model??e?.modelName??this.model,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this.stop,this.user=e?.user,this.__includeRawResponse=e?.__includeRawResponse,this.audio=e?.audio,this.modalities=e?.modalities,this.reasoning=e?.reasoning,this.maxTokens=e?.maxCompletionTokens??e?.maxTokens,this.promptCacheKey=e?.promptCacheKey??this.promptCacheKey,this.promptCacheRetention=e?.promptCacheRetention??this.promptCacheRetention,this.verbosity=e?.verbosity??this.verbosity,this.disableStreaming=e?.disableStreaming===!0,this.streaming=e?.streaming===!0,this.disableStreaming&&(this.streaming=!1),e?.streaming===!1&&(this.disableStreaming=!0),this.streamUsage=e?.streamUsage??this.streamUsage,this.disableStreaming&&(this.streamUsage=!1),this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e?.configuration},e?.supportsStrictToolCalling!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling),e?.service_tier!==void 0&&(this.service_tier=e.service_tier),this.zdrEnabled=e?.zdrEnabled??!1}_getReasoningParams(e){if(!Vl(this.model))return;let t;return this.reasoning!==void 0&&(t={...t,...this.reasoning}),e?.reasoning!==void 0&&(t={...t,...e.reasoning}),e?.reasoningEffort!==void 0&&t?.effort===void 0&&(t={...t,effort:e.reasoningEffort}),t}_getResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&Ls(e.json_schema.schema)?J6(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}_combineCallOptions(e){return{...this.defaultOptions,...e??{}}}_getClientOptions(e){if(!this.client){const t=yU({baseURL:this.clientConfig.baseURL}),n={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};n.baseURL||delete n.baseURL,n.defaultHeaders=wU(n.defaultHeaders),this.client=new Ue(n)}return{...this.clientConfig,...e}}_convertChatOpenAIToolToCompletionsTool(e,t){return Pf(e)?zU(e.metadata.customTool):vC(e)?t?.strict!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:AU(e,t)}bindTools(e,t){let n;return t?.strict!==void 0?n=t.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling),this.withConfig({tools:e.map(r=>cy(r)||Pf(r)?r:NU(r)?r.extras.providerToolDefinition:this._convertChatOpenAIToolToCompletionsTool(r,{strict:n})),...t})}async stream(e,t){return super.stream(e,this._combineCallOptions(t))}async invoke(e,t){return super.invoke(e,this._combineCallOptions(t))}_combineLLMOutput(...e){return e.reduce((t,n)=>(n&&n.tokenUsage&&(t.tokenUsage.completionTokens+=n.tokenUsage.completionTokens??0,t.tokenUsage.promptTokens+=n.tokenUsage.promptTokens??0,t.tokenUsage.totalTokens+=n.tokenUsage.totalTokens??0),t),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}async getNumTokensFromMessages(e){let t=0,n=0,r=0;this.model==="gpt-3.5-turbo-0301"?(n=4,r=-1):(n=3,r=1);const s=await Promise.all(e.map(async o=>{const[u,f]=await Promise.all([this.getNumTokens(o.content),this.getNumTokens(Jl(o))]),d=o.name!==void 0?r+await this.getNumTokens(o.name):0;let h=u+n+f+d;const m=o;if(m._getType()==="function"&&(h-=2),m.additional_kwargs?.function_call&&(h+=3),m?.additional_kwargs.function_call?.name&&(h+=await this.getNumTokens(m.additional_kwargs.function_call?.name)),m.additional_kwargs.function_call?.arguments)try{h+=await this.getNumTokens(JSON.stringify(JSON.parse(m.additional_kwargs.function_call?.arguments)))}catch(_){console.error("Error parsing function arguments",_,JSON.stringify(m.additional_kwargs.function_call)),h+=await this.getNumTokens(m.additional_kwargs.function_call?.arguments)}return t+=h,h}));return t+=3,{totalCount:t,countPerMessage:s}}async _getNumTokensFromGenerations(e){return(await Promise.all(e.map(async t=>t.message.additional_kwargs?.function_call?(await this.getNumTokensFromMessages([t.message])).countPerMessage[0]:await this.getNumTokens(t.message.content)))).reduce((t,n)=>t+n,0)}async _getEstimatedTokenCountFromPrompt(e,t,n){let r=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&n!=="auto"){const s=RU(t);r+=await this.getNumTokens(s),r+=9}return t&&e.find(s=>s._getType()==="system")&&(r-=4),n==="none"?r+=1:typeof n=="object"&&(r+=await this.getNumTokens(n.name)+4),r}async moderateContent(e,t){const n=this._getClientOptions(t?.options),r={input:e,model:t?.model??"omni-moderation-latest"};return this.caller.call(async()=>{try{return await this.client.moderations.create(r,n)}catch(s){throw uy(s)}})}get profile(){return Y6[this.model]??{}}_getStructuredOutputMethod(e){const t={...e};if(!this.model.startsWith("gpt-3")&&!this.model.startsWith("gpt-4-")&&this.model!=="gpt-4"){if(t?.method===void 0)return"jsonSchema"}else t.method==="jsonSchema"&&console.warn(`[WARNING]: JSON Schema is not supported for model "${this.model}". Falling back to tool calling.`);return t.method}withStructuredOutput(e,t){let n,r;const{schema:s,name:o,includeRaw:u}={...t,schema:e};if(t?.strict!==void 0&&t.method==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");const f=G6(this.model,t?.method);if(f==="jsonMode"){Ls(s)?r=WT.fromZodSchema(s):r=new e1;const _=da(s);n=this.withConfig({outputVersion:"v0",response_format:{type:"json_object"},ls_structured_output_format:{kwargs:{method:"json_mode"},schema:{title:o??"extract",..._}}})}else if(f==="jsonSchema"){const _={name:o??"extract",description:z_(s),schema:s,strict:t?.strict},y=da(_.schema);if(n=this.withConfig({outputVersion:"v0",response_format:{type:"json_schema",json_schema:_},ls_structured_output_format:{kwargs:{method:"json_schema"},schema:{title:_.name,description:_.description,...y}}}),Ls(s)){const v=WT.fromZodSchema(s);r=od.from(w=>"parsed"in w.additional_kwargs?w.additional_kwargs.parsed:v)}else r=new e1}else{let _=o??"extract";if(Ls(s)){const y=da(s);n=this.withConfig({outputVersion:"v0",tools:[{type:"function",function:{name:_,description:y.description,parameters:y}}],tool_choice:{type:"function",function:{name:_}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:_,...y}},...t?.strict!==void 0?{strict:t.strict}:{}}),r=new t1({returnSingle:!0,keyName:_,zodSchema:s})}else{let y;typeof s.name=="string"&&typeof s.parameters=="object"&&s.parameters!=null?(y=s,_=s.name):(_=s.title??_,y={name:_,description:s.description??"",parameters:s});const v=da(s);n=this.withConfig({outputVersion:"v0",tools:[{type:"function",function:y}],tool_choice:{type:"function",function:{name:_}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:_,...v}},...t?.strict!==void 0?{strict:t.strict}:{}}),r=new t1({returnSingle:!0,keyName:_})}}if(!u)return n.pipe(r);const d=Zf.assign({parsed:(_,y)=>r.invoke(_.raw,y)}),h=Zf.assign({parsed:()=>null}),m=d.withFallbacks({fallbacks:[h]});return sd.from([{raw:n},m])}};const SC={providerName:"ChatOpenAI",fromStandardTextBlock(e){return{type:"text",text:e.text}},fromStandardImageBlock(e){if(e.source_type==="url")return{type:"image_url",image_url:{url:e.url,...e.metadata?.detail?{detail:e.metadata.detail}:{}}};if(e.source_type==="base64")return{type:"image_url",image_url:{url:`data:${e.mime_type??""};base64,${e.data}`,...e.metadata?.detail?{detail:e.metadata.detail}:{}}};throw new Error(`Image content blocks with source_type ${e.source_type} are not supported for ChatOpenAI`)},fromStandardAudioBlock(e){if(e.source_type==="url"){const t=af({dataUrl:e.url});if(!t)throw new Error(`URL audio blocks with source_type ${e.source_type} must be formatted as a data URL for ChatOpenAI`);const n=t.mime_type||e.mime_type||"";let r;try{r=Ow(n)}catch{throw new Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`)}if(r.type!=="audio"||r.subtype!=="wav"&&r.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:r.subtype,data:t.data}}}if(e.source_type==="base64"){let t;try{t=Ow(e.mime_type??"")}catch{throw new Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`)}if(t.type!=="audio"||t.subtype!=="wav"&&t.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:t.subtype,data:e.data}}}throw new Error(`Audio content blocks with source_type ${e.source_type} are not supported for ChatOpenAI`)},fromStandardFileBlock(e){if(e.source_type==="url"){const t=af({dataUrl:e.url}),n=Df(e);if(!t)throw new Error(`URL file blocks with source_type ${e.source_type} must be formatted as a data URL for ChatOpenAI`);return{type:"file",file:{file_data:e.url,...e.metadata?.filename||e.metadata?.name?{filename:n}:{}}}}if(e.source_type==="base64"){const t=Df(e);return{type:"file",file:{file_data:`data:${e.mime_type??""};base64,${e.data}`,...e.metadata?.filename||e.metadata?.name||e.metadata?.title?{filename:t}:{}}}}if(e.source_type==="id")return{type:"file",file:{file_id:e.id}};throw new Error(`File content blocks with source_type ${e.source_type} are not supported for ChatOpenAI`)}},R5=({message:e,rawResponse:t,includeRawResponse:n})=>{const r=e.tool_calls;switch(e.role){case"assistant":{const s=[],o=[];for(const d of r??[])try{s.push(hy(d,{returnId:!0}))}catch(h){o.push(rf(d,h.message))}const u={function_call:e.function_call,tool_calls:r};n!==void 0&&(u.__raw_response=t);const f={model_provider:"openai",model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(u.audio=e.audio),new ga({content:X6(e.content||"",t.choices?.[0]?.message),tool_calls:s,invalid_tool_calls:o,additional_kwargs:u,response_metadata:f,id:t.id})}default:return new g_(e.content||"",e.role??"unknown")}},N5=({delta:e,rawResponse:t,includeRawResponse:n,defaultRole:r})=>{const s=e.role??r,o=e.content??"";let u;e.function_call?u={function_call:e.function_call}:e.tool_calls?u={tool_calls:e.tool_calls}:u={},n&&(u.__raw_response=t),e.audio&&(u.audio={...e.audio,index:t.choices[0].index});const f={model_provider:"openai",usage:{...t.usage}};if(s==="user")return new O1({content:o,response_metadata:f});if(s==="assistant"){const d=[];if(Array.isArray(e.tool_calls))for(const h of e.tool_calls)d.push({name:h.function?.name,args:h.function?.arguments,id:h.id,index:h.index,type:"tool_call_chunk"});return new Vs({content:o,tool_call_chunks:d,additional_kwargs:u,id:t.id,response_metadata:f})}else return s==="system"?new mg({content:o,response_metadata:f}):s==="developer"?new mg({content:o,response_metadata:f,additional_kwargs:{__openai_role__:"developer"}}):s==="function"?new x1({content:o,additional_kwargs:u,name:e.name,response_metadata:f}):s==="tool"?new HI({content:o,additional_kwargs:u,tool_call_id:e.tool_call_id,response_metadata:f}):new T1({content:o,role:s,response_metadata:f})},I5=e=>{if(e.type==="image"){if(e.url)return{type:"image_url",image_url:{url:e.url}};if(e.data)return{type:"image_url",image_url:{url:`data:${e.mimeType};base64,${e.data}`}}}if(e.type==="audio"&&e.data){const t=uk(()=>{const[,n]=e.mimeType.split("/");return n==="wav"||n==="mp3"?n:"wav"});return{type:"input_audio",input_audio:{data:e.data.toString(),format:t}}}if(e.type==="file"){if(e.data){const t=Df(e);return{type:"file",file:{file_data:`data:${e.mimeType};base64,${e.data}`,filename:t}}}if(e.fileId)return{type:"file",file:{file_id:e.fileId}}}},k5=({message:e,model:t})=>{let n=Jl(e);if(n==="system"&&Vl(t)&&(n="developer"),n==="developer")return{role:"developer",content:e.contentBlocks.filter(s=>s.type==="text")};if(n==="system")return{role:"system",content:e.contentBlocks.filter(s=>s.type==="text")};if(n==="assistant")return{role:"assistant",content:e.contentBlocks.filter(s=>s.type==="text")};if(n==="tool"&&d_.isInstance(e))return{role:"tool",tool_call_id:e.tool_call_id,content:e.contentBlocks.filter(s=>s.type==="text")};if(n==="function")return{role:"function",name:e.name??"",content:e.contentBlocks.filter(s=>s.type==="text").join("")};function*r(s){for(const o of s){o.type==="text"&&(yield{type:"text",text:o.text});const u=I5(o);u&&(yield u)}}return{role:"user",content:Array.from(r(e.contentBlocks))}},n1=({messages:e,model:t})=>e.flatMap(n=>{if("output_version"in n.response_metadata&&n.response_metadata?.output_version==="v1")return k5({message:n});let r=Jl(n);r==="system"&&Vl(t)&&(r="developer");const s=typeof n.content=="string"?n.content:n.content.flatMap(u=>es(u)?l1(u,SC):typeof u=="object"&&u!==null&&"type"in u&&u.type==="tool_use"?[]:u),o={role:r,content:s};return n.name!=null&&(o.name=n.name),n.additional_kwargs.function_call!=null&&(o.function_call=n.additional_kwargs.function_call),ga.isInstance(n)&&n.tool_calls?.length?o.tool_calls=n.tool_calls.map(A5):(n.additional_kwargs.tool_calls!=null&&(o.tool_calls=n.additional_kwargs.tool_calls),d_.isInstance(n)&&n.tool_call_id!=null&&(o.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio?[o,{role:"assistant",audio:{id:n.additional_kwargs.audio.id}}]:o});var $5=class extends my{constructor(e,t){super(py(e,t))}invocationParams(e,t){let n;e?.strict!==void 0?n=e.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling);let r={};e?.stream_options!==void 0?r={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t?.streaming)&&(r={stream_options:{include_usage:!0}});const s={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:e?.tools?.length?e.tools.map(u=>this._convertChatOpenAIToolToCompletionsTool(u,{strict:n})):void 0,tool_choice:iC(e?.tool_choice),response_format:this._getResponseFormat(e?.response_format),seed:e?.seed,...r,parallel_tool_calls:e?.parallel_tool_calls,...this.audio||e?.audio?{audio:this.audio||e?.audio}:{},...this.modalities||e?.modalities?{modalities:this.modalities||e?.modalities}:{},...this.modelKwargs,prompt_cache_key:e?.promptCacheKey??this.promptCacheKey,prompt_cache_retention:e?.promptCacheRetention??this.promptCacheRetention,verbosity:e?.verbosity??this.verbosity};e?.prediction!==void 0&&(s.prediction=e.prediction),this.service_tier!==void 0&&(s.service_tier=this.service_tier),e?.service_tier!==void 0&&(s.service_tier=e.service_tier);const o=this._getReasoningParams(e);return o!==void 0&&o.effort!==void 0&&(s.reasoning_effort=o.effort),Vl(s.model)?s.max_completion_tokens=this.maxTokens===-1?void 0:this.maxTokens:s.max_tokens=this.maxTokens===-1?void 0:this.maxTokens,s}async _generate(e,t,n){t.signal?.throwIfAborted();const r={},s=this.invocationParams(t),o=n1({messages:e,model:this.model});if(s.stream){const u=this._streamResponseChunks(e,t,n),f={};for await(const v of u){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const w=v.generationInfo?.completion??0;f[w]===void 0?f[w]=v:f[w]=f[w].concat(v)}const d=Object.entries(f).sort(([v],[w])=>parseInt(v,10)-parseInt(w,10)).map(([v,w])=>w),{functions:h,function_call:m}=this.invocationParams(t),_=await this._getEstimatedTokenCountFromPrompt(e,h,m),y=await this._getNumTokensFromGenerations(d);return r.input_tokens=_,r.output_tokens=y,r.total_tokens=_+y,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:r.input_tokens,completionTokens:r.output_tokens,totalTokens:r.total_tokens}}}}else{const u=await this.completionWithRetry({...s,stream:!1,messages:o},{signal:t?.signal,...t?.options}),{completion_tokens:f,prompt_tokens:d,total_tokens:h,prompt_tokens_details:m,completion_tokens_details:_}=u?.usage??{};f&&(r.output_tokens=(r.output_tokens??0)+f),d&&(r.input_tokens=(r.input_tokens??0)+d),h&&(r.total_tokens=(r.total_tokens??0)+h),(m?.audio_tokens!==null||m?.cached_tokens!==null)&&(r.input_token_details={...m?.audio_tokens!==null&&{audio:m?.audio_tokens},...m?.cached_tokens!==null&&{cache_read:m?.cached_tokens}}),(_?.audio_tokens!==null||_?.reasoning_tokens!==null)&&(r.output_token_details={..._?.audio_tokens!==null&&{audio:_?.audio_tokens},..._?.reasoning_tokens!==null&&{reasoning:_?.reasoning_tokens}});const y=[];for(const v of u?.choices??[]){const w={text:v.message?.content??"",message:this._convertCompletionsMessageToBaseMessage(v.message??{role:"assistant"},u)};w.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},__(w.message)&&(w.message.usage_metadata=r),w.message=new ga(Object.fromEntries(Object.entries(w.message).filter(([x])=>!x.startsWith("lc_")))),y.push(w)}return{generations:y,llmOutput:{tokenUsage:{promptTokens:r.input_tokens,completionTokens:r.output_tokens,totalTokens:r.total_tokens}}}}}async*_streamResponseChunks(e,t,n){const r=n1({messages:e,model:this.model}),s={...this.invocationParams(t,{streaming:!0}),messages:r,stream:!0};let o;const u=await this.completionWithRetry(s,t);let f;for await(const d of u){if(t.signal?.aborted)return;const h=d?.choices?.[0];if(d.usage&&(f=d.usage),!h)continue;const{delta:m}=h;if(!m)continue;const _=this._convertCompletionsDeltaToBaseMessageChunk(m,d,o);o=m.role??o;const y={prompt:t.promptIndex??0,completion:h.index??0};if(typeof _.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const v={...y};h.finish_reason!=null&&(v.finish_reason=h.finish_reason,v.system_fingerprint=d.system_fingerprint,v.model_name=d.model,v.service_tier=d.service_tier),this.logprobs&&(v.logprobs=h.logprobs);const w=new Ll({message:_,text:_.content,generationInfo:v});yield w,await n?.handleLLMNewToken(w.text??"",y,void 0,void 0,void 0,{chunk:w})}if(f){const d={...f.prompt_tokens_details?.audio_tokens!==null&&{audio:f.prompt_tokens_details?.audio_tokens},...f.prompt_tokens_details?.cached_tokens!==null&&{cache_read:f.prompt_tokens_details?.cached_tokens}},h={...f.completion_tokens_details?.audio_tokens!==null&&{audio:f.completion_tokens_details?.audio_tokens},...f.completion_tokens_details?.reasoning_tokens!==null&&{reasoning:f.completion_tokens_details?.reasoning_tokens}},m=new Ll({message:new Vs({content:"",response_metadata:{usage:{...f}},usage_metadata:{input_tokens:f.prompt_tokens,output_tokens:f.completion_tokens,total_tokens:f.total_tokens,...Object.keys(d).length>0&&{input_token_details:d},...Object.keys(h).length>0&&{output_token_details:h}}}),text:""});yield m,await n?.handleLLMNewToken(m.text??"",{prompt:0,completion:0},void 0,void 0,void 0,{chunk:m})}if(t.signal?.aborted)throw new Error("AbortError")}async completionWithRetry(e,t){const n=this._getClientOptions(t),r=e.response_format&&e.response_format.type==="json_schema";return this.caller.call(async()=>{try{return r&&!e.stream?await this.client.chat.completions.parse(e,n):await this.client.chat.completions.create(e,n)}catch(s){throw uy(s)}})}_convertCompletionsDeltaToBaseMessageChunk(e,t,n){return N5({delta:e,rawResponse:t,includeRawResponse:this.__includeRawResponse,defaultRole:n})}_convertCompletionsMessageToBaseMessage(e,t){return R5({message:e,rawResponse:t,includeRawResponse:this.__includeRawResponse})}};const qf="__openai_function_call_ids__";function EC(e){return e.type==="url_citation"?{type:"citation",source:"url_citation",url:e.url,title:e.title,startIndex:e.start_index,endIndex:e.end_index}:e.type==="file_citation"?{type:"citation",source:"file_citation",title:e.filename,startIndex:e.index,file_id:e.file_id}:e.type==="container_file_citation"?{type:"citation",source:"container_file_citation",title:e.filename,startIndex:e.start_index,endIndex:e.end_index,file_id:e.file_id,container_id:e.container_id}:e.type==="file_path"?{type:"citation",source:"file_path",startIndex:e.index,file_id:e.file_id}:{type:"non_standard",value:e}}function M5(e){if(e.type==="url_citation"||e.type==="file_citation"||e.type==="container_file_citation"||e.type==="file_path")return e;if(e.type==="citation"){const t=e;if(t.source==="url_citation")return{type:"url_citation",url:t.url??"",title:t.title??"",start_index:t.startIndex??0,end_index:t.endIndex??0};if(t.source==="file_citation")return{type:"file_citation",file_id:t.file_id??"",filename:t.title??"",index:t.startIndex??0};if(t.source==="container_file_citation")return{type:"container_file_citation",file_id:t.file_id??"",filename:t.title??"",container_id:t.container_id??"",start_index:t.startIndex??0,end_index:t.endIndex??0};if(t.source==="file_path")return{type:"file_path",file_id:t.file_id??"",index:t.startIndex??0}}return e.type==="non_standard"?e.value:e}const TC=e=>{const t={...e?.input_tokens_details?.cached_tokens!=null&&{cache_read:e?.input_tokens_details?.cached_tokens}},n={...e?.output_tokens_details?.reasoning_tokens!=null&&{reasoning:e?.output_tokens_details?.reasoning_tokens}};return{input_tokens:e?.input_tokens??0,output_tokens:e?.output_tokens??0,total_tokens:e?.total_tokens??0,input_token_details:t,output_token_details:n}},xC=e=>{if(e.error){const d=new Error(e.error.message);throw d.name=e.error.code,d}let t;const n=[],r=[],s=[],o=e.output.map(d=>{if(d.type==="function_call"&&"parsed_arguments"in d){const h={...d};return delete h.parsed_arguments,h}return d}),u={model_provider:"openai",model:e.model,created_at:e.created_at,id:e.id,incomplete_details:e.incomplete_details,metadata:e.metadata,object:e.object,output:o,status:e.status,user:e.user,service_tier:e.service_tier,model_name:e.model},f={};for(const d of e.output)if(d.type==="message")t=d.id,n.push(...d.content.flatMap(h=>h.type==="output_text"?("parsed"in h&&h.parsed!=null&&(f.parsed=h.parsed),{type:"text",text:h.text,annotations:h.annotations.map(EC)}):h.type==="refusal"?(f.refusal=h.refusal,[]):h));else if(d.type==="function_call"){const h={function:{name:d.name,arguments:d.arguments},id:d.call_id};try{r.push(hy(h,{returnId:!0}))}catch(m){let _;typeof m=="object"&&m!=null&&"message"in m&&typeof m.message=="string"&&(_=m.message),s.push(rf(h,_))}f[qf]??={},d.id&&(f[qf][d.call_id]=d.id)}else if(d.type==="reasoning"){f.reasoning=d;const h=d.summary?.map(m=>m.text).filter(Boolean).join("");h&&n.push({type:"reasoning",reasoning:h})}else if(d.type==="custom_tool_call"){const h=kU(d);h?r.push(h):s.push(rf(d,"Malformed custom tool call"))}else if(d.type==="computer_call"){const h=$U(d);h?r.push(h):s.push(rf(d,"Malformed computer call"))}else d.type==="image_generation_call"?(d.result&&n.push({type:"image",mimeType:"image/png",data:d.result,id:d.id,metadata:{status:d.status}}),f.tool_outputs??=[],f.tool_outputs.push(d)):(f.tool_outputs??=[],f.tool_outputs.push(d));return new ga({id:t,content:n,tool_calls:r,invalid_tool_calls:s,usage_metadata:TC(e.usage),additional_kwargs:f,response_metadata:u})},j5=e=>{const t=(e.summary.length>1?e.summary.reduce((n,r)=>{const s=n[n.length-1];return s.index===r.index?s.text+=r.text:n.push(r),n},[{...e.summary[0]}]):e.summary).map(n=>Object.fromEntries(Object.entries(n).filter(([r])=>r!=="index")));return{...e,summary:t}},L5=e=>{const t=[];let n={},r;const s=[],o={model_provider:"openai"},u={};let f;if(e.type==="response.output_text.delta")t.push({type:"text",text:e.delta,index:e.content_index});else if(e.type==="response.output_text.annotation.added")t.push({type:"text",text:"",annotations:[EC(e.annotation)],index:e.content_index});else if(e.type==="response.output_item.added"&&e.item.type==="message")f=e.item.id;else if(e.type==="response.output_item.added"&&e.item.type==="function_call")s.push({type:"tool_call_chunk",name:e.item.name,args:e.item.arguments,id:e.item.call_id,index:e.output_index}),u[qf]={[e.item.call_id]:e.item.id};else if(e.type==="response.output_item.done"&&e.item.type==="computer_call")s.push({type:"tool_call_chunk",name:"computer_use",args:JSON.stringify({action:e.item.action}),id:e.item.call_id,index:e.output_index}),u.tool_outputs=[e.item];else if(e.type==="response.output_item.done"&&e.item.type==="image_generation_call")e.item.result&&t.push({type:"image",mimeType:"image/png",data:e.item.result,id:e.item.id,metadata:{status:e.item.status}}),u.tool_outputs=[e.item];else if(e.type==="response.output_item.done"&&["web_search_call","file_search_call","code_interpreter_call","shell_call","local_shell_call","mcp_call","mcp_list_tools","mcp_approval_request","custom_tool_call"].includes(e.item.type))u.tool_outputs=[e.item];else if(e.type==="response.created")o.id=e.response.id,o.model_name=e.response.model,o.model=e.response.model;else if(e.type==="response.completed"){const d=xC(e.response);r=TC(e.response.usage),e.response.text?.format?.type==="json_schema"&&(u.parsed??=JSON.parse(d.text));for(const[h,m]of Object.entries(e.response))h!=="id"&&(h==="output"?o[h]=d.response_metadata.output:o[h]=m)}else if(e.type==="response.function_call_arguments.delta"||e.type==="response.custom_tool_call_input.delta")s.push({type:"tool_call_chunk",args:e.delta,index:e.output_index});else if(e.type==="response.web_search_call.completed"||e.type==="response.file_search_call.completed")n={tool_outputs:{id:e.item_id,type:e.type.replace("response.","").replace(".completed",""),status:"completed"}};else if(e.type==="response.refusal.done")u.refusal=e.refusal;else if(e.type==="response.output_item.added"&&"item"in e&&e.item.type==="reasoning"){const d=e.item.summary?e.item.summary.map((m,_)=>({...m,index:_})):void 0;u.reasoning={id:e.item.id,type:e.item.type,...d?{summary:d}:{}};const h=e.item.summary?.map(m=>m.text).filter(Boolean).join("");h&&t.push({type:"reasoning",reasoning:h})}else if(e.type==="response.reasoning_summary_part.added")u.reasoning={type:"reasoning",summary:[{...e.part,index:e.summary_index}]},e.part.text&&t.push({type:"reasoning",reasoning:e.part.text});else if(e.type==="response.reasoning_summary_text.delta")u.reasoning={type:"reasoning",summary:[{text:e.delta,type:"summary_text",index:e.summary_index}]},e.delta&&t.push({type:"reasoning",reasoning:e.delta});else return e.type==="response.image_generation_call.partial_image",null;return new Ll({text:t.map(d=>d.text).join(""),message:new Vs({id:f,content:t,tool_call_chunks:s,usage_metadata:r,additional_kwargs:u,response_metadata:o}),generationInfo:n})},z5=e=>{const t=ga.isInstance(e)&&e.response_metadata?.model_provider==="openai";function*n(){const r=Bs(()=>{try{const E=Jl(e);return E==="system"||E==="developer"||E==="assistant"||E==="user"?E:"assistant"}catch{return"assistant"}});let s;const o=new Set,u=new Set,f=new Map,d=new Map;function*h(){if(!s)return;const E=s.content;(typeof E=="string"&&E.length>0||Array.isArray(E)&&E.length>0)&&(yield s),s=void 0}const m=E=>{s||(s={type:"message",role:r,content:[]}),typeof s.content=="string"?s.content=s.content.length>0?[{type:"input_text",text:s.content},...E]:[...E]:s.content.push(...E)},_=E=>{if(typeof E=="string")return E;try{return JSON.stringify(E??{})}catch{return"{}"}},y=E=>{const A=Bs(()=>{const N=E.metadata?.detail;return N==="low"||N==="high"||N==="auto"?N:"auto"});if(E.fileId)return{type:"input_image",detail:A,file_id:E.fileId};if(E.url)return{type:"input_image",detail:A,image_url:E.url};if(E.data){const N=typeof E.data=="string"?E.data:Buffer.from(E.data).toString("base64");return{type:"input_image",detail:A,image_url:`data:${E.mimeType??"image/png"};base64,${N}`}}},v=E=>{if(E.fileId){const A=PT(E);return{type:"input_file",file_id:E.fileId,...A?{filename:A}:{}}}if(E.url){const A=PT(E);return{...A?{filename:A}:{},type:"input_file",file_url:E.url}}if(E.data){const A=Df(E),N=typeof E.data=="string"?E.data:Buffer.from(E.data).toString("base64");return{type:"input_file",file_data:`data:${E.mimeType??"application/octet-stream"};base64,${N}`,...A?{filename:A}:{}}}},w=E=>{const A=Bs(()=>{if(Array.isArray(E.summary)){const B=E.summary?.map(Y=>Y?.text).filter(Y=>typeof Y=="string")??[];if(B.length>0)return B}return E.reasoning?[E.reasoning]:[]}),N=A.length>0?A.map(B=>({type:"summary_text",text:B})):[{type:"summary_text",text:""}],M={type:"reasoning",id:E.id??"",summary:N};return E.reasoning&&(M.content=[{type:"reasoning_text",text:E.reasoning}]),M},x=E=>({type:"function_call",name:E.name??"",call_id:E.id??"",arguments:_(E.args)}),R=E=>{const A=_(E.output),N=E.status==="success"?"completed":E.status==="error"?"incomplete":void 0;return{type:"function_call_output",call_id:E.toolCallId??"",output:A,...N?{status:N}:{}}};for(const E of e.contentBlocks)if(E.type==="text")m([{type:"input_text",text:E.text}]);else if(E.type!=="invalid_tool_call"){if(E.type==="reasoning")yield*h(),yield w(E);else if(E.type==="tool_call"){yield*h();const A=E.id??"";A&&(o.add(A),f.delete(A)),yield x(E)}else if(E.type==="tool_call_chunk"){if(E.id){const A=f.get(E.id)??{name:E.name,args:[]};E.name&&(A.name=E.name),E.args&&A.args.push(E.args),f.set(E.id,A)}}else if(E.type==="server_tool_call"){yield*h();const A=E.id??"";A&&(u.add(A),d.delete(A)),yield x(E)}else if(E.type==="server_tool_call_chunk"){if(E.id){const A=d.get(E.id)??{name:E.name,args:[]};E.name&&(A.name=E.name),E.args&&A.args.push(E.args),d.set(E.id,A)}}else if(E.type==="server_tool_call_result")yield*h(),yield R(E);else if(E.type!=="audio")if(E.type==="file"){const A=v(E);A&&m([A])}else if(E.type==="image"){const A=y(E);A&&m([A])}else if(E.type==="video"){const A=v(E);A&&m([A])}else E.type==="text-plain"?E.text&&m([{type:"input_text",text:E.text}]):E.type==="non_standard"&&t&&(yield*h(),yield E.value)}yield*h();for(const[E,A]of f){if(!E||o.has(E))continue;const N=A.args.join("");!A.name&&!N||(yield{type:"function_call",call_id:E,name:A.name??"",arguments:N})}for(const[E,A]of d){if(!E||u.has(E))continue;const N=A.args.join("");!A.name&&!N||(yield{type:"function_call",call_id:E,name:A.name??"",arguments:N})}}return Array.from(n())},r1=({messages:e,zdrEnabled:t,model:n})=>e.flatMap(r=>{const s=r.response_metadata;if(s?.output_version==="v1")return z5(r);const o=r.additional_kwargs;let u=Jl(r);if(u==="system"&&Vl(n)&&(u="developer"),u==="function")throw new Error("Function messages are not supported in Responses API");if(u==="tool"){const f=r;if(o?.type==="computer_call_output")return{type:"computer_call_output",output:(()=>{if(typeof f.content=="string")return{type:"input_image",image_url:f.content};if(Array.isArray(f.content)){const h=f.content.find(y=>y.type==="input_image");if(h)return h;const m=f.content.find(y=>y.type==="computer_screenshot");if(m)return m;const _=f.content.find(y=>y.type==="image_url");if(_)return{type:"input_image",image_url:typeof _.image_url=="string"?_.image_url:_.image_url.url}}throw new Error("Invalid computer call output")})(),call_id:f.tool_call_id};if(f.additional_kwargs?.customTool)return{type:"custom_tool_call_output",call_id:f.tool_call_id,output:f.content};const d=Array.isArray(f.content)&&f.content.every(h=>typeof h=="object"&&h!==null&&"type"in h&&(h.type==="input_file"||h.type==="input_image"||h.type==="input_text"));return{type:"function_call_output",call_id:f.tool_call_id,id:f.id?.startsWith("fc_")?f.id:void 0,output:d?f.content:typeof f.content!="string"?JSON.stringify(f.content):f.content}}if(u==="assistant"){if(!t&&s?.output!=null&&Array.isArray(s?.output)&&s?.output.length>0&&s?.output.every(w=>"type"in w))return s?.output;const f=[],d=o?.reasoning,h=!!d?.encrypted_content;if(d&&(!t||h)){const w=j5(d);f.push(w)}let{content:m}=r;o?.refusal&&(typeof m=="string"&&(m=[{type:"output_text",text:m,annotations:[]}]),m=[...m,{type:"refusal",refusal:o.refusal}]),(typeof m=="string"||m.length>0)&&f.push({type:"message",role:"assistant",...r.id&&!t&&r.id.startsWith("msg_")?{id:r.id}:{},content:Bs(()=>typeof m=="string"?m:m.flatMap(w=>w.type==="text"?{type:"output_text",text:w.text,annotations:(w.annotations??[]).map(M5)}:w.type==="output_text"||w.type==="refusal"?w:[]))});const _=o?.[qf];ga.isInstance(r)&&r.tool_calls?.length?f.push(...r.tool_calls.map(w=>jU(w)?{type:"custom_tool_call",id:w.call_id,call_id:w.id??"",input:w.args.input,name:w.name}:MU(w)?{type:"computer_call",id:w.call_id,call_id:w.id??"",action:w.args.action}:{type:"function_call",name:w.name,arguments:JSON.stringify(w.args),call_id:w.id,...t?{}:{id:_?.[w.id]}})):o?.tool_calls&&f.push(...o.tool_calls.map(w=>({type:"function_call",name:w.function.name,call_id:w.id,arguments:w.function.arguments,...t?{}:{id:_?.[w.id]}})));const y=s?.output?.length?s?.output:o.tool_outputs,v=["computer_call","mcp_call","code_interpreter_call","image_generation_call","shell_call","local_shell_call"];if(y!=null){const w=y?.filter(x=>v.includes(x.type));w.length>0&&f.push(...w)}return f}if(u==="user"||u==="system"||u==="developer"){if(typeof r.content=="string")return{type:"message",role:u,content:r.content};const f=[],d=r.content.flatMap(h=>(h.type==="mcp_approval_response"&&f.push({type:"mcp_approval_response",approval_request_id:h.approval_request_id,approve:h.approve}),es(h)?l1(h,SC):h.type==="text"?{type:"input_text",text:h.text}:h.type==="image_url"?{type:"input_image",image_url:Bs(()=>{if(typeof h.image_url=="string")return h.image_url;if(typeof h.image_url=="object"&&h.image_url!==null&&"url"in h.image_url)return h.image_url.url}),detail:Bs(()=>{if(typeof h.image_url=="string")return"auto";if(typeof h.image_url=="object"&&h.image_url!==null&&"detail"in h.image_url)return h.image_url.detail})}:h.type==="input_text"||h.type==="input_image"||h.type==="input_file"?h:[]));return d.length>0&&f.push({type:"message",role:u,content:d}),f}return console.warn(`Unsupported role found when converting to OpenAI Responses API: ${u}`),[]});var D5=class extends my{constructor(e,t){super(py(e,t))}invocationParams(e){let t;e?.strict!==void 0&&(t=e.strict),t===void 0&&this.supportsStrictToolCalling!==void 0&&(t=this.supportsStrictToolCalling);const n={model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,service_tier:this.service_tier,stream:this.streaming,previous_response_id:e?.previous_response_id,truncation:e?.truncation,include:e?.include,tools:e?.tools?.length?this._reduceChatOpenAITools(e.tools,{stream:this.streaming,strict:t}):void 0,tool_choice:IU(e?.tool_choice)?e?.tool_choice:(()=>{const s=iC(e?.tool_choice);if(typeof s=="object"&&"type"in s){if(s.type==="function")return{type:"function",name:s.function.name};if(s.type==="allowed_tools")return{type:"allowed_tools",mode:s.allowed_tools.mode,tools:s.allowed_tools.tools};if(s.type==="custom")return{type:"custom",name:s.custom.name}}})(),text:(()=>{if(e?.text)return e.text;const s=this._getResponseFormat(e?.response_format);return s?.type==="json_schema"?s.json_schema.schema!=null?{format:{type:"json_schema",schema:s.json_schema.schema,description:s.json_schema.description,name:s.json_schema.name,strict:s.json_schema.strict},verbosity:e?.verbosity}:void 0:{format:s,verbosity:e?.verbosity}})(),parallel_tool_calls:e?.parallel_tool_calls,max_output_tokens:this.maxTokens===-1?void 0:this.maxTokens,prompt_cache_key:e?.promptCacheKey??this.promptCacheKey,prompt_cache_retention:e?.promptCacheRetention??this.promptCacheRetention,...this.zdrEnabled?{store:!1}:{},...this.modelKwargs},r=this._getReasoningParams(e);return r!==void 0&&(n.reasoning=r),n}async _generate(e,t,n){t.signal?.throwIfAborted();const r=this.invocationParams(t);if(r.stream){const s=this._streamResponseChunks(e,t,n);let o;for await(const u of s)u.message.response_metadata={...u.generationInfo,...u.message.response_metadata},o=o?.concat(u)??u;return{generations:o?[o]:[],llmOutput:{estimatedTokenUsage:o?.message?.usage_metadata}}}else{const s=await this.completionWithRetry({input:r1({messages:e,zdrEnabled:this.zdrEnabled??!1,model:this.model}),...r,stream:!1},{signal:t?.signal,...t?.options});return{generations:[{text:s.output_text,message:xC(s)}],llmOutput:{id:s.id,estimatedTokenUsage:s.usage?{promptTokens:s.usage.input_tokens,completionTokens:s.usage.output_tokens,totalTokens:s.usage.total_tokens}:void 0}}}}async*_streamResponseChunks(e,t,n){const r=await this.completionWithRetry({...this.invocationParams(t),input:r1({messages:e,zdrEnabled:this.zdrEnabled??!1,model:this.model}),stream:!0},t);for await(const s of r){if(t.signal?.aborted)return;const o=L5(s);o!=null&&(yield o,await n?.handleLLMNewToken(o.text||"",{prompt:t.promptIndex??0,completion:0},void 0,void 0,void 0,{chunk:o}))}}async completionWithRetry(e,t){return this.caller.call(async()=>{const n=this._getClientOptions(t);try{return e.text?.format?.type==="json_schema"&&!e.stream?await this.client.responses.parse(e,n):await this.client.responses.create(e,n)}catch(r){throw uy(r)}})}_reduceChatOpenAITools(e,t){const n=[];for(const r of e)if(cy(r))r.type==="image_generation"&&t?.stream&&(r.partial_images=1),n.push(r);else if(Pf(r)){const s=r.metadata.customTool;n.push({type:"custom",name:s.name,description:s.description,format:s.format})}else vC(r)?n.push({type:"function",name:r.function.name,parameters:r.function.parameters,description:r.function.description,strict:t?.strict??null}):oC(r)&&n.push(LU(r));return n}},U5=class OC extends my{useResponsesApi=!1;responses;completions;get lc_serializable_keys(){return[...super.lc_serializable_keys,"useResponsesApi"]}get callKeys(){return[...super.callKeys,"useResponsesApi"]}fields;constructor(t,n){const r=py(t,n);super(r),this.fields=r,this.useResponsesApi=r?.useResponsesApi??!1,this.responses=r?.responses??new D5(r),this.completions=r?.completions??new $5(r)}_useResponsesApi(t){const n=t?.tools?.some(cy),r=t?.previous_response_id!=null||t?.text!=null||t?.truncation!=null||t?.include!=null||t?.reasoning?.summary!=null||this.reasoning?.summary!=null,s=t?.tools?.some(oC)||t?.tools?.some(Pf);return this.useResponsesApi||n||r||s||_U(this.model)}getLsParams(t){const n=this._combineCallOptions(t);return this._useResponsesApi(t)?this.responses.getLsParams(n):this.completions.getLsParams(n)}invocationParams(t){const n=this._combineCallOptions(t);return this._useResponsesApi(t)?this.responses.invocationParams(n):this.completions.invocationParams(n)}async _generate(t,n,r){return this._useResponsesApi(n)?this.responses._generate(t,n,r):this.completions._generate(t,n,r)}async*_streamResponseChunks(t,n,r){if(this._useResponsesApi(n)){yield*this.responses._streamResponseChunks(t,this._combineCallOptions(n),r);return}yield*this.completions._streamResponseChunks(t,this._combineCallOptions(n),r)}withConfig(t){const n=new OC(this.fields);return n.defaultOptions={...this.defaultOptions,...t},n}};const P5=sn({type:Yn("screenshot")}),B5=sn({type:Yn("click"),x:an(),y:an(),button:fy(["left","right","wheel","back","forward"]).default("left")}),Z5=sn({type:Yn("double_click"),x:an(),y:an(),button:fy(["left","right","wheel","back","forward"]).default("left")}),q5=sn({type:Yn("drag"),path:Xl(sn({x:an(),y:an()}))}),F5=sn({type:Yn("keypress"),keys:Xl(Hn())}),H5=sn({type:Yn("move"),x:an(),y:an()}),G5=sn({type:Yn("scroll"),x:an(),y:an(),scroll_x:an(),scroll_y:an()}),V5=sn({type:Yn("type"),text:Hn()}),J5=sn({type:Yn("wait"),duration:an().optional()}),X5=bd([P5,B5,Z5,q5,F5,H5,G5,V5,J5]);sn({action:X5});const Y5=sn({type:Yn("exec"),command:Xl(Hn()),env:$P(Hn(),Hn()).optional(),working_directory:Hn().optional(),timeout_ms:an().optional(),user:Hn().optional()});bd([Y5]);sn({commands:Xl(Hn()).describe("Array of shell commands to execute"),timeout_ms:an().optional().describe("Optional timeout in milliseconds for the commands"),max_output_length:an().optional().describe("Optional maximum number of characters to return from each command")});const Q5=sn({type:Yn("create_file"),path:Hn(),diff:Hn()}),K5=sn({type:Yn("update_file"),path:Hn(),diff:Hn()}),W5=sn({type:Yn("delete_file"),path:Hn()});bd([Q5,K5,W5]);function e9(){return new U5({apiKey:"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",model:"gpt-4o-mini",maxTokens:500,temperature:.7})}let hg=null;function wd(){return hg||(hg=e9()),hg}async function t9(e){const t=new Qi("JSON only."),n=e.resumeText?e.resumeText.slice(0,300)+"...":"No resume",r=e.jdText.slice(0,500)+"...",s=e.durationMinutes===10?5:e.durationMinutes===20?8:10,u=(d=>d==="Fresher"?"entry":d==="1 year"||d==="2 years"?"junior":d==="3 years"?"mid":d==="5 years"?"senior":d==="10+ years"?"lead":"mid")(e.yoe),f=new Gs(`${e.domain} ${e.yoe} ${u} ${e.durationMinutes}min
${e.candidateName}
Resume: ${n}
JD: ${r}

{"introduction":"Hi ${e.candidateName}, hope you're having a good day! Let's start with you sharing a bit about yourself and your experience, then we'll proceed with some questions.","questions":[{"id":"q1","prompt":"?","competency":"tech","followUps":[{"id":"q1_f1","prompt":"?"},{"id":"q1_f2","prompt":"?"}]}]}

${s} questions. Short.`);try{const m=((await wd().invoke([t,f])).content||"").trim().replace(/^```[a-z]*\n?/i,"").replace(/```$/i,"").trim();return JSON.parse(m)}catch(d){throw console.error("Interview generation error:",d),new Error("Failed to generate interview questions")}}async function n9(e,t,n){const r=new Qi("JSON only."),s=n.slice(-1).map(u=>`Q:${u.question}
A:${u.answer}`).join(`
`),o=new Gs(`Q:${e}
A:${t}
C:${s}

{"score":3,"feedback":["ok"],"needsFollowUp":false,"followUpQuestion":""}`);try{const d=((await wd().invoke([r,o])).content||"").trim().replace(/^```[a-z]*\n?/i,"").replace(/```$/i,"").trim();return JSON.parse(d)}catch(u){return console.error("Evaluation error:",u),{score:3,feedback:["Unable to evaluate"],needsFollowUp:!1}}}async function a1(e,t,n,r){const s=new Qi("JSON only."),u=(h=>h==="Fresher"?"patient":h==="1 year"?"encourage":h==="2 years"?"balanced":h==="3 years"?"professional":h==="5 years"?"direct":h==="10+ years"?"concise":"balanced")(r),f=n.slice(-1).map(h=>`Q:${h.question}
A:${h.answer}`).join(`
`),d=new Gs(`Q:${t}
U:"${e}"
YOE:${r}(${u})
C:${f}

{"intent":"answer","response":"","shouldProceed":true,"extraTime":0}`);try{const _=((await wd().invoke([s,d])).content||"").trim().replace(/^```[a-z]*\n?/i,"").replace(/```$/i,"").trim();return JSON.parse(_)}catch(h){return console.error("User response handling error:",h),{intent:"answer",response:"",shouldProceed:!0,extraTime:0}}}async function r9(e,t){const n=new Qi("JSON only."),r=e.map(o=>`Q:${o.prompt}
A:${o.answer}
S:${o.evaluation.score}`).join(`
`),s=new Gs(`${t.candidateName} ${t.domain} ${t.yoe}
${r}

{"overallScore":3,"strengths":[],"improvements":[],"competencyScores":{},"recommendation":"consider","summary":"ok"}`);try{const f=((await wd().invoke([n,s])).content||"").trim().replace(/^```[a-z]*\n?/i,"").replace(/```$/i,"").trim();return JSON.parse(f)}catch(o){throw console.error("Report generation error:",o),new Error("Failed to generate report")}}function a9(e){const[t,n]=Re.useState(null),[r,s]=Re.useState(0),[o,u]=Re.useState([]),[f,d]=Re.useState(!0),[h,m]=Re.useState(null),_=Re.useRef([]),y=Re.useRef({transcript:o,currentQuestionIndex:r});Re.useEffect(()=>{y.current={transcript:o,currentQuestionIndex:r}},[o,r]),Re.useEffect(()=>{async function N(){try{d(!0);const M=await t9(e);n(M);const B=[];M.questions.forEach(Y=>{B.push({id:Y.id,prompt:Y.prompt,competency:Y.competency,type:"main"}),Y.followUps.forEach(W=>{B.push({id:W.id,prompt:W.prompt,competency:Y.competency,type:"followup",parentQuestion:Y.prompt})})}),_.current=B}catch(M){console.error("Failed to generate interview:",M),_.current=[{id:"fallback1",prompt:`Tell me about your experience with ${e.domain} development.`,competency:"experience",type:"main"},{id:"fallback2",prompt:"What projects are you most proud of?",competency:"projects",type:"main"}],n({introduction:`Hi ${e.candidateName}, hope you're having a good day! Let's start with you sharing a bit about yourself and your experience, then we'll proceed with some questions.`,questions:_.current})}finally{d(!1)}}N()},[e]);const v=_.current[r]||null,w=!!h;async function x(N,M="voice"){if(!v||w)return{ok:!1,message:"No active question"};const B=String(N||"").trim();if(!B)return{ok:!1,message:"Answer cannot be empty"};try{const Y=await n9(v.prompt,B,y.current.transcript),W={id:`${v.id}_answer`,questionId:v.id,prompt:v.prompt,answer:B,competency:v.competency,type:v.type,inputMode:M,evaluation:Y,answeredAt:new Date().toISOString()},C=[...y.current.transcript,W];if(u(C),Y.needsFollowUp&&Y.followUpQuestion){const xe={id:`fu_${Date.now()}`,prompt:Y.followUpQuestion,competency:v.competency,type:"dynamic_followup",parentQuestion:v.prompt};_.current.splice(r+1,0,xe)}const Te=r+1;return s(Te),Te>=_.current.length?(await R(C),{ok:!0,evaluation:Y,isComplete:!0}):{ok:!0,evaluation:Y,isComplete:!1}}catch(Y){return console.error("Answer submission error:",Y),{ok:!1,message:"Failed to process answer"}}}async function R(N){try{const M=await r9(N,e);return m(M),M}catch(M){console.error("Report generation error:",M);const B={overallScore:3,strengths:["Completed interview"],improvements:["Continue practicing"],competencyScores:{},recommendation:"consider",summary:"Interview completed successfully"};return m(B),B}}function E(){if(!v)return;const N={id:`${v.id}_skipped`,questionId:v.id,prompt:v.prompt,answer:"",competency:v.competency,type:v.type,skipped:!0,evaluation:{score:1,feedback:["Question skipped"]},answeredAt:new Date().toISOString()},M=[...y.current.transcript,N];u(M);const B=r+1;s(B),B>=_.current.length&&R(M)}function A(){R(y.current.transcript)}return{introduction:t?.introduction||"",templateLabel:`${e.domain} Engineer`,progress:{current:Math.min(r+1,_.current.length),total:_.current.length},currentQuestion:v,transcript:o,isComplete:w,isGenerating:f,report:h,submitAnswer:x,skipQuestion:E,endInterviewNow:A}}function s9(){const e=Re.useRef(null),t=Re.useRef(""),n=Re.useRef(null),r=Re.useRef(null),[s,o]=Re.useState(!1),[u,f]=Re.useState(""),[d,h]=Re.useState(""),[m,_]=Re.useState(""),y=Re.useMemo(()=>typeof window>"u"?!1:!!(window.SpeechRecognition||window.webkitSpeechRecognition),[]);Re.useEffect(()=>{if(!y)return;const R=window.SpeechRecognition||window.webkitSpeechRecognition,E=new R;return E.continuous=!1,E.interimResults=!0,E.lang="en-US",E.onresult=A=>{let N="",M="";for(let B=A.resultIndex;B<A.results.length;B+=1){const Y=A.results[B],W=Y[0]?.transcript||"";Y.isFinal?N+=`${W} `:M+=`${W} `}N.trim()&&f(B=>{const Y=`${B} ${N}`.trim();return t.current=Y,Y}),h(M.trim())},E.onstart=()=>{o(!0),_("")},E.onend=()=>{o(!1),h(""),typeof n.current=="function"&&n.current(t.current.trim())},E.onerror=A=>{const N=A.error||"Speech recognition failed.";_(N),o(!1),typeof r.current=="function"&&r.current(N)},e.current=E,()=>{E.stop(),e.current=null,n.current=null,r.current=null}},[y]);function v(R={}){if(!e.current||s)return!1;e.current.continuous=!!R.continuous,e.current.interimResults=R.interimResults??!0,e.current.lang=R.lang||"en-US",n.current=R.onEnd||null,r.current=R.onError||null,f(""),h(""),_(""),t.current="";try{return e.current.start(),!0}catch(E){return _(E.message||"Could not start speech recognition."),!1}}function w(){!e.current||!s||e.current.stop()}function x(){f(""),h(""),_(""),t.current=""}return{isSupported:y,isListening:s,finalTranscript:u,interimTranscript:d,error:m,startListening:v,stopListening:w,resetTranscript:x}}const i9=["google us english","microsoft aria","microsoft guy","microsoft jenny","english united states","samantha"];function s1(e){const t=String(e?.name||"").toLowerCase(),n=String(e?.lang||"").toLowerCase();let r=0;return n.startsWith("en-us")?r+=5:n.startsWith("en")&&(r+=3),i9.forEach((s,o)=>{t.includes(s)&&(r+=10-o)}),e?.localService&&(r+=1),r}function o9(e){return e.length?e.slice().sort((t,n)=>s1(n)-s1(t))[0]:null}function l9(){const[e,t]=Re.useState(!1),[n,r]=Re.useState(""),[s,o]=Re.useState([]),u=Re.useRef(null),f=Re.useMemo(()=>typeof window>"u"?!1:!!(window.speechSynthesis&&window.SpeechSynthesisUtterance),[]);Re.useEffect(()=>{if(!f)return;const _=()=>{const y=window.speechSynthesis.getVoices();o(y)};return _(),window.speechSynthesis.addEventListener("voiceschanged",_),()=>{window.speechSynthesis.removeEventListener("voiceschanged",_)}},[f]),Re.useEffect(()=>()=>{typeof window<"u"&&window.speechSynthesis&&window.speechSynthesis.cancel(),u.current=null},[]);const d=Re.useMemo(()=>o9(s),[s]);function h(){f&&(window.speechSynthesis.cancel(),t(!1))}function m(_,y={}){if(!f)return!1;const v=String(_||"").trim();if(!v)return!1;h(),r("");const w=new SpeechSynthesisUtterance(v);return w.voice=y.voice||d||null,w.lang=y.lang||w.voice?.lang||"en-US",w.rate=y.rate||.96,w.pitch=y.pitch||.95,w.volume=y.volume||1,w.onstart=()=>{t(!0)},w.onend=()=>{t(!1),typeof y.onEnd=="function"&&y.onEnd()},w.onerror=x=>{r(x.error||"Speech synthesis failed."),t(!1)},u.current=w,window.speechSynthesis.speak(w),!0}return{isSupported:f,isSpeaking:e,error:n,speak:m,cancel:h}}const u9="_stage_13pvu_1",c9="_rightRail_13pvu_14",f9="_aiCard_13pvu_18",d9="_userCard_13pvu_19",h9="_leftStage_13pvu_29",p9="_speechBubble_13pvu_34",m9="_orbWrap_13pvu_39",g9="_orb_13pvu_39",_9="_aiCore_13pvu_57",y9="_avatar_13pvu_72",v9="_controls_13pvu_77",b9="_primaryButton_13pvu_81",w9="_secondaryButton_13pvu_82",S9="_headline_13pvu_94",E9="_liveTag_13pvu_112",T9="_bubbleDot_13pvu_167",x9="_voiceStage_13pvu_179",O9="_userMeta_13pvu_347",A9="_warning_13pvu_358",C9="_error_13pvu_363",R9="_card_13pvu_368",N9="_srOnly_13pvu_375",Be={stage:u9,rightRail:c9,aiCard:f9,userCard:d9,leftStage:h9,speechBubble:p9,orbWrap:m9,orb:g9,aiCore:_9,avatar:y9,controls:v9,primaryButton:b9,secondaryButton:w9,headline:S9,liveTag:E9,bubbleDot:T9,voiceStage:x9,userMeta:O9,warning:A9,error:C9,card:R9,srOnly:N9};function I9({config:e,onComplete:t,onAbort:n}){const[r,s]=Re.useState(!1),[o,u]=Re.useState("ready"),[f,d]=Re.useState("Preparing personalized interview..."),[h,m]=Re.useState(""),[_,y]=Re.useState(!1),[v,w]=Re.useState(""),x=Re.useRef(null),R=Re.useRef(null),E=Re.useRef(null),A=Re.useRef(()=>{}),N=Re.useRef(()=>{}),M=a9(e),B=s9(),Y=l9(),W=h||B.error||Y.error,C=e.candidateName.split(/\s+/).filter(Boolean).slice(0,2).map(D=>D[0]?.toUpperCase()).join("");Re.useEffect(()=>{M.report&&t(M.report)},[M.report,t]),Re.useEffect(()=>{E.current=M,A.current=B.stopListening,N.current=Y.cancel},[M,B.stopListening,Y.cancel]),Re.useEffect(()=>{!M.isGenerating&&!M.currentQuestion?d("Interview preparation failed. Please try again."):M.isGenerating||d("Ready to start your personalized interview.")},[M.isGenerating,M.currentQuestion]);function Te(){x.current&&(window.clearTimeout(x.current),x.current=null)}function xe(){R.current&&(window.clearTimeout(R.current),R.current=null)}function me(){xe(),R.current=window.setTimeout(()=>{Je()},1e4)}async function Je(){if(!r||_)return;d("Taking longer than expected? Need more time?"),u("processing");const D=await a1("timeout",M.currentQuestion?.prompt||"",M.transcript,e.yoe);D.intent==="timeout"&&F(D.response||"Would you like more time to think, or should I repeat the question?","listen")}async function At(D){if(!(!r||_)){y(!0),u("processing"),xe();try{const V=await a1(D,M.currentQuestion?.prompt||"",M.transcript,e.yoe);if(V.intent==="clarify"||V.intent==="repeat")F(V.response||M.currentQuestion?.prompt||"Let me repeat the question.","listen");else if(V.intent==="thinking"){const ie=V.extraTime||30;d(`Take your time... (${ie}s)`),F(V.response||"Take your time.","wait"),setTimeout(()=>{ne(M.currentQuestion?.prompt||"")},ie*1e3)}else V.intent==="answer"?await se(D):F(V.response||"Please answer the question.","listen")}catch(V){console.error("User input handling error:",V),F("Could you please repeat that?","listen")}finally{y(!1)}}}function ue(D=1e3){Te(),x.current=window.setTimeout(()=>{const V=E.current;if(!V||V.isComplete||V.report)return;const ie=V.currentQuestion;ie&&ne(ie.prompt)},D)}async function se(D){const V=E.current;if(!V||V.isComplete||V.report||_)return;const ie=String(D||"").trim(),he=ie.toLowerCase(),O=["let me think","give me a moment","i need time","let me consider"],S=["can you explain","didnt get that","can you repeat","what do you mean","clarify"],Q=["repeat","again","say that again","didnt hear"];if(O.some(L=>he.includes(L))){await At(ie);return}if(S.some(L=>he.includes(L))||Q.some(L=>he.includes(L))){await At(ie);return}if(!ie){d("No response detected. Please try again."),F("I didn't catch that. Could you please answer?","listen");return}m(""),u("processing"),d("Analyzing your response..."),y(!0);try{const L=await V.submitAnswer(ie,"voice");if(B.resetTranscript(),!L.ok){u("error"),m(L.message);return}if(L.isComplete){d("Interview complete. Generating your report...");return}const Pe=L.evaluation;let nt="";if(Pe.feedback&&Pe.feedback.length>0)nt=Pe.feedback[0];else{const Nt=["Good point, let's continue.","Thanks for sharing.","I understand.","That makes sense."];nt=Nt[Math.floor(Math.random()*Nt.length)]}F(nt,"wait"),setTimeout(()=>{ue(800)},1200)}catch(L){u("error"),m("Something went wrong while processing your answer."),console.error("[InterviewSession] submitAnswer error:",L)}finally{y(!1)}}function $(){if(!B.isSupported){u("error"),m("Speech recognition is unavailable in this browser. Use Chrome or Edge.");return}if(B.resetTranscript(),!B.startListening({continuous:!1,interimResults:!0,lang:"en-US",onEnd:se,onError:V=>{u("error"),m(V)}})){u("error"),m("Microphone could not start. Please allow mic permission and retry.");return}m(""),u("listening"),d("Listening..."),me()}function F(D,V="listen"){if(!D)return;if(m(""),u("ai-speaking"),d("Interviewer speaking..."),w(D),xe(),!Y.isSupported){V==="listen"&&$(),V==="wait"&&ue();return}Y.speak(D,{rate:.85,onEnd:()=>{V==="listen"&&$(),V==="wait"&&ue()}})||(V==="listen"&&$(),V==="wait"&&ue())}function ne(D){B.resetTranscript(),F(D,"listen")}function oe(){if(M.isGenerating){d("Still preparing your interview...");return}if(!M.currentQuestion){m("Failed to generate interview questions.");return}s(!0),d("Starting interview..."),M.introduction?F(M.introduction,"wait"):ne(M.currentQuestion.prompt)}function fe(){!r||!M.currentQuestion||_||ne(M.currentQuestion.prompt)}function I(){Te(),xe(),Y.cancel(),B.stopListening(),y(!0),d("Ending interview..."),M.endInterviewNow()}return Re.useEffect(()=>()=>{x.current&&window.clearTimeout(x.current),R.current&&window.clearTimeout(R.current),N.current(),A.current()},[]),M.isGenerating?G.jsxs("section",{className:Be.stage,children:[G.jsx("div",{className:Be.leftStage,children:G.jsxs("div",{className:Be.voiceStage,children:[G.jsx("div",{className:Be.orbWrap,"data-phase":"processing",children:G.jsx("span",{className:Be.orb})}),G.jsx("p",{className:Be.liveTag,children:"Generating personalized interview..."})]})}),G.jsxs("aside",{className:Be.rightRail,children:[G.jsxs("div",{className:Be.aiCard,children:[G.jsx("div",{className:Be.aiCore,"data-phase":"processing",children:G.jsx("span",{})}),G.jsx("p",{children:"AI Interviewer"})]}),G.jsxs("div",{className:Be.userCard,children:[G.jsx("div",{className:Be.avatar,children:C||"U"}),G.jsxs("div",{className:Be.userMeta,children:[G.jsx("p",{children:e.candidateName}),G.jsx("span",{children:"Preparing..."})]})]})]})]}):M.currentQuestion?G.jsxs("section",{className:Be.stage,"aria-labelledby":"voice-interview-title",children:[G.jsxs("div",{className:Be.leftStage,children:[G.jsxs("header",{className:Be.headline,children:[G.jsxs("h2",{id:"voice-interview-title",children:[M.templateLabel," Interview"]}),G.jsxs("span",{children:[M.progress.current,"/",M.progress.total]})]}),G.jsxs("div",{className:Be.speechBubble,"aria-live":"polite","aria-atomic":"true",children:[G.jsx("div",{className:Be.bubbleDot}),o==="ai-speaking"?G.jsxs("p",{children:[G.jsx("strong",{children:"AI:"})," ",v]}):o==="listening"?G.jsxs("p",{children:[G.jsx("strong",{children:"You:"})," ",B.interimTranscript||B.finalTranscript||"..."]}):G.jsx("p",{children:f})]}),G.jsxs("div",{className:Be.voiceStage,children:[G.jsx("div",{className:Be.orbWrap,"data-phase":o,children:G.jsx("span",{className:Be.orb})}),o==="listening"&&G.jsx("p",{className:Be.liveTag,children:"Listening..."}),_&&G.jsx("p",{className:Be.liveTag,children:"Processing..."})]}),G.jsxs("div",{className:Be.controls,children:[!r&&G.jsx("button",{type:"button",className:Be.primaryButton,onClick:oe,disabled:M.isGenerating,children:M.isGenerating?"Preparing...":"Start Interview"}),G.jsx("button",{type:"button",className:Be.secondaryButton,onClick:fe,disabled:!r||Y.isSpeaking||_,children:"Repeat"}),G.jsx("button",{type:"button",className:Be.secondaryButton,onClick:I,disabled:_||M.isComplete,children:"End Interview"})]}),!Y.isSupported&&G.jsx("p",{className:Be.warning,children:"Voice playback unavailable in this browser."}),!B.isSupported&&G.jsx("p",{className:Be.error,children:"Microphone speech recognition unavailable."}),W&&G.jsx("p",{className:Be.error,role:"alert",children:W})]}),G.jsxs("aside",{className:Be.rightRail,children:[G.jsxs("div",{className:Be.aiCard,children:[G.jsx("div",{className:Be.aiCore,"data-phase":o,children:G.jsx("span",{})}),G.jsx("p",{children:"AI Interviewer"})]}),G.jsxs("div",{className:Be.userCard,children:[G.jsx("div",{className:Be.avatar,children:C||"U"}),G.jsxs("div",{className:Be.userMeta,children:[G.jsx("p",{children:e.candidateName}),G.jsx("span",{children:o==="listening"?"Speaking":"Ready"})]})]})]}),G.jsx("p",{className:Be.srOnly,children:M.currentQuestion.prompt})]}):G.jsxs("section",{className:Be.card,children:[G.jsx("p",{children:"Failed to generate interview questions."}),G.jsx("button",{type:"button",className:Be.secondaryButton,onClick:n,children:"Exit Session"})]})}const k9="_card_hwdzd_1",$9="_header_hwdzd_10",M9="_scoreBadge_hwdzd_30",j9="_grid_hwdzd_51",L9="_panel_hwdzd_58",z9="_primaryButton_hwdzd_91",la={card:k9,header:$9,scoreBadge:M9,grid:j9,panel:L9,primaryButton:z9};function D9({report:e,onStartOver:t}){return G.jsxs("section",{className:la.card,"aria-labelledby":"report-title",children:[G.jsxs("header",{className:la.header,children:[G.jsxs("div",{children:[G.jsx("h2",{id:"report-title",children:"Interview Report"}),G.jsxs("p",{children:["Candidate: ",G.jsx("strong",{children:e.candidateName})," | Template:"," ",G.jsx("strong",{children:e.templateLabel})]})]}),G.jsxs("div",{className:la.scoreBadge,role:"status","aria-live":"polite",children:[G.jsx("span",{children:"Overall"}),G.jsxs("strong",{children:[e.overallScore,"/5"]})]})]}),G.jsxs("div",{className:la.grid,children:[G.jsxs("div",{className:la.panel,children:[G.jsx("h3",{children:"Competency Scores"}),G.jsx("ul",{children:e.competencyScores.map(n=>G.jsxs("li",{children:[G.jsx("span",{children:n.competency}),G.jsxs("strong",{children:[n.score,"/5"]})]},n.competency))})]}),G.jsxs("div",{className:la.panel,children:[G.jsx("h3",{children:"JD Match"}),G.jsxs("p",{children:[G.jsx("strong",{children:"Matched skills:"})," ",e.matchedSkills.length?e.matchedSkills.join(", "):"None detected"]}),G.jsxs("p",{children:[G.jsx("strong",{children:"Missing required:"})," ",e.missingRequiredSkills.length?e.missingRequiredSkills.join(", "):"No critical gaps detected"]})]}),G.jsxs("div",{className:la.panel,children:[G.jsx("h3",{children:"Strengths"}),G.jsx("ul",{children:e.strengths.map(n=>G.jsx("li",{children:n},n))})]}),G.jsxs("div",{className:la.panel,children:[G.jsx("h3",{children:"Improvements"}),G.jsx("ul",{children:e.improvements.map(n=>G.jsx("li",{children:n},n))})]})]}),G.jsx("button",{type:"button",className:la.primaryButton,onClick:t,children:"Start New Mock Interview"})]})}const U9=["txt","md","json","csv","log"],P9=1024*1024*2;function B9(e){const t=String(e||"").split(".");return t.length>1?t.pop().toLowerCase():""}function Z9(e){return new Promise((t,n)=>{const r=B9(e?.name),s=U9.includes(r)?"":"Non-text files may not parse correctly in this backend-free prototype.",o=e?.size>P9?"Large files may affect responsiveness. Prefer a smaller text-only resume/JD extract.":"",u=[s,o].filter(Boolean).join(" "),f=new FileReader;f.onload=d=>{t({text:String(d.target?.result||""),warning:u})},f.onerror=()=>{n(new Error("Could not read this file. Try copy-pasting plain text instead."))},f.readAsText(e)})}const q9="_card_1g4ak_1",F9="_form_1g4ak_12",H9="_rowGroup_1g4ak_17",G9="_row_1g4ak_17",V9="_fileInput_1g4ak_73",J9="_filePreview_1g4ak_105",X9="_error_1g4ak_116",Y9="_primaryButton_1g4ak_126",Dn={card:q9,form:F9,rowGroup:H9,row:G9,fileInput:V9,filePreview:J9,error:X9,primaryButton:Y9},Q9=["Frontend","Backend","Fullstack","DevOps","QA","SRE"],K9=["Fresher","1 year","2 years","3 years","5 years","10+ years"];function W9({onStartInterview:e}){const[t,n]=Re.useState(""),[r,s]=Re.useState(20),[o,u]=Re.useState(""),[f,d]=Re.useState(""),[h,m]=Re.useState("Frontend"),[_,y]=Re.useState("1 year"),[v,w]=Re.useState("");async function x(E,A){const N=E.target.files?.[0];if(N)try{const{text:M}=await Z9(N);A==="resume"&&u(M),w("")}catch(M){w(M.message)}}function R(E){if(E.preventDefault(),!t.trim()){w("Candidate name is required.");return}if(!f.trim()){w("Job Description is required.");return}w(""),e({candidateName:t.trim(),durationMinutes:Number(r),resumeText:o,jdText:f,domain:h,yoe:_})}return G.jsx("section",{className:Dn.card,children:G.jsxs("form",{className:Dn.form,onSubmit:R,children:[G.jsxs("div",{className:Dn.row,children:[G.jsx("label",{htmlFor:"candidateName",children:"Name"}),G.jsx("input",{id:"candidateName",value:t,onChange:E=>n(E.target.value),placeholder:"Enter your name",autoComplete:"name",required:!0})]}),G.jsxs("div",{className:Dn.rowGroup,children:[G.jsxs("div",{className:Dn.row,children:[G.jsx("label",{htmlFor:"domain",children:"Domain/Role"}),G.jsx("select",{id:"domain",value:h,onChange:E=>m(E.target.value),children:Q9.map(E=>G.jsx("option",{value:E,children:E},E))})]}),G.jsxs("div",{className:Dn.row,children:[G.jsx("label",{htmlFor:"yoe",children:"Years of Experience"}),G.jsx("select",{id:"yoe",value:_,onChange:E=>y(E.target.value),children:K9.map(E=>G.jsx("option",{value:E,children:E},E))})]})]}),G.jsxs("div",{className:Dn.row,children:[G.jsx("label",{htmlFor:"duration",children:"Duration"}),G.jsxs("select",{id:"duration",value:r,onChange:E=>s(E.target.value),children:[G.jsx("option",{value:10,children:"10 min"}),G.jsx("option",{value:20,children:"20 min"}),G.jsx("option",{value:30,children:"30 min"})]})]}),G.jsxs("div",{className:Dn.row,children:[G.jsx("label",{htmlFor:"jdText",children:"Job Description"}),G.jsx("textarea",{id:"jdText",value:f,onChange:E=>d(E.target.value),placeholder:"Paste the job description here...",rows:4,required:!0})]}),G.jsxs("div",{className:Dn.row,children:[G.jsx("label",{htmlFor:"resumeFile",children:"Resume (Optional)"}),G.jsx("input",{id:"resumeFile",type:"file",accept:".txt,.md,.json,.csv,.log,text/plain,.pdf,.doc,.docx",onChange:E=>x(E,"resume"),className:Dn.fileInput}),o&&G.jsx("div",{className:Dn.filePreview,children:"Resume uploaded "})]}),v&&G.jsx("div",{className:Dn.error,children:v}),G.jsx("button",{type:"submit",className:Dn.primaryButton,children:"Start Interview"})]})})}const e8="_fullScreen_fbpro_1",t8="_heroSection_fbpro_10",n8="_heroTitle_fbpro_16",r8="_heroSubtitle_fbpro_39",a8="_shell_fbpro_68",s8="_shellInterview_fbpro_74",i8="_skipLink_fbpro_82",o8="_header_fbpro_97",l8="_headerInterview_fbpro_106",u8="_main_fbpro_122",c8="_mainInterview_fbpro_126",f8="_interviewTitle_fbpro_130",d8="_secondaryButton_fbpro_138",Un={fullScreen:e8,heroSection:t8,heroTitle:n8,heroSubtitle:r8,shell:a8,shellInterview:s8,skipLink:i8,header:o8,headerInterview:l8,main:u8,mainInterview:c8,interviewTitle:f8,secondaryButton:d8};function h8(){const[e,t]=Re.useState("setup"),[n,r]=Re.useState(null),[s,o]=Re.useState(null);function u(h){r(h),o(null),t("interview")}function f(h){o(h),t("report")}function d(){r(null),o(null),t("setup")}return e==="setup"?G.jsx("div",{className:Un.fullScreen,children:G.jsxs("div",{className:Un.heroSection,children:[G.jsx("h1",{className:Un.heroTitle,children:"NEXUS AI"}),G.jsx("p",{className:Un.heroSubtitle,children:"Advanced Interview Intelligence System"}),G.jsx(W9,{onStartInterview:u})]})}):G.jsxs("div",{className:`${Un.shell} ${e==="interview"?Un.shellInterview:""}`,children:[G.jsx("a",{href:"#main-content",className:Un.skipLink,children:"Skip to main content"}),G.jsxs("header",{className:`${Un.header} ${e==="interview"?Un.headerInterview:""}`,children:[e!=="interview"&&G.jsxs("div",{children:[G.jsx("h1",{children:"Nexus AI"}),G.jsx("p",{children:"Tailored mock interviews for better prep!"})]}),e==="interview"&&G.jsx("h1",{className:Un.interviewTitle,children:"Live Interview Room"}),e!=="setup"&&G.jsx("button",{type:"button",className:Un.secondaryButton,onClick:d,children:"Start New Session"})]}),G.jsxs("main",{id:"main-content",className:`${Un.main} ${e==="interview"?Un.mainInterview:""}`,tabIndex:"-1",children:[e==="interview"&&n&&G.jsx(I9,{config:n,onComplete:f,onAbort:d}),e==="report"&&s&&G.jsx(D9,{report:s,onStartOver:d})]})]})}aI.createRoot(document.getElementById("root")).render(G.jsx(Re.StrictMode,{children:G.jsx(h8,{})}));
